<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>8 Models for Matched Pairs | Notes for Agresti’s Introduction to Categorical Data Analysis 3rd Edition</title>
  <meta name="description" content="Notes for Agresti’s Introduction to Categorical Data Analysis" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="8 Models for Matched Pairs | Notes for Agresti’s Introduction to Categorical Data Analysis 3rd Edition" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Notes for Agresti’s Introduction to Categorical Data Analysis" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="8 Models for Matched Pairs | Notes for Agresti’s Introduction to Categorical Data Analysis 3rd Edition" />
  
  <meta name="twitter:description" content="Notes for Agresti’s Introduction to Categorical Data Analysis" />
  

<meta name="author" content="Raymond R. Balise with help from Wayne F. DeFreitas" />


<meta name="date" content="2021-01-09" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="Loglinear.html"/>
<link rel="next" href="Marginal.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/tabwid-1.0.0/tabwid.css" rel="stylesheet" />


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>0 Prelude</a></li>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i>1 Introduction</a><ul>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#categorical-response-data"><i class="fa fa-check"></i>1.1 Categorical Response Data</a><ul>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#response-variables-and-explanatory-variables"><i class="fa fa-check"></i>1.1.1 Response Variables and Explanatory Variables</a></li>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#binary-nominal-ordinal-scale-distinction"><i class="fa fa-check"></i>1.1.2 Binary-Nominal-Ordinal Scale Distinction</a></li>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#organization-of-this-book"><i class="fa fa-check"></i>1.1.3 Organization of this Book</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#probability-distributions-for-categorical-data"><i class="fa fa-check"></i>1.2 Probability Distributions for Categorical Data</a><ul>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#binomial"><i class="fa fa-check"></i>1.2.1 Binomial Distribution</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#statistical-inference-for-a-proportion"><i class="fa fa-check"></i>1.3 Statistical Inference for a Proportion</a><ul>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#likelihood-function-and-maximum-likelihood-estimation"><i class="fa fa-check"></i>1.3.1 Likelihood Function and Maximum Likelihood Estimation</a></li>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#significance-test-about-a-binomial-parameter"><i class="fa fa-check"></i>1.3.2 Significance Test about a Binomial Parameter</a></li>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#example-surveyed-opinions-about-legalized-abortion"><i class="fa fa-check"></i>1.3.3 Example: Surveyed Opinions About Legalized Abortion</a></li>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#confidence-intervals-for-a-binomial-parameter"><i class="fa fa-check"></i>1.3.4 Confidence Intervals for a Binomial Parameter</a></li>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#better-confidence-intervals-for-a-binomial-proportion"><i class="fa fa-check"></i>1.3.5 Better Confidence Intervals for a Binomial Proportion</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#statistical-inference-for-discrete-data"><i class="fa fa-check"></i>1.4 Statistical Inference for Discrete Data</a><ul>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#x1.4.1"><i class="fa fa-check"></i>1.4.1 Wald, Likelihood-Ratio, and Score Tests</a></li>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#example-wald-score-and-likelihood-ratio-binomial-tests"><i class="fa fa-check"></i>1.4.2 Example Wald, Score and Likelihood-Ratio Binomial Tests</a></li>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#ssbi"><i class="fa fa-check"></i>1.4.3 Small-Sample Binomial Inference and the Mid P-Value</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#bayesian-inference-for-proportions"><i class="fa fa-check"></i>1.5 Bayesian Inference for Proportions</a><ul>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#the-bayesian-approach-to-statistical-inference"><i class="fa fa-check"></i>1.5.1 The Bayesian Approach to Statistical Inference</a></li>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#bayesian-binomial-inference-beta-prior-distributions"><i class="fa fa-check"></i>1.5.2 Bayesian Binomial Inference: Beta Prior Distributions</a></li>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#example-opinions-about-legalized-abortion-revisited"><i class="fa fa-check"></i>1.5.3 Example: Opinions about Legalized Abortion, Revisited</a></li>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#other-prior-distributions"><i class="fa fa-check"></i>1.5.4 Other Prior Distributions</a></li>
</ul></li>
<li><a href="intro.html#using-r-software-for-statistical-inference-about-proportions">1.6 Using <code>R</code> software for Statistical Inference about Proportions</a><ul>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#reading-data-files-and-installing-packages"><i class="fa fa-check"></i>1.6.1 Reading Data Files and Installing Packages</a></li>
<li><a href="intro.html#using-r-for-statistical-inference-about-proportions">1.6.2 Using <code>R</code> for Statistical Inference about Proportions</a></li>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#summary-choosing-an-inference-method"><i class="fa fa-check"></i>1.6.3 Summary: Choosing an Inference Method</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#exercises"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html"><i class="fa fa-check"></i>2 Analyzing Contingency Tables</a><ul>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#probability-structure-for-contingency-tables"><i class="fa fa-check"></i>2.1 Probability Structure for Contingency Tables</a><ul>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#joint-marginal-and-conditional-probabilities"><i class="fa fa-check"></i>2.1.1 Joint, Marginal, and Conditional Probabilities</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#binomial-and-multinomial-sampling"><i class="fa fa-check"></i>2.1.4 Binomial and Multinomial Sampling</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#comparing-proportions-in-2-x-2-contingency-tables"><i class="fa fa-check"></i>2.2 Comparing Proportions in 2 x 2 Contingency Tables</a><ul>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#difference-of-proportions"><i class="fa fa-check"></i>2.2.1 Difference of Proportions</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#table2-2"><i class="fa fa-check"></i>2.2.2 Example: Aspirin and incidence of Heart Attacks</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#ratio-of-proportions-relative-risk"><i class="fa fa-check"></i>2.2.3 Ratio of Proportions (Relative Risk)</a></li>
<li><a href="Contingency.html#using-r-for-comparing-proportions-in-2-x-2-tables">2.2.4 Using <code>R</code> for Comparing Proportions in 2 x 2 Tables</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#the-odds-ratio"><i class="fa fa-check"></i>2.3 The Odds Ratio</a><ul>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#properties-of-the-odds-ratio"><i class="fa fa-check"></i>2.3.1 Properties of the Odds Ratio</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#example-odds-ratio-for-aspirin-and-hart-attacks"><i class="fa fa-check"></i>2.3.2 Example: Odds Ratio for Aspirin and Hart Attacks</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#inference-for-odds-ratios-and-log-odds-ratios"><i class="fa fa-check"></i>2.3.3 Inference for Odds Ratios and Log Odds Ratios</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#relationship-between-odds-ratio-and-relative-risk"><i class="fa fa-check"></i>2.3.4 Relationship Between Odds Ratio and Relative Risk</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#x2.3.5"><i class="fa fa-check"></i>2.3.5 Example: The Odds Ratio Applies in Case-Control Studies</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#types-of-studies-observational-versus-experimental"><i class="fa fa-check"></i>2.3.6 Types of Studies Observational Versus Experimental</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#x2.4"><i class="fa fa-check"></i>2.4 Chi-Squared Tests of Independence</a><ul>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#x2.4.1"><i class="fa fa-check"></i>2.4.1 Pearson Statistic and the Chi-Squared Distribution</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#likelihood-ratio-statistic"><i class="fa fa-check"></i>2.4.2 likelihood-Ratio Statistic</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#testing-independence-in-two-way-contingency-tables"><i class="fa fa-check"></i>2.4.3 Testing Independence in Two-Way Contingency Tables</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#example-gender-gap-in-political-party-affiliation"><i class="fa fa-check"></i>2.4.4 Example: Gender Gap in Political Party Affiliation</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#residuals-for-cells-in-a-contingency-table"><i class="fa fa-check"></i>2.4.5 Residuals for Cells in a Contingency Table</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#partitioning-chi-squared-statistics"><i class="fa fa-check"></i>2.4.6 Partitioning Chi-Squared Statistics</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#limitations-of-chi-squared-tests"><i class="fa fa-check"></i>2.4.7 Limitations of Chi-Squared Tests</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#x2.5"><i class="fa fa-check"></i>2.5 Testing Independence for Ordinal Variables</a><ul>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#linear-trend-alternative-to-independence"><i class="fa fa-check"></i>2.5.1 Linear Trend Alternative to Independence</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#example-alcohol-use-and-infant-malformation"><i class="fa fa-check"></i>2.5.2 Example: Alcohol Use and Infant Malformation</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#ordinal-tests-usually-have-greater-power"><i class="fa fa-check"></i>2.5.3 Ordinal Tests Usually Have Greater Power</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#choice-of-scores"><i class="fa fa-check"></i>2.5.4 Choice of Scores</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#trend-tests-for-r-x-2-and-2-x-c-and-nominal-ordinal-tables"><i class="fa fa-check"></i>2.5.6 Trend Tests for r x 2 and 2 x c and Nominal-Ordinal Tables</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#exact-frequentist-and-bayesian-inference"><i class="fa fa-check"></i>2.6 Exact Frequentist and Bayesian Inference</a><ul>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#fishers-exact-test-for-2-x-2-tables"><i class="fa fa-check"></i>2.6.1 Fisher’s Exact Test for 2 x 2 Tables</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#example-fishers-tea-tasting-colleague"><i class="fa fa-check"></i>2.6.2 Example: Fisher’s Tea Tasting Colleague</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#conservatism-for-actual-ptype-i-error-mid-p-value"><i class="fa fa-check"></i>2.6.3 Conservatism for Actual P(Type I Error); Mid P-Value</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#small-sample-confidence-intervals-for-odds-ratio"><i class="fa fa-check"></i>2.6.4 Small-Sample Confidence Intervals for Odds Ratio</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#bayesian-estimation-for-association-measures"><i class="fa fa-check"></i>2.6.5 Bayesian Estimation for Association Measures</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#example-bayesian-inference-in-a-small-clinical-trial"><i class="fa fa-check"></i>2.6.6 Example: Bayesian Inference in a Small Clinical Trial</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#association-in-three-way-tables"><i class="fa fa-check"></i>2.7 Association in Three-Way Tables</a><ul>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#partial-tables"><i class="fa fa-check"></i>2.7.1 Partial Tables</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#example-death-penalty-verdicts-and-race"><i class="fa fa-check"></i>2.7.2 Example: Death Penalty Verdicts and Race</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#simpsons-paradox"><i class="fa fa-check"></i>2.7.3 Simpson’s Paradox</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#conditional-and-marginal-odds-ratios"><i class="fa fa-check"></i>2.7.4 Conditional and Marginal Odds Ratios</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#x2.7.5"><i class="fa fa-check"></i>2.7.5 Homogeneous Association</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#exercises-1"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html"><i class="fa fa-check"></i>3 Generalized Linear Models</a><ul>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#components-of-a-generalized-linear-model"><i class="fa fa-check"></i>3.1 Components of a Generalized Linear Model</a><ul>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#random-component"><i class="fa fa-check"></i>3.1.1 Random Component</a></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#linear-predictor"><i class="fa fa-check"></i>3.1.2 Linear Predictor</a></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#link-function"><i class="fa fa-check"></i>3.1.3 Link Function</a></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#ordinary-linear-model-glm-with-normal-random-component"><i class="fa fa-check"></i>3.1.4 Ordinary Linear Model: GLM with Normal Random Component</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#components-of-a-generalized-linear-model-1"><i class="fa fa-check"></i>3.2 Components of a Generalized Linear Model</a><ul>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#x3.2.1"><i class="fa fa-check"></i>3.2.1 Linear Probability Model</a></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#logistic-regression-model"><i class="fa fa-check"></i>3.2.2 Logistic Regression Model</a></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#x3.2.3"><i class="fa fa-check"></i>3.2.3 Example Snoring and Heart Disease</a></li>
<li><a href="Generalized.html#using-r-to-fit-generalized-lineare-models-for-binary-data">3.2.4 Using <code>R</code> to Fit Generalized Lineare Models for Binary Data</a></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#x3.2.5"><i class="fa fa-check"></i>3.2.5 Data Files: Ungrouped or Grouped Binary Data</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#x3.3"><i class="fa fa-check"></i>3.3 Generalized Linear Models for Binary Data</a><ul>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#poisson-distribution-for-counts"><i class="fa fa-check"></i>3.3.1 Poisson Distribution for Counts</a></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#poisson-loglinear-model"><i class="fa fa-check"></i>3.3.2 Poisson Loglinear Model</a></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#x3.3.3"><i class="fa fa-check"></i>3.3.3 Example: Female Horseshoe Crabs and their Satellites</a></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#x3.3.4"><i class="fa fa-check"></i>3.3.4 Overdispersion: Greater Variability than Expected</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#generalized-lineaer-models-for-counts-and-rates"><i class="fa fa-check"></i>3.4 Generalized Lineaer Models for Counts and Rates</a><ul>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#x3.4.1"><i class="fa fa-check"></i>3.4.1 Wald, Likelihood-Ratio, and Score Inference Use the Likelihood Function</a></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#example-political-ideology-and-belief-in-evolution"><i class="fa fa-check"></i>3.4.2 Example Political Ideology and Belief in Evolution</a></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#model-comparison-using-the-deviance"><i class="fa fa-check"></i>3.4.4 Model Comparison Using the Deviance</a></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#x3.4.5"><i class="fa fa-check"></i>3.4.5 Residuals Comparing Ovservations to the Model Fit</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#fitting-generalized-linear-models"><i class="fa fa-check"></i>3.5 Fitting Generalized Linear Models</a><ul>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#x3.5.1"><i class="fa fa-check"></i>3.5.1 The Fisher Scoring Algorithm Fits GLMs</a></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#bayesian-methods-for-generalized-lineare-models"><i class="fa fa-check"></i>3.5.2 Bayesian Methods for Generalized Lineare Models</a></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#glms-a-unified-approach-to-statistical-analysis"><i class="fa fa-check"></i>3.5.3 GLMs: A Unified Approach to Statistical Analysis</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html"><i class="fa fa-check"></i>4 Logistic Regression</a><ul>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#the-logistic-regression-model"><i class="fa fa-check"></i>4.1 The Logistic Regression Model</a><ul>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#the-logistic-regression-model-1"><i class="fa fa-check"></i>4.1.1 The Logistic Regression Model</a></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#odds-ratio-and-linear-approximaiton-interpreetations-4.1.2"><i class="fa fa-check"></i>4.1.2 Odds Ratio and Linear Approximaiton Interpreetations {#4.1.2}</a></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#x4.1.3"><i class="fa fa-check"></i>4.1.3 Example: Whethr a Female Horsehoe Crab Has Satelites</a></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#logistic-regression-with-retrospective-studies"><i class="fa fa-check"></i>4.1.4 Logistic Regression with Retrospective Studies</a></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#normally-distributed-x-implies-logistic-regression-for-y"><i class="fa fa-check"></i>4.1.5 Normally Distributed X Implies Logistic Regression for Y</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#x4.2"><i class="fa fa-check"></i>4.2 Statistical Inference for Logistic Regression</a><ul>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#x4.2.1"><i class="fa fa-check"></i>4.2.1 Confidence Intervals for Effects</a></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#x4.2.2"><i class="fa fa-check"></i>4.2.2 Significance Testing</a></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#fitted-values-and-confidence-intervals-for-probabilities"><i class="fa fa-check"></i>4.2.3 Fitted Values and Confidence Intervals for Probabilities</a></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#why-use-a-model-to-estimate-probabilities"><i class="fa fa-check"></i>4.2.4 Why Use a Model to Estimate Probabilities?</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#logistic-regression-with-categorical-predictors"><i class="fa fa-check"></i>4.3 Logistic Regression with Categorical Predictors</a><ul>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#indicator-variables-represent-categories-of-predictors"><i class="fa fa-check"></i>4.3.1 Indicator Variables Represent Categories of Predictors</a></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#example-survey-about-marijuana-use"><i class="fa fa-check"></i>4.3.2 Example: Survey about Marijuana Use</a></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#anova-type-model-representation-of-factors"><i class="fa fa-check"></i>4.3.3 ANOVA-Type Model Representation of Factors</a></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#tests-of-conditoinal-independence-and-of-homogeneity-for-three-way-contingency-tables"><i class="fa fa-check"></i>4.3.4 Tests of Conditoinal Independence and of Homogeneity for Three-Way Contingency Tables</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#multiple-logistic-regression"><i class="fa fa-check"></i>4.4 Multiple Logistic Regression</a><ul>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#x4.4.1"><i class="fa fa-check"></i>4.4.1 Example: Horseshoe Crabs with Color and Width Predictors</a></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#model-comparison-to-check-whether-a-term-is-needed"><i class="fa fa-check"></i>4.4.2 Model Comparison to Check Whether a Term is Needed</a></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#example-treating-color-as-quantitative-or-binary"><i class="fa fa-check"></i>4.4.3 Example: Treating Color as Quantitative or Binary</a></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#allowing-interaction-between-explanatory-variables"><i class="fa fa-check"></i>4.4.4 Allowing Interaction between Explanatory Variables</a></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#effects-depend-on-other-explanatory-variables-in-model"><i class="fa fa-check"></i>4.4.5 Effects Depend on Other Explanatory Variables in Model</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#summarizing-effects-in-logistic-regression"><i class="fa fa-check"></i>4.5 Summarizing Effects in Logistic Regression</a><ul>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#probability-based-interpretations"><i class="fa fa-check"></i>4.5.1 Probability-Based Interpretations</a></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#x4.5.2"><i class="fa fa-check"></i>4.5.2 Marginal Effects and Their Average</a></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#x4.5.3"><i class="fa fa-check"></i>4.5.3 Standardized Interpretations</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#summzarizing-predictive-power-classification-tables-roc-curves-and-multiple-correlation"><i class="fa fa-check"></i>4.6 Summzarizing Predictive Power: Classification Tables, ROC Curves and Multiple Correlation</a><ul>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#x4.6.1"><i class="fa fa-check"></i>4.6.1 Summarizing Predictive Power: Classification Tables</a></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#summarizing-predictive-power-roc-curves"><i class="fa fa-check"></i>4.6.2 Summarizing Predictive Power: ROC Curves</a></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#x4.6.3"><i class="fa fa-check"></i>4.6.3 Summarizing Predictive Power: Multiple Correlation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html"><i class="fa fa-check"></i>5 Building and Applying Logistic Regression Models</a><ul>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#strategies-in-model-selection"><i class="fa fa-check"></i>5.1 Strategies in Model Selection</a><ul>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#how-many-explanatory-variables-can-the-model-handle"><i class="fa fa-check"></i>5.1.1 How Many Explanatory Variables Can the Model Handle?</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#example-horseshoe-crab-satellites-revisited"><i class="fa fa-check"></i>5.1.2 Example: Horseshoe Crab Satellites Revisited</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#stepwise-variable-selection-algorithms"><i class="fa fa-check"></i>5.1.3 Stepwise Variable Selection Algorithms</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#surposeful-selection-of-explanatory-variables"><i class="fa fa-check"></i>5.1.4 Surposeful Selection of Explanatory Variables</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#example-variable-selection-for-horseshoe-crabs"><i class="fa fa-check"></i>5.1.5 Example: Variable Selection for Horseshoe Crabs</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#aic-and-the-biasvariance-tradeoff"><i class="fa fa-check"></i>5.1.6 AIC and the Bias/Variance Tradeoff</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#model-checking"><i class="fa fa-check"></i>5.2 Model Checking</a><ul>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#x5.2.1"><i class="fa fa-check"></i>5.2.1 Goodness of Fit: Model Comparison Using the Deviance</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#x5.2.2"><i class="fa fa-check"></i>5.2.2 Example: Goodness of Fit for Marijuana Use Survey</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#goodness-of-fit-grouped-versus-ungrouped-data-and-continuous-predictors"><i class="fa fa-check"></i>5.2.3 Goodness of Fit: Grouped versus Ungrouped Data and Continuous Predictors</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#residuals-for-logistic-models-with-categorical-predictors"><i class="fa fa-check"></i>5.2.4 Residuals for Logistic Models with Categorical Predictors</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#standardized-versus-pearson-and-deviance-residuals"><i class="fa fa-check"></i>5.2.6 Standardized versus Pearson and Deviance Residuals</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#influence-diagnostics-for-logistic-regression"><i class="fa fa-check"></i>5.2.7 Influence Diagnostics for Logistic Regression</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#example-heart-disease-and-blood-pressure"><i class="fa fa-check"></i>5.2.8 Example: Heart Disease and Blood Pressure</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#infinite-estimates-in-logistic-regression"><i class="fa fa-check"></i>5.3 Infinite Estimates in Logistic Regression</a><ul>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#complete-and-quasi-complete-separation-perfeect-discrination"><i class="fa fa-check"></i>5.3.1 Complete and Quasi-Complete Separation: Perfeect Discrination</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#example-infinite-estimate-for-toy-example"><i class="fa fa-check"></i>5.3.2 Example: Infinite Estimate for Toy Example</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#sparse-data-and-infinite-effects-with-categorical-predictors"><i class="fa fa-check"></i>5.3.3 Sparse Data and Infinite Effects with Categorical Predictors</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#x5.3.5"><i class="fa fa-check"></i>5.3.4 Example: Risk Factors for Endometrial Cancer Grade</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#x5.4"><i class="fa fa-check"></i>5.4 Bayesian Inference, Penalized Likelihood, and Conditional Likelihood for Logistic Regression *</a><ul>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#bayesian-modeling-specification-of-prior-distributions"><i class="fa fa-check"></i>5.4.1 Bayesian Modeling: Specification of Prior Distributions</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#example-risk-factors-for-endometrial-caner-revisited"><i class="fa fa-check"></i>5.4.2 Example: Risk Factors for Endometrial Caner Revisited</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#penalized-likelihood-reduces-bias-in-logistic-regression"><i class="fa fa-check"></i>5.4.3 Penalized Likelihood Reduces Bias in Logistic Regression</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#example-risk-factors-for-endometrial-cancer-revisited"><i class="fa fa-check"></i>5.4.4 Example: Risk Factors for Endometrial Cancer Revisited</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#x5.4.5"><i class="fa fa-check"></i>5.4.5 Conditional Likelihood and Conditional Logistic Regression</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#conditional-logistic-regression-and-exact-tests-for-contingency-tables"><i class="fa fa-check"></i>5.4.6 Conditional Logistic Regression and Exact Tests for Contingency Tables</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#alternative-link-functions-linear-probability-and-probit-models"><i class="fa fa-check"></i>5.5 Alternative Link Functions: Linear Probability and Probit Models *</a><ul>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#linar-probability-model"><i class="fa fa-check"></i>5.5.1 Linar Probability Model</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#example-political-ideology-and-belief-in-evolution-1"><i class="fa fa-check"></i>5.5.2 Example: Political Ideology and Belief in Evolution</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#x5.5.3"><i class="fa fa-check"></i>5.5.3 Probit Model and Normal Latent Variable Model</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#example-snoring-and-heart-disease-revisited"><i class="fa fa-check"></i>5.5.4 Example: Snoring and Heart Disease Revisited</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#latent-variable-models-imply-binary-regression-models"><i class="fa fa-check"></i>5.5.5 Latent Variable Models Imply Binary Regression Models</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#cdfs-and-shapes-of-curves-for-binary-reegressoin-models"><i class="fa fa-check"></i>5.5.6 CDFs and Shapes of Curves for Binary Reegressoin Models</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#sample-size-and-power-for-logistic-regression"><i class="fa fa-check"></i>5.6 Sample Size and Power for Logistic Regression *</a><ul>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#sample-size-for-comparing-two-proportions"><i class="fa fa-check"></i>5.6.1 Sample Size for Comparing Two Proportions</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#sample-size-in-logistic-regression-modeling"><i class="fa fa-check"></i>5.6.2 Sample Size in Logistic Regression Modeling</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#example-modeling-the-probability-of-heart-disease"><i class="fa fa-check"></i>5.6.3 Example: Modeling the Probability of Heart Disease</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html"><i class="fa fa-check"></i>6 Multicategory Logit Models</a><ul>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#baseline-category-logit-models-for-nominal-responses"><i class="fa fa-check"></i>6.1 Baseline-Category Logit Models for Nominal Responses</a><ul>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#baseline-category-logits"><i class="fa fa-check"></i>6.1.1 Baseline-Category Logits</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#example-what-do-alligators-eat"><i class="fa fa-check"></i>6.1.2 Example: What Do Alligators Eat?</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#estimating-response-probabilities"><i class="fa fa-check"></i>6.1.3 Estimating Response Probabilities</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#checking-multinomial-model-goodness-of-fit"><i class="fa fa-check"></i>6.1.4 Checking multinomial Model Goodness of Fit</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#example-belief-in-afterlife"><i class="fa fa-check"></i>6.1.5 Example: Belief in Afterlife</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#discrete-choice-models"><i class="fa fa-check"></i>6.1.6 Discrete Choice Models*</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#example-shopping-destination-choice"><i class="fa fa-check"></i>6.1.7 Example: Shopping Destination Choice*</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#cumulative-logit-models-for-ordinal-responses-x6.2"><i class="fa fa-check"></i>6.2 Cumulative Logit Models for Ordinal Responses {x6.2}</a><ul>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#x6.2.1"><i class="fa fa-check"></i>6.2.1 Cumulative Logit Models with Proportional Odds</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#x6.2.2"><i class="fa fa-check"></i>6.2.2 Example: Political Ideology and Political Party Affiliation</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#inference-about-cumulative-logit-model-parameters"><i class="fa fa-check"></i>6.2.3 Inference about Cumulative Logit Model Parameters</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#increased-power-for-ordinal-analyses"><i class="fa fa-check"></i>6.2.4 Increased Power for Ordinal Analyses</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#example-happiness-and-family-income"><i class="fa fa-check"></i>6.2.5 Example: Happiness and Family Income</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#x6.2.6"><i class="fa fa-check"></i>6.2.6 Latent Variable Linear Models Imply Cumulative Link Models</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#invariance-to-choice-of-response-categories"><i class="fa fa-check"></i>6.2.7 Invariance to Choice of Response Categories</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#cumulative-link-models-model-checking-and-extensions"><i class="fa fa-check"></i>6.3 Cumulative Link Models: Model Checking and Extensions *</a><ul>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#checking-ordinal-model-goodness-of-fit"><i class="fa fa-check"></i>6.3.1 Checking Ordinal Model Goodness of Fit</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#cumulative-logit-model-without-proportional-odds"><i class="fa fa-check"></i>6.3.2 Cumulative Logit Model without Proportional Odds</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#simpler-interpretatoins-using-probabiliteis"><i class="fa fa-check"></i>6.3.3 Simpler Interpretatoins Using Probabiliteis</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#example-modeling-mental-impairment"><i class="fa fa-check"></i>6.3.4 Example: Modeling Mental Impairment</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#a-latent-variable-probability-comparison-of-groups"><i class="fa fa-check"></i>6.3.5 A Latent Variable Probability Comparison of Groups</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#cumulative-probit-model"><i class="fa fa-check"></i>6.3.6 Cumulative Probit Model</a></li>
<li><a href="Multicategory.html#r2-based-on-latent-variable-model">6.3.7 <span class="math inline">\(R^2\)</span> Based on Latent Variable Model</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#bayesian-inference-for-multinomial-models"><i class="fa fa-check"></i>6.3.8 Bayesian Inference for Multinomial Models</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#example-modeling-mental-impairment-revisited"><i class="fa fa-check"></i>6.3.9 Example: Modeling Mental Impairment Revisited</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#paired-category-logit-modeling-of-ordinal-response"><i class="fa fa-check"></i>6.4 Paired-Category Logit Modeling of Ordinal Response *</a><ul>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#adjacent-categories-logits"><i class="fa fa-check"></i>6.4.1 Adjacent-Categories Logits</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#example-political-ideology-revisited"><i class="fa fa-check"></i>6.4.2 Example: Political Ideology Revisited</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#sequential-logits"><i class="fa fa-check"></i>6.4.3 Sequential Logits</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#example-tonsil-size-and-streptococcus"><i class="fa fa-check"></i>6.4.4 Example: Tonsil Size and Streptococcus</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html"><i class="fa fa-check"></i>7 Loglinear Models for Contingency Tables and Counts</a><ul>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#loglinear-models-for-counts-in-contingency-tables"><i class="fa fa-check"></i>7.1 Loglinear Models for Counts in Contingency Tables</a><ul>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#loglinear-model-of-independence-for-two-way-contingency-tables"><i class="fa fa-check"></i>7.1.1 Loglinear Model of Independence for Two-Way Contingency Tables</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#interpretation-of-parameters-in-the-independence-model"><i class="fa fa-check"></i>7.1.2 Interpretation of Parameters in the Independence Model</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#example-happiness-and-belief-in-heaven"><i class="fa fa-check"></i>7.1.3 Example: Happiness and Belief in Heaven</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#saturated-model-for-two-way-contingency-tables"><i class="fa fa-check"></i>7.1.4 Saturated Model for Two-Way Contingency Tables</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#loglinear-models-for-three-way-contingency-tables"><i class="fa fa-check"></i>7.1.5 Loglinear Models for Three-Way Contingency Tables</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#two-factor-parameters-describe-conditional-associations"><i class="fa fa-check"></i>7.1.6 Two-Factor Parameters Describe Conditional Associations</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#example-student-alcohol-cigarette-and-marijuana-use"><i class="fa fa-check"></i>7.1.7 Example: Student Alcohol, Cigarette, and Marijuana Use</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#statistical-inference-for-loglinear-models"><i class="fa fa-check"></i>7.2 Statistical Inference for Loglinear Models</a><ul>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#chi-squared-goodness-of-fit-tests"><i class="fa fa-check"></i>7.2.1 Chi-Squared Goodness-of-Fit Tests</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#x7.2.2"><i class="fa fa-check"></i>7.2.2 Cell Standardized Residuals for Loglinear Models</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#significance-tests-about-conditional-associations"><i class="fa fa-check"></i>7.2.3 Significance Tests about Conditional Associations</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#confidence-intervals-for-conditional-odds-ratios"><i class="fa fa-check"></i>7.2.4 Confidence Intervals for Conditional Odds Ratios</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#bayesian-fitting-of-loglinear-models"><i class="fa fa-check"></i>7.2.5 Bayesian Fitting of Loglinear Models</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#loglinear-models-for-higher-dimensional-contingency-tables"><i class="fa fa-check"></i>7.2.6 Loglinear Models for Higher-Dimensional Contingency Tables</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#example-automobile-accidents-and-seat-belts"><i class="fa fa-check"></i>7.2.7 Example: Automobile Accidents and Seat Belts</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#interpreting-three-factor-interaction-terms"><i class="fa fa-check"></i>7.2.8 Interpreting Three-Factor Interaction Terms</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#statistical-versus-practical-significance-dissimilarity-index"><i class="fa fa-check"></i>7.2.9 Statistical Versus Practical Significance: Dissimilarity Index</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#the-loglinear---logistic-model-connection"><i class="fa fa-check"></i>7.3 The Loglinear - Logistic Model Connection</a><ul>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#using-logistic-models-to-interpret-loglinear-models"><i class="fa fa-check"></i>7.3.1 Using Logistic Models to Interpret Loglinear Models</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#example-auto-accident-data-revisited"><i class="fa fa-check"></i>7.3.2 Example: Auto Accident Data Revisited</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#condition-for-equivalent-loglinear-and-logistic-models"><i class="fa fa-check"></i>7.3.3 Condition for Equivalent Loglinear and Logistic Models</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#loglinearlogistic-model-selection-issues"><i class="fa fa-check"></i>7.3.4 Loglinear/Logistic Model Selection Issues</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#independence-graphs-and-collapsibility"><i class="fa fa-check"></i>7.4 Independence Graphs and Collapsibility</a><ul>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#independence-graphs"><i class="fa fa-check"></i>7.4.1 Independence Graphs</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#collapsibility-conditions-for-contingency-tables"><i class="fa fa-check"></i>7.4.2 Collapsibility Conditions for Contingency Tables</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#example-loglinear-model-building-for-student-substance-use"><i class="fa fa-check"></i>7.4.3 Example: Loglinear Model Building for Student Substance Use</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#collapsibility-and-logistic-models"><i class="fa fa-check"></i>7.4.4 Collapsibility and Logistic Models</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#modeling-ordinal-associations-in-contingency-tables"><i class="fa fa-check"></i>7.5 Modeling Ordinal Associations in Contingency Tables</a><ul>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#linear-by-linear-association-model"><i class="fa fa-check"></i>7.5.1 Linear-by-Linear Association Model</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#example-linear-by-linear-association-for-sex-opinions"><i class="fa fa-check"></i>7.5.2 Example: Linear-by-Linear Association for Sex Opinions</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#ordinal-significance-tests-of-independence"><i class="fa fa-check"></i>7.5.3 Ordinal Significance Tests of Independence</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#loglinear-modeling-of-count-response-variables"><i class="fa fa-check"></i>7.6 Loglinear Modeling of Count Response Variables *</a><ul>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#count-regressoin-modeling-of-rate-data"><i class="fa fa-check"></i>7.6.1 Count Regressoin Modeling of Rate Data</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#example-death-rates-for-lung-cancer-patients"><i class="fa fa-check"></i>7.6.2 Example: Death Rates for Lung Cancer Patients</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#negativee-binomial-regression-models"><i class="fa fa-check"></i>7.6.3 Negativee Binomial Regression Models</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#example-female-horseshoe-crab-satelites-revisited"><i class="fa fa-check"></i>7.6.4 Example: Female Horseshoe Crab Satelites Revisited</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html"><i class="fa fa-check"></i>8 Models for Matched Pairs</a><ul>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#x8.1"><i class="fa fa-check"></i>8.1 Comparing Dependent Proporitons for Binary Mached Pairs</a><ul>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#mcnemar-test-comparing-marginal-proportions"><i class="fa fa-check"></i>8.1.1 McNemar Test Comparing Marginal Proportions</a></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#estimating-the-difference-between-dependent-proportions"><i class="fa fa-check"></i>8.1.2 Estimating the difference between Dependent Proportions</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#x8.2"><i class="fa fa-check"></i>8.2 Marginal Models and Subject-Specific Models for Matched Pairs</a><ul>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#x8.2.1"><i class="fa fa-check"></i>8.2.1 Marginal Models for Marginal Proportions</a></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#example-enironmental-options-revisted"><i class="fa fa-check"></i>8.2.2 Example: Enironmental Options Revisted</a></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#x8.2.3"><i class="fa fa-check"></i>8.2.3 Subject-Specific and Population-Averaging Tables</a></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#x8.2.4"><i class="fa fa-check"></i>8.2.4 Conditional Logistic Regression for Matched-Pairs*</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#comparing-proportions-for-nominal-matched-pairs-responses"><i class="fa fa-check"></i>8.3 Comparing Proportions for Nominal Matched-Pairs Responses</a><ul>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#marginal-homogeneity-for-baseline-category-logit-models"><i class="fa fa-check"></i>8.3.1 Marginal Homogeneity for Baseline-Category Logit Models</a></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#using-cochran-mantel-haenszel-test-to-test-marinal-homogeneity"><i class="fa fa-check"></i>8.3.3 Using Cochran-Mantel-Haenszel Test to Test marinal Homogeneity*</a></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#x8.3.4"><i class="fa fa-check"></i>8.3.4 Symmetry and Quasi-Symmetry Models for Square Contingency Tables</a></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#example-coffee-brand-market-share-revisited"><i class="fa fa-check"></i>8.3.5 Example: Coffee Brand market Share Revisited</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#comparing-proportions-for-ordinal-matched-pairs-responses"><i class="fa fa-check"></i>8.4 Comparing Proportions for Ordinal Matched-Pairs Responses</a><ul>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#marginal-homogeneity-and-cummulative-logit-marginal-model"><i class="fa fa-check"></i>8.4.1 Marginal Homogeneity and Cummulative Logit Marginal Model</a></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#x8.4.2"><i class="fa fa-check"></i>8.4.2 Example: Recycle or Drive Less to Help the Environment?</a></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#an-ordinal-quasi-symmetry-model"><i class="fa fa-check"></i>8.4.3 An Ordinal Quasi-Symmetry Model *</a></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#example-recycle-or-drive-less-revisited"><i class="fa fa-check"></i>8.4.4 Example: Recycle or Drive Less Revisited?</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#analyzing-rater-agreement"><i class="fa fa-check"></i>8.5 Analyzing Rater Agreement *</a><ul>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#example-agreement-on-carcinoma-diagnosis"><i class="fa fa-check"></i>8.5.1 Example: Agreement on Carcinoma Diagnosis</a></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#cell-residuals-for-independence-model"><i class="fa fa-check"></i>8.5.2 Cell Residuals for Independence Model</a></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#quasi-independence-model"><i class="fa fa-check"></i>8.5.3 Quasi-Independence Model</a></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#quasi-independence-and-odds-ratios-summarizing-agreement"><i class="fa fa-check"></i>8.5.4 Quasi Independence and Odds Ratios Summarizing Agreement</a></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#kappa-summary-measure-of-agreement"><i class="fa fa-check"></i>8.5.5 Kappa Summary Measure of Agreement</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#bradley-terry-model-for-paired-preferences"><i class="fa fa-check"></i>8.6 Bradley-Terry Model for Paired Preferences *</a><ul>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#the-bradley-terry-model-of-quasi-symmetry"><i class="fa fa-check"></i>8.6.1 The Bradley-Terry Model of Quasi-Symmetry</a></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#example-ranking-men-tennis-players"><i class="fa fa-check"></i>8.6.2 Example: Ranking Men Tennis Players</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html"><i class="fa fa-check"></i>9 Marginal Modeling of Correlated, Clustered Responses</a><ul>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html#marginal-models-vs-subject-specific-models"><i class="fa fa-check"></i>9.1 Marginal Models Vs Subject-Specific Models</a><ul>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html#marginal-models-for-a-clustered-binary-response"><i class="fa fa-check"></i>9.1.1 Marginal Models for a Clustered Binary Response</a></li>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html#x9.1.2"><i class="fa fa-check"></i>9.1.2 Example: Repeated Responses on Similar Survey Questions</a></li>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html#subject-specific-models-for-a-repeated-response"><i class="fa fa-check"></i>9.1.3 Subject-Specific Models for a Repeated Response</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html#marginal-modeling-the-generalized-estimating-equations-gee-approach"><i class="fa fa-check"></i>9.2 Marginal Modeling: The Generalized Estimating Equations (GEE) Approach</a><ul>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html#quasi-likelihood-methods"><i class="fa fa-check"></i>9.2.1 Quasi-Likelihood Methods</a></li>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html#generalized-estimating-equation-methodology-basic-ideas"><i class="fa fa-check"></i>9.2.2 Generalized Estimating Equation Methodology: Basic Ideas</a></li>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html#x9.2.3"><i class="fa fa-check"></i>9.2.3 Example: Opinion about Legalized Abortion Revisited</a></li>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html#limitations-of-gee-compared-to-ml"><i class="fa fa-check"></i>9.2.4 Limitations of GEE Compared to ML</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html#marginal-modeling-for-clustered-multinomial-responses"><i class="fa fa-check"></i>9.3 Marginal Modeling for Clustered Multinomial Responses</a><ul>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html#x9.3.1"><i class="fa fa-check"></i>9.3.1 Example: Insomnia Study</a></li>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html#alternative-gee-specification-of-working-association"><i class="fa fa-check"></i>9.3.2 Alternative GEE Specification of Working Association</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html#transitional-modeling-given-the-past"><i class="fa fa-check"></i>9.4 Transitional Modeling, Given the Past</a><ul>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html#transitional-models-with-explanatory-variables"><i class="fa fa-check"></i>9.4.1 Transitional Models with Explanatory Variables</a></li>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html#example-respiratory-illness-and-maternal-smoking"><i class="fa fa-check"></i>9.4.2 Example: Respiratory Illness and Maternal Smoking</a></li>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html#x9.4.3"><i class="fa fa-check"></i>9.4.3 Group Comparisons Treating Initial Response as Covariate</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html#dealing-with-missing-data"><i class="fa fa-check"></i>9.5 Dealing with Missing Data *</a><ul>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html#missing-at-random-impact-on-ml-and-gee-methods"><i class="fa fa-check"></i>9.5.1 Missing at Random: Impact on ML and GEE Methods</a></li>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html#multiple-imputation-monte-carlo-prediction-of-missing-data"><i class="fa fa-check"></i>9.5.2 Multiple Imputation: Monte Carlo Prediction of missing Data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html"><i class="fa fa-check"></i>10 Random Effects: Generalized Linear Mixed Models</a><ul>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#random-effects-modeling-of-clustered-categorical-data"><i class="fa fa-check"></i>10.1 Random Effects Modeling of Clustered Categorical Data</a><ul>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#the-generalized-linear-mixed-model-glmm"><i class="fa fa-check"></i>10.1.1 The Generalized Linear Mixed Model (GLMM)</a></li>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#a-logistic-glmm-for-binary-matched-pairs"><i class="fa fa-check"></i>10.1.2 A Logistic GLMM for Binary Matched Pairs</a></li>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#example-environmental-opinions-revised"><i class="fa fa-check"></i>10.1.3 Example: Environmental Opinions Revised</a></li>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#differing-effects-in-glmms-and-marginal-models"><i class="fa fa-check"></i>10.1.4 Differing Effects in GLMMs and Marginal Models</a></li>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#model-fitting-for-glmms"><i class="fa fa-check"></i>10.1.5 Model Fitting for GLMMs</a></li>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#inference-for-model-parameters-and-prediction"><i class="fa fa-check"></i>10.1.6 Inference for Model Parameters and Prediction</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#examples-random-effects-models-for-binary-data"><i class="fa fa-check"></i>10.2 Examples: Random Effects Models for Binary Data</a><ul>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#small-area-estimation-of-binomial-probabilities"><i class="fa fa-check"></i>10.2.1 Small-Area Estimation of Binomial Probabilities</a></li>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#example-estimating-basketball-free-throw-success"><i class="fa fa-check"></i>10.2.2 Example: Estimating Basketball Free Throw Success</a></li>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#example-opinions-about-legalizing-abortion-revised"><i class="fa fa-check"></i>10.2.3 Example: Opinions about Legalizing Abortion Revised</a></li>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#item-response-models-the-rasch-model"><i class="fa fa-check"></i>10.2.4 Item Response Models: The Rasch Model</a></li>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#choice-of-marginal-model-or-random-effects-model"><i class="fa fa-check"></i>10.2.5 Choice of Marginal Model or Random Effects Model</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#extensions-to-multinomial-responses-and-multiple-random-effect-terms"><i class="fa fa-check"></i>10.3 Extensions to Multinomial Responses and Multiple Random Effect Terms</a><ul>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#example-insomnia-study-revisited"><i class="fa fa-check"></i>10.3.1 Example: Insomnia Study Revisited</a></li>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#meta-analysis-bivariate-random-effects-for-association-heterogeneity"><i class="fa fa-check"></i>10.3.2 Meta-Analysis: Bivariate Random Effects for Association Heterogeneity</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#multilevel-hierarchical-models"><i class="fa fa-check"></i>10.4 Multilevel (Hierarchical) Models</a><ul>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#example-two-level-model-for-student-performance"><i class="fa fa-check"></i>10.4.1 Example: Two-Level Model for Student Performance</a></li>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#example-smoking-prevention-and-cessation-study"><i class="fa fa-check"></i>10.4.2 Example: Smoking Prevention and Cessation Study</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#latent-class-models"><i class="fa fa-check"></i>10.5 Latent Class Models *</a><ul>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#independence-given-a-latent-categorical-variable"><i class="fa fa-check"></i>10.5.1 Independence Given a Latent Categorical Variable</a></li>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#example-latent-class-model-for-rater-agreement"><i class="fa fa-check"></i>10.5.2 Example: Latent Class Model for Rater Agreement</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#exercises-2"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html"><i class="fa fa-check"></i>11 Classification and Smoothing</a><ul>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#classification-linear-discrinant-analysis"><i class="fa fa-check"></i>11.1 Classification: Linear Discrinant Analysis</a><ul>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#classification-with-fishers-linear-discriminant-function"><i class="fa fa-check"></i>11.1.1 Classification with Fisher’s Linear Discriminant Function</a></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#example-horseshoe-crab-satellites-revisited-1"><i class="fa fa-check"></i>11.1.2 Example: Horseshoe Crab Satellites Revisited</a></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#discriminant-analysis-versus-logistic-regression"><i class="fa fa-check"></i>11.1.3 Discriminant Analysis Versus Logistic Regression</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#classification-tree-based-prediction"><i class="fa fa-check"></i>11.2 Classification: Tree-Based Prediction</a><ul>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#classification-trees"><i class="fa fa-check"></i>11.2.1 Classification Trees</a></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#example-a-classification-tree-for-horseshoe-crab-mating"><i class="fa fa-check"></i>11.2.2 Example: A classification Tree for Horseshoe Crab Mating</a></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#how-does-the-classification-tree-grow"><i class="fa fa-check"></i>11.2.3 How Does the Classification Tree Grow?</a></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#pruning-a-tree-and-checking-prediction-accuracy"><i class="fa fa-check"></i>11.2.4 Pruning a Tree and Checking Prediction Accuracy</a></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#classification-trees-versus-logistic-regression-and-discriminant-analysis"><i class="fa fa-check"></i>11.2.5 Classification Trees Versus Logistic Regression and Discriminant Analysis</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#cluster-analysis-for-categorical-responses"><i class="fa fa-check"></i>11.3 Cluster Analysis for Categorical Responses</a><ul>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#measuring-dissimilarity-between-observations"><i class="fa fa-check"></i>11.3.1 Measuring Dissimilarity Between Observations</a></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#hierarchical-clustering-algorithm-and-dendrograms"><i class="fa fa-check"></i>11.3.2 Hierarchical Clustering Algorithm and Dendrograms</a></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#example-clustering-states-on-presidential-elections"><i class="fa fa-check"></i>11.3.3 Example: Clustering States on Presidential Elections</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#smoothing-generalized-additive-models"><i class="fa fa-check"></i>11.4 Smoothing: Generalized Additive Models</a><ul>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#generalized-additive-models"><i class="fa fa-check"></i>11.4.1 Generalized Additive Models</a></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#example-gams-for-horseshoe-crab-data"><i class="fa fa-check"></i>11.4.2 Example: GAMs for Horseshoe Crab Data</a></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#how-much-smoothing-the-biasvariance-tradeoff"><i class="fa fa-check"></i>11.4.3 How Much Smoothing? The Bias/Variance Tradeoff</a></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#example-smoothing-to-portray-probability-of-kyphosis"><i class="fa fa-check"></i>11.4.4 Example: Smoothing to Portray Probability of Kyphosis</a></li>
</ul></li>
<li><a href="Classification.html#regularization-for-high-dimensional-categorical-data-large-p">11.5 Regularization for High-Dimensional Categorical Data (Large <em>p</em>)</a><ul>
<li><a href="Classification.html#penalized-likelihood-methods-and-l_q-norm-smoothing">11.5.1 Penalized-Likelihood Methods and <span class="math inline">\(L_q\)</span>-Norm Smoothing</a></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#implementing-the-lasso"><i class="fa fa-check"></i>11.5.2 Implementing the Lasso</a></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#example-predicting-option-on-abortion-with-student-survey"><i class="fa fa-check"></i>11.5.3 Example: Predicting Option on Abortion with Student Survey</a></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#why-shrink-ml-estimates-toward-0"><i class="fa fa-check"></i>11.5.4 Why Shrink ML Estimates Toward 0?</a></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#issues-in-variable-selection-dimension-reduction"><i class="fa fa-check"></i>11.5.5 Issues In variable Selection (Dimension Reduction)</a></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#controlling-the-false-discovery-rate"><i class="fa fa-check"></i>11.5.6 Controlling the False Discovery Rate</a></li>
<li><a href="Classification.html#large-p-also-makes-bayesian-inference-challenging">11.5.7 Large <span class="math inline">\(p\)</span> also Makes Bayesian Inference Challenging</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="rmarkdown.html"><a href="rmarkdown.html"><i class="fa fa-check"></i>99 R Markdown</a><ul>
<li class="chapter" data-level="" data-path="rmarkdown.html"><a href="rmarkdown.html#formatting"><i class="fa fa-check"></i>Formatting</a></li>
<li class="chapter" data-level="" data-path="rmarkdown.html"><a href="rmarkdown.html#symbols"><i class="fa fa-check"></i>Symbols</a></li>
<li class="chapter" data-level="" data-path="rmarkdown.html"><a href="rmarkdown.html#markdown-highlighting"><i class="fa fa-check"></i>Markdown highlighting</a></li>
<li class="chapter" data-level="" data-path="rmarkdown.html"><a href="rmarkdown.html#text-coloring"><i class="fa fa-check"></i>Text coloring</a></li>
<li class="chapter" data-level="" data-path="rmarkdown.html"><a href="rmarkdown.html#equations"><i class="fa fa-check"></i>Equations</a></li>
<li class="chapter" data-level="" data-path="rmarkdown.html"><a href="rmarkdown.html#x99.4"><i class="fa fa-check"></i>Section references</a></li>
<li class="chapter" data-level="" data-path="rmarkdown.html"><a href="rmarkdown.html#footnotes"><i class="fa fa-check"></i>Footnotes</a></li>
<li class="chapter" data-level="" data-path="rmarkdown.html"><a href="rmarkdown.html#displaying-formula"><i class="fa fa-check"></i>Displaying Formula</a><ul>
<li class="chapter" data-level="" data-path="rmarkdown.html"><a href="rmarkdown.html#notation"><i class="fa fa-check"></i>Notation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="rmarkdown.html"><a href="rmarkdown.html#greek-letters"><i class="fa fa-check"></i>Greek letters</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Notes for Agresti’s Introduction to Categorical Data Analysis 3rd Edition</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="Matched" class="section level1">
<h1>8 Models for Matched Pairs</h1>
<div class="sourceCode" id="cb501"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb501-1"><a href="Matched.html#cb501-1"></a>Opinions &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;http://users.stat.ufl.edu/~aa/cat/data/Envir_opinions.dat&quot;</span>,</span>
<span id="cb501-2"><a href="Matched.html#cb501-2"></a>                        <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">stringsAsFactors =</span> <span class="ot">TRUE</span>)</span>
<span id="cb501-3"><a href="Matched.html#cb501-3"></a><span class="co"># Make contingency table</span></span>
<span id="cb501-4"><a href="Matched.html#cb501-4"></a>tab &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">addmargins</span>(<span class="kw">xtabs</span>(<span class="op">~</span>y1 <span class="op">+</span><span class="st"> </span>y2, <span class="dt">data =</span> Opinions)))</span>
<span id="cb501-5"><a href="Matched.html#cb501-5"></a></span>
<span id="cb501-6"><a href="Matched.html#cb501-6"></a><span class="kw">library</span>(tibble)</span>
<span id="cb501-7"><a href="Matched.html#cb501-7"></a><span class="co"># Add label as the first column and variable names</span></span>
<span id="cb501-8"><a href="Matched.html#cb501-8"></a><span class="st">`</span><span class="dt">Table 8.1</span><span class="st">`</span> &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="st">`</span><span class="dt">Pay Higher Taxes</span><span class="st">`</span> =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;No&quot;</span>, <span class="st">&quot;Total&quot;</span>), </span>
<span id="cb501-9"><a href="Matched.html#cb501-9"></a>                      <span class="dt">Yes =</span> tab[,<span class="dv">1</span>], <span class="dt">No =</span> tab[,<span class="dv">2</span>], <span class="dt">Total =</span> tab[,<span class="dv">3</span>])</span>
<span id="cb501-10"><a href="Matched.html#cb501-10"></a></span>
<span id="cb501-11"><a href="Matched.html#cb501-11"></a><span class="co"># horrible kludge</span></span>
<span id="cb501-12"><a href="Matched.html#cb501-12"></a><span class="st">`</span><span class="dt">Table 8.1</span><span class="st">`</span><span class="op">$</span>Yes &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="st">`</span><span class="dt">Table 8.1</span><span class="st">`</span><span class="op">$</span>Yes, <span class="kw">c</span>(<span class="st">&quot; (pi11)&quot;</span>, <span class="st">&quot; (pi21)&quot;</span>, <span class="st">&quot;&quot;</span>))</span>
<span id="cb501-13"><a href="Matched.html#cb501-13"></a><span class="st">`</span><span class="dt">Table 8.1</span><span class="st">`</span><span class="op">$</span>No &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="st">`</span><span class="dt">Table 8.1</span><span class="st">`</span><span class="op">$</span>No, <span class="kw">c</span>(<span class="st">&quot; (pi12)&quot;</span>, <span class="st">&quot; (pi22)&quot;</span>, <span class="st">&quot;&quot;</span>))</span>
<span id="cb501-14"><a href="Matched.html#cb501-14"></a></span>
<span id="cb501-15"><a href="Matched.html#cb501-15"></a><span class="kw">library</span>(flextable)</span>
<span id="cb501-16"><a href="Matched.html#cb501-16"></a>my_header &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</span>
<span id="cb501-17"><a href="Matched.html#cb501-17"></a>  <span class="dt">col_keys =</span> <span class="kw">colnames</span>(<span class="st">`</span><span class="dt">Table 8.1</span><span class="st">`</span>),</span>
<span id="cb501-18"><a href="Matched.html#cb501-18"></a>  <span class="dt">line1 =</span> <span class="kw">c</span>(<span class="st">&quot;Pay Higher Taxes&quot;</span>, <span class="kw">rep</span>(<span class="st">&quot;Cut Living Standards&quot;</span>, <span class="dv">2</span>), <span class="st">&quot;Total&quot;</span>),</span>
<span id="cb501-19"><a href="Matched.html#cb501-19"></a>  <span class="dt">line2 =</span> <span class="kw">colnames</span>(<span class="st">`</span><span class="dt">Table 8.1</span><span class="st">`</span>)</span>
<span id="cb501-20"><a href="Matched.html#cb501-20"></a>)</span>
<span id="cb501-21"><a href="Matched.html#cb501-21"></a></span>
<span id="cb501-22"><a href="Matched.html#cb501-22"></a><span class="kw">flextable</span>(<span class="st">`</span><span class="dt">Table 8.1</span><span class="st">`</span>, <span class="dt">col_keys =</span> my_header<span class="op">$</span>col_keys) <span class="op">%&gt;%</span></span>
<span id="cb501-23"><a href="Matched.html#cb501-23"></a><span class="st">  </span><span class="kw">set_header_df</span>(</span>
<span id="cb501-24"><a href="Matched.html#cb501-24"></a>    <span class="dt">mapping =</span> my_header,</span>
<span id="cb501-25"><a href="Matched.html#cb501-25"></a>    <span class="dt">key =</span> <span class="st">&quot;col_keys&quot;</span></span>
<span id="cb501-26"><a href="Matched.html#cb501-26"></a>  ) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb501-27"><a href="Matched.html#cb501-27"></a><span class="st">  </span><span class="kw">theme_booktabs</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb501-28"><a href="Matched.html#cb501-28"></a><span class="st">  </span><span class="kw">autofit</span>(<span class="dt">part =</span> <span class="st">&quot;all&quot;</span>) <span class="op">%&gt;%</span><span class="st">    </span></span>
<span id="cb501-29"><a href="Matched.html#cb501-29"></a><span class="st">  </span><span class="kw">align</span>(<span class="dt">align =</span> <span class="st">&quot;center&quot;</span>, <span class="dt">part =</span> <span class="st">&quot;all&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb501-30"><a href="Matched.html#cb501-30"></a><span class="st">  </span><span class="kw">merge_h</span>(<span class="dt">part =</span> <span class="st">&quot;header&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb501-31"><a href="Matched.html#cb501-31"></a><span class="st">  </span><span class="kw">merge_v</span>(<span class="dt">part =</span> <span class="st">&quot;header&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb501-32"><a href="Matched.html#cb501-32"></a><span class="st">  </span><span class="kw">merge_h</span>(<span class="dt">part =</span> <span class="st">&quot;body&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb501-33"><a href="Matched.html#cb501-33"></a><span class="st">  </span><span class="kw">merge_v</span>(<span class="dt">part =</span> <span class="st">&quot;body&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb501-34"><a href="Matched.html#cb501-34"></a><span class="st">  </span><span class="kw">align_nottext_col</span>(<span class="dt">align =</span> <span class="st">&quot;center&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb501-35"><a href="Matched.html#cb501-35"></a><span class="st">  </span><span class="kw">set_caption</span>(<span class="dt">caption =</span> <span class="st">&quot;Table 8.1&quot;</span>) </span></code></pre></div>
<template id="3e5c82e0-e9d2-482f-9037-9635d4357787"><style>
.tabwid table{
  border-collapse:collapse;
  line-height:1;
  margin-left:auto;
  margin-right:auto;
  border-width: 0;
  display: table;
  margin-top: 5px;
  margin-bottom: 5px;
  table-layout: fixed;
  border-spacing: 0;
  border-color: transparent;
}
.tabwid_left table{
  margin-left:0;
}
.tabwid_right table{
  margin-right:0;
}
.tabwid td {
    padding: 0;
}
.tabwid a {
  text-decoration: none;
}
.tabwid thead {
    background-color: transparent;
}
.tabwid tfoot {
    background-color: transparent;
}
.tabwid table tr {
background-color: transparent;
}
</style><div class="tabwid"><style>.cl-7e2f87e6{border-collapse:collapse;}.cl-7e28aad4{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-7e28bb00{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:3pt;padding-top:3pt;padding-left:3pt;padding-right:3pt;line-height: 1;background-color:transparent;}.cl-7e28e904{width:43pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7e28e922{width:117pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7e28e92c{width:103pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7e28e936{width:117pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7e28e940{width:103pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7e28e94a{width:43pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7e28e954{width:117pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 2pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7e28e95e{width:103pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 2pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7e28e968{width:43pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 2pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7e28e972{width:117pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7e28e97c{width:103pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7e28e986{width:43pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table class='cl-7e2f87e6'>
<caption class="Table Caption">
<span id="tab:unnamed-chunk-95">Table 2: </span>Table 8.1
</caption>
<thead><tr style="overflow-wrap:break-word;"><td  rowspan="2"class="cl-7e28e95e"><p class="cl-7e28bb00"><span class="cl-7e28aad4">Pay Higher Taxes</span></p></td><td  colspan="2"class="cl-7e28e954"><p class="cl-7e28bb00"><span class="cl-7e28aad4">Cut Living Standards</span></p></td><td  rowspan="2"class="cl-7e28e968"><p class="cl-7e28bb00"><span class="cl-7e28aad4">Total</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7e28e972"><p class="cl-7e28bb00"><span class="cl-7e28aad4">Yes</span></p></td><td class="cl-7e28e972"><p class="cl-7e28bb00"><span class="cl-7e28aad4">No</span></p></td></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-7e28e92c"><p class="cl-7e28bb00"><span class="cl-7e28aad4">Yes</span></p></td><td class="cl-7e28e922"><p class="cl-7e28bb00"><span class="cl-7e28aad4">227  (pi11)</span></p></td><td class="cl-7e28e922"><p class="cl-7e28bb00"><span class="cl-7e28aad4">132  (pi12)</span></p></td><td class="cl-7e28e904"><p class="cl-7e28bb00"><span class="cl-7e28aad4">359</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7e28e92c"><p class="cl-7e28bb00"><span class="cl-7e28aad4">No</span></p></td><td class="cl-7e28e922"><p class="cl-7e28bb00"><span class="cl-7e28aad4">107  (pi21)</span></p></td><td class="cl-7e28e922"><p class="cl-7e28bb00"><span class="cl-7e28aad4">678  (pi22)</span></p></td><td class="cl-7e28e904"><p class="cl-7e28bb00"><span class="cl-7e28aad4">785</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7e28e940"><p class="cl-7e28bb00"><span class="cl-7e28aad4">Total</span></p></td><td class="cl-7e28e936"><p class="cl-7e28bb00"><span class="cl-7e28aad4">334 </span></p></td><td class="cl-7e28e936"><p class="cl-7e28bb00"><span class="cl-7e28aad4">810 </span></p></td><td class="cl-7e28e94a"><p class="cl-7e28bb00"><span class="cl-7e28aad4">1,144</span></p></td></tr></tbody></table></div></template>
<div id="076d6ab1-19b9-4bb0-a3d0-d6ae9c670476"></div>
<script>
var dest = document.getElementById("076d6ab1-19b9-4bb0-a3d0-d6ae9c670476");
var template = document.getElementById("3e5c82e0-e9d2-482f-9037-9635d4357787");
var caption = template.content.querySelector("caption");
if(caption) {
  caption.style.cssText = "display:block;"
  var newcapt = document.createElement("p");
  newcapt.appendChild(caption)
  dest.parentNode.insertBefore(newcapt, dest.previousSibling);
}
var fantome = dest.attachShadow({mode: 'open'});
var templateContent = template.content;
fantome.appendChild(templateContent);
fantome.appendChild(templateContent);
</script>

<div id="x8.1" class="section level2">
<h2>8.1 Comparing Dependent Proporitons for Binary Mached Pairs</h2>
<div id="mcnemar-test-comparing-marginal-proportions" class="section level3">
<h3>8.1.1 McNemar Test Comparing Marginal Proportions</h3>
<p><span class="math display">\[H_0: P(Y_1 = 1) = P(Y_2 = 1), \mathrm{\ or\ equivalently\ } H_0: \pi_{12} = \pi_{21}.\]</span></p>
<p><span class="math display" id="eq:eq81">\[\begin{equation} 
  z = \frac{n_{12}-(\frac{1}{2}n^*)}{\sqrt{n^*(\frac{1}{2})(\frac{1}{2})}}= \frac{n_{12}- n_{21}}{\sqrt{n_{12}+n_{21}}}
  \tag{20}
\end{equation}\]</span></p>
<div class="sourceCode" id="cb502"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb502-1"><a href="Matched.html#cb502-1"></a>Opinions &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;http://users.stat.ufl.edu/~aa/cat/data/Envir_opinions.dat&quot;</span>,</span>
<span id="cb502-2"><a href="Matched.html#cb502-2"></a>                        <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">stringsAsFactors =</span> <span class="ot">TRUE</span>)</span>
<span id="cb502-3"><a href="Matched.html#cb502-3"></a></span>
<span id="cb502-4"><a href="Matched.html#cb502-4"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb502-5"><a href="Matched.html#cb502-5"></a></span>
<span id="cb502-6"><a href="Matched.html#cb502-6"></a><span class="co"># Data file has 1144 lines, one for each of 1144 people. </span></span>
<span id="cb502-7"><a href="Matched.html#cb502-7"></a><span class="co"># Each person has two binary responses (y1 and y2)</span></span>
<span id="cb502-8"><a href="Matched.html#cb502-8"></a>Opinions <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb502-9"><a href="Matched.html#cb502-9"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">row_number</span>() <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="kw">n</span>()))  </span></code></pre></div>
<pre class="custom-output"><code>  person y1 y2
1      1  1  1
2      2  1  1
3   1144  2  2</code></pre>
<div class="sourceCode" id="cb504"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb504-1"><a href="Matched.html#cb504-1"></a>tab &lt;-<span class="st"> </span><span class="kw">xtabs</span>(<span class="op">~</span>y1 <span class="op">+</span><span class="st"> </span>y2, <span class="dt">data =</span> Opinions)</span>
<span id="cb504-2"><a href="Matched.html#cb504-2"></a>tab</span></code></pre></div>
<pre class="custom-output"><code>   y2
y1    1   2
  1 227 132
  2 107 678</code></pre>
<div class="sourceCode" id="cb506"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb506-1"><a href="Matched.html#cb506-1"></a><span class="co"># Don&#39;t use continuity correction, which is too conservative.</span></span>
<span id="cb506-2"><a href="Matched.html#cb506-2"></a><span class="kw">mcnemar.test</span>(tab, <span class="dt">correct =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<pre class="custom-output"><code>
    McNemar&#39;s Chi-squared test

data:  tab
McNemar&#39;s chi-squared = 2.6151, df = 1, p-value = 0.1059</code></pre>
<div class="sourceCode" id="cb508"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb508-1"><a href="Matched.html#cb508-1"></a><span class="kw">library</span>(PropCIs)</span>
<span id="cb508-2"><a href="Matched.html#cb508-2"></a></span>
<span id="cb508-3"><a href="Matched.html#cb508-3"></a><span class="co"># specific to how to round </span></span>
<span id="cb508-4"><a href="Matched.html#cb508-4"></a>currentDigits =<span class="st"> </span><span class="kw">unlist</span>(<span class="kw">options</span>(<span class="st">&quot;digits&quot;</span>))  <span class="co"># save current rounding</span></span>
<span id="cb508-5"><a href="Matched.html#cb508-5"></a><span class="kw">options</span>(<span class="dt">digits =</span> <span class="dv">1</span>)</span>
<span id="cb508-6"><a href="Matched.html#cb508-6"></a></span>
<span id="cb508-7"><a href="Matched.html#cb508-7"></a><span class="co"># 95% Wald CI for difference of marginal probabilities </span></span>
<span id="cb508-8"><a href="Matched.html#cb508-8"></a><span class="kw">diffpropci.Wald.mp</span>(<span class="dv">107</span>, <span class="dv">132</span>, <span class="dv">1144</span>, <span class="fl">0.95</span>)  <span class="co"># (n21, n12, n, confidence level)</span></span></code></pre></div>
<pre class="custom-output"><code>


data:  

95 percent confidence interval:
 -0.005  0.048
sample estimates:
[1] 0.02</code></pre>
<div class="sourceCode" id="cb510"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb510-1"><a href="Matched.html#cb510-1"></a><span class="kw">diffpropci.Wald.mp</span>(tab[<span class="dv">2</span>,<span class="dv">1</span>], tab[<span class="dv">1</span>,<span class="dv">2</span>], <span class="kw">sum</span>(tab), <span class="fl">0.95</span>)  </span></code></pre></div>
<pre class="custom-output"><code>


data:  

95 percent confidence interval:
 -0.005  0.048
sample estimates:
[1] 0.02</code></pre>
<div class="sourceCode" id="cb512"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb512-1"><a href="Matched.html#cb512-1"></a><span class="co"># 95% score CI for difference of marginal probabilities </span></span>
<span id="cb512-2"><a href="Matched.html#cb512-2"></a><span class="kw">scoreci.mp</span>(tab[<span class="dv">2</span>,<span class="dv">1</span>], tab[<span class="dv">1</span>,<span class="dv">2</span>], <span class="kw">sum</span>(tab), <span class="fl">0.95</span>)</span></code></pre></div>
<pre class="custom-output"><code>


data:  

95 percent confidence interval:
 -0.005  0.048</code></pre>
<div class="sourceCode" id="cb514"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb514-1"><a href="Matched.html#cb514-1"></a><span class="kw">options</span>(<span class="dt">digits =</span> currentDigits)  <span class="co"># reset rounding</span></span></code></pre></div>
</div>
<div id="estimating-the-difference-between-dependent-proportions" class="section level3">
<h3>8.1.2 Estimating the difference between Dependent Proportions</h3>
</div>
</div>
<div id="x8.2" class="section level2">
<h2>8.2 Marginal Models and Subject-Specific Models for Matched Pairs</h2>
<div id="x8.2.1" class="section level3">
<h3>8.2.1 Marginal Models for Marginal Proportions</h3>
<p><span class="math display">\[P(Y_1 = 1) = \alpha + \delta,\ P(Y_2= 1) = \alpha,\]</span></p>
<p><span class="math display">\[P(Y_1 = 1) = \alpha + \delta x_i\]</span></p>
<p><span class="math display" id="eq:eq82">\[\begin{equation} 
  \mathrm{logit}[P(Y_t = 1)] = \alpha + \beta x_i.
  \tag{21}
\end{equation}\]</span></p>
</div>
<div id="example-enironmental-options-revisted" class="section level3">
<h3>8.2.2 Example: Enironmental Options Revisted</h3>
<div class="sourceCode" id="cb515"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb515-1"><a href="Matched.html#cb515-1"></a>Opinions &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;http://users.stat.ufl.edu/~aa/cat/data/Opinions.dat&quot;</span>,</span>
<span id="cb515-2"><a href="Matched.html#cb515-2"></a>                        <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">stringsAsFactors =</span> <span class="ot">TRUE</span>)</span>
<span id="cb515-3"><a href="Matched.html#cb515-3"></a></span>
<span id="cb515-4"><a href="Matched.html#cb515-4"></a><span class="co"># Data file has 1144 lines, one for each of 1144 people. </span></span>
<span id="cb515-5"><a href="Matched.html#cb515-5"></a><span class="co"># Each person has two binary responses (y1 and y2)</span></span>
<span id="cb515-6"><a href="Matched.html#cb515-6"></a>Opinions <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb515-7"><a href="Matched.html#cb515-7"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">row_number</span>() <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="kw">n</span>()<span class="op">-</span><span class="dv">1</span>, <span class="kw">n</span>()))  </span></code></pre></div>
<pre class="custom-output"><code>  person question y
1      1        1 1
2      1        0 1
3      2        1 1
4      2        0 1
5   1144        1 0
6   1144        0 0</code></pre>
<div class="sourceCode" id="cb517"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb517-1"><a href="Matched.html#cb517-1"></a><span class="kw">library</span>(gee)</span>
<span id="cb517-2"><a href="Matched.html#cb517-2"></a><span class="co"># id identifies variable on which observe y1, y2</span></span>
<span id="cb517-3"><a href="Matched.html#cb517-3"></a>fit &lt;-<span class="st"> </span><span class="kw">gee</span>(y <span class="op">~</span><span class="st"> </span>question, <span class="dt">id =</span> person, <span class="dt">family =</span> <span class="kw">binomial</span>(<span class="dt">link =</span> <span class="st">&quot;identity&quot;</span>),</span>
<span id="cb517-4"><a href="Matched.html#cb517-4"></a>           <span class="dt">data =</span> Opinions)</span></code></pre></div>
<pre><code>Beginning Cgee S-function, @(#) geeformula.q 4.13 98/01/27</code></pre>
<pre><code>running glm to get initial regression estimate</code></pre>
<pre class="custom-output"><code>(Intercept)    question 
 0.29195804  0.02185315 </code></pre>
<div class="sourceCode" id="cb521"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb521-1"><a href="Matched.html#cb521-1"></a><span class="kw">summary</span>(fit) <span class="co"># question parameter for identity link is difference of proportions</span></span></code></pre></div>
<pre class="custom-output"><code>
 GEE:  GENERALIZED LINEAR MODELS FOR DEPENDENT DATA
 gee S-function, version 4.13 modified 98/01/27 (1998) 

Model:
 Link:                      Identity 
 Variance to Mean Relation: Binomial 
 Correlation Structure:     Independent 

Call:
gee(formula = y ~ question, id = person, data = Opinions, family = binomial(link = &quot;identity&quot;))

Summary of Residuals:
       Min         1Q     Median         3Q        Max 
-0.3138112 -0.3138112 -0.2919580  0.6861888  0.7080420 


Coefficients:
              Estimate Naive S.E.   Naive z Robust S.E.  Robust z
(Intercept) 0.29195804 0.01344828 21.709701   0.0134424 21.719196
question    0.02185315 0.01921587  1.137245   0.0134982  1.618967

Estimated Scale Parameter:  1.000875
Number of Iterations:  1

Working Correlation
     [,1] [,2]
[1,]    1    0
[2,]    0    1</code></pre>
<div class="sourceCode" id="cb523"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb523-1"><a href="Matched.html#cb523-1"></a>fit2 &lt;-<span class="st"> </span><span class="kw">gee</span>(y <span class="op">~</span><span class="st"> </span>question, <span class="dt">id =</span> person, <span class="dt">family =</span> <span class="kw">binomial</span>(<span class="dt">link =</span> logit),</span>
<span id="cb523-2"><a href="Matched.html#cb523-2"></a>           <span class="dt">data =</span> Opinions)</span></code></pre></div>
<pre><code>Beginning Cgee S-function, @(#) geeformula.q 4.13 98/01/27
running glm to get initial regression estimate</code></pre>
<pre class="custom-output"><code>(Intercept)    question 
 -0.8858933   0.1035319 </code></pre>
<div class="sourceCode" id="cb526"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb526-1"><a href="Matched.html#cb526-1"></a><span class="kw">summary</span>(fit2) <span class="co"># question parameter for logit link is log odds ratio</span></span></code></pre></div>
<pre class="custom-output"><code>
 GEE:  GENERALIZED LINEAR MODELS FOR DEPENDENT DATA
 gee S-function, version 4.13 modified 98/01/27 (1998) 

Model:
 Link:                      Logit 
 Variance to Mean Relation: Binomial 
 Correlation Structure:     Independent 

Call:
gee(formula = y ~ question, id = person, data = Opinions, family = binomial(link = logit))

Summary of Residuals:
       Min         1Q     Median         3Q        Max 
-0.3138112 -0.3138112 -0.2919580  0.6861888  0.7080420 


Coefficients:
              Estimate Naive S.E.    Naive z Robust S.E.   Robust z
(Intercept) -0.8858933 0.06505597 -13.617401  0.06502753 -13.623357
question     0.1035319 0.09107816   1.136737  0.06397794   1.618244

Estimated Scale Parameter:  1.000875
Number of Iterations:  1

Working Correlation
     [,1] [,2]
[1,]    1    0
[2,]    0    1</code></pre>
</div>
<div id="x8.2.3" class="section level3">
<h3>8.2.3 Subject-Specific and Population-Averaging Tables</h3>
<div class="sourceCode" id="cb528"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb528-1"><a href="Matched.html#cb528-1"></a><span class="st">`</span><span class="dt">Table 8.2</span><span class="st">`</span> &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Question =</span> <span class="kw">c</span>(<span class="st">&quot;yi1: Pay higher taxes?&quot;</span>, </span>
<span id="cb528-2"><a href="Matched.html#cb528-2"></a>                                       <span class="st">&quot;yi2: Cut living standards?&quot;</span>),</span>
<span id="cb528-3"><a href="Matched.html#cb528-3"></a>                          <span class="dt">Yes =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb528-4"><a href="Matched.html#cb528-4"></a>                          <span class="dt">No =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb528-5"><a href="Matched.html#cb528-5"></a></span>
<span id="cb528-6"><a href="Matched.html#cb528-6"></a>theHeader &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">col_keys =</span> <span class="kw">colnames</span>(<span class="st">`</span><span class="dt">Table 8.2</span><span class="st">`</span>),</span>
<span id="cb528-7"><a href="Matched.html#cb528-7"></a>                        <span class="dt">line1 =</span> <span class="kw">c</span>(<span class="st">&quot;Question&quot;</span>, <span class="kw">rep</span>(<span class="st">&quot;Response&quot;</span>, <span class="dv">2</span>)),</span>
<span id="cb528-8"><a href="Matched.html#cb528-8"></a>                        <span class="dt">line2 =</span> <span class="kw">colnames</span>(<span class="st">`</span><span class="dt">Table 8.2</span><span class="st">`</span>))</span>
<span id="cb528-9"><a href="Matched.html#cb528-9"></a></span>
<span id="cb528-10"><a href="Matched.html#cb528-10"></a><span class="kw">library</span>(flextable)</span>
<span id="cb528-11"><a href="Matched.html#cb528-11"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb528-12"><a href="Matched.html#cb528-12"></a></span>
<span id="cb528-13"><a href="Matched.html#cb528-13"></a><span class="kw">flextable</span>(<span class="st">`</span><span class="dt">Table 8.2</span><span class="st">`</span>, <span class="dt">col_keys =</span> theHeader<span class="op">$</span>col_keys) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb528-14"><a href="Matched.html#cb528-14"></a><span class="st">  </span><span class="kw">set_header_df</span>(</span>
<span id="cb528-15"><a href="Matched.html#cb528-15"></a>    <span class="dt">mapping =</span> theHeader,</span>
<span id="cb528-16"><a href="Matched.html#cb528-16"></a>    <span class="dt">key =</span> <span class="st">&quot;col_keys&quot;</span></span>
<span id="cb528-17"><a href="Matched.html#cb528-17"></a>  ) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb528-18"><a href="Matched.html#cb528-18"></a><span class="st">  </span><span class="kw">theme_booktabs</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb528-19"><a href="Matched.html#cb528-19"></a><span class="st">  </span><span class="kw">merge_v</span>(<span class="dt">part =</span> <span class="st">&quot;header&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb528-20"><a href="Matched.html#cb528-20"></a><span class="st">  </span><span class="kw">merge_h</span>(<span class="dt">part =</span> <span class="st">&quot;header&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb528-21"><a href="Matched.html#cb528-21"></a><span class="st">  </span><span class="kw">align</span>(<span class="dt">align =</span> <span class="st">&quot;center&quot;</span>, <span class="dt">part =</span> <span class="st">&quot;all&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb528-22"><a href="Matched.html#cb528-22"></a><span class="st">  </span><span class="co">#autofit() %&gt;% </span></span>
<span id="cb528-23"><a href="Matched.html#cb528-23"></a><span class="st">  </span><span class="kw">empty_blanks</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb528-24"><a href="Matched.html#cb528-24"></a><span class="st">  </span><span class="kw">fix_border_issues</span>()  <span class="op">%&gt;%</span></span>
<span id="cb528-25"><a href="Matched.html#cb528-25"></a><span class="st">  </span><span class="kw">set_caption</span>(<span class="dt">caption =</span> <span class="st">&quot;Table 8.2: Representation of subject-specific table for matched pair contributing to count n_11 = 227 in Table 8.1.&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb528-26"><a href="Matched.html#cb528-26"></a><span class="st">  </span><span class="kw">set_table_properties</span>(<span class="dt">width =</span> <span class="fl">.75</span>, <span class="dt">layout =</span> <span class="st">&quot;autofit&quot;</span>)</span></code></pre></div>
<template id="44e6d0ba-2e6c-472c-bb05-71bede74ff7d"><style>
.tabwid table{
  border-collapse:collapse;
  line-height:1;
  margin-left:auto;
  margin-right:auto;
  border-width: 0;
  display: table;
  margin-top: 5px;
  margin-bottom: 5px;
  table-layout: fixed;
  border-spacing: 0;
  border-color: transparent;
}
.tabwid_left table{
  margin-left:0;
}
.tabwid_right table{
  margin-right:0;
}
.tabwid td {
    padding: 0;
}
.tabwid a {
  text-decoration: none;
}
.tabwid thead {
    background-color: transparent;
}
.tabwid tfoot {
    background-color: transparent;
}
.tabwid table tr {
background-color: transparent;
}
</style><div class="tabwid"><style>.cl-7f0beb82{table-layout:auto;border-collapse:collapse;width:75%;}.cl-7f070c20{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-7f071aa8{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:3pt;padding-top:3pt;padding-left:3pt;padding-right:3pt;line-height: 1;background-color:transparent;}.cl-7f0741e0{width:54pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7f0741f4{width:54pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7f0741fe{width:54pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 2pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7f074208{width:54pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 2pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7f074212{width:54pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table class='cl-7f0beb82'>
<caption class="Table Caption">
<span id="tab:unnamed-chunk-98">Table 3: </span>Table 8.2: Representation of subject-specific table for matched pair contributing to count n_11 = 227 in Table 8.1.
</caption>
<thead><tr style="overflow-wrap:break-word;"><td  rowspan="2"class="cl-7f074208"><p class="cl-7f071aa8"><span class="cl-7f070c20">Question</span></p></td><td  colspan="2"class="cl-7f0741fe"><p class="cl-7f071aa8"><span class="cl-7f070c20">Response</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7f074212"><p class="cl-7f071aa8"><span class="cl-7f070c20">Yes</span></p></td><td class="cl-7f074212"><p class="cl-7f071aa8"><span class="cl-7f070c20">No</span></p></td></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-7f0741e0"><p class="cl-7f071aa8"><span class="cl-7f070c20">yi1: Pay higher taxes?</span></p></td><td class="cl-7f0741e0"><p class="cl-7f071aa8"><span class="cl-7f070c20">1</span></p></td><td class="cl-7f0741e0"><p class="cl-7f071aa8"><span class="cl-7f070c20">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7f0741f4"><p class="cl-7f071aa8"><span class="cl-7f070c20">yi2: Cut living standards?</span></p></td><td class="cl-7f0741f4"><p class="cl-7f071aa8"><span class="cl-7f070c20">1</span></p></td><td class="cl-7f0741f4"><p class="cl-7f071aa8"><span class="cl-7f070c20">0</span></p></td></tr></tbody></table></div></template>
<div id="dc8613e1-1f21-4cdf-a9bb-14b1436f142e"></div>
<script>
var dest = document.getElementById("dc8613e1-1f21-4cdf-a9bb-14b1436f142e");
var template = document.getElementById("44e6d0ba-2e6c-472c-bb05-71bede74ff7d");
var caption = template.content.querySelector("caption");
if(caption) {
  caption.style.cssText = "display:block;"
  var newcapt = document.createElement("p");
  newcapt.appendChild(caption)
  dest.parentNode.insertBefore(newcapt, dest.previousSibling);
}
var fantome = dest.attachShadow({mode: 'open'});
var templateContent = template.content;
fantome.appendChild(templateContent);
fantome.appendChild(templateContent);
</script>

</div>
<div id="x8.2.4" class="section level3">
<h3>8.2.4 Conditional Logistic Regression for Matched-Pairs*</h3>
<p><span class="math display" id="eq:eq83">\[\begin{equation} 
  \mathrm{logit}[P(Y_{it} = 1)] = \alpha_i + \beta x_{it},\ t = 1,\ 2,
  \tag{22}
\end{equation}\]</span></p>
<p><span class="math display">\[P(Y_{i1} = 1) = \frac{\mathrm{exp}(\alpha_i + \beta)}{1 + \mathrm{exp}(\alpha_i + \beta)},\  P(Y_{i2} = 1) = \frac{\mathrm{exp}(\alpha_i)}{1 + \mathrm{exp}(\alpha_i)}.\]</span><br />
### 8.2.5 Logistic Regression for Matched Case-Control Studies*</p>
<div class="sourceCode" id="cb529"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb529-1"><a href="Matched.html#cb529-1"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb529-2"><a href="Matched.html#cb529-2"></a><span class="st">`</span><span class="dt">Table 8.3</span><span class="st">`</span> &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="st">`</span><span class="dt">Normal Birth Weight (Controls)</span><span class="st">`</span> =<span class="st"> </span></span>
<span id="cb529-3"><a href="Matched.html#cb529-3"></a><span class="st">                            </span><span class="kw">c</span>(<span class="st">&quot;Nonsmokers&quot;</span>, </span>
<span id="cb529-4"><a href="Matched.html#cb529-4"></a>                              <span class="st">&quot;Smokers&quot;</span>),</span>
<span id="cb529-5"><a href="Matched.html#cb529-5"></a>                          <span class="dt">Nonsmokers =</span> <span class="kw">c</span>(<span class="dv">159</span>, <span class="dv">8</span>),</span>
<span id="cb529-6"><a href="Matched.html#cb529-6"></a>                          <span class="dt">Smokers =</span> <span class="kw">c</span>(<span class="dv">22</span>, <span class="dv">14</span>))</span>
<span id="cb529-7"><a href="Matched.html#cb529-7"></a></span>
<span id="cb529-8"><a href="Matched.html#cb529-8"></a>theHeader &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">col_keys =</span> <span class="kw">c</span>(<span class="st">&quot;Normal Birth Weight (Controls)&quot;</span>, <span class="st">&quot;blank&quot;</span>, <span class="st">&quot;Nonsmokers&quot;</span>, <span class="st">&quot;Smokers&quot;</span>),</span>
<span id="cb529-9"><a href="Matched.html#cb529-9"></a>                        <span class="dt">line1 =</span> <span class="kw">c</span>(<span class="st">&quot;Normal Birth Weight (Controls)&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="kw">rep</span>(<span class="st">&quot;Low Birth Weight (Cases)&quot;</span>, <span class="dv">2</span>)),</span>
<span id="cb529-10"><a href="Matched.html#cb529-10"></a>                        <span class="dt">line2 =</span> <span class="kw">c</span>(<span class="st">&quot;Normal Birth Weight (Controls)&quot;</span>, <span class="st">&quot;blank&quot;</span>, <span class="st">&quot;Nonsmokers&quot;</span>, <span class="st">&quot;Smokers&quot;</span>))</span>
<span id="cb529-11"><a href="Matched.html#cb529-11"></a></span>
<span id="cb529-12"><a href="Matched.html#cb529-12"></a><span class="kw">library</span>(flextable)</span>
<span id="cb529-13"><a href="Matched.html#cb529-13"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb529-14"><a href="Matched.html#cb529-14"></a></span>
<span id="cb529-15"><a href="Matched.html#cb529-15"></a><span class="kw">library</span>(officer)</span>
<span id="cb529-16"><a href="Matched.html#cb529-16"></a>big_border =<span class="st"> </span><span class="kw">fp_border</span>(<span class="dt">color=</span><span class="st">&quot;black&quot;</span>, <span class="dt">width =</span> <span class="dv">2</span>)</span>
<span id="cb529-17"><a href="Matched.html#cb529-17"></a></span>
<span id="cb529-18"><a href="Matched.html#cb529-18"></a><span class="kw">flextable</span>(<span class="st">`</span><span class="dt">Table 8.3</span><span class="st">`</span>, <span class="dt">col_keys =</span> theHeader<span class="op">$</span>col_keys) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb529-19"><a href="Matched.html#cb529-19"></a><span class="st">  </span><span class="kw">set_header_df</span>(</span>
<span id="cb529-20"><a href="Matched.html#cb529-20"></a>    <span class="dt">mapping =</span> theHeader,</span>
<span id="cb529-21"><a href="Matched.html#cb529-21"></a>    <span class="dt">key =</span> <span class="st">&quot;col_keys&quot;</span></span>
<span id="cb529-22"><a href="Matched.html#cb529-22"></a>  ) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb529-23"><a href="Matched.html#cb529-23"></a><span class="st">  </span><span class="kw">theme_booktabs</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb529-24"><a href="Matched.html#cb529-24"></a><span class="st">  </span><span class="kw">merge_v</span>(<span class="dt">part =</span> <span class="st">&quot;header&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb529-25"><a href="Matched.html#cb529-25"></a><span class="st">  </span><span class="kw">merge_h</span>(<span class="dt">part =</span> <span class="st">&quot;header&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb529-26"><a href="Matched.html#cb529-26"></a><span class="st">  </span><span class="kw">align</span>(<span class="dt">align =</span> <span class="st">&quot;center&quot;</span>, <span class="dt">part =</span> <span class="st">&quot;all&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb529-27"><a href="Matched.html#cb529-27"></a><span class="st">  </span><span class="co">#autofit() %&gt;% </span></span>
<span id="cb529-28"><a href="Matched.html#cb529-28"></a><span class="st">  </span><span class="kw">empty_blanks</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb529-29"><a href="Matched.html#cb529-29"></a><span class="st">  </span><span class="kw">fix_border_issues</span>()  <span class="op">%&gt;%</span></span>
<span id="cb529-30"><a href="Matched.html#cb529-30"></a><span class="st">  </span><span class="kw">set_caption</span>(<span class="dt">caption =</span> <span class="st">&quot;Table 8.3&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb529-31"><a href="Matched.html#cb529-31"></a><span class="st">  </span><span class="kw">set_table_properties</span>(<span class="dt">width =</span> <span class="fl">.75</span>, <span class="dt">layout =</span> <span class="st">&quot;autofit&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb529-32"><a href="Matched.html#cb529-32"></a><span class="st">  </span><span class="kw">hline_top</span>(<span class="dt">part=</span><span class="st">&quot;header&quot;</span>, <span class="dt">border =</span> big_border) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb529-33"><a href="Matched.html#cb529-33"></a><span class="st">  </span><span class="kw">hline_bottom</span>(<span class="dt">part=</span><span class="st">&quot;body&quot;</span>, <span class="dt">border =</span> big_border)  </span></code></pre></div>
<template id="2dc1e636-e0c6-48d2-864d-2aaab2b9bd7f"><style>
.tabwid table{
  border-collapse:collapse;
  line-height:1;
  margin-left:auto;
  margin-right:auto;
  border-width: 0;
  display: table;
  margin-top: 5px;
  margin-bottom: 5px;
  table-layout: fixed;
  border-spacing: 0;
  border-color: transparent;
}
.tabwid_left table{
  margin-left:0;
}
.tabwid_right table{
  margin-right:0;
}
.tabwid td {
    padding: 0;
}
.tabwid a {
  text-decoration: none;
}
.tabwid thead {
    background-color: transparent;
}
.tabwid tfoot {
    background-color: transparent;
}
.tabwid table tr {
background-color: transparent;
}
</style><div class="tabwid"><style>.cl-7f4a967a{table-layout:auto;border-collapse:collapse;width:75%;}.cl-7f4554f8{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-7f45550c{font-family:'Arial';font-size:10pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-7f455fc0{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:3pt;padding-top:3pt;padding-left:3pt;padding-right:3pt;line-height: 1;background-color:transparent;}.cl-7f457cf8{width:54pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7f457d0c{width:54pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7f457d16{width:54pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 2pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7f457d20{width:54pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 2pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7f457d21{width:54pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 2pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7f457d2a{width:54pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7f457d34{width:54pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table class='cl-7f4a967a'>
<caption class="Table Caption">
<span id="tab:unnamed-chunk-99">Table 4: </span>Table 8.3
</caption>
<thead><tr style="overflow-wrap:break-word;"><td  rowspan="2"class="cl-7f457d21"><p class="cl-7f455fc0"><span class="cl-7f4554f8">Normal Birth Weight (Controls)</span></p></td><td  rowspan="2"class="cl-7f457d16"><p class="cl-7f455fc0"><span class="cl-7f45550c"></span></p></td><td  colspan="2"class="cl-7f457d20"><p class="cl-7f455fc0"><span class="cl-7f4554f8">Low Birth Weight (Cases)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7f457d34"><p class="cl-7f455fc0"><span class="cl-7f4554f8">Nonsmokers</span></p></td><td class="cl-7f457d34"><p class="cl-7f455fc0"><span class="cl-7f4554f8">Smokers</span></p></td></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-7f457cf8"><p class="cl-7f455fc0"><span class="cl-7f4554f8">Nonsmokers</span></p></td><td class="cl-7f457cf8"><p class="cl-7f455fc0"><span class="cl-7f45550c"></span></p></td><td class="cl-7f457cf8"><p class="cl-7f455fc0"><span class="cl-7f4554f8">159</span></p></td><td class="cl-7f457cf8"><p class="cl-7f455fc0"><span class="cl-7f4554f8">22</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7f457d0c"><p class="cl-7f455fc0"><span class="cl-7f4554f8">Smokers</span></p></td><td class="cl-7f457d0c"><p class="cl-7f455fc0"><span class="cl-7f45550c"></span></p></td><td class="cl-7f457d0c"><p class="cl-7f455fc0"><span class="cl-7f4554f8">8</span></p></td><td class="cl-7f457d0c"><p class="cl-7f455fc0"><span class="cl-7f4554f8">14</span></p></td></tr></tbody></table></div></template>
<div id="4e43df4b-5555-49d2-8178-70f640fde427"></div>
<script>
var dest = document.getElementById("4e43df4b-5555-49d2-8178-70f640fde427");
var template = document.getElementById("2dc1e636-e0c6-48d2-864d-2aaab2b9bd7f");
var caption = template.content.querySelector("caption");
if(caption) {
  caption.style.cssText = "display:block;"
  var newcapt = document.createElement("p");
  newcapt.appendChild(caption)
  dest.parentNode.insertBefore(newcapt, dest.previousSibling);
}
var fantome = dest.attachShadow({mode: 'open'});
var templateContent = template.content;
fantome.appendChild(templateContent);
fantome.appendChild(templateContent);
</script>

<div class="sourceCode" id="cb530"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb530-1"><a href="Matched.html#cb530-1"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb530-2"><a href="Matched.html#cb530-2"></a><span class="st">`</span><span class="dt">Table 8.4</span><span class="st">`</span> &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="st">`</span><span class="dt">Smoker</span><span class="st">`</span> =<span class="st"> </span></span>
<span id="cb530-3"><a href="Matched.html#cb530-3"></a><span class="st">                            </span><span class="kw">c</span>(<span class="st">&quot;No&quot;</span>, </span>
<span id="cb530-4"><a href="Matched.html#cb530-4"></a>                              <span class="st">&quot;Yes&quot;</span>),</span>
<span id="cb530-5"><a href="Matched.html#cb530-5"></a>                          <span class="dt">aCase =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb530-6"><a href="Matched.html#cb530-6"></a>                          <span class="dt">aCon =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb530-7"><a href="Matched.html#cb530-7"></a>                          <span class="dt">bCase =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb530-8"><a href="Matched.html#cb530-8"></a>                          <span class="dt">bCon =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb530-9"><a href="Matched.html#cb530-9"></a>                          <span class="dt">cCase =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb530-10"><a href="Matched.html#cb530-10"></a>                          <span class="dt">cCon =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb530-11"><a href="Matched.html#cb530-11"></a>                          <span class="dt">dCase =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb530-12"><a href="Matched.html#cb530-12"></a>                          <span class="dt">dCon =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb530-13"><a href="Matched.html#cb530-13"></a></span>
<span id="cb530-14"><a href="Matched.html#cb530-14"></a>theHeader &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">col_keys =</span> <span class="kw">c</span>(<span class="st">&quot;Smoker&quot;</span> ,</span>
<span id="cb530-15"><a href="Matched.html#cb530-15"></a>                         </span>
<span id="cb530-16"><a href="Matched.html#cb530-16"></a>                          <span class="st">&quot;aCase&quot;</span>,</span>
<span id="cb530-17"><a href="Matched.html#cb530-17"></a>                          <span class="st">&quot;aCon&quot;</span>, </span>
<span id="cb530-18"><a href="Matched.html#cb530-18"></a>                          <span class="st">&quot;blank1&quot;</span>,</span>
<span id="cb530-19"><a href="Matched.html#cb530-19"></a>                          <span class="st">&quot;bCase&quot;</span>,</span>
<span id="cb530-20"><a href="Matched.html#cb530-20"></a>                          <span class="st">&quot;bCon&quot;</span>, </span>
<span id="cb530-21"><a href="Matched.html#cb530-21"></a>                           </span>
<span id="cb530-22"><a href="Matched.html#cb530-22"></a>                          <span class="st">&quot;blank2&quot;</span>,</span>
<span id="cb530-23"><a href="Matched.html#cb530-23"></a>                          <span class="st">&quot;cCase&quot;</span>,</span>
<span id="cb530-24"><a href="Matched.html#cb530-24"></a>                          <span class="st">&quot;cCon&quot;</span>, </span>
<span id="cb530-25"><a href="Matched.html#cb530-25"></a>                           </span>
<span id="cb530-26"><a href="Matched.html#cb530-26"></a>                          <span class="st">&quot;blank3&quot;</span>,</span>
<span id="cb530-27"><a href="Matched.html#cb530-27"></a>                          <span class="st">&quot;dCase&quot;</span>,</span>
<span id="cb530-28"><a href="Matched.html#cb530-28"></a>                          <span class="st">&quot;dCon&quot;</span>, </span>
<span id="cb530-29"><a href="Matched.html#cb530-29"></a>                          <span class="st">&quot;blank4&quot;</span> ),</span>
<span id="cb530-30"><a href="Matched.html#cb530-30"></a>                        <span class="dt">line1 =</span> <span class="kw">c</span>(<span class="st">&quot;Smoker&quot;</span>, <span class="kw">rep</span>(<span class="st">&quot;a&quot;</span>, <span class="dv">2</span>), <span class="st">&quot;&quot;</span>, <span class="kw">rep</span>(<span class="st">&quot;b&quot;</span>, <span class="dv">2</span>), <span class="st">&quot;&quot;</span>, </span>
<span id="cb530-31"><a href="Matched.html#cb530-31"></a>                                  <span class="kw">rep</span>(<span class="st">&quot;c&quot;</span>, <span class="dv">2</span>), <span class="st">&quot;&quot;</span>, <span class="kw">rep</span>(<span class="st">&quot;d&quot;</span>, <span class="dv">2</span>),<span class="st">&quot;&quot;</span>),</span>
<span id="cb530-32"><a href="Matched.html#cb530-32"></a>                        <span class="dt">line2 =</span> <span class="kw">c</span>(<span class="st">&quot;Smoker&quot;</span>, <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;Case&quot;</span>, <span class="st">&quot;Control&quot;</span>, <span class="st">&quot; &quot;</span>), <span class="dv">4</span>)))</span>
<span id="cb530-33"><a href="Matched.html#cb530-33"></a></span>
<span id="cb530-34"><a href="Matched.html#cb530-34"></a><span class="kw">library</span>(flextable)</span>
<span id="cb530-35"><a href="Matched.html#cb530-35"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb530-36"><a href="Matched.html#cb530-36"></a></span>
<span id="cb530-37"><a href="Matched.html#cb530-37"></a><span class="kw">flextable</span>(<span class="st">`</span><span class="dt">Table 8.4</span><span class="st">`</span>, <span class="dt">col_keys =</span> theHeader<span class="op">$</span>col_keys) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb530-38"><a href="Matched.html#cb530-38"></a><span class="st">  </span><span class="kw">set_header_df</span>(</span>
<span id="cb530-39"><a href="Matched.html#cb530-39"></a>    <span class="dt">mapping =</span> theHeader,</span>
<span id="cb530-40"><a href="Matched.html#cb530-40"></a>    <span class="dt">key =</span> <span class="st">&quot;col_keys&quot;</span></span>
<span id="cb530-41"><a href="Matched.html#cb530-41"></a>  ) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb530-42"><a href="Matched.html#cb530-42"></a><span class="st">  </span><span class="kw">theme_booktabs</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb530-43"><a href="Matched.html#cb530-43"></a><span class="st">  </span><span class="kw">merge_v</span>(<span class="dt">part =</span> <span class="st">&quot;header&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb530-44"><a href="Matched.html#cb530-44"></a><span class="st">  </span><span class="kw">merge_h</span>(<span class="dt">part =</span> <span class="st">&quot;header&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb530-45"><a href="Matched.html#cb530-45"></a><span class="st">  </span><span class="kw">align</span>(<span class="dt">align =</span> <span class="st">&quot;center&quot;</span>, <span class="dt">part =</span> <span class="st">&quot;all&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb530-46"><a href="Matched.html#cb530-46"></a><span class="st">  </span><span class="co">#autofit() %&gt;% </span></span>
<span id="cb530-47"><a href="Matched.html#cb530-47"></a><span class="st">  </span><span class="kw">empty_blanks</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb530-48"><a href="Matched.html#cb530-48"></a><span class="st">  </span><span class="kw">fix_border_issues</span>()  <span class="op">%&gt;%</span></span>
<span id="cb530-49"><a href="Matched.html#cb530-49"></a><span class="st">  </span><span class="kw">set_caption</span>(<span class="dt">caption =</span> <span class="st">&quot;Table 8.4&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb530-50"><a href="Matched.html#cb530-50"></a><span class="st">  </span><span class="kw">set_table_properties</span>(<span class="dt">width =</span> <span class="fl">.75</span>, <span class="dt">layout =</span> <span class="st">&quot;autofit&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb530-51"><a href="Matched.html#cb530-51"></a><span class="st">  </span><span class="kw">hline_top</span>(<span class="dt">part=</span><span class="st">&quot;header&quot;</span>, <span class="dt">border =</span> big_border) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb530-52"><a href="Matched.html#cb530-52"></a><span class="st">  </span><span class="kw">hline_top</span>(<span class="dt">part=</span><span class="st">&quot;body&quot;</span>, <span class="dt">border =</span> big_border)  <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb530-53"><a href="Matched.html#cb530-53"></a><span class="st">  </span><span class="kw">hline_bottom</span>(<span class="dt">part=</span><span class="st">&quot;body&quot;</span>, <span class="dt">border =</span> big_border)  </span></code></pre></div>
<template id="c4bf8a75-5aff-403a-a940-e9291eef76e0"><style>
.tabwid table{
  border-collapse:collapse;
  line-height:1;
  margin-left:auto;
  margin-right:auto;
  border-width: 0;
  display: table;
  margin-top: 5px;
  margin-bottom: 5px;
  table-layout: fixed;
  border-spacing: 0;
  border-color: transparent;
}
.tabwid_left table{
  margin-left:0;
}
.tabwid_right table{
  margin-right:0;
}
.tabwid td {
    padding: 0;
}
.tabwid a {
  text-decoration: none;
}
.tabwid thead {
    background-color: transparent;
}
.tabwid tfoot {
    background-color: transparent;
}
.tabwid table tr {
background-color: transparent;
}
</style><div class="tabwid"><style>.cl-7f886d88{table-layout:auto;border-collapse:collapse;width:75%;}.cl-7f83cad0{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-7f83cae4{font-family:'Arial';font-size:10pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-7f83d804{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:3pt;padding-top:3pt;padding-left:3pt;padding-right:3pt;line-height: 1;background-color:transparent;}.cl-7f8405b8{width:54pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 2pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7f8405cc{width:54pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7f8405d6{width:54pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 2pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7f8405e0{width:54pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 2pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7f8405ea{width:54pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 2pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7f8405f4{width:54pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7f8405fe{width:54pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table class='cl-7f886d88'>
<caption class="Table Caption">
<span id="tab:unnamed-chunk-100">Table 5: </span>Table 8.4
</caption>
<thead><tr style="overflow-wrap:break-word;"><td  rowspan="2"class="cl-7f8405ea"><p class="cl-7f83d804"><span class="cl-7f83cad0">Smoker</span></p></td><td  colspan="2"class="cl-7f8405d6"><p class="cl-7f83d804"><span class="cl-7f83cad0">a</span></p></td><td  rowspan="2"class="cl-7f8405e0"><p class="cl-7f83d804"><span class="cl-7f83cae4"></span></p></td><td  colspan="2"class="cl-7f8405d6"><p class="cl-7f83d804"><span class="cl-7f83cad0">b</span></p></td><td  rowspan="2"class="cl-7f8405e0"><p class="cl-7f83d804"><span class="cl-7f83cae4"></span></p></td><td  colspan="2"class="cl-7f8405d6"><p class="cl-7f83d804"><span class="cl-7f83cad0">c</span></p></td><td  rowspan="2"class="cl-7f8405e0"><p class="cl-7f83d804"><span class="cl-7f83cae4"></span></p></td><td  colspan="2"class="cl-7f8405d6"><p class="cl-7f83d804"><span class="cl-7f83cad0">d</span></p></td><td  rowspan="2"class="cl-7f8405e0"><p class="cl-7f83d804"><span class="cl-7f83cae4"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7f8405f4"><p class="cl-7f83d804"><span class="cl-7f83cad0">Case</span></p></td><td class="cl-7f8405f4"><p class="cl-7f83d804"><span class="cl-7f83cad0">Control</span></p></td><td class="cl-7f8405f4"><p class="cl-7f83d804"><span class="cl-7f83cad0">Case</span></p></td><td class="cl-7f8405f4"><p class="cl-7f83d804"><span class="cl-7f83cad0">Control</span></p></td><td class="cl-7f8405f4"><p class="cl-7f83d804"><span class="cl-7f83cad0">Case</span></p></td><td class="cl-7f8405f4"><p class="cl-7f83d804"><span class="cl-7f83cad0">Control</span></p></td><td class="cl-7f8405f4"><p class="cl-7f83d804"><span class="cl-7f83cad0">Case</span></p></td><td class="cl-7f8405f4"><p class="cl-7f83d804"><span class="cl-7f83cad0">Control</span></p></td></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-7f8405b8"><p class="cl-7f83d804"><span class="cl-7f83cad0">No</span></p></td><td class="cl-7f8405b8"><p class="cl-7f83d804"><span class="cl-7f83cad0">1</span></p></td><td class="cl-7f8405b8"><p class="cl-7f83d804"><span class="cl-7f83cad0">1</span></p></td><td class="cl-7f8405b8"><p class="cl-7f83d804"><span class="cl-7f83cae4"></span></p></td><td class="cl-7f8405b8"><p class="cl-7f83d804"><span class="cl-7f83cad0">0</span></p></td><td class="cl-7f8405b8"><p class="cl-7f83d804"><span class="cl-7f83cad0">1</span></p></td><td class="cl-7f8405b8"><p class="cl-7f83d804"><span class="cl-7f83cae4"></span></p></td><td class="cl-7f8405b8"><p class="cl-7f83d804"><span class="cl-7f83cad0">1</span></p></td><td class="cl-7f8405b8"><p class="cl-7f83d804"><span class="cl-7f83cad0">0</span></p></td><td class="cl-7f8405b8"><p class="cl-7f83d804"><span class="cl-7f83cae4"></span></p></td><td class="cl-7f8405b8"><p class="cl-7f83d804"><span class="cl-7f83cad0">0</span></p></td><td class="cl-7f8405b8"><p class="cl-7f83d804"><span class="cl-7f83cad0">0</span></p></td><td class="cl-7f8405b8"><p class="cl-7f83d804"><span class="cl-7f83cae4"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7f8405cc"><p class="cl-7f83d804"><span class="cl-7f83cad0">Yes</span></p></td><td class="cl-7f8405cc"><p class="cl-7f83d804"><span class="cl-7f83cad0">0</span></p></td><td class="cl-7f8405cc"><p class="cl-7f83d804"><span class="cl-7f83cad0">0</span></p></td><td class="cl-7f8405cc"><p class="cl-7f83d804"><span class="cl-7f83cae4"></span></p></td><td class="cl-7f8405cc"><p class="cl-7f83d804"><span class="cl-7f83cad0">1</span></p></td><td class="cl-7f8405cc"><p class="cl-7f83d804"><span class="cl-7f83cad0">0</span></p></td><td class="cl-7f8405cc"><p class="cl-7f83d804"><span class="cl-7f83cae4"></span></p></td><td class="cl-7f8405cc"><p class="cl-7f83d804"><span class="cl-7f83cad0">0</span></p></td><td class="cl-7f8405cc"><p class="cl-7f83d804"><span class="cl-7f83cad0">1</span></p></td><td class="cl-7f8405cc"><p class="cl-7f83d804"><span class="cl-7f83cae4"></span></p></td><td class="cl-7f8405cc"><p class="cl-7f83d804"><span class="cl-7f83cad0">1</span></p></td><td class="cl-7f8405cc"><p class="cl-7f83d804"><span class="cl-7f83cad0">1</span></p></td><td class="cl-7f8405cc"><p class="cl-7f83d804"><span class="cl-7f83cae4"></span></p></td></tr></tbody></table></div></template>
<div id="c6d7d8e4-5e72-401d-8aff-682db03e9900"></div>
<script>
var dest = document.getElementById("c6d7d8e4-5e72-401d-8aff-682db03e9900");
var template = document.getElementById("c4bf8a75-5aff-403a-a940-e9291eef76e0");
var caption = template.content.querySelector("caption");
if(caption) {
  caption.style.cssText = "display:block;"
  var newcapt = document.createElement("p");
  newcapt.appendChild(caption)
  dest.parentNode.insertBefore(newcapt, dest.previousSibling);
}
var fantome = dest.attachShadow({mode: 'open'});
var templateContent = template.content;
fantome.appendChild(templateContent);
fantome.appendChild(templateContent);
</script>

</div>
</div>
<div id="comparing-proportions-for-nominal-matched-pairs-responses" class="section level2">
<h2>8.3 Comparing Proportions for Nominal Matched-Pairs Responses</h2>
<p><span class="math display">\[P(Y_1 = i) = P(Y_2 = i)\ \mathrm{for}\ i = 1, \dots, c,\]</span></p>
<div id="marginal-homogeneity-for-baseline-category-logit-models" class="section level3">
<h3>8.3.1 Marginal Homogeneity for Baseline-Category Logit Models</h3>
<p><span class="math display">\[\mathrm{log}\left[\frac{P(Y_1 = j)}{P(Y_1 = c)}\right] = \alpha_j + \beta_j,\ \mathrm{log}\left[\frac{P(Y_2 = j)}{P(Y_2 = c)}\right] = \alpha_j\]</span>
### 8.3.2 Example: Coffee Brand Market Share</p>
<div class="sourceCode" id="cb531"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb531-1"><a href="Matched.html#cb531-1"></a>Coffee &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;http://users.stat.ufl.edu/~aa/cat/data/Coffee.dat&quot;</span>,</span>
<span id="cb531-2"><a href="Matched.html#cb531-2"></a>                        <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">stringsAsFactors =</span> <span class="ot">TRUE</span>)</span>
<span id="cb531-3"><a href="Matched.html#cb531-3"></a></span>
<span id="cb531-4"><a href="Matched.html#cb531-4"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb531-5"><a href="Matched.html#cb531-5"></a><span class="kw">library</span>(tidyr)</span>
<span id="cb531-6"><a href="Matched.html#cb531-6"></a>coffee_wide &lt;-<span class="st"> </span>Coffee <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb531-7"><a href="Matched.html#cb531-7"></a><span class="st">  </span>tidyr<span class="op">::</span><span class="kw">pivot_wider</span>(<span class="dt">id_cols =</span> person, <span class="dt">names_from=</span>purchase, <span class="dt">names_prefix =</span> <span class="st">&quot;y&quot;</span>, </span>
<span id="cb531-8"><a href="Matched.html#cb531-8"></a>                     <span class="dt">values_from =</span> y)</span>
<span id="cb531-9"><a href="Matched.html#cb531-9"></a>  </span>
<span id="cb531-10"><a href="Matched.html#cb531-10"></a></span>
<span id="cb531-11"><a href="Matched.html#cb531-11"></a></span>
<span id="cb531-12"><a href="Matched.html#cb531-12"></a><span class="co"># Make contingency table</span></span>
<span id="cb531-13"><a href="Matched.html#cb531-13"></a>tab &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">addmargins</span>(<span class="kw">xtabs</span>(<span class="op">~</span>y1 <span class="op">+</span><span class="st"> </span>y0, <span class="dt">data =</span> coffee_wide)))</span>
<span id="cb531-14"><a href="Matched.html#cb531-14"></a></span>
<span id="cb531-15"><a href="Matched.html#cb531-15"></a><span class="kw">library</span>(tibble)</span>
<span id="cb531-16"><a href="Matched.html#cb531-16"></a><span class="co"># Add label as the first column and variable names</span></span>
<span id="cb531-17"><a href="Matched.html#cb531-17"></a><span class="st">`</span><span class="dt">Table 8.5</span><span class="st">`</span> &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="st">`</span><span class="dt">First Purchase</span><span class="st">`</span> =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;High Point&quot;</span>, <span class="st">&quot;Taster&#39;s Choice&quot;</span>,</span>
<span id="cb531-18"><a href="Matched.html#cb531-18"></a>                                           <span class="st">&quot;Sanka&quot;</span>, <span class="st">&quot;Nescafe&quot;</span>, <span class="st">&quot;Brim&quot;</span>, <span class="st">&quot;Total&quot;</span>), </span>
<span id="cb531-19"><a href="Matched.html#cb531-19"></a>                      <span class="st">`</span><span class="dt">High Point</span><span class="st">`</span> =<span class="st"> </span>tab[, <span class="dv">1</span>], <span class="st">`</span><span class="dt">Taster&#39;s Choice</span><span class="st">`</span> =<span class="st"> </span>tab[,<span class="dv">2</span>],</span>
<span id="cb531-20"><a href="Matched.html#cb531-20"></a>                      <span class="st">`</span><span class="dt">Sanka</span><span class="st">`</span> =<span class="st"> </span>tab[, <span class="dv">3</span>], <span class="st">`</span><span class="dt">Nescafe</span><span class="st">`</span> =<span class="st"> </span>tab[,<span class="dv">4</span>], <span class="st">`</span><span class="dt">Brim</span><span class="st">`</span> =<span class="st"> </span>tab[,<span class="dv">5</span>],</span>
<span id="cb531-21"><a href="Matched.html#cb531-21"></a>                      <span class="dt">Total =</span> tab[, <span class="dv">6</span>])</span>
<span id="cb531-22"><a href="Matched.html#cb531-22"></a></span>
<span id="cb531-23"><a href="Matched.html#cb531-23"></a></span>
<span id="cb531-24"><a href="Matched.html#cb531-24"></a>theHeader &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">col_keys =</span> <span class="kw">c</span>(<span class="st">&quot;First Purchase&quot;</span>, <span class="st">&quot;Blank&quot;</span>, <span class="st">&quot;High Point&quot;</span>, </span>
<span id="cb531-25"><a href="Matched.html#cb531-25"></a>                                     <span class="st">&quot;Taster&#39;s Choice&quot;</span>, <span class="st">&quot;Sanka&quot;</span>, <span class="st">&quot;Nescafe&quot;</span>, </span>
<span id="cb531-26"><a href="Matched.html#cb531-26"></a>                                     <span class="st">&quot;Brim&quot;</span>, <span class="st">&quot;Total&quot;</span>),</span>
<span id="cb531-27"><a href="Matched.html#cb531-27"></a>                        <span class="dt">line1 =</span> <span class="kw">c</span>(<span class="st">&quot;First Purchase&quot;</span>, <span class="st">&quot;&quot;</span>, </span>
<span id="cb531-28"><a href="Matched.html#cb531-28"></a>                                  <span class="kw">rep</span>(<span class="st">&quot;Second Purchase&quot;</span>, <span class="dv">6</span>)),</span>
<span id="cb531-29"><a href="Matched.html#cb531-29"></a>                        <span class="dt">line2 =</span> <span class="kw">c</span>(<span class="st">&quot;First Purchase&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="st">&quot;High Point&quot;</span>, </span>
<span id="cb531-30"><a href="Matched.html#cb531-30"></a>                                     <span class="st">&quot;Taster&#39;s Choice&quot;</span>, <span class="st">&quot;Sanka&quot;</span>, <span class="st">&quot;Nescafe&quot;</span>, </span>
<span id="cb531-31"><a href="Matched.html#cb531-31"></a>                                     <span class="st">&quot;Brim&quot;</span>, <span class="st">&quot;Total&quot;</span>))</span>
<span id="cb531-32"><a href="Matched.html#cb531-32"></a></span>
<span id="cb531-33"><a href="Matched.html#cb531-33"></a><span class="kw">library</span>(flextable)</span>
<span id="cb531-34"><a href="Matched.html#cb531-34"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb531-35"><a href="Matched.html#cb531-35"></a></span>
<span id="cb531-36"><a href="Matched.html#cb531-36"></a><span class="kw">library</span>(officer)</span>
<span id="cb531-37"><a href="Matched.html#cb531-37"></a>big_border =<span class="st"> </span><span class="kw">fp_border</span>(<span class="dt">color=</span><span class="st">&quot;black&quot;</span>, <span class="dt">width =</span> <span class="dv">2</span>)</span>
<span id="cb531-38"><a href="Matched.html#cb531-38"></a></span>
<span id="cb531-39"><a href="Matched.html#cb531-39"></a><span class="kw">flextable</span>(<span class="st">`</span><span class="dt">Table 8.5</span><span class="st">`</span>, <span class="dt">col_keys =</span> theHeader<span class="op">$</span>col_keys) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb531-40"><a href="Matched.html#cb531-40"></a><span class="st">  </span><span class="kw">set_header_df</span>(</span>
<span id="cb531-41"><a href="Matched.html#cb531-41"></a>    <span class="dt">mapping =</span> theHeader,</span>
<span id="cb531-42"><a href="Matched.html#cb531-42"></a>    <span class="dt">key =</span> <span class="st">&quot;col_keys&quot;</span></span>
<span id="cb531-43"><a href="Matched.html#cb531-43"></a>  ) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb531-44"><a href="Matched.html#cb531-44"></a><span class="st">  </span><span class="kw">theme_booktabs</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb531-45"><a href="Matched.html#cb531-45"></a><span class="st">  </span><span class="kw">merge_v</span>(<span class="dt">part =</span> <span class="st">&quot;header&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb531-46"><a href="Matched.html#cb531-46"></a><span class="st">  </span><span class="kw">merge_h</span>(<span class="dt">part =</span> <span class="st">&quot;header&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb531-47"><a href="Matched.html#cb531-47"></a><span class="st">  </span><span class="kw">align</span>(<span class="dt">align =</span> <span class="st">&quot;center&quot;</span>, <span class="dt">part =</span> <span class="st">&quot;all&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb531-48"><a href="Matched.html#cb531-48"></a><span class="st">  </span><span class="kw">align</span>(<span class="dt">j=</span><span class="st">&quot;First Purchase&quot;</span>, <span class="dt">align=</span> <span class="st">&quot;left&quot;</span>, <span class="dt">part =</span> <span class="st">&quot;all&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb531-49"><a href="Matched.html#cb531-49"></a><span class="st">  </span><span class="co">#autofit() %&gt;% </span></span>
<span id="cb531-50"><a href="Matched.html#cb531-50"></a><span class="st">  </span><span class="kw">empty_blanks</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb531-51"><a href="Matched.html#cb531-51"></a><span class="st">  </span><span class="kw">fix_border_issues</span>()  <span class="op">%&gt;%</span></span>
<span id="cb531-52"><a href="Matched.html#cb531-52"></a><span class="st">  </span><span class="kw">set_caption</span>(<span class="dt">caption =</span> <span class="st">&quot;Table 8.5&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb531-53"><a href="Matched.html#cb531-53"></a><span class="st">  </span><span class="kw">set_table_properties</span>(<span class="dt">width =</span> <span class="fl">.75</span>, <span class="dt">layout =</span> <span class="st">&quot;autofit&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb531-54"><a href="Matched.html#cb531-54"></a><span class="st">  </span><span class="kw">hline_top</span>(<span class="dt">part=</span><span class="st">&quot;header&quot;</span>, <span class="dt">border =</span> big_border) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb531-55"><a href="Matched.html#cb531-55"></a><span class="st">  </span><span class="kw">hline_bottom</span>(<span class="dt">part=</span><span class="st">&quot;body&quot;</span>, <span class="dt">border =</span> big_border)  </span></code></pre></div>
<template id="d1d8589f-54c3-4fef-8f74-14da53112e70"><style>
.tabwid table{
  border-collapse:collapse;
  line-height:1;
  margin-left:auto;
  margin-right:auto;
  border-width: 0;
  display: table;
  margin-top: 5px;
  margin-bottom: 5px;
  table-layout: fixed;
  border-spacing: 0;
  border-color: transparent;
}
.tabwid_left table{
  margin-left:0;
}
.tabwid_right table{
  margin-right:0;
}
.tabwid td {
    padding: 0;
}
.tabwid a {
  text-decoration: none;
}
.tabwid thead {
    background-color: transparent;
}
.tabwid tfoot {
    background-color: transparent;
}
.tabwid table tr {
background-color: transparent;
}
</style><div class="tabwid"><style>.cl-80273a4e{table-layout:auto;border-collapse:collapse;width:75%;}.cl-8022f8c6{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-8022f8da{font-family:'Arial';font-size:10pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-802303a2{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:3pt;padding-top:3pt;padding-left:3pt;padding-right:3pt;line-height: 1;background-color:transparent;}.cl-802303ac{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:3pt;padding-top:3pt;padding-left:3pt;padding-right:3pt;line-height: 1;background-color:transparent;}.cl-8023314c{width:54pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-80233160{width:54pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8023316a{width:54pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8023316b{width:54pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-80233174{width:54pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 2pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8023317e{width:54pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 2pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-80233188{width:54pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 2pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-80233189{width:54pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-80233192{width:54pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8023319c{width:54pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table class='cl-80273a4e'>
<caption class="Table Caption">
<span id="tab:unnamed-chunk-101">Table 6: </span>Table 8.5
</caption>
<thead><tr style="overflow-wrap:break-word;"><td  rowspan="2"class="cl-80233188"><p class="cl-802303a2"><span class="cl-8022f8c6">First Purchase</span></p></td><td  rowspan="2"class="cl-8023317e"><p class="cl-802303ac"><span class="cl-8022f8da"></span></p></td><td  colspan="6"class="cl-80233174"><p class="cl-802303ac"><span class="cl-8022f8c6">Second Purchase</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-80233192"><p class="cl-802303ac"><span class="cl-8022f8c6">High Point</span></p></td><td class="cl-80233192"><p class="cl-802303ac"><span class="cl-8022f8c6">Taster's Choice</span></p></td><td class="cl-80233192"><p class="cl-802303ac"><span class="cl-8022f8c6">Sanka</span></p></td><td class="cl-80233192"><p class="cl-802303ac"><span class="cl-8022f8c6">Nescafe</span></p></td><td class="cl-80233192"><p class="cl-802303ac"><span class="cl-8022f8c6">Brim</span></p></td><td class="cl-80233192"><p class="cl-802303ac"><span class="cl-8022f8c6">Total</span></p></td></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-80233160"><p class="cl-802303a2"><span class="cl-8022f8c6">High Point</span></p></td><td class="cl-8023314c"><p class="cl-802303ac"><span class="cl-8022f8da"></span></p></td><td class="cl-8023314c"><p class="cl-802303ac"><span class="cl-8022f8c6">93</span></p></td><td class="cl-8023314c"><p class="cl-802303ac"><span class="cl-8022f8c6">17</span></p></td><td class="cl-8023314c"><p class="cl-802303ac"><span class="cl-8022f8c6">44</span></p></td><td class="cl-8023314c"><p class="cl-802303ac"><span class="cl-8022f8c6">7</span></p></td><td class="cl-8023314c"><p class="cl-802303ac"><span class="cl-8022f8c6">10</span></p></td><td class="cl-8023314c"><p class="cl-802303ac"><span class="cl-8022f8c6">171</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-80233160"><p class="cl-802303a2"><span class="cl-8022f8c6">Taster's Choice</span></p></td><td class="cl-8023314c"><p class="cl-802303ac"><span class="cl-8022f8da"></span></p></td><td class="cl-8023314c"><p class="cl-802303ac"><span class="cl-8022f8c6">9</span></p></td><td class="cl-8023314c"><p class="cl-802303ac"><span class="cl-8022f8c6">46</span></p></td><td class="cl-8023314c"><p class="cl-802303ac"><span class="cl-8022f8c6">11</span></p></td><td class="cl-8023314c"><p class="cl-802303ac"><span class="cl-8022f8c6">0</span></p></td><td class="cl-8023314c"><p class="cl-802303ac"><span class="cl-8022f8c6">9</span></p></td><td class="cl-8023314c"><p class="cl-802303ac"><span class="cl-8022f8c6">75</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-80233160"><p class="cl-802303a2"><span class="cl-8022f8c6">Sanka</span></p></td><td class="cl-8023314c"><p class="cl-802303ac"><span class="cl-8022f8da"></span></p></td><td class="cl-8023314c"><p class="cl-802303ac"><span class="cl-8022f8c6">17</span></p></td><td class="cl-8023314c"><p class="cl-802303ac"><span class="cl-8022f8c6">11</span></p></td><td class="cl-8023314c"><p class="cl-802303ac"><span class="cl-8022f8c6">155</span></p></td><td class="cl-8023314c"><p class="cl-802303ac"><span class="cl-8022f8c6">9</span></p></td><td class="cl-8023314c"><p class="cl-802303ac"><span class="cl-8022f8c6">12</span></p></td><td class="cl-8023314c"><p class="cl-802303ac"><span class="cl-8022f8c6">204</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-80233160"><p class="cl-802303a2"><span class="cl-8022f8c6">Nescafe</span></p></td><td class="cl-8023314c"><p class="cl-802303ac"><span class="cl-8022f8da"></span></p></td><td class="cl-8023314c"><p class="cl-802303ac"><span class="cl-8022f8c6">6</span></p></td><td class="cl-8023314c"><p class="cl-802303ac"><span class="cl-8022f8c6">4</span></p></td><td class="cl-8023314c"><p class="cl-802303ac"><span class="cl-8022f8c6">9</span></p></td><td class="cl-8023314c"><p class="cl-802303ac"><span class="cl-8022f8c6">15</span></p></td><td class="cl-8023314c"><p class="cl-802303ac"><span class="cl-8022f8c6">2</span></p></td><td class="cl-8023314c"><p class="cl-802303ac"><span class="cl-8022f8c6">36</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-80233160"><p class="cl-802303a2"><span class="cl-8022f8c6">Brim</span></p></td><td class="cl-8023314c"><p class="cl-802303ac"><span class="cl-8022f8da"></span></p></td><td class="cl-8023314c"><p class="cl-802303ac"><span class="cl-8022f8c6">10</span></p></td><td class="cl-8023314c"><p class="cl-802303ac"><span class="cl-8022f8c6">4</span></p></td><td class="cl-8023314c"><p class="cl-802303ac"><span class="cl-8022f8c6">12</span></p></td><td class="cl-8023314c"><p class="cl-802303ac"><span class="cl-8022f8c6">2</span></p></td><td class="cl-8023314c"><p class="cl-802303ac"><span class="cl-8022f8c6">27</span></p></td><td class="cl-8023314c"><p class="cl-802303ac"><span class="cl-8022f8c6">55</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8023316b"><p class="cl-802303a2"><span class="cl-8022f8c6">Total</span></p></td><td class="cl-8023316a"><p class="cl-802303ac"><span class="cl-8022f8da"></span></p></td><td class="cl-8023316a"><p class="cl-802303ac"><span class="cl-8022f8c6">135</span></p></td><td class="cl-8023316a"><p class="cl-802303ac"><span class="cl-8022f8c6">82</span></p></td><td class="cl-8023316a"><p class="cl-802303ac"><span class="cl-8022f8c6">231</span></p></td><td class="cl-8023316a"><p class="cl-802303ac"><span class="cl-8022f8c6">33</span></p></td><td class="cl-8023316a"><p class="cl-802303ac"><span class="cl-8022f8c6">60</span></p></td><td class="cl-8023316a"><p class="cl-802303ac"><span class="cl-8022f8c6">541</span></p></td></tr></tbody></table></div></template>
<div id="92e8f60f-4112-4e1a-ab7a-d90d7217b3f8"></div>
<script>
var dest = document.getElementById("92e8f60f-4112-4e1a-ab7a-d90d7217b3f8");
var template = document.getElementById("d1d8589f-54c3-4fef-8f74-14da53112e70");
var caption = template.content.querySelector("caption");
if(caption) {
  caption.style.cssText = "display:block;"
  var newcapt = document.createElement("p");
  newcapt.appendChild(caption)
  dest.parentNode.insertBefore(newcapt, dest.previousSibling);
}
var fantome = dest.attachShadow({mode: 'open'});
var templateContent = template.content;
fantome.appendChild(templateContent);
fantome.appendChild(templateContent);
</script>

<p>Using GEE methodology, we can fit the baseline-category logit model, as shown in the following <code>R</code> output.</p>
<div class="sourceCode" id="cb532"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb532-1"><a href="Matched.html#cb532-1"></a>Coffee &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;http://users.stat.ufl.edu/~aa/cat/data/Coffee.dat&quot;</span>,</span>
<span id="cb532-2"><a href="Matched.html#cb532-2"></a>                        <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">stringsAsFactors =</span> <span class="ot">TRUE</span>)</span>
<span id="cb532-3"><a href="Matched.html#cb532-3"></a></span>
<span id="cb532-4"><a href="Matched.html#cb532-4"></a><span class="co"># subject-specific data file, purchase is 1 for first purchase 0 for second</span></span>
<span id="cb532-5"><a href="Matched.html#cb532-5"></a>Coffee <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb532-6"><a href="Matched.html#cb532-6"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">row_number</span>() <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="kw">n</span>()<span class="op">-</span><span class="dv">1</span>, <span class="kw">n</span>()))  </span></code></pre></div>
<pre class="custom-output"><code>  person purchase y
1      1        1 1
2      1        0 1
3      2        1 1
4      2        0 1
5    541        1 5
6    541        0 5</code></pre>
<div class="sourceCode" id="cb534"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb534-1"><a href="Matched.html#cb534-1"></a><span class="kw">library</span>(multgee)  <span class="co"># package for multinomial GEE analysis</span></span>
<span id="cb534-2"><a href="Matched.html#cb534-2"></a>fit &lt;-<span class="st"> </span><span class="kw">nomLORgee</span>(y <span class="op">~</span><span class="st"> </span>purchase, <span class="dt">id =</span> person, <span class="dt">LORstr =</span> <span class="st">&quot;independence&quot;</span>, </span>
<span id="cb534-3"><a href="Matched.html#cb534-3"></a>                 <span class="dt">data =</span> Coffee)</span>
<span id="cb534-4"><a href="Matched.html#cb534-4"></a><span class="co"># san.se = robust SE</span></span>
<span id="cb534-5"><a href="Matched.html#cb534-5"></a><span class="co"># beta01 is alpha1 in our notation</span></span>
<span id="cb534-6"><a href="Matched.html#cb534-6"></a><span class="kw">summary</span>(fit)  <span class="co"># nomLORgee uses baseline category logits for nominal response </span></span></code></pre></div>
<pre class="custom-output"><code>GEE FOR NOMINAL MULTINOMIAL RESPONSES 
version 1.6.0 modified 2017-07-10 

Link : Baseline Category Logit 

Local Odds Ratios:
Structure:         independence
Homogenous scores: TRUE

call:
nomLORgee(formula = y ~ purchase, data = Coffee, id = person, 
    LORstr = &quot;independence&quot;)

Summary of residuals:
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
-0.4270 -0.2495 -0.1386  0.0000 -0.0610  0.9390 

Number of Iterations: 1 

Coefficients:
           Estimate   san.se   san.z Pr(&gt;|san.z|)    
beta10      0.81093  0.15516  5.2265      &lt; 2e-16 ***
purchase:1  0.32340  0.16830  1.9215      0.05466 .  
beta20      0.31237  0.16989  1.8387      0.06596 .  
purchase:2 -0.00222  0.18662 -0.0119      0.99051    
beta30      1.34807  0.14490  9.3036      &lt; 2e-16 ***
purchase:3 -0.03729  0.15807 -0.2359      0.81353    
beta40     -0.59784  0.21672 -2.7585      0.00581 ** 
purchase:4  0.17402  0.23531  0.7396      0.45957    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Local Odds Ratios Estimates:
     [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8]
[1,]    0    0    0    0    1    1    1    1
[2,]    0    0    0    0    1    1    1    1
[3,]    0    0    0    0    1    1    1    1
[4,]    0    0    0    0    1    1    1    1
[5,]    1    1    1    1    0    0    0    0
[6,]    1    1    1    1    0    0    0    0
[7,]    1    1    1    1    0    0    0    0
[8,]    1    1    1    1    0    0    0    0

pvalue of Null model: &lt;0.0001 </code></pre>
<div class="sourceCode" id="cb536"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb536-1"><a href="Matched.html#cb536-1"></a>fit0 &lt;-<span class="st"> </span><span class="kw">nomLORgee</span>(y <span class="op">~</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">id =</span> person, <span class="dt">LORstr =</span> <span class="st">&quot;independence&quot;</span>, <span class="dt">data =</span> Coffee)</span>
<span id="cb536-2"><a href="Matched.html#cb536-2"></a></span>
<span id="cb536-3"><a href="Matched.html#cb536-3"></a><span class="co"># Model under H_0: y ~ 1 null model (marginal homogeneity)</span></span>
<span id="cb536-4"><a href="Matched.html#cb536-4"></a><span class="kw">waldts</span>(fit0, fit)</span></code></pre></div>
<pre class="custom-output"><code>Goodness of Fit based on the Wald test 

Model under H_0: y ~ 1
Model under H_1: y ~ purchase

Wald Statistic=12.4869, df=4, p-value=0.0141</code></pre>
<div class="sourceCode" id="cb538"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb538-1"><a href="Matched.html#cb538-1"></a><span class="kw">with</span>(Coffee, <span class="kw">mantelhaen.test</span>(purchase, y, person))</span></code></pre></div>
<pre class="custom-output"><code>
    Cochran-Mantel-Haenszel test

data:  purchase and y and person
Cochran-Mantel-Haenszel M^2 = 12.291, df = 4, p-value = 0.01531</code></pre>
</div>
<div id="using-cochran-mantel-haenszel-test-to-test-marinal-homogeneity" class="section level3">
<h3>8.3.3 Using Cochran-Mantel-Haenszel Test to Test marinal Homogeneity*</h3>
</div>
<div id="x8.3.4" class="section level3">
<h3>8.3.4 Symmetry and Quasi-Symmetry Models for Square Contingency Tables</h3>
<p><span class="math display">\[\pi_{ij} = \pi_{ji}\]</span>
<span class="math display">\[\mathrm{log}(\pi_{ij}/\pi_{ji}) = 0\ \mathrm{for\ all}\ i \ \mathrm{and}\ j.\]</span></p>
<p><span class="math display">\[r_{ij} = (n_{ij} - n_{ji})/\sqrt{n_{ij} + n_{ji}}.\]</span></p>
<p><span class="math display" id="eq:eq84">\[\begin{equation} 
  \mathrm{log}(\pi_{ij}/\pi_{ji}) = \beta_i - \beta_j\  \mathrm{for\ all}\ i \ \mathrm{and}\ j.
  \tag{23}
\end{equation}\]</span></p>
</div>
<div id="example-coffee-brand-market-share-revisited" class="section level3">
<h3>8.3.5 Example: Coffee Brand market Share Revisited</h3>
<div class="sourceCode" id="cb540"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb540-1"><a href="Matched.html#cb540-1"></a>Coffee2 &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;http://users.stat.ufl.edu/~aa/cat/data/Coffee2.dat&quot;</span>,</span>
<span id="cb540-2"><a href="Matched.html#cb540-2"></a>                        <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">stringsAsFactors =</span> <span class="ot">TRUE</span>)</span>
<span id="cb540-3"><a href="Matched.html#cb540-3"></a><span class="co"># quasi-symmetry model, nij and nji are opposite cell counts in table 8.5</span></span>
<span id="cb540-4"><a href="Matched.html#cb540-4"></a>Coffee2</span></code></pre></div>
<pre class="custom-output"><code>   H  T  S  N  B nij nji
1  1 -1  0  0  0  17   9
2  1  0 -1  0  0  44  17
3  1  0  0 -1  0   7   6
4  1  0  0  0 -1  10  10
5  0  1 -1  0  0  11  11
6  0  1  0 -1  0   0   4
7  0  1  0  0 -1   9   4
8  0  0  1 -1  0   9   9
9  0  0  1  0 -1  12  12
10 0  0  0  1 -1   2   2</code></pre>
<div class="sourceCode" id="cb542"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb542-1"><a href="Matched.html#cb542-1"></a>symm &lt;-<span class="st"> </span><span class="kw">glm</span>(nij<span class="op">/</span>(nij<span class="op">+</span>nji) <span class="op">~</span><span class="st"> </span><span class="dv">-1</span>, <span class="dt">family =</span> binomial, <span class="dt">weights =</span> nij <span class="op">+</span><span class="st"> </span>nji, </span>
<span id="cb542-2"><a href="Matched.html#cb542-2"></a>            <span class="dt">data =</span> Coffee2)</span>
<span id="cb542-3"><a href="Matched.html#cb542-3"></a><span class="kw">summary</span>(symm)  <span class="co"># symmetry model, -1 in model statement sets intercept = 0</span></span></code></pre></div>
<pre class="custom-output"><code>
Call:
glm(formula = nij/(nij + nji) ~ -1, family = binomial, data = Coffee2, 
    weights = nij + nji)

Deviance Residuals: 
   Min      1Q  Median      3Q     Max  
-2.355   0.000   0.000   1.123   3.518  

No Coefficients

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 22.473  on 10  degrees of freedom
Residual deviance: 22.473  on 10  degrees of freedom
AIC: 52.433

Number of Fisher Scoring iterations: 0</code></pre>
<div class="sourceCode" id="cb544"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb544-1"><a href="Matched.html#cb544-1"></a>QS &lt;-<span class="st"> </span><span class="kw">glm</span>(nij<span class="op">/</span>(nij<span class="op">+</span>nji) <span class="op">~</span><span class="st"> </span><span class="dv">-1</span> <span class="op">+</span><span class="st"> </span>H <span class="op">+</span><span class="st"> </span>T <span class="op">+</span><span class="st"> </span>S <span class="op">+</span><span class="st"> </span>N <span class="op">+</span><span class="st"> </span>B , <span class="dt">family =</span> binomial, </span>
<span id="cb544-2"><a href="Matched.html#cb544-2"></a>          <span class="dt">weights =</span> nij <span class="op">+</span><span class="st"> </span>nji, <span class="dt">data =</span> Coffee2)</span>
<span id="cb544-3"><a href="Matched.html#cb544-3"></a><span class="kw">summary</span>(QS)</span></code></pre></div>
<pre class="custom-output"><code>
Call:
glm(formula = nij/(nij + nji) ~ -1 + H + T + S + N + B, family = binomial, 
    data = Coffee2, weights = nij + nji)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.1010  -0.2902  -0.0804   0.7165   1.4120  

Coefficients: (1 not defined because of singularities)
   Estimate Std. Error z value Pr(&gt;|z|)  
H  0.595440   0.293658   2.028   0.0426 *
T -0.004004   0.329359  -0.012   0.9903  
S -0.113299   0.285082  -0.397   0.6911  
N  0.302115   0.401589   0.752   0.4519  
B        NA         NA      NA       NA  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 22.473  on 10  degrees of freedom
Residual deviance:  9.974  on  6  degrees of freedom
AIC: 47.934

Number of Fisher Scoring iterations: 4</code></pre>
</div>
</div>
<div id="comparing-proportions-for-ordinal-matched-pairs-responses" class="section level2">
<h2>8.4 Comparing Proportions for Ordinal Matched-Pairs Responses</h2>
<div id="marginal-homogeneity-and-cummulative-logit-marginal-model" class="section level3">
<h3>8.4.1 Marginal Homogeneity and Cummulative Logit Marginal Model</h3>
<p><span class="math display">\[\mathrm{logit}[P(Y_1 \le j)] = \alpha_j + \beta,\ \mathrm{logit}[P(Y_2 \le j)] = \alpha_j\]</span></p>
</div>
<div id="x8.4.2" class="section level3">
<h3>8.4.2 Example: Recycle or Drive Less to Help the Environment?</h3>
<div class="sourceCode" id="cb546"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb546-1"><a href="Matched.html#cb546-1"></a>Envir &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;http://users.stat.ufl.edu/~aa/cat/data/Envir.dat&quot;</span>,</span>
<span id="cb546-2"><a href="Matched.html#cb546-2"></a>                        <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">stringsAsFactors =</span> <span class="ot">TRUE</span>)</span>
<span id="cb546-3"><a href="Matched.html#cb546-3"></a></span>
<span id="cb546-4"><a href="Matched.html#cb546-4"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb546-5"><a href="Matched.html#cb546-5"></a><span class="kw">library</span>(tidyr)</span>
<span id="cb546-6"><a href="Matched.html#cb546-6"></a>envir_wide &lt;-<span class="st"> </span>Envir <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb546-7"><a href="Matched.html#cb546-7"></a><span class="st">  </span>tidyr<span class="op">::</span><span class="kw">pivot_wider</span>(<span class="dt">id_cols =</span> person, <span class="dt">names_from=</span>question, <span class="dt">names_prefix =</span> <span class="st">&quot;y&quot;</span>, </span>
<span id="cb546-8"><a href="Matched.html#cb546-8"></a>                     <span class="dt">values_from =</span> y)</span>
<span id="cb546-9"><a href="Matched.html#cb546-9"></a>  </span>
<span id="cb546-10"><a href="Matched.html#cb546-10"></a></span>
<span id="cb546-11"><a href="Matched.html#cb546-11"></a></span>
<span id="cb546-12"><a href="Matched.html#cb546-12"></a><span class="co"># Make contingency table</span></span>
<span id="cb546-13"><a href="Matched.html#cb546-13"></a>tab &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">xtabs</span>(<span class="op">~</span>y1 <span class="op">+</span><span class="st"> </span>y0, <span class="dt">data =</span> envir_wide))</span>
<span id="cb546-14"><a href="Matched.html#cb546-14"></a></span>
<span id="cb546-15"><a href="Matched.html#cb546-15"></a><span class="kw">library</span>(tibble)</span>
<span id="cb546-16"><a href="Matched.html#cb546-16"></a><span class="co"># Add label as the first column and variable names</span></span>
<span id="cb546-17"><a href="Matched.html#cb546-17"></a><span class="st">`</span><span class="dt">Table 8.6</span><span class="st">`</span> &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="st">`</span><span class="dt">Recycle</span><span class="st">`</span> =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Always&quot;</span>, <span class="st">&quot;Often&quot;</span>, <span class="st">&quot;Sometimes&quot;</span>, <span class="st">&quot;Never&quot;</span>), </span>
<span id="cb546-18"><a href="Matched.html#cb546-18"></a>                      <span class="st">`</span><span class="dt">Always</span><span class="st">`</span> =<span class="st"> </span>tab[, <span class="dv">1</span>], <span class="st">`</span><span class="dt">Often</span><span class="st">`</span> =<span class="st"> </span>tab[,<span class="dv">2</span>], </span>
<span id="cb546-19"><a href="Matched.html#cb546-19"></a>                      <span class="st">`</span><span class="dt">Sometimes</span><span class="st">`</span> =<span class="st"> </span>tab[, <span class="dv">3</span>], <span class="st">`</span><span class="dt">Never</span><span class="st">`</span> =<span class="st"> </span>tab[,<span class="dv">4</span>])</span>
<span id="cb546-20"><a href="Matched.html#cb546-20"></a></span>
<span id="cb546-21"><a href="Matched.html#cb546-21"></a></span>
<span id="cb546-22"><a href="Matched.html#cb546-22"></a>theHeader &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">col_keys =</span> <span class="kw">c</span>(<span class="st">&quot;Recycle&quot;</span>, <span class="st">&quot;Blank&quot;</span>, <span class="st">&quot;Always&quot;</span>, <span class="st">&quot;Often&quot;</span>,</span>
<span id="cb546-23"><a href="Matched.html#cb546-23"></a>                                           <span class="st">&quot;Sometimes&quot;</span>, <span class="st">&quot;Never&quot;</span>),</span>
<span id="cb546-24"><a href="Matched.html#cb546-24"></a>                        <span class="dt">line1 =</span> <span class="kw">c</span>(<span class="st">&quot;Recycle&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="kw">rep</span>(<span class="st">&quot;Drive Less&quot;</span>, <span class="dv">4</span>)),</span>
<span id="cb546-25"><a href="Matched.html#cb546-25"></a>                        <span class="dt">line2 =</span> <span class="kw">c</span>(<span class="st">&quot;Recycle&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="st">&quot;Always&quot;</span>, <span class="st">&quot;Often&quot;</span>, </span>
<span id="cb546-26"><a href="Matched.html#cb546-26"></a>                                  <span class="st">&quot;Sometimes&quot;</span>, <span class="st">&quot;Never&quot;</span>))</span>
<span id="cb546-27"><a href="Matched.html#cb546-27"></a></span>
<span id="cb546-28"><a href="Matched.html#cb546-28"></a><span class="kw">library</span>(flextable)</span>
<span id="cb546-29"><a href="Matched.html#cb546-29"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb546-30"><a href="Matched.html#cb546-30"></a></span>
<span id="cb546-31"><a href="Matched.html#cb546-31"></a><span class="kw">library</span>(officer)</span>
<span id="cb546-32"><a href="Matched.html#cb546-32"></a>big_border =<span class="st"> </span><span class="kw">fp_border</span>(<span class="dt">color=</span><span class="st">&quot;black&quot;</span>, <span class="dt">width =</span> <span class="dv">2</span>)</span>
<span id="cb546-33"><a href="Matched.html#cb546-33"></a></span>
<span id="cb546-34"><a href="Matched.html#cb546-34"></a><span class="kw">flextable</span>(<span class="st">`</span><span class="dt">Table 8.6</span><span class="st">`</span>, <span class="dt">col_keys =</span> theHeader<span class="op">$</span>col_keys) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb546-35"><a href="Matched.html#cb546-35"></a><span class="st">  </span><span class="kw">set_header_df</span>(</span>
<span id="cb546-36"><a href="Matched.html#cb546-36"></a>    <span class="dt">mapping =</span> theHeader,</span>
<span id="cb546-37"><a href="Matched.html#cb546-37"></a>    <span class="dt">key =</span> <span class="st">&quot;col_keys&quot;</span></span>
<span id="cb546-38"><a href="Matched.html#cb546-38"></a>  ) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb546-39"><a href="Matched.html#cb546-39"></a><span class="st">  </span><span class="kw">theme_booktabs</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb546-40"><a href="Matched.html#cb546-40"></a><span class="st">  </span><span class="kw">merge_v</span>(<span class="dt">part =</span> <span class="st">&quot;header&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb546-41"><a href="Matched.html#cb546-41"></a><span class="st">  </span><span class="kw">merge_h</span>(<span class="dt">part =</span> <span class="st">&quot;header&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb546-42"><a href="Matched.html#cb546-42"></a><span class="st">  </span><span class="kw">align</span>(<span class="dt">align =</span> <span class="st">&quot;center&quot;</span>, <span class="dt">part =</span> <span class="st">&quot;all&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb546-43"><a href="Matched.html#cb546-43"></a><span class="st">  </span><span class="kw">align</span>(<span class="dt">j=</span><span class="st">&quot;Recycle&quot;</span>, <span class="dt">align=</span> <span class="st">&quot;left&quot;</span>, <span class="dt">part =</span> <span class="st">&quot;all&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb546-44"><a href="Matched.html#cb546-44"></a><span class="st">  </span><span class="kw">autofit</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb546-45"><a href="Matched.html#cb546-45"></a><span class="st">  </span><span class="kw">empty_blanks</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb546-46"><a href="Matched.html#cb546-46"></a><span class="st">  </span><span class="kw">fix_border_issues</span>()  <span class="op">%&gt;%</span></span>
<span id="cb546-47"><a href="Matched.html#cb546-47"></a><span class="st">  </span><span class="kw">set_caption</span>(<span class="dt">caption =</span> <span class="st">&quot;Table 8.6&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb546-48"><a href="Matched.html#cb546-48"></a><span class="st">  </span><span class="co">#set_table_properties(width = .75, layout = &quot;autofit&quot;) %&gt;% </span></span>
<span id="cb546-49"><a href="Matched.html#cb546-49"></a><span class="st">  </span><span class="kw">hline_top</span>(<span class="dt">part=</span><span class="st">&quot;header&quot;</span>, <span class="dt">border =</span> big_border) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb546-50"><a href="Matched.html#cb546-50"></a><span class="st">  </span><span class="kw">hline_bottom</span>(<span class="dt">part=</span><span class="st">&quot;body&quot;</span>, <span class="dt">border =</span> big_border)  </span></code></pre></div>
<template id="9b86f96d-e960-47c0-a7d5-6437f022155f"><style>
.tabwid table{
  border-collapse:collapse;
  line-height:1;
  margin-left:auto;
  margin-right:auto;
  border-width: 0;
  display: table;
  margin-top: 5px;
  margin-bottom: 5px;
  table-layout: fixed;
  border-spacing: 0;
  border-color: transparent;
}
.tabwid_left table{
  margin-left:0;
}
.tabwid_right table{
  margin-right:0;
}
.tabwid td {
    padding: 0;
}
.tabwid a {
  text-decoration: none;
}
.tabwid thead {
    background-color: transparent;
}
.tabwid tfoot {
    background-color: transparent;
}
.tabwid table tr {
background-color: transparent;
}
</style><div class="tabwid"><style>.cl-8163d426{border-collapse:collapse;}.cl-815f0efa{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-815f0f0e{font-family:'Arial';font-size:10pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-815f1a26{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:3pt;padding-top:3pt;padding-left:3pt;padding-right:3pt;line-height: 1;background-color:transparent;}.cl-815f1a30{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:3pt;padding-top:3pt;padding-left:3pt;padding-right:3pt;line-height: 1;background-color:transparent;}.cl-815f410e{width:45pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-815f4118{width:70pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-815f4122{width:67pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-815f412c{width:42pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-815f4136{width:15pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-815f4140{width:70pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-815f4141{width:45pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-815f414a{width:70pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-815f4154{width:70pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-815f4155{width:15pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-815f415e{width:67pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-815f415f{width:42pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-815f4168{width:42pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-815f4172{width:67pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-815f417c{width:70pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-815f4186{width:15pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-815f4187{width:45pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-815f4190{width:70pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-815f419a{width:67pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 2pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-815f419b{width:42pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 2pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-815f41a4{width:15pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 2pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-815f41ae{width:70pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 2pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-815f41b8{width:70pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 2pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-815f41b9{width:45pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 2pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-815f41c2{width:45pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-815f41cc{width:42pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-815f41cd{width:70pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-815f41d6{width:67pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-815f41e0{width:70pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table class='cl-8163d426'>
<caption class="Table Caption">
<span id="tab:unnamed-chunk-104">Table 7: </span>Table 8.6
</caption>
<thead><tr style="overflow-wrap:break-word;"><td  rowspan="2"class="cl-815f41ae"><p class="cl-815f1a26"><span class="cl-815f0efa">Recycle</span></p></td><td  rowspan="2"class="cl-815f41a4"><p class="cl-815f1a30"><span class="cl-815f0f0e"></span></p></td><td  colspan="4"class="cl-815f419a"><p class="cl-815f1a30"><span class="cl-815f0efa">Drive Less</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-815f41d6"><p class="cl-815f1a30"><span class="cl-815f0efa">Always</span></p></td><td class="cl-815f41cc"><p class="cl-815f1a30"><span class="cl-815f0efa">Often</span></p></td><td class="cl-815f41cd"><p class="cl-815f1a30"><span class="cl-815f0efa">Sometimes</span></p></td><td class="cl-815f41c2"><p class="cl-815f1a30"><span class="cl-815f0efa">Never</span></p></td></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-815f4118"><p class="cl-815f1a26"><span class="cl-815f0efa">Always</span></p></td><td class="cl-815f4136"><p class="cl-815f1a30"><span class="cl-815f0f0e"></span></p></td><td class="cl-815f4122"><p class="cl-815f1a30"><span class="cl-815f0efa">12</span></p></td><td class="cl-815f412c"><p class="cl-815f1a30"><span class="cl-815f0efa">43</span></p></td><td class="cl-815f4140"><p class="cl-815f1a30"><span class="cl-815f0efa">163</span></p></td><td class="cl-815f410e"><p class="cl-815f1a30"><span class="cl-815f0efa">233</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-815f4154"><p class="cl-815f1a26"><span class="cl-815f0efa">Often</span></p></td><td class="cl-815f4155"><p class="cl-815f1a30"><span class="cl-815f0f0e"></span></p></td><td class="cl-815f415e"><p class="cl-815f1a30"><span class="cl-815f0efa">4</span></p></td><td class="cl-815f415f"><p class="cl-815f1a30"><span class="cl-815f0efa">21</span></p></td><td class="cl-815f414a"><p class="cl-815f1a30"><span class="cl-815f0efa">99</span></p></td><td class="cl-815f4141"><p class="cl-815f1a30"><span class="cl-815f0efa">185</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-815f4154"><p class="cl-815f1a26"><span class="cl-815f0efa">Sometimes</span></p></td><td class="cl-815f4155"><p class="cl-815f1a30"><span class="cl-815f0f0e"></span></p></td><td class="cl-815f415e"><p class="cl-815f1a30"><span class="cl-815f0efa">4</span></p></td><td class="cl-815f415f"><p class="cl-815f1a30"><span class="cl-815f0efa">8</span></p></td><td class="cl-815f414a"><p class="cl-815f1a30"><span class="cl-815f0efa">77</span></p></td><td class="cl-815f4141"><p class="cl-815f1a30"><span class="cl-815f0efa">230</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-815f417c"><p class="cl-815f1a26"><span class="cl-815f0efa">Never</span></p></td><td class="cl-815f4186"><p class="cl-815f1a30"><span class="cl-815f0f0e"></span></p></td><td class="cl-815f4172"><p class="cl-815f1a30"><span class="cl-815f0efa">0</span></p></td><td class="cl-815f4168"><p class="cl-815f1a30"><span class="cl-815f0efa">1</span></p></td><td class="cl-815f4190"><p class="cl-815f1a30"><span class="cl-815f0efa">18</span></p></td><td class="cl-815f4187"><p class="cl-815f1a30"><span class="cl-815f0efa">132</span></p></td></tr></tbody></table></div></template>
<div id="642d2785-6f3f-40f2-b33b-20946773576f"></div>
<script>
var dest = document.getElementById("642d2785-6f3f-40f2-b33b-20946773576f");
var template = document.getElementById("9b86f96d-e960-47c0-a7d5-6437f022155f");
var caption = template.content.querySelector("caption");
if(caption) {
  caption.style.cssText = "display:block;"
  var newcapt = document.createElement("p");
  newcapt.appendChild(caption)
  dest.parentNode.insertBefore(newcapt, dest.previousSibling);
}
var fantome = dest.attachShadow({mode: 'open'});
var templateContent = template.content;
fantome.appendChild(templateContent);
fantome.appendChild(templateContent);
</script>

<div class="sourceCode" id="cb547"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb547-1"><a href="Matched.html#cb547-1"></a>Envir &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;http://users.stat.ufl.edu/~aa/cat/data/Envir.dat&quot;</span>,</span>
<span id="cb547-2"><a href="Matched.html#cb547-2"></a>                        <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">stringsAsFactors =</span> <span class="ot">TRUE</span>)</span>
<span id="cb547-3"><a href="Matched.html#cb547-3"></a></span>
<span id="cb547-4"><a href="Matched.html#cb547-4"></a>Envir <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb547-5"><a href="Matched.html#cb547-5"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">row_number</span>() <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="kw">n</span>()<span class="op">-</span><span class="dv">1</span>, <span class="kw">n</span>()))  </span></code></pre></div>
<pre class="custom-output"><code>  person question y
1      1        1 1
2      1        0 1
3   1230        1 4
4   1230        0 4</code></pre>
<div class="sourceCode" id="cb549"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb549-1"><a href="Matched.html#cb549-1"></a><span class="kw">library</span>(multgee)</span>
<span id="cb549-2"><a href="Matched.html#cb549-2"></a>fit &lt;-<span class="st"> </span><span class="kw">ordLORgee</span>(y <span class="op">~</span><span class="st"> </span>question, <span class="dt">id =</span> person, <span class="dt">LORstr =</span> <span class="st">&quot;independence&quot;</span>, </span>
<span id="cb549-3"><a href="Matched.html#cb549-3"></a>                 <span class="dt">data =</span> Envir)</span>
<span id="cb549-4"><a href="Matched.html#cb549-4"></a><span class="kw">summary</span>(fit)</span></code></pre></div>
<pre class="custom-output"><code>GEE FOR ORDINAL MULTINOMIAL RESPONSES 
version 1.6.0 modified 2017-07-10 

Link : Cumulative logit 

Local Odds Ratios:
Structure:         independence

call:
ordLORgee(formula = y ~ question, data = Envir, id = person, 
    LORstr = &quot;independence&quot;)

Summary of residuals:
     Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
-0.354916 -0.264742 -0.059210 -0.002021 -0.033859  0.966141 

Number of Iterations: 1 

Coefficients:
         Estimate   san.se    san.z Pr(&gt;|san.z|)    
beta10   -3.35111  0.08289 -40.4287    &lt; 2.2e-16 ***
beta20   -2.27673  0.07430 -30.6424    &lt; 2.2e-16 ***
beta30   -0.58488  0.05882  -9.9443    &lt; 2.2e-16 ***
question  2.75361  0.08147  33.7985    &lt; 2.2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Local Odds Ratios Estimates:
     [,1] [,2] [,3] [,4] [,5] [,6]
[1,]    0    0    0    1    1    1
[2,]    0    0    0    1    1    1
[3,]    0    0    0    1    1    1
[4,]    1    1    1    0    0    0
[5,]    1    1    1    0    0    0
[6,]    1    1    1    0    0    0

pvalue of Null model: &lt;0.0001 </code></pre>
</div>
<div id="an-ordinal-quasi-symmetry-model" class="section level3">
<h3>8.4.3 An Ordinal Quasi-Symmetry Model *</h3>
<p><span class="math display" id="eq:eq85">\[\begin{equation} 
  \mathrm{log}(\pi_{ij}/\pi_{ji}) = \beta(u_j = u_i).
  \tag{24}
\end{equation}\]</span></p>
</div>
<div id="example-recycle-or-drive-less-revisited" class="section level3">
<h3>8.4.4 Example: Recycle or Drive Less Revisited?</h3>
<div class="sourceCode" id="cb551"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb551-1"><a href="Matched.html#cb551-1"></a>Envir &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;http://users.stat.ufl.edu/~aa/cat/data/Environment.dat&quot;</span>,</span>
<span id="cb551-2"><a href="Matched.html#cb551-2"></a>                        <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">stringsAsFactors =</span> <span class="ot">TRUE</span>)</span>
<span id="cb551-3"><a href="Matched.html#cb551-3"></a></span>
<span id="cb551-4"><a href="Matched.html#cb551-4"></a><span class="co"># nij and nji are opposite cell counts in Table 8.6</span></span>
<span id="cb551-5"><a href="Matched.html#cb551-5"></a><span class="co"># x = j-1 = distance between categories, 6 pairs of opposite cells</span></span>
<span id="cb551-6"><a href="Matched.html#cb551-6"></a>Envir  </span></code></pre></div>
<pre class="custom-output"><code>  always often sometimes never x nij nji
1      1    -1         0     0 1  43   4
2      1     0        -1     0 2 163   4
3      1     0         0    -1 3 233   0
4      0     1        -1     0 1  99   8
5      0     1         0    -1 2 185   1
6      0     0         1    -1 1 230  18</code></pre>
<div class="sourceCode" id="cb553"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb553-1"><a href="Matched.html#cb553-1"></a>fit &lt;-<span class="st"> </span><span class="kw">glm</span>(nij<span class="op">/</span>(nij<span class="op">+</span>nji) <span class="op">~</span><span class="st"> </span><span class="dv">-1</span> <span class="op">+</span><span class="st"> </span>x, <span class="dt">family =</span> binomial, <span class="dt">weight =</span> nij <span class="op">+</span><span class="st"> </span>nji, </span>
<span id="cb553-2"><a href="Matched.html#cb553-2"></a>           <span class="dt">data =</span> Envir)</span>
<span id="cb553-3"><a href="Matched.html#cb553-3"></a><span class="kw">summary</span>(fit)  <span class="co"># ordinal quasi symmetry; -1 in model sets intercept = 0</span></span></code></pre></div>
<pre class="custom-output"><code>
Call:
glm(formula = nij/(nij + nji) ~ -1 + x, family = binomial, data = Envir, 
    weights = nij + nji)

Deviance Residuals: 
       1         2         3         4         5         6  
-0.03567  -1.82023   0.59541   0.33794   0.46512   0.64368  

Coefficients:
  Estimate Std. Error z value Pr(&gt;|z|)    
x   2.3936     0.1508   15.88   &lt;2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1106.1240  on 6  degrees of freedom
Residual deviance:    4.4139  on 5  degrees of freedom
AIC: 23.35

Number of Fisher Scoring iterations: 4</code></pre>
<div class="sourceCode" id="cb555"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb555-1"><a href="Matched.html#cb555-1"></a>fit.QS &lt;-<span class="st"> </span><span class="kw">glm</span>(nij<span class="op">/</span>(nij<span class="op">+</span>nji) <span class="op">~</span><span class="st"> </span><span class="dv">-1</span> <span class="op">+</span><span class="st"> </span>always <span class="op">+</span><span class="st"> </span>often <span class="op">+</span><span class="st"> </span>sometimes <span class="op">+</span><span class="st"> </span>never, </span>
<span id="cb555-2"><a href="Matched.html#cb555-2"></a>              <span class="dt">family =</span> binomial, <span class="dt">weight =</span> nij <span class="op">+</span><span class="st"> </span>nji, <span class="dt">data =</span> Envir)</span>
<span id="cb555-3"><a href="Matched.html#cb555-3"></a><span class="kw">summary</span>(fit.QS)  <span class="co"># quasi symmetry</span></span></code></pre></div>
<pre class="custom-output"><code>
Call:
glm(formula = nij/(nij + nji) ~ -1 + always + often + sometimes + 
    never, family = binomial, data = Envir, weights = nij + nji)

Deviance Residuals: 
      1        2        3        4        5        6  
 0.7689  -1.1439   0.6760   0.4572   0.3006  -0.1381  

Coefficients: (1 not defined because of singularities)
          Estimate Std. Error z value Pr(&gt;|z|)    
always      6.9269     0.4708   14.71   &lt;2e-16 ***
often       4.9332     0.3617   13.64   &lt;2e-16 ***
sometimes   2.5817     0.2386   10.82   &lt;2e-16 ***
never           NA         NA      NA       NA    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1106.1240  on 6  degrees of freedom
Residual deviance:    2.6751  on 3  degrees of freedom
AIC: 25.611

Number of Fisher Scoring iterations: 4</code></pre>
</div>
</div>
<div id="analyzing-rater-agreement" class="section level2">
<h2>8.5 Analyzing Rater Agreement *</h2>
<div id="example-agreement-on-carcinoma-diagnosis" class="section level3">
<h3>8.5.1 Example: Agreement on Carcinoma Diagnosis</h3>
<div class="sourceCode" id="cb557"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb557-1"><a href="Matched.html#cb557-1"></a>Pathology &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;http://users.stat.ufl.edu/~aa/cat/data/Pathologists.dat&quot;</span>,</span>
<span id="cb557-2"><a href="Matched.html#cb557-2"></a>                        <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">stringsAsFactors =</span> <span class="ot">TRUE</span>)</span>
<span id="cb557-3"><a href="Matched.html#cb557-3"></a></span>
<span id="cb557-4"><a href="Matched.html#cb557-4"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb557-5"><a href="Matched.html#cb557-5"></a><span class="kw">library</span>(tibble)</span>
<span id="cb557-6"><a href="Matched.html#cb557-6"></a></span>
<span id="cb557-7"><a href="Matched.html#cb557-7"></a><span class="co"># Make contingency table</span></span>
<span id="cb557-8"><a href="Matched.html#cb557-8"></a>mat &lt;-<span class="st"> </span><span class="kw">matrix</span>(Pathology<span class="op">$</span>count, <span class="dt">ncol =</span> <span class="dv">4</span>,<span class="dt">byrow =</span> T) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb557-9"><a href="Matched.html#cb557-9"></a><span class="st">  </span><span class="kw">addmargins</span>()</span>
<span id="cb557-10"><a href="Matched.html#cb557-10"></a>  </span>
<span id="cb557-11"><a href="Matched.html#cb557-11"></a><span class="kw">colnames</span>(mat) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;V1&quot;</span>, <span class="st">&quot;V2&quot;</span>, <span class="st">&quot;V3&quot;</span>, <span class="st">&quot;V4&quot;</span>, <span class="st">&quot;Sum&quot;</span>) </span>
<span id="cb557-12"><a href="Matched.html#cb557-12"></a>  </span>
<span id="cb557-13"><a href="Matched.html#cb557-13"></a><span class="st">`</span><span class="dt">Table 8.7</span><span class="st">`</span> &lt;-<span class="st">  </span></span>
<span id="cb557-14"><a href="Matched.html#cb557-14"></a><span class="st">  </span>mat <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb557-15"><a href="Matched.html#cb557-15"></a><span class="st">  </span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb557-16"><a href="Matched.html#cb557-16"></a><span class="st">  </span><span class="kw">bind_cols</span>(<span class="st">`</span><span class="dt">Pathologist X</span><span class="st">`</span> =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="st">&quot;Total&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb557-17"><a href="Matched.html#cb557-17"></a><span class="st">  </span><span class="kw">select</span>(<span class="st">`</span><span class="dt">Pathologist X</span><span class="st">`</span>, <span class="kw">everything</span>())</span>
<span id="cb557-18"><a href="Matched.html#cb557-18"></a>  </span>
<span id="cb557-19"><a href="Matched.html#cb557-19"></a>theHeader &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">col_keys =</span> <span class="kw">c</span>(<span class="st">&quot;Pathologist X&quot;</span>, <span class="st">&quot;Blank&quot;</span>, <span class="st">&quot;V1&quot;</span>, <span class="st">&quot;V2&quot;</span>,</span>
<span id="cb557-20"><a href="Matched.html#cb557-20"></a>                                           <span class="st">&quot;V3&quot;</span>, <span class="st">&quot;V4&quot;</span>, <span class="st">&quot;Sum&quot;</span>),</span>
<span id="cb557-21"><a href="Matched.html#cb557-21"></a>                        <span class="dt">line1 =</span> <span class="kw">c</span>(<span class="st">&quot;Pathologist X&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="kw">rep</span>(<span class="st">&quot;Pathologist Y&quot;</span>, <span class="dv">4</span>),</span>
<span id="cb557-22"><a href="Matched.html#cb557-22"></a>                                  <span class="st">&quot;Total&quot;</span>),</span>
<span id="cb557-23"><a href="Matched.html#cb557-23"></a>                        <span class="dt">line2 =</span> <span class="kw">c</span>(<span class="st">&quot;Pathologist X&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;4&quot;</span>,</span>
<span id="cb557-24"><a href="Matched.html#cb557-24"></a>                                  <span class="st">&quot;Total&quot;</span>))</span>
<span id="cb557-25"><a href="Matched.html#cb557-25"></a></span>
<span id="cb557-26"><a href="Matched.html#cb557-26"></a><span class="kw">library</span>(flextable)</span>
<span id="cb557-27"><a href="Matched.html#cb557-27"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb557-28"><a href="Matched.html#cb557-28"></a></span>
<span id="cb557-29"><a href="Matched.html#cb557-29"></a><span class="kw">library</span>(officer)</span>
<span id="cb557-30"><a href="Matched.html#cb557-30"></a>big_border =<span class="st"> </span><span class="kw">fp_border</span>(<span class="dt">color=</span><span class="st">&quot;black&quot;</span>, <span class="dt">width =</span> <span class="dv">2</span>)</span>
<span id="cb557-31"><a href="Matched.html#cb557-31"></a></span>
<span id="cb557-32"><a href="Matched.html#cb557-32"></a><span class="kw">flextable</span>(<span class="st">`</span><span class="dt">Table 8.7</span><span class="st">`</span>, <span class="dt">col_keys =</span> theHeader<span class="op">$</span>col_keys) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb557-33"><a href="Matched.html#cb557-33"></a><span class="st">  </span><span class="kw">set_header_df</span>(</span>
<span id="cb557-34"><a href="Matched.html#cb557-34"></a>    <span class="dt">mapping =</span> theHeader,</span>
<span id="cb557-35"><a href="Matched.html#cb557-35"></a>    <span class="dt">key =</span> <span class="st">&quot;col_keys&quot;</span></span>
<span id="cb557-36"><a href="Matched.html#cb557-36"></a>  ) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb557-37"><a href="Matched.html#cb557-37"></a><span class="st">  </span><span class="kw">theme_booktabs</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb557-38"><a href="Matched.html#cb557-38"></a><span class="st">  </span><span class="kw">merge_v</span>(<span class="dt">part =</span> <span class="st">&quot;header&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb557-39"><a href="Matched.html#cb557-39"></a><span class="st">  </span><span class="kw">merge_h</span>(<span class="dt">part =</span> <span class="st">&quot;header&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb557-40"><a href="Matched.html#cb557-40"></a><span class="st">  </span><span class="kw">align</span>(<span class="dt">align =</span> <span class="st">&quot;center&quot;</span>, <span class="dt">part =</span> <span class="st">&quot;all&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb557-41"><a href="Matched.html#cb557-41"></a><span class="st">  </span><span class="kw">align</span>(<span class="dt">j=</span><span class="st">&quot;Pathologist X&quot;</span>, <span class="dt">align=</span> <span class="st">&quot;left&quot;</span>, <span class="dt">part =</span> <span class="st">&quot;all&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb557-42"><a href="Matched.html#cb557-42"></a><span class="st">  </span><span class="kw">autofit</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb557-43"><a href="Matched.html#cb557-43"></a><span class="st">  </span><span class="kw">empty_blanks</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb557-44"><a href="Matched.html#cb557-44"></a><span class="st">  </span><span class="kw">fix_border_issues</span>()  <span class="op">%&gt;%</span></span>
<span id="cb557-45"><a href="Matched.html#cb557-45"></a><span class="st">  </span><span class="kw">set_caption</span>(<span class="dt">caption =</span> <span class="st">&quot;Table 8.7&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb557-46"><a href="Matched.html#cb557-46"></a><span class="st">  </span><span class="co">#set_table_properties(width = .75, layout = &quot;autofit&quot;) %&gt;% </span></span>
<span id="cb557-47"><a href="Matched.html#cb557-47"></a><span class="st">  </span><span class="kw">hline_top</span>(<span class="dt">part=</span><span class="st">&quot;header&quot;</span>, <span class="dt">border =</span> big_border) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb557-48"><a href="Matched.html#cb557-48"></a><span class="st">  </span><span class="kw">hline_bottom</span>(<span class="dt">part=</span><span class="st">&quot;body&quot;</span>, <span class="dt">border =</span> big_border)  </span></code></pre></div>
<template id="c6c87d29-5594-494f-a220-2769efc463b4"><style>
.tabwid table{
  border-collapse:collapse;
  line-height:1;
  margin-left:auto;
  margin-right:auto;
  border-width: 0;
  display: table;
  margin-top: 5px;
  margin-bottom: 5px;
  table-layout: fixed;
  border-spacing: 0;
  border-color: transparent;
}
.tabwid_left table{
  margin-left:0;
}
.tabwid_right table{
  margin-right:0;
}
.tabwid td {
    padding: 0;
}
.tabwid a {
  text-decoration: none;
}
.tabwid thead {
    background-color: transparent;
}
.tabwid tfoot {
    background-color: transparent;
}
.tabwid table tr {
background-color: transparent;
}
</style><div class="tabwid"><style>.cl-82aeac34{border-collapse:collapse;}.cl-82a953e2{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-82a95400{font-family:'Arial';font-size:10pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-82a96314{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:3pt;padding-top:3pt;padding-left:3pt;padding-right:3pt;line-height: 1;background-color:transparent;}.cl-82a96328{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:3pt;padding-top:3pt;padding-left:3pt;padding-right:3pt;line-height: 1;background-color:transparent;}.cl-82a996fe{width:40pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-82a9971c{width:27pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-82a99726{width:15pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-82a99730{width:80pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-82a9973a{width:80pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-82a9973b{width:40pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-82a99744{width:27pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-82a9974e{width:15pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-82a99758{width:80pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-82a99762{width:80pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-82a99763{width:15pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-82a9976c{width:40pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-82a99776{width:27pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-82a99780{width:80pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-82a9978a{width:80pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-82a99794{width:27pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-82a9979e{width:80pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-82a9979f{width:40pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-82a997a8{width:80pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-82a997b2{width:15pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-82a997bc{width:27pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 2pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-82a997bd{width:80pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 2pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-82a997c6{width:40pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 2pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-82a997d0{width:15pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 2pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-82a997d1{width:80pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 2pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-82a997da{width:15pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-82a997e4{width:27pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-82a997ee{width:80pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-82a997f8{width:40pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-82a99802{width:80pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table class='cl-82aeac34'>
<caption class="Table Caption">
<span id="tab:unnamed-chunk-107">Table 8: </span>Table 8.7
</caption>
<thead><tr style="overflow-wrap:break-word;"><td  rowspan="2"class="cl-82a997d1"><p class="cl-82a96314"><span class="cl-82a953e2">Pathologist X</span></p></td><td  rowspan="2"class="cl-82a997d0"><p class="cl-82a96328"><span class="cl-82a95400"></span></p></td><td  colspan="4"class="cl-82a997bd"><p class="cl-82a96328"><span class="cl-82a953e2">Pathologist Y</span></p></td><td  rowspan="2"class="cl-82a997c6"><p class="cl-82a96328"><span class="cl-82a953e2">Total</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-82a997ee"><p class="cl-82a96328"><span class="cl-82a953e2">1</span></p></td><td class="cl-82a997e4"><p class="cl-82a96328"><span class="cl-82a953e2">2</span></p></td><td class="cl-82a997e4"><p class="cl-82a96328"><span class="cl-82a953e2">3</span></p></td><td class="cl-82a997e4"><p class="cl-82a96328"><span class="cl-82a953e2">4</span></p></td></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-82a9973a"><p class="cl-82a96314"><span class="cl-82a953e2">1</span></p></td><td class="cl-82a99726"><p class="cl-82a96328"><span class="cl-82a95400"></span></p></td><td class="cl-82a99730"><p class="cl-82a96328"><span class="cl-82a953e2">22</span></p></td><td class="cl-82a9971c"><p class="cl-82a96328"><span class="cl-82a953e2">2</span></p></td><td class="cl-82a9971c"><p class="cl-82a96328"><span class="cl-82a953e2">2</span></p></td><td class="cl-82a9971c"><p class="cl-82a96328"><span class="cl-82a953e2">0</span></p></td><td class="cl-82a996fe"><p class="cl-82a96328"><span class="cl-82a953e2">26</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-82a9973a"><p class="cl-82a96314"><span class="cl-82a953e2">2</span></p></td><td class="cl-82a99726"><p class="cl-82a96328"><span class="cl-82a95400"></span></p></td><td class="cl-82a99730"><p class="cl-82a96328"><span class="cl-82a953e2">5</span></p></td><td class="cl-82a9971c"><p class="cl-82a96328"><span class="cl-82a953e2">7</span></p></td><td class="cl-82a9971c"><p class="cl-82a96328"><span class="cl-82a953e2">14</span></p></td><td class="cl-82a9971c"><p class="cl-82a96328"><span class="cl-82a953e2">0</span></p></td><td class="cl-82a996fe"><p class="cl-82a96328"><span class="cl-82a953e2">26</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-82a99762"><p class="cl-82a96314"><span class="cl-82a953e2">3</span></p></td><td class="cl-82a9974e"><p class="cl-82a96328"><span class="cl-82a95400"></span></p></td><td class="cl-82a99758"><p class="cl-82a96328"><span class="cl-82a953e2">0</span></p></td><td class="cl-82a99744"><p class="cl-82a96328"><span class="cl-82a953e2">2</span></p></td><td class="cl-82a99744"><p class="cl-82a96328"><span class="cl-82a953e2">36</span></p></td><td class="cl-82a99744"><p class="cl-82a96328"><span class="cl-82a953e2">0</span></p></td><td class="cl-82a9973b"><p class="cl-82a96328"><span class="cl-82a953e2">38</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-82a99780"><p class="cl-82a96314"><span class="cl-82a953e2">4</span></p></td><td class="cl-82a99763"><p class="cl-82a96328"><span class="cl-82a95400"></span></p></td><td class="cl-82a9978a"><p class="cl-82a96328"><span class="cl-82a953e2">0</span></p></td><td class="cl-82a99776"><p class="cl-82a96328"><span class="cl-82a953e2">1</span></p></td><td class="cl-82a99776"><p class="cl-82a96328"><span class="cl-82a953e2">17</span></p></td><td class="cl-82a99776"><p class="cl-82a96328"><span class="cl-82a953e2">10</span></p></td><td class="cl-82a9976c"><p class="cl-82a96328"><span class="cl-82a953e2">28</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-82a997a8"><p class="cl-82a96314"><span class="cl-82a953e2">Total</span></p></td><td class="cl-82a997b2"><p class="cl-82a96328"><span class="cl-82a95400"></span></p></td><td class="cl-82a9979e"><p class="cl-82a96328"><span class="cl-82a953e2">27</span></p></td><td class="cl-82a99794"><p class="cl-82a96328"><span class="cl-82a953e2">12</span></p></td><td class="cl-82a99794"><p class="cl-82a96328"><span class="cl-82a953e2">69</span></p></td><td class="cl-82a99794"><p class="cl-82a96328"><span class="cl-82a953e2">10</span></p></td><td class="cl-82a9979f"><p class="cl-82a96328"><span class="cl-82a953e2">118</span></p></td></tr></tbody></table></div></template>
<div id="a2ac1b30-1697-4930-82b8-361aeef8a57e"></div>
<script>
var dest = document.getElementById("a2ac1b30-1697-4930-82b8-361aeef8a57e");
var template = document.getElementById("c6c87d29-5594-494f-a220-2769efc463b4");
var caption = template.content.querySelector("caption");
if(caption) {
  caption.style.cssText = "display:block;"
  var newcapt = document.createElement("p");
  newcapt.appendChild(caption)
  dest.parentNode.insertBefore(newcapt, dest.previousSibling);
}
var fantome = dest.attachShadow({mode: 'open'});
var templateContent = template.content;
fantome.appendChild(templateContent);
fantome.appendChild(templateContent);
</script>

</div>
<div id="cell-residuals-for-independence-model" class="section level3">
<h3>8.5.2 Cell Residuals for Independence Model</h3>
</div>
<div id="quasi-independence-model" class="section level3">
<h3>8.5.3 Quasi-Independence Model</h3>
<div class="sourceCode" id="cb558"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb558-1"><a href="Matched.html#cb558-1"></a>Pathology &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;http://users.stat.ufl.edu/~aa/cat/data/Pathologists.dat&quot;</span>,</span>
<span id="cb558-2"><a href="Matched.html#cb558-2"></a>                        <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">stringsAsFactors =</span> <span class="ot">TRUE</span>)</span>
<span id="cb558-3"><a href="Matched.html#cb558-3"></a></span>
<span id="cb558-4"><a href="Matched.html#cb558-4"></a>Pathology  <span class="co"># diag: separate category (1, 2, 3, 4) for each main-diagonal cell </span></span></code></pre></div>
<pre class="custom-output"><code>   X Y count diag
1  1 1    22    1
2  1 2     2    0
3  1 3     2    0
4  1 4     0    0
5  2 1     5    0
6  2 2     7    2
7  2 3    14    0
8  2 4     0    0
9  3 1     0    0
10 3 2     2    0
11 3 3    36    3
12 3 4     0    0
13 4 1     0    0
14 4 2     1    0
15 4 3    17    0
16 4 4    10    4</code></pre>
<div class="sourceCode" id="cb560"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb560-1"><a href="Matched.html#cb560-1"></a><span class="co"># and a single (0) for all other cells</span></span>
<span id="cb560-2"><a href="Matched.html#cb560-2"></a></span>
<span id="cb560-3"><a href="Matched.html#cb560-3"></a>fit &lt;-<span class="st"> </span><span class="kw">glm</span>(count <span class="op">~</span><span class="st"> </span><span class="kw">factor</span>(X) <span class="op">+</span><span class="st"> </span><span class="kw">factor</span>(Y) <span class="op">+</span><span class="st"> </span><span class="kw">factor</span>(diag), <span class="dt">family =</span> poisson,</span>
<span id="cb560-4"><a href="Matched.html#cb560-4"></a>           <span class="dt">data =</span> Pathology)</span>
<span id="cb560-5"><a href="Matched.html#cb560-5"></a></span>
<span id="cb560-6"><a href="Matched.html#cb560-6"></a><span class="co"># quasi independence, not showing intercept or main effects</span></span>
<span id="cb560-7"><a href="Matched.html#cb560-7"></a><span class="kw">summary</span>(fit)</span></code></pre></div>
<pre class="custom-output"><code>
Call:
glm(formula = count ~ factor(X) + factor(Y) + factor(diag), family = poisson, 
    data = Pathology)

Deviance Residuals: 
       1         2         3         4         5         6         7         8  
 0.00000   1.19586  -0.74802  -0.00006   1.48661   0.00000  -0.66364  -0.00014  
       9        10        11        12        13        14        15        16  
-1.23667   0.63080   0.00000  -0.00008  -1.93254  -1.35095   1.02517   0.00000  

Coefficients:
               Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)     -0.7700     0.6979  -1.103  0.26986    
factor(X)2       1.6321     0.5604   2.912  0.00359 ** 
factor(X)3       0.5017     0.9261   0.542  0.58801    
factor(X)4       1.3946     0.5551   2.512  0.01199 *  
factor(Y)2       0.4796     0.6552   0.732  0.46414    
factor(Y)3       1.9493     0.4971   3.921 8.80e-05 ***
factor(Y)4     -19.3097  4988.8789  -0.004  0.99691    
factor(diag)1    3.8611     0.7297   5.291 1.22e-07 ***
factor(diag)2    0.6042     0.6900   0.876  0.38119    
factor(diag)3    1.9025     0.8367   2.274  0.02298 *  
factor(diag)4   20.9877  4988.8789   0.004  0.99664    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 190.398  on 15  degrees of freedom
Residual deviance:  13.178  on  5  degrees of freedom
AIC: 75.997

Number of Fisher Scoring iterations: 17</code></pre>
</div>
<div id="quasi-independence-and-odds-ratios-summarizing-agreement" class="section level3">
<h3>8.5.4 Quasi Independence and Odds Ratios Summarizing Agreement</h3>
<p><span class="math display">\[\tau_{ab} = \mathrm{exp}(\delta_a + \delta_b).\]</span></p>
</div>
<div id="kappa-summary-measure-of-agreement" class="section level3">
<h3>8.5.5 Kappa Summary Measure of Agreement</h3>
<p><span class="math display">\[\kappa = \frac{\sum_i\pi_{ii}-\sum_i\pi_{i+}\pi_{+i}}{1-\sum_i\pi_{i+}\pi_{+i}}\]</span></p>
<div class="sourceCode" id="cb562"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb562-1"><a href="Matched.html#cb562-1"></a><span class="kw">library</span>(psych)</span>
<span id="cb562-2"><a href="Matched.html#cb562-2"></a>dat &lt;-<span class="st"> </span><span class="kw">matrix</span>(Pathology<span class="op">$</span>count, <span class="dt">ncol =</span> <span class="dv">4</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)</span>
<span id="cb562-3"><a href="Matched.html#cb562-3"></a><span class="kw">cohen.kappa</span>(dat)</span></code></pre></div>
<pre class="custom-output"><code>Call: cohen.kappa1(x = x, w = w, n.obs = n.obs, alpha = alpha, levels = levels)

Cohen Kappa and Weighted Kappa correlation coefficients and confidence boundaries 
                 lower estimate upper
unweighted kappa  0.38     0.49  0.60
weighted kappa    0.78     0.78  0.78

 Number of subjects = 118 </code></pre>
</div>
</div>
<div id="bradley-terry-model-for-paired-preferences" class="section level2">
<h2>8.6 Bradley-Terry Model for Paired Preferences *</h2>
<div class="sourceCode" id="cb564"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb564-1"><a href="Matched.html#cb564-1"></a><span class="st">`</span><span class="dt">Table 8.8</span><span class="st">`</span> &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">Winner =</span> <span class="kw">c</span>(<span class="st">&quot;Djokovic&quot;</span>, <span class="st">&quot;Federer&quot;</span>, <span class="st">&quot;Murray&quot;</span>, <span class="st">&quot;Nadal&quot;</span>, </span>
<span id="cb564-2"><a href="Matched.html#cb564-2"></a>                                 <span class="st">&quot;Wawrinka&quot;</span>),</span>
<span id="cb564-3"><a href="Matched.html#cb564-3"></a>                      <span class="dt">Djokovic =</span> <span class="kw">c</span>(<span class="st">&quot;-&quot;</span>, <span class="dv">6</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">3</span>), </span>
<span id="cb564-4"><a href="Matched.html#cb564-4"></a>                      <span class="dt">Federer =</span> <span class="kw">c</span>(<span class="dv">9</span>, <span class="st">&quot;-&quot;</span>, <span class="dv">0</span> ,<span class="dv">1</span> , <span class="dv">2</span>),</span>
<span id="cb564-5"><a href="Matched.html#cb564-5"></a>                      <span class="dt">Murray =</span> <span class="kw">c</span>(<span class="dv">14</span>, <span class="dv">5</span>, <span class="st">&quot;-&quot;</span>, <span class="dv">4</span>, <span class="dv">2</span>),</span>
<span id="cb564-6"><a href="Matched.html#cb564-6"></a>                      <span class="dt">Nadal =</span> <span class="kw">c</span>(<span class="dv">9</span>, <span class="dv">5</span>, <span class="dv">2</span>, <span class="st">&quot;-&quot;</span>, <span class="dv">3</span>),</span>
<span id="cb564-7"><a href="Matched.html#cb564-7"></a>                      <span class="dt">Wawrinka =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="st">&quot;-&quot;</span>))</span>
<span id="cb564-8"><a href="Matched.html#cb564-8"></a></span>
<span id="cb564-9"><a href="Matched.html#cb564-9"></a>theHeader &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">col_keys =</span> <span class="kw">c</span>(<span class="st">&quot;Winner&quot;</span>, <span class="st">&quot;Blank&quot;</span>, <span class="st">&quot;Djokovic&quot;</span>, <span class="st">&quot;Federer&quot;</span>,</span>
<span id="cb564-10"><a href="Matched.html#cb564-10"></a>                                     <span class="st">&quot;Murray&quot;</span>, <span class="st">&quot;Nadal&quot;</span>, <span class="st">&quot;Wawrinka&quot;</span>),</span>
<span id="cb564-11"><a href="Matched.html#cb564-11"></a>                        <span class="dt">line1 =</span> <span class="kw">c</span>(<span class="st">&quot;Winner&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="kw">rep</span>(<span class="st">&quot;Looser&quot;</span>, <span class="dv">5</span>)),</span>
<span id="cb564-12"><a href="Matched.html#cb564-12"></a>                        <span class="dt">line2 =</span> <span class="kw">c</span>(<span class="st">&quot;Winner&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="st">&quot;Djokovic&quot;</span>, <span class="st">&quot;Federer&quot;</span>,</span>
<span id="cb564-13"><a href="Matched.html#cb564-13"></a>                                     <span class="st">&quot;Murray&quot;</span>, <span class="st">&quot;Nadal&quot;</span>, <span class="st">&quot;Wawrinka&quot;</span>))</span>
<span id="cb564-14"><a href="Matched.html#cb564-14"></a></span>
<span id="cb564-15"><a href="Matched.html#cb564-15"></a><span class="kw">library</span>(flextable)</span>
<span id="cb564-16"><a href="Matched.html#cb564-16"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb564-17"><a href="Matched.html#cb564-17"></a></span>
<span id="cb564-18"><a href="Matched.html#cb564-18"></a><span class="kw">library</span>(officer)</span>
<span id="cb564-19"><a href="Matched.html#cb564-19"></a>big_border =<span class="st"> </span><span class="kw">fp_border</span>(<span class="dt">color=</span><span class="st">&quot;black&quot;</span>, <span class="dt">width =</span> <span class="dv">2</span>)</span>
<span id="cb564-20"><a href="Matched.html#cb564-20"></a></span>
<span id="cb564-21"><a href="Matched.html#cb564-21"></a><span class="kw">flextable</span>(<span class="st">`</span><span class="dt">Table 8.8</span><span class="st">`</span>, <span class="dt">col_keys =</span> theHeader<span class="op">$</span>col_keys) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb564-22"><a href="Matched.html#cb564-22"></a><span class="st">  </span><span class="kw">set_header_df</span>(</span>
<span id="cb564-23"><a href="Matched.html#cb564-23"></a>    <span class="dt">mapping =</span> theHeader,</span>
<span id="cb564-24"><a href="Matched.html#cb564-24"></a>    <span class="dt">key =</span> <span class="st">&quot;col_keys&quot;</span></span>
<span id="cb564-25"><a href="Matched.html#cb564-25"></a>  ) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb564-26"><a href="Matched.html#cb564-26"></a><span class="st">  </span><span class="kw">theme_booktabs</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb564-27"><a href="Matched.html#cb564-27"></a><span class="st">  </span><span class="kw">merge_v</span>(<span class="dt">part =</span> <span class="st">&quot;header&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb564-28"><a href="Matched.html#cb564-28"></a><span class="st">  </span><span class="kw">merge_h</span>(<span class="dt">part =</span> <span class="st">&quot;header&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb564-29"><a href="Matched.html#cb564-29"></a><span class="st">  </span><span class="kw">align</span>(<span class="dt">align =</span> <span class="st">&quot;center&quot;</span>, <span class="dt">part =</span> <span class="st">&quot;all&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb564-30"><a href="Matched.html#cb564-30"></a><span class="st">  </span><span class="kw">align</span>(<span class="dt">j=</span><span class="st">&quot;Winner&quot;</span>, <span class="dt">align=</span> <span class="st">&quot;left&quot;</span>, <span class="dt">part =</span> <span class="st">&quot;all&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb564-31"><a href="Matched.html#cb564-31"></a><span class="st">  </span><span class="kw">autofit</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb564-32"><a href="Matched.html#cb564-32"></a><span class="st">  </span><span class="kw">empty_blanks</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb564-33"><a href="Matched.html#cb564-33"></a><span class="st">  </span><span class="kw">fix_border_issues</span>()  <span class="op">%&gt;%</span></span>
<span id="cb564-34"><a href="Matched.html#cb564-34"></a><span class="st">  </span><span class="kw">set_caption</span>(<span class="dt">caption =</span> <span class="st">&quot;Resuls of 2014-2018 matches for men tennis players.&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb564-35"><a href="Matched.html#cb564-35"></a><span class="st">  </span><span class="co">#set_table_properties(width = .75, layout = &quot;autofit&quot;) %&gt;% </span></span>
<span id="cb564-36"><a href="Matched.html#cb564-36"></a><span class="st">  </span><span class="kw">hline_top</span>(<span class="dt">part=</span><span class="st">&quot;header&quot;</span>, <span class="dt">border =</span> big_border) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb564-37"><a href="Matched.html#cb564-37"></a><span class="st">  </span><span class="kw">hline_bottom</span>(<span class="dt">part=</span><span class="st">&quot;body&quot;</span>, <span class="dt">border =</span> big_border)  </span></code></pre></div>
<template id="fff4e996-2ea0-45fe-9c97-718525be714e"><style>
.tabwid table{
  border-collapse:collapse;
  line-height:1;
  margin-left:auto;
  margin-right:auto;
  border-width: 0;
  display: table;
  margin-top: 5px;
  margin-bottom: 5px;
  table-layout: fixed;
  border-spacing: 0;
  border-color: transparent;
}
.tabwid_left table{
  margin-left:0;
}
.tabwid_right table{
  margin-right:0;
}
.tabwid td {
    padding: 0;
}
.tabwid a {
  text-decoration: none;
}
.tabwid thead {
    background-color: transparent;
}
.tabwid tfoot {
    background-color: transparent;
}
.tabwid table tr {
background-color: transparent;
}
</style><div class="tabwid"><style>.cl-83497282{border-collapse:collapse;}.cl-8343600e{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-83436022{font-family:'Arial';font-size:10pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-83436ec8{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:3pt;padding-top:3pt;padding-left:3pt;padding-right:3pt;line-height: 1;background-color:transparent;}.cl-83436edc{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:3pt;padding-top:3pt;padding-left:3pt;padding-right:3pt;line-height: 1;background-color:transparent;}.cl-8343a92e{width:15pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8343a94c{width:63pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8343a956{width:54pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8343a960{width:49pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8343a96a{width:44pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8343a974{width:57pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8343a975{width:63pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8343a97e{width:63pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8343a988{width:44pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8343a992{width:57pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8343a993{width:15pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8343a99c{width:63pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8343a9a6{width:54pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8343a9b0{width:49pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8343a9b1{width:63pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8343a9ba{width:63pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8343a9c4{width:44pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8343a9ce{width:57pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8343a9d8{width:49pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8343a9e2{width:54pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8343a9ec{width:15pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8343a9f6{width:57pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8343aa00{width:63pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8343aa0a{width:49pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8343aa0b{width:15pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8343aa14{width:63pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8343aa1e{width:44pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8343aa28{width:54pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8343aa32{width:15pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 2pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8343aa3c{width:63pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 2pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8343aa46{width:63pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 2pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8343aa50{width:49pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 2pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8343aa51{width:54pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 2pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8343aa5a{width:44pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 2pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8343aa64{width:57pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 2pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8343aa6e{width:44pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8343aa78{width:54pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8343aa82{width:57pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8343aa83{width:63pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8343aa8c{width:63pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8343aa96{width:49pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table class='cl-83497282'>
<caption class="Table Caption">
<span id="tab:unnamed-chunk-110">Table 9: </span>Resuls of 2014-2018 matches for men tennis players.
</caption>
<thead><tr style="overflow-wrap:break-word;"><td  rowspan="2"class="cl-8343aa3c"><p class="cl-83436ec8"><span class="cl-8343600e">Winner</span></p></td><td  rowspan="2"class="cl-8343aa32"><p class="cl-83436edc"><span class="cl-83436022"></span></p></td><td  colspan="5"class="cl-8343aa64"><p class="cl-83436edc"><span class="cl-8343600e">Looser</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8343aa82"><p class="cl-83436edc"><span class="cl-8343600e">Djokovic</span></p></td><td class="cl-8343aa78"><p class="cl-83436edc"><span class="cl-8343600e">Federer</span></p></td><td class="cl-8343aa96"><p class="cl-83436edc"><span class="cl-8343600e">Murray</span></p></td><td class="cl-8343aa6e"><p class="cl-83436edc"><span class="cl-8343600e">Nadal</span></p></td><td class="cl-8343aa83"><p class="cl-83436edc"><span class="cl-8343600e">Wawrinka</span></p></td></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-8343a94c"><p class="cl-83436ec8"><span class="cl-8343600e">Djokovic</span></p></td><td class="cl-8343a92e"><p class="cl-83436edc"><span class="cl-83436022"></span></p></td><td class="cl-8343a974"><p class="cl-83436edc"><span class="cl-8343600e">-</span></p></td><td class="cl-8343a956"><p class="cl-83436edc"><span class="cl-8343600e">9</span></p></td><td class="cl-8343a960"><p class="cl-83436edc"><span class="cl-8343600e">14</span></p></td><td class="cl-8343a96a"><p class="cl-83436edc"><span class="cl-8343600e">9</span></p></td><td class="cl-8343a975"><p class="cl-83436edc"><span class="cl-8343600e">4</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8343a99c"><p class="cl-83436ec8"><span class="cl-8343600e">Federer</span></p></td><td class="cl-8343a993"><p class="cl-83436edc"><span class="cl-83436022"></span></p></td><td class="cl-8343a992"><p class="cl-83436edc"><span class="cl-8343600e">6</span></p></td><td class="cl-8343a9a6"><p class="cl-83436edc"><span class="cl-8343600e">-</span></p></td><td class="cl-8343a9b0"><p class="cl-83436edc"><span class="cl-8343600e">5</span></p></td><td class="cl-8343a988"><p class="cl-83436edc"><span class="cl-8343600e">5</span></p></td><td class="cl-8343a97e"><p class="cl-83436edc"><span class="cl-8343600e">7</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8343a9ba"><p class="cl-83436ec8"><span class="cl-8343600e">Murray</span></p></td><td class="cl-8343a9ec"><p class="cl-83436edc"><span class="cl-83436022"></span></p></td><td class="cl-8343a9ce"><p class="cl-83436edc"><span class="cl-8343600e">3</span></p></td><td class="cl-8343a9e2"><p class="cl-83436edc"><span class="cl-8343600e">0</span></p></td><td class="cl-8343a9d8"><p class="cl-83436edc"><span class="cl-8343600e">-</span></p></td><td class="cl-8343a9c4"><p class="cl-83436edc"><span class="cl-8343600e">2</span></p></td><td class="cl-8343a9b1"><p class="cl-83436edc"><span class="cl-8343600e">2</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8343a99c"><p class="cl-83436ec8"><span class="cl-8343600e">Nadal</span></p></td><td class="cl-8343a993"><p class="cl-83436edc"><span class="cl-83436022"></span></p></td><td class="cl-8343a992"><p class="cl-83436edc"><span class="cl-8343600e">2</span></p></td><td class="cl-8343a9a6"><p class="cl-83436edc"><span class="cl-8343600e">1</span></p></td><td class="cl-8343a9b0"><p class="cl-83436edc"><span class="cl-8343600e">4</span></p></td><td class="cl-8343a988"><p class="cl-83436edc"><span class="cl-8343600e">-</span></p></td><td class="cl-8343a97e"><p class="cl-83436edc"><span class="cl-8343600e">4</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8343aa14"><p class="cl-83436ec8"><span class="cl-8343600e">Wawrinka</span></p></td><td class="cl-8343aa0b"><p class="cl-83436edc"><span class="cl-83436022"></span></p></td><td class="cl-8343a9f6"><p class="cl-83436edc"><span class="cl-8343600e">3</span></p></td><td class="cl-8343aa28"><p class="cl-83436edc"><span class="cl-8343600e">2</span></p></td><td class="cl-8343aa0a"><p class="cl-83436edc"><span class="cl-8343600e">2</span></p></td><td class="cl-8343aa1e"><p class="cl-83436edc"><span class="cl-8343600e">3</span></p></td><td class="cl-8343aa00"><p class="cl-83436edc"><span class="cl-8343600e">-</span></p></td></tr></tbody></table></div></template>
<div id="9c9fcc9f-190a-4911-82cc-b8035fbc6ddf"></div>
<script>
var dest = document.getElementById("9c9fcc9f-190a-4911-82cc-b8035fbc6ddf");
var template = document.getElementById("fff4e996-2ea0-45fe-9c97-718525be714e");
var caption = template.content.querySelector("caption");
if(caption) {
  caption.style.cssText = "display:block;"
  var newcapt = document.createElement("p");
  newcapt.appendChild(caption)
  dest.parentNode.insertBefore(newcapt, dest.previousSibling);
}
var fantome = dest.attachShadow({mode: 'open'});
var templateContent = template.content;
fantome.appendChild(templateContent);
fantome.appendChild(templateContent);
</script>

<div id="the-bradley-terry-model-of-quasi-symmetry" class="section level3">
<h3>8.6.1 The Bradley-Terry Model of Quasi-Symmetry</h3>
<p><span class="math display">\[\mathrm{logit}(\Pi_{ij}) = \mathrm{log}(\Pi_{ij}/\Pi_{ji}) = \beta_i - \beta_j.\]</span></p>
<p><span class="math display">\[\hat\Pi_{ij} = \mathrm{exp}(\hat\beta_i - \hat\beta_j)/[1 + \mathrm{exp}(\hat\beta_i - \hat\beta_j)].\]</span></p>
</div>
<div id="example-ranking-men-tennis-players" class="section level3">
<h3>8.6.2 Example: Ranking Men Tennis Players</h3>
<div class="sourceCode" id="cb565"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb565-1"><a href="Matched.html#cb565-1"></a>Tennis &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;http://users.stat.ufl.edu/~aa/cat/data/Tennis.dat&quot;</span>,</span>
<span id="cb565-2"><a href="Matched.html#cb565-2"></a>                        <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">stringsAsFactors =</span> <span class="ot">TRUE</span>)</span>
<span id="cb565-3"><a href="Matched.html#cb565-3"></a><span class="co"># Djokovic won 9 lost 6 vs Fed</span></span>
<span id="cb565-4"><a href="Matched.html#cb565-4"></a><span class="co"># Federer always beat Murray</span></span>
<span id="cb565-5"><a href="Matched.html#cb565-5"></a></span>
<span id="cb565-6"><a href="Matched.html#cb565-6"></a>fit &lt;-<span class="st"> </span></span>
<span id="cb565-7"><a href="Matched.html#cb565-7"></a><span class="st">  </span><span class="kw">glm</span>(nij<span class="op">/</span>(nij <span class="op">+</span><span class="st"> </span>nji) <span class="op">~</span><span class="st"> </span><span class="dv">-1</span> <span class="op">+</span><span class="st"> </span>Djokovic <span class="op">+</span><span class="st"> </span>Federer <span class="op">+</span><span class="st"> </span>Murray <span class="op">+</span><span class="st"> </span>Nadal <span class="op">+</span><span class="st"> </span>Wawrinka, </span>
<span id="cb565-8"><a href="Matched.html#cb565-8"></a>      <span class="dt">family =</span> binomial, <span class="dt">weights =</span> nij <span class="op">+</span><span class="st"> </span>nji, <span class="dt">data =</span> Tennis)</span>
<span id="cb565-9"><a href="Matched.html#cb565-9"></a><span class="kw">summary</span>(fit) </span></code></pre></div>
<pre class="custom-output"><code>
Call:
glm(formula = nij/(nij + nji) ~ -1 + Djokovic + Federer + Murray + 
    Nadal + Wawrinka, family = binomial, data = Tennis, weights = nij + 
    nji)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.1225  -0.1262   0.3715   0.5386   1.2928  

Coefficients: (1 not defined because of singularities)
         Estimate Std. Error z value Pr(&gt;|z|)  
Djokovic  1.17612    0.49952   2.354   0.0185 *
Federer   1.13578    0.51095   2.223   0.0262 *
Murray   -0.56852    0.56833  -1.000   0.3172  
Nadal    -0.06185    0.51487  -0.120   0.9044  
Wawrinka       NA         NA      NA       NA  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 26.8960  on 10  degrees of freedom
Residual deviance:  4.3958  on  6  degrees of freedom
AIC: 34.041

Number of Fisher Scoring iterations: 4</code></pre>
<p><span class="math display">\[\hat\Pi_{ij} = \frac{\mathrm{exp}(\hat\beta_i - \hat\beta_j)}{1 + \mathrm{exp}(\hat\beta_i - \hat\beta_j)} = \frac{\mathrm{exp}(1.136 - 1.176)}{1 + \mathrm{exp}(1.136 - 1.176)} = 0.49\]</span></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="Loglinear.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="Marginal.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": false
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
