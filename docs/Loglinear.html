<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>7 Loglinear Models for Contingency Tables and Counts | html</title>
  <meta name="description" content="Notes for Agresti’s Introduction to Categorical Data Analysis" />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="7 Loglinear Models for Contingency Tables and Counts | html" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Notes for Agresti’s Introduction to Categorical Data Analysis" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="7 Loglinear Models for Contingency Tables and Counts | html" />
  
  <meta name="twitter:description" content="Notes for Agresti’s Introduction to Categorical Data Analysis" />
  

<meta name="author" content="Raymond R Balise" />


<meta name="date" content="2023-04-04" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="Multicategory.html"/>
<link rel="next" href="Matched.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/tabwid-1.1.3/tabwid.css" rel="stylesheet" />
<script src="libs/tabwid-1.1.3/tabwid.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>0 Prelude</a></li>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i>1 Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#categorical-response-data"><i class="fa fa-check"></i>1.1 Categorical Response Data</a>
<ul>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#response-variables-and-explanatory-variables"><i class="fa fa-check"></i>1.1.1 Response Variables and Explanatory Variables</a></li>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#binary-nominal-ordinal-scale-distinction"><i class="fa fa-check"></i>1.1.2 Binary-Nominal-Ordinal Scale Distinction</a></li>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#organization-of-this-book"><i class="fa fa-check"></i>1.1.3 Organization of this Book</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#probability-distributions-for-categorical-data"><i class="fa fa-check"></i>1.2 Probability Distributions for Categorical Data</a>
<ul>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#binomial"><i class="fa fa-check"></i>1.2.1 Binomial Distribution</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#statistical-inference-for-a-proportion"><i class="fa fa-check"></i>1.3 Statistical Inference for a Proportion</a>
<ul>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#likelihood-function-and-maximum-likelihood-estimation"><i class="fa fa-check"></i>1.3.1 Likelihood Function and Maximum Likelihood Estimation</a></li>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#significance-test-about-a-binomial-parameter"><i class="fa fa-check"></i>1.3.2 Significance Test about a Binomial Parameter</a></li>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#example-surveyed-opinions-about-legalized-abortion"><i class="fa fa-check"></i>1.3.3 Example: Surveyed Opinions About Legalized Abortion</a></li>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#confidence-intervals-for-a-binomial-parameter"><i class="fa fa-check"></i>1.3.4 Confidence Intervals for a Binomial Parameter</a></li>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#better-confidence-intervals-for-a-binomial-proportion"><i class="fa fa-check"></i>1.3.5 Better Confidence Intervals for a Binomial Proportion</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#statistical-inference-for-discrete-data"><i class="fa fa-check"></i>1.4 Statistical Inference for Discrete Data</a>
<ul>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#x1.4.1"><i class="fa fa-check"></i>1.4.1 Wald, Likelihood-Ratio, and Score Tests</a></li>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#example-wald-score-and-likelihood-ratio-binomial-tests"><i class="fa fa-check"></i>1.4.2 Example Wald, Score and Likelihood-Ratio Binomial Tests</a></li>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#ssbi"><i class="fa fa-check"></i>1.4.3 Small-Sample Binomial Inference and the Mid P-Value</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#bayesian-inference-for-proportions"><i class="fa fa-check"></i>1.5 Bayesian Inference for Proportions</a>
<ul>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#the-bayesian-approach-to-statistical-inference"><i class="fa fa-check"></i>1.5.1 The Bayesian Approach to Statistical Inference</a></li>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#bayesian-binomial-inference-beta-prior-distributions"><i class="fa fa-check"></i>1.5.2 Bayesian Binomial Inference: Beta Prior Distributions</a></li>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#example-opinions-about-legalized-abortion-revisited"><i class="fa fa-check"></i>1.5.3 Example: Opinions about Legalized Abortion, Revisited</a></li>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#other-prior-distributions"><i class="fa fa-check"></i>1.5.4 Other Prior Distributions</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#using-r-software-for-statistical-inference-about-proportions"><i class="fa fa-check"></i>1.6 Using <code>R</code> software for Statistical Inference about Proportions</a>
<ul>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#reading-data-files-and-installing-packages"><i class="fa fa-check"></i>1.6.1 Reading Data Files and Installing Packages</a></li>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#using-r-for-statistical-inference-about-proportions"><i class="fa fa-check"></i>1.6.2 Using <code>R</code> for Statistical Inference about Proportions</a></li>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#summary-choosing-an-inference-method"><i class="fa fa-check"></i>1.6.3 Summary: Choosing an Inference Method</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#exercises"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html"><i class="fa fa-check"></i>2 Analyzing Contingency Tables</a>
<ul>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#probability-structure-for-contingency-tables"><i class="fa fa-check"></i>2.1 Probability Structure for Contingency Tables</a>
<ul>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#joint-marginal-and-conditional-probabilities"><i class="fa fa-check"></i>2.1.1 Joint, Marginal, and Conditional Probabilities</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#binomial-and-multinomial-sampling"><i class="fa fa-check"></i>2.1.4 Binomial and Multinomial Sampling</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#comparing-proportions-in-2-x-2-contingency-tables"><i class="fa fa-check"></i>2.2 Comparing Proportions in 2 x 2 Contingency Tables</a>
<ul>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#difference-of-proportions"><i class="fa fa-check"></i>2.2.1 Difference of Proportions</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#table2-2"><i class="fa fa-check"></i>2.2.2 Example: Aspirin and incidence of Heart Attacks</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#ratio-of-proportions-relative-risk"><i class="fa fa-check"></i>2.2.3 Ratio of Proportions (Relative Risk)</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#using-r-for-comparing-proportions-in-2-x-2-tables"><i class="fa fa-check"></i>2.2.4 Using <code>R</code> for Comparing Proportions in 2 x 2 Tables</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#the-odds-ratio"><i class="fa fa-check"></i>2.3 The Odds Ratio</a>
<ul>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#properties-of-the-odds-ratio"><i class="fa fa-check"></i>2.3.1 Properties of the Odds Ratio</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#example-odds-ratio-for-aspirin-and-hart-attacks"><i class="fa fa-check"></i>2.3.2 Example: Odds Ratio for Aspirin and Hart Attacks</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#inference-for-odds-ratios-and-log-odds-ratios"><i class="fa fa-check"></i>2.3.3 Inference for Odds Ratios and Log Odds Ratios</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#relationship-between-odds-ratio-and-relative-risk"><i class="fa fa-check"></i>2.3.4 Relationship Between Odds Ratio and Relative Risk</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#x2.3.5"><i class="fa fa-check"></i>2.3.5 Example: The Odds Ratio Applies in Case-Control Studies</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#types-of-studies-observational-versus-experimental"><i class="fa fa-check"></i>2.3.6 Types of Studies Observational Versus Experimental</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#x2.4"><i class="fa fa-check"></i>2.4 Chi-Squared Tests of Independence</a>
<ul>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#x2.4.1"><i class="fa fa-check"></i>2.4.1 Pearson Statistic and the Chi-Squared Distribution</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#likelihood-ratio-statistic"><i class="fa fa-check"></i>2.4.2 likelihood-Ratio Statistic</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#testing-independence-in-two-way-contingency-tables"><i class="fa fa-check"></i>2.4.3 Testing Independence in Two-Way Contingency Tables</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#example-gender-gap-in-political-party-affiliation"><i class="fa fa-check"></i>2.4.4 Example: Gender Gap in Political Party Affiliation</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#residuals-for-cells-in-a-contingency-table"><i class="fa fa-check"></i>2.4.5 Residuals for Cells in a Contingency Table</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#partitioning-chi-squared-statistics"><i class="fa fa-check"></i>2.4.6 Partitioning Chi-Squared Statistics</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#limitations-of-chi-squared-tests"><i class="fa fa-check"></i>2.4.7 Limitations of Chi-Squared Tests</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#x2.5"><i class="fa fa-check"></i>2.5 Testing Independence for Ordinal Variables</a>
<ul>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#linear-trend-alternative-to-independence"><i class="fa fa-check"></i>2.5.1 Linear Trend Alternative to Independence</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#example-alcohol-use-and-infant-malformation"><i class="fa fa-check"></i>2.5.2 Example: Alcohol Use and Infant Malformation</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#ordinal-tests-usually-have-greater-power"><i class="fa fa-check"></i>2.5.3 Ordinal Tests Usually Have Greater Power</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#choice-of-scores"><i class="fa fa-check"></i>2.5.4 Choice of Scores</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#trend-tests-for-r-x-2-and-2-x-c-and-nominal-ordinal-tables"><i class="fa fa-check"></i>2.5.6 Trend Tests for r x 2 and 2 x c and Nominal-Ordinal Tables</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#exact-frequentist-and-bayesian-inference"><i class="fa fa-check"></i>2.6 Exact Frequentist and Bayesian Inference</a>
<ul>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#fishers-exact-test-for-2-x-2-tables"><i class="fa fa-check"></i>2.6.1 Fisher’s Exact Test for 2 x 2 Tables</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#example-fishers-tea-tasting-colleague"><i class="fa fa-check"></i>2.6.2 Example: Fisher’s Tea Tasting Colleague</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#conservatism-for-actual-ptype-i-error-mid-p-value"><i class="fa fa-check"></i>2.6.3 Conservatism for Actual P(Type I Error); Mid P-Value</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#small-sample-confidence-intervals-for-odds-ratio"><i class="fa fa-check"></i>2.6.4 Small-Sample Confidence Intervals for Odds Ratio</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#bayesian-estimation-for-association-measures"><i class="fa fa-check"></i>2.6.5 Bayesian Estimation for Association Measures</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#example-bayesian-inference-in-a-small-clinical-trial"><i class="fa fa-check"></i>2.6.6 Example: Bayesian Inference in a Small Clinical Trial</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#association-in-three-way-tables"><i class="fa fa-check"></i>2.7 Association in Three-Way Tables</a>
<ul>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#partial-tables"><i class="fa fa-check"></i>2.7.1 Partial Tables</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#example-death-penalty-verdicts-and-race"><i class="fa fa-check"></i>2.7.2 Example: Death Penalty Verdicts and Race</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#simpsons-paradox"><i class="fa fa-check"></i>2.7.3 Simpson’s Paradox</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#conditional-and-marginal-odds-ratios"><i class="fa fa-check"></i>2.7.4 Conditional and Marginal Odds Ratios</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#x2.7.5"><i class="fa fa-check"></i>2.7.5 Homogeneous Association</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#exercises-1"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html"><i class="fa fa-check"></i>3 Generalized Linear Models</a>
<ul>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#components-of-a-generalized-linear-model"><i class="fa fa-check"></i>3.1 Components of a Generalized Linear Model</a>
<ul>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#random-component"><i class="fa fa-check"></i>3.1.1 Random Component</a></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#linear-predictor"><i class="fa fa-check"></i>3.1.2 Linear Predictor</a></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#link-function"><i class="fa fa-check"></i>3.1.3 Link Function</a></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#ordinary-linear-model-glm-with-normal-random-component"><i class="fa fa-check"></i>3.1.4 Ordinary Linear Model: GLM with Normal Random Component</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#components-of-a-generalized-linear-model-1"><i class="fa fa-check"></i>3.2 Components of a Generalized Linear Model</a>
<ul>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#x3.2.1"><i class="fa fa-check"></i>3.2.1 Linear Probability Model</a></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#logistic-regression-model"><i class="fa fa-check"></i>3.2.2 Logistic Regression Model</a></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#x3.2.3"><i class="fa fa-check"></i>3.2.3 Example Snoring and Heart Disease</a></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#using-r-to-fit-generalized-lineare-models-for-binary-data"><i class="fa fa-check"></i>3.2.4 Using <code>R</code> to Fit Generalized Lineare Models for Binary Data</a></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#x3.2.5"><i class="fa fa-check"></i>3.2.5 Data Files: Ungrouped or Grouped Binary Data</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#x3.3"><i class="fa fa-check"></i>3.3 Generalized Linear Models for Binary Data</a>
<ul>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#poisson-distribution-for-counts"><i class="fa fa-check"></i>3.3.1 Poisson Distribution for Counts</a></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#poisson-loglinear-model"><i class="fa fa-check"></i>3.3.2 Poisson Loglinear Model</a></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#x3.3.3"><i class="fa fa-check"></i>3.3.3 Example: Female Horseshoe Crabs and their Satellites</a></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#x3.3.4"><i class="fa fa-check"></i>3.3.4 Overdispersion: Greater Variability than Expected</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#generalized-lineaer-models-for-counts-and-rates"><i class="fa fa-check"></i>3.4 Generalized Lineaer Models for Counts and Rates</a>
<ul>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#x3.4.1"><i class="fa fa-check"></i>3.4.1 Wald, Likelihood-Ratio, and Score Inference Use the Likelihood Function</a></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#example-political-ideology-and-belief-in-evolution"><i class="fa fa-check"></i>3.4.2 Example Political Ideology and Belief in Evolution</a></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#model-comparison-using-the-deviance"><i class="fa fa-check"></i>3.4.4 Model Comparison Using the Deviance</a></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#x3.4.5"><i class="fa fa-check"></i>3.4.5 Residuals Comparing Ovservations to the Model Fit</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#fitting-generalized-linear-models"><i class="fa fa-check"></i>3.5 Fitting Generalized Linear Models</a>
<ul>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#x3.5.1"><i class="fa fa-check"></i>3.5.1 The Fisher Scoring Algorithm Fits GLMs</a></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#bayesian-methods-for-generalized-lineare-models"><i class="fa fa-check"></i>3.5.2 Bayesian Methods for Generalized Lineare Models</a></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#glms-a-unified-approach-to-statistical-analysis"><i class="fa fa-check"></i>3.5.3 GLMs: A Unified Approach to Statistical Analysis</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html"><i class="fa fa-check"></i>4 Logistic Regression</a>
<ul>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#the-logistic-regression-model"><i class="fa fa-check"></i>4.1 The Logistic Regression Model</a>
<ul>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#the-logistic-regression-model-1"><i class="fa fa-check"></i>4.1.1 The Logistic Regression Model</a></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#id_4.1.2"><i class="fa fa-check"></i>4.1.2 Odds Ratio and Linear Approximaiton Interpreetations</a></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#x4.1.3"><i class="fa fa-check"></i>4.1.3 Example: Whethr a Female Horsehoe Crab Has Satelites</a></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#logistic-regression-with-retrospective-studies"><i class="fa fa-check"></i>4.1.4 Logistic Regression with Retrospective Studies</a></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#normally-distributed-x-implies-logistic-regression-for-y"><i class="fa fa-check"></i>4.1.5 Normally Distributed X Implies Logistic Regression for Y</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#x4.2"><i class="fa fa-check"></i>4.2 Statistical Inference for Logistic Regression</a>
<ul>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#x4.2.1"><i class="fa fa-check"></i>4.2.1 Confidence Intervals for Effects</a></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#x4.2.2"><i class="fa fa-check"></i>4.2.2 Significance Testing</a></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#fitted-values-and-confidence-intervals-for-probabilities"><i class="fa fa-check"></i>4.2.3 Fitted Values and Confidence Intervals for Probabilities</a></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#why-use-a-model-to-estimate-probabilities"><i class="fa fa-check"></i>4.2.4 Why Use a Model to Estimate Probabilities?</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#logistic-regression-with-categorical-predictors"><i class="fa fa-check"></i>4.3 Logistic Regression with Categorical Predictors</a>
<ul>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#indicator-variables-represent-categories-of-predictors"><i class="fa fa-check"></i>4.3.1 Indicator Variables Represent Categories of Predictors</a></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#example-survey-about-marijuana-use"><i class="fa fa-check"></i>4.3.2 Example: Survey about Marijuana Use</a></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#anova-type-model-representation-of-factors"><i class="fa fa-check"></i>4.3.3 ANOVA-Type Model Representation of Factors</a></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#tests-of-conditoinal-independence-and-of-homogeneity-for-three-way-contingency-tables"><i class="fa fa-check"></i>4.3.4 Tests of Conditoinal Independence and of Homogeneity for Three-Way Contingency Tables</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#multiple-logistic-regression"><i class="fa fa-check"></i>4.4 Multiple Logistic Regression</a>
<ul>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#x4.4.1"><i class="fa fa-check"></i>4.4.1 Example: Horseshoe Crabs with Color and Width Predictors</a></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#model-comparison-to-check-whether-a-term-is-needed"><i class="fa fa-check"></i>4.4.2 Model Comparison to Check Whether a Term is Needed</a></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#example-treating-color-as-quantitative-or-binary"><i class="fa fa-check"></i>4.4.3 Example: Treating Color as Quantitative or Binary</a></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#allowing-interaction-between-explanatory-variables"><i class="fa fa-check"></i>4.4.4 Allowing Interaction between Explanatory Variables</a></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#effects-depend-on-other-explanatory-variables-in-model"><i class="fa fa-check"></i>4.4.5 Effects Depend on Other Explanatory Variables in Model</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#summarizing-effects-in-logistic-regression"><i class="fa fa-check"></i>4.5 Summarizing Effects in Logistic Regression</a>
<ul>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#probability-based-interpretations"><i class="fa fa-check"></i>4.5.1 Probability-Based Interpretations</a></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#x4.5.2"><i class="fa fa-check"></i>4.5.2 Marginal Effects and Their Average</a></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#x4.5.3"><i class="fa fa-check"></i>4.5.3 Standardized Interpretations</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#summzarizing-predictive-power-classification-tables-roc-curves-and-multiple-correlation"><i class="fa fa-check"></i>4.6 Summzarizing Predictive Power: Classification Tables, ROC Curves and Multiple Correlation</a>
<ul>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#x4.6.1"><i class="fa fa-check"></i>4.6.1 Summarizing Predictive Power: Classification Tables</a></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#summarizing-predictive-power-roc-curves"><i class="fa fa-check"></i>4.6.2 Summarizing Predictive Power: ROC Curves</a></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#x4.6.3"><i class="fa fa-check"></i>4.6.3 Summarizing Predictive Power: Multiple Correlation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html"><i class="fa fa-check"></i>5 Building and Applying Logistic Regression Models</a>
<ul>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#strategies-in-model-selection"><i class="fa fa-check"></i>5.1 Strategies in Model Selection</a>
<ul>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#how-many-explanatory-variables-can-the-model-handle"><i class="fa fa-check"></i>5.1.1 How Many Explanatory Variables Can the Model Handle?</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#example-horseshoe-crab-satellites-revisited"><i class="fa fa-check"></i>5.1.2 Example: Horseshoe Crab Satellites Revisited</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#stepwise-variable-selection-algorithms"><i class="fa fa-check"></i>5.1.3 Stepwise Variable Selection Algorithms</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#surposeful-selection-of-explanatory-variables"><i class="fa fa-check"></i>5.1.4 Surposeful Selection of Explanatory Variables</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#example-variable-selection-for-horseshoe-crabs"><i class="fa fa-check"></i>5.1.5 Example: Variable Selection for Horseshoe Crabs</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#aic-and-the-biasvariance-tradeoff"><i class="fa fa-check"></i>5.1.6 AIC and the Bias/Variance Tradeoff</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#model-checking"><i class="fa fa-check"></i>5.2 Model Checking</a>
<ul>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#x5.2.1"><i class="fa fa-check"></i>5.2.1 Goodness of Fit: Model Comparison Using the Deviance</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#x5.2.2"><i class="fa fa-check"></i>5.2.2 Example: Goodness of Fit for Marijuana Use Survey</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#goodness-of-fit-grouped-versus-ungrouped-data-and-continuous-predictors"><i class="fa fa-check"></i>5.2.3 Goodness of Fit: Grouped versus Ungrouped Data and Continuous Predictors</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#residuals-for-logistic-models-with-categorical-predictors"><i class="fa fa-check"></i>5.2.4 Residuals for Logistic Models with Categorical Predictors</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#standardized-versus-pearson-and-deviance-residuals"><i class="fa fa-check"></i>5.2.6 Standardized versus Pearson and Deviance Residuals</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#influence-diagnostics-for-logistic-regression"><i class="fa fa-check"></i>5.2.7 Influence Diagnostics for Logistic Regression</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#example-heart-disease-and-blood-pressure"><i class="fa fa-check"></i>5.2.8 Example: Heart Disease and Blood Pressure</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#infinite-estimates-in-logistic-regression"><i class="fa fa-check"></i>5.3 Infinite Estimates in Logistic Regression</a>
<ul>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#complete-and-quasi-complete-separation-perfeect-discrination"><i class="fa fa-check"></i>5.3.1 Complete and Quasi-Complete Separation: Perfeect Discrination</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#example-infinite-estimate-for-toy-example"><i class="fa fa-check"></i>5.3.2 Example: Infinite Estimate for Toy Example</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#sparse-data-and-infinite-effects-with-categorical-predictors"><i class="fa fa-check"></i>5.3.3 Sparse Data and Infinite Effects with Categorical Predictors</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#x5.3.5"><i class="fa fa-check"></i>5.3.4 Example: Risk Factors for Endometrial Cancer Grade</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#x5.4"><i class="fa fa-check"></i>5.4 Bayesian Inference, Penalized Likelihood, and Conditional Likelihood for Logistic Regression *</a>
<ul>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#bayesian-modeling-specification-of-prior-distributions"><i class="fa fa-check"></i>5.4.1 Bayesian Modeling: Specification of Prior Distributions</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#example-risk-factors-for-endometrial-caner-revisited"><i class="fa fa-check"></i>5.4.2 Example: Risk Factors for Endometrial Caner Revisited</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#penalized-likelihood-reduces-bias-in-logistic-regression"><i class="fa fa-check"></i>5.4.3 Penalized Likelihood Reduces Bias in Logistic Regression</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#example-risk-factors-for-endometrial-cancer-revisited"><i class="fa fa-check"></i>5.4.4 Example: Risk Factors for Endometrial Cancer Revisited</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#x5.4.5"><i class="fa fa-check"></i>5.4.5 Conditional Likelihood and Conditional Logistic Regression</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#conditional-logistic-regression-and-exact-tests-for-contingency-tables"><i class="fa fa-check"></i>5.4.6 Conditional Logistic Regression and Exact Tests for Contingency Tables</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#alternative-link-functions-linear-probability-and-probit-models"><i class="fa fa-check"></i>5.5 Alternative Link Functions: Linear Probability and Probit Models *</a>
<ul>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#linar-probability-model"><i class="fa fa-check"></i>5.5.1 Linar Probability Model</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#example-political-ideology-and-belief-in-evolution-1"><i class="fa fa-check"></i>5.5.2 Example: Political Ideology and Belief in Evolution</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#x5.5.3"><i class="fa fa-check"></i>5.5.3 Probit Model and Normal Latent Variable Model</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#example-snoring-and-heart-disease-revisited"><i class="fa fa-check"></i>5.5.4 Example: Snoring and Heart Disease Revisited</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#latent-variable-models-imply-binary-regression-models"><i class="fa fa-check"></i>5.5.5 Latent Variable Models Imply Binary Regression Models</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#cdfs-and-shapes-of-curves-for-binary-reegressoin-models"><i class="fa fa-check"></i>5.5.6 CDFs and Shapes of Curves for Binary Reegressoin Models</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#sample-size-and-power-for-logistic-regression"><i class="fa fa-check"></i>5.6 Sample Size and Power for Logistic Regression *</a>
<ul>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#sample-size-for-comparing-two-proportions"><i class="fa fa-check"></i>5.6.1 Sample Size for Comparing Two Proportions</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#sample-size-in-logistic-regression-modeling"><i class="fa fa-check"></i>5.6.2 Sample Size in Logistic Regression Modeling</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#example-modeling-the-probability-of-heart-disease"><i class="fa fa-check"></i>5.6.3 Example: Modeling the Probability of Heart Disease</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html"><i class="fa fa-check"></i>6 Multicategory Logit Models</a>
<ul>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#baseline-category-logit-models-for-nominal-responses"><i class="fa fa-check"></i>6.1 Baseline-Category Logit Models for Nominal Responses</a>
<ul>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#baseline-category-logits"><i class="fa fa-check"></i>6.1.1 Baseline-Category Logits</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#example-what-do-alligators-eat"><i class="fa fa-check"></i>6.1.2 Example: What Do Alligators Eat?</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#estimating-response-probabilities"><i class="fa fa-check"></i>6.1.3 Estimating Response Probabilities</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#checking-multinomial-model-goodness-of-fit"><i class="fa fa-check"></i>6.1.4 Checking multinomial Model Goodness of Fit</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#example-belief-in-afterlife"><i class="fa fa-check"></i>6.1.5 Example: Belief in Afterlife</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#discrete-choice-models"><i class="fa fa-check"></i>6.1.6 Discrete Choice Models*</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#example-shopping-destination-choice"><i class="fa fa-check"></i>6.1.7 Example: Shopping Destination Choice*</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#cumulative-logit-models-for-ordinal-responses-x6.2"><i class="fa fa-check"></i>6.2 Cumulative Logit Models for Ordinal Responses {x6.2}</a>
<ul>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#x6.2.1"><i class="fa fa-check"></i>6.2.1 Cumulative Logit Models with Proportional Odds</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#x6.2.2"><i class="fa fa-check"></i>6.2.2 Example: Political Ideology and Political Party Affiliation</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#inference-about-cumulative-logit-model-parameters"><i class="fa fa-check"></i>6.2.3 Inference about Cumulative Logit Model Parameters</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#increased-power-for-ordinal-analyses"><i class="fa fa-check"></i>6.2.4 Increased Power for Ordinal Analyses</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#example-happiness-and-family-income"><i class="fa fa-check"></i>6.2.5 Example: Happiness and Family Income</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#x6.2.6"><i class="fa fa-check"></i>6.2.6 Latent Variable Linear Models Imply Cumulative Link Models</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#invariance-to-choice-of-response-categories"><i class="fa fa-check"></i>6.2.7 Invariance to Choice of Response Categories</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#cumulative-link-models-model-checking-and-extensions"><i class="fa fa-check"></i>6.3 Cumulative Link Models: Model Checking and Extensions *</a>
<ul>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#checking-ordinal-model-goodness-of-fit"><i class="fa fa-check"></i>6.3.1 Checking Ordinal Model Goodness of Fit</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#cumulative-logit-model-without-proportional-odds"><i class="fa fa-check"></i>6.3.2 Cumulative Logit Model without Proportional Odds</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#simpler-interpretatoins-using-probabiliteis"><i class="fa fa-check"></i>6.3.3 Simpler Interpretatoins Using Probabiliteis</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#example-modeling-mental-impairment"><i class="fa fa-check"></i>6.3.4 Example: Modeling Mental Impairment</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#a-latent-variable-probability-comparison-of-groups"><i class="fa fa-check"></i>6.3.5 A Latent Variable Probability Comparison of Groups</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#cumulative-probit-model"><i class="fa fa-check"></i>6.3.6 Cumulative Probit Model</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#r2-based-on-latent-variable-model"><i class="fa fa-check"></i>6.3.7 <span class="math inline">\(R^2\)</span> Based on Latent Variable Model</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#bayesian-inference-for-multinomial-models"><i class="fa fa-check"></i>6.3.8 Bayesian Inference for Multinomial Models</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#example-modeling-mental-impairment-revisited"><i class="fa fa-check"></i>6.3.9 Example: Modeling Mental Impairment Revisited</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#paired-category-logit-modeling-of-ordinal-response"><i class="fa fa-check"></i>6.4 Paired-Category Logit Modeling of Ordinal Response *</a>
<ul>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#adjacent-categories-logits"><i class="fa fa-check"></i>6.4.1 Adjacent-Categories Logits</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#example-political-ideology-revisited"><i class="fa fa-check"></i>6.4.2 Example: Political Ideology Revisited</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#sequential-logits"><i class="fa fa-check"></i>6.4.3 Sequential Logits</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#example-tonsil-size-and-streptococcus"><i class="fa fa-check"></i>6.4.4 Example: Tonsil Size and Streptococcus</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html"><i class="fa fa-check"></i>7 Loglinear Models for Contingency Tables and Counts</a>
<ul>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#loglinear-models-for-counts-in-contingency-tables"><i class="fa fa-check"></i>7.1 Loglinear Models for Counts in Contingency Tables</a>
<ul>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#loglinear-model-of-independence-for-two-way-contingency-tables"><i class="fa fa-check"></i>7.1.1 Loglinear Model of Independence for Two-Way Contingency Tables</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#interpretation-of-parameters-in-the-independence-model"><i class="fa fa-check"></i>7.1.2 Interpretation of Parameters in the Independence Model</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#example-happiness-and-belief-in-heaven"><i class="fa fa-check"></i>7.1.3 Example: Happiness and Belief in Heaven</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#saturated-model-for-two-way-contingency-tables"><i class="fa fa-check"></i>7.1.4 Saturated Model for Two-Way Contingency Tables</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#loglinear-models-for-three-way-contingency-tables"><i class="fa fa-check"></i>7.1.5 Loglinear Models for Three-Way Contingency Tables</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#two-factor-parameters-describe-conditional-associations"><i class="fa fa-check"></i>7.1.6 Two-Factor Parameters Describe Conditional Associations</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#example-student-alcohol-cigarette-and-marijuana-use"><i class="fa fa-check"></i>7.1.7 Example: Student Alcohol, Cigarette, and Marijuana Use</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#statistical-inference-for-loglinear-models"><i class="fa fa-check"></i>7.2 Statistical Inference for Loglinear Models</a>
<ul>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#chi-squared-goodness-of-fit-tests"><i class="fa fa-check"></i>7.2.1 Chi-Squared Goodness-of-Fit Tests</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#x7.2.2"><i class="fa fa-check"></i>7.2.2 Cell Standardized Residuals for Loglinear Models</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#significance-tests-about-conditional-associations"><i class="fa fa-check"></i>7.2.3 Significance Tests about Conditional Associations</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#confidence-intervals-for-conditional-odds-ratios"><i class="fa fa-check"></i>7.2.4 Confidence Intervals for Conditional Odds Ratios</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#bayesian-fitting-of-loglinear-models"><i class="fa fa-check"></i>7.2.5 Bayesian Fitting of Loglinear Models</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#loglinear-models-for-higher-dimensional-contingency-tables"><i class="fa fa-check"></i>7.2.6 Loglinear Models for Higher-Dimensional Contingency Tables</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#example-automobile-accidents-and-seat-belts"><i class="fa fa-check"></i>7.2.7 Example: Automobile Accidents and Seat Belts</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#interpreting-three-factor-interaction-terms"><i class="fa fa-check"></i>7.2.8 Interpreting Three-Factor Interaction Terms</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#statistical-versus-practical-significance-dissimilarity-index"><i class="fa fa-check"></i>7.2.9 Statistical Versus Practical Significance: Dissimilarity Index</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#the-loglinear---logistic-model-connection"><i class="fa fa-check"></i>7.3 The Loglinear - Logistic Model Connection</a>
<ul>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#using-logistic-models-to-interpret-loglinear-models"><i class="fa fa-check"></i>7.3.1 Using Logistic Models to Interpret Loglinear Models</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#example-auto-accident-data-revisited"><i class="fa fa-check"></i>7.3.2 Example: Auto Accident Data Revisited</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#condition-for-equivalent-loglinear-and-logistic-models"><i class="fa fa-check"></i>7.3.3 Condition for Equivalent Loglinear and Logistic Models</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#loglinearlogistic-model-selection-issues"><i class="fa fa-check"></i>7.3.4 Loglinear/Logistic Model Selection Issues</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#independence-graphs-and-collapsibility"><i class="fa fa-check"></i>7.4 Independence Graphs and Collapsibility</a>
<ul>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#independence-graphs"><i class="fa fa-check"></i>7.4.1 Independence Graphs</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#collapsibility-conditions-for-contingency-tables"><i class="fa fa-check"></i>7.4.2 Collapsibility Conditions for Contingency Tables</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#example-loglinear-model-building-for-student-substance-use"><i class="fa fa-check"></i>7.4.3 Example: Loglinear Model Building for Student Substance Use</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#collapsibility-and-logistic-models"><i class="fa fa-check"></i>7.4.4 Collapsibility and Logistic Models</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#modeling-ordinal-associations-in-contingency-tables"><i class="fa fa-check"></i>7.5 Modeling Ordinal Associations in Contingency Tables</a>
<ul>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#linear-by-linear-association-model"><i class="fa fa-check"></i>7.5.1 Linear-by-Linear Association Model</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#example-linear-by-linear-association-for-sex-opinions"><i class="fa fa-check"></i>7.5.2 Example: Linear-by-Linear Association for Sex Opinions</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#ordinal-significance-tests-of-independence"><i class="fa fa-check"></i>7.5.3 Ordinal Significance Tests of Independence</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#loglinear-modeling-of-count-response-variables"><i class="fa fa-check"></i>7.6 Loglinear Modeling of Count Response Variables *</a>
<ul>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#count-regressoin-modeling-of-rate-data"><i class="fa fa-check"></i>7.6.1 Count Regressoin Modeling of Rate Data</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#example-death-rates-for-lung-cancer-patients"><i class="fa fa-check"></i>7.6.2 Example: Death Rates for Lung Cancer Patients</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#negativee-binomial-regression-models"><i class="fa fa-check"></i>7.6.3 Negativee Binomial Regression Models</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#example-female-horseshoe-crab-satelites-revisited"><i class="fa fa-check"></i>7.6.4 Example: Female Horseshoe Crab Satelites Revisited</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html"><i class="fa fa-check"></i>8 Models for Matched Pairs</a>
<ul>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#x8.1"><i class="fa fa-check"></i>8.1 Comparing Dependent Proporitons for Binary Mached Pairs</a>
<ul>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#mcnemar-test-comparing-marginal-proportions"><i class="fa fa-check"></i>8.1.1 McNemar Test Comparing Marginal Proportions</a></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#estimating-the-difference-between-dependent-proportions"><i class="fa fa-check"></i>8.1.2 Estimating the difference between Dependent Proportions</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#x8.2"><i class="fa fa-check"></i>8.2 Marginal Models and Subject-Specific Models for Matched Pairs</a>
<ul>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#x8.2.1"><i class="fa fa-check"></i>8.2.1 Marginal Models for Marginal Proportions</a></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#example-enironmental-options-revisted"><i class="fa fa-check"></i>8.2.2 Example: Enironmental Options Revisted</a></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#x8.2.3"><i class="fa fa-check"></i>8.2.3 Subject-Specific and Population-Averaging Tables</a></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#x8.2.4"><i class="fa fa-check"></i>8.2.4 Conditional Logistic Regression for Matched-Pairs*</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#comparing-proportions-for-nominal-matched-pairs-responses"><i class="fa fa-check"></i>8.3 Comparing Proportions for Nominal Matched-Pairs Responses</a>
<ul>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#marginal-homogeneity-for-baseline-category-logit-models"><i class="fa fa-check"></i>8.3.1 Marginal Homogeneity for Baseline-Category Logit Models</a></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#using-cochran-mantel-haenszel-test-to-test-marinal-homogeneity"><i class="fa fa-check"></i>8.3.3 Using Cochran-Mantel-Haenszel Test to Test marinal Homogeneity*</a></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#x8.3.4"><i class="fa fa-check"></i>8.3.4 Symmetry and Quasi-Symmetry Models for Square Contingency Tables</a></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#example-coffee-brand-market-share-revisited"><i class="fa fa-check"></i>8.3.5 Example: Coffee Brand market Share Revisited</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#comparing-proportions-for-ordinal-matched-pairs-responses"><i class="fa fa-check"></i>8.4 Comparing Proportions for Ordinal Matched-Pairs Responses</a>
<ul>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#marginal-homogeneity-and-cummulative-logit-marginal-model"><i class="fa fa-check"></i>8.4.1 Marginal Homogeneity and Cummulative Logit Marginal Model</a></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#x8.4.2"><i class="fa fa-check"></i>8.4.2 Example: Recycle or Drive Less to Help the Environment?</a></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#an-ordinal-quasi-symmetry-model"><i class="fa fa-check"></i>8.4.3 An Ordinal Quasi-Symmetry Model *</a></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#example-recycle-or-drive-less-revisited"><i class="fa fa-check"></i>8.4.4 Example: Recycle or Drive Less Revisited?</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#analyzing-rater-agreement"><i class="fa fa-check"></i>8.5 Analyzing Rater Agreement *</a>
<ul>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#example-agreement-on-carcinoma-diagnosis"><i class="fa fa-check"></i>8.5.1 Example: Agreement on Carcinoma Diagnosis</a></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#cell-residuals-for-independence-model"><i class="fa fa-check"></i>8.5.2 Cell Residuals for Independence Model</a></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#quasi-independence-model"><i class="fa fa-check"></i>8.5.3 Quasi-Independence Model</a></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#quasi-independence-and-odds-ratios-summarizing-agreement"><i class="fa fa-check"></i>8.5.4 Quasi Independence and Odds Ratios Summarizing Agreement</a></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#kappa-summary-measure-of-agreement"><i class="fa fa-check"></i>8.5.5 Kappa Summary Measure of Agreement</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#bradley-terry-model-for-paired-preferences"><i class="fa fa-check"></i>8.6 Bradley-Terry Model for Paired Preferences *</a>
<ul>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#the-bradley-terry-model-of-quasi-symmetry"><i class="fa fa-check"></i>8.6.1 The Bradley-Terry Model of Quasi-Symmetry</a></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#example-ranking-men-tennis-players"><i class="fa fa-check"></i>8.6.2 Example: Ranking Men Tennis Players</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html"><i class="fa fa-check"></i>9 Marginal Modeling of Correlated, Clustered Responses</a>
<ul>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html#marginal-models-vs-subject-specific-models"><i class="fa fa-check"></i>9.1 Marginal Models Vs Subject-Specific Models</a>
<ul>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html#marginal-models-for-a-clustered-binary-response"><i class="fa fa-check"></i>9.1.1 Marginal Models for a Clustered Binary Response</a></li>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html#x9.1.2"><i class="fa fa-check"></i>9.1.2 Example: Repeated Responses on Similar Survey Questions</a></li>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html#subject-specific-models-for-a-repeated-response"><i class="fa fa-check"></i>9.1.3 Subject-Specific Models for a Repeated Response</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html#marginal-modeling-the-generalized-estimating-equations-gee-approach"><i class="fa fa-check"></i>9.2 Marginal Modeling: The Generalized Estimating Equations (GEE) Approach</a>
<ul>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html#quasi-likelihood-methods"><i class="fa fa-check"></i>9.2.1 Quasi-Likelihood Methods</a></li>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html#generalized-estimating-equation-methodology-basic-ideas"><i class="fa fa-check"></i>9.2.2 Generalized Estimating Equation Methodology: Basic Ideas</a></li>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html#x9.2.3"><i class="fa fa-check"></i>9.2.3 Example: Opinion about Legalized Abortion Revisited</a></li>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html#limitations-of-gee-compared-to-ml"><i class="fa fa-check"></i>9.2.4 Limitations of GEE Compared to ML</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html#marginal-modeling-for-clustered-multinomial-responses"><i class="fa fa-check"></i>9.3 Marginal Modeling for Clustered Multinomial Responses</a>
<ul>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html#x9.3.1"><i class="fa fa-check"></i>9.3.1 Example: Insomnia Study</a></li>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html#alternative-gee-specification-of-working-association"><i class="fa fa-check"></i>9.3.2 Alternative GEE Specification of Working Association</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html#transitional-modeling-given-the-past"><i class="fa fa-check"></i>9.4 Transitional Modeling, Given the Past</a>
<ul>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html#transitional-models-with-explanatory-variables"><i class="fa fa-check"></i>9.4.1 Transitional Models with Explanatory Variables</a></li>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html#example-respiratory-illness-and-maternal-smoking"><i class="fa fa-check"></i>9.4.2 Example: Respiratory Illness and Maternal Smoking</a></li>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html#x9.4.3"><i class="fa fa-check"></i>9.4.3 Group Comparisons Treating Initial Response as Covariate</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html#dealing-with-missing-data"><i class="fa fa-check"></i>9.5 Dealing with Missing Data *</a>
<ul>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html#missing-at-random-impact-on-ml-and-gee-methods"><i class="fa fa-check"></i>9.5.1 Missing at Random: Impact on ML and GEE Methods</a></li>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html#multiple-imputation-monte-carlo-prediction-of-missing-data"><i class="fa fa-check"></i>9.5.2 Multiple Imputation: Monte Carlo Prediction of missing Data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html"><i class="fa fa-check"></i>10 Random Effects: Generalized Linear Mixed Models</a>
<ul>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#random-effects-modeling-of-clustered-categorical-data"><i class="fa fa-check"></i>10.1 Random Effects Modeling of Clustered Categorical Data</a>
<ul>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#the-generalized-linear-mixed-model-glmm"><i class="fa fa-check"></i>10.1.1 The Generalized Linear Mixed Model (GLMM)</a></li>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#a-logistic-glmm-for-binary-matched-pairs"><i class="fa fa-check"></i>10.1.2 A Logistic GLMM for Binary Matched Pairs</a></li>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#example-environmental-opinions-revised"><i class="fa fa-check"></i>10.1.3 Example: Environmental Opinions Revised</a></li>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#differing-effects-in-glmms-and-marginal-models"><i class="fa fa-check"></i>10.1.4 Differing Effects in GLMMs and Marginal Models</a></li>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#model-fitting-for-glmms"><i class="fa fa-check"></i>10.1.5 Model Fitting for GLMMs</a></li>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#inference-for-model-parameters-and-prediction"><i class="fa fa-check"></i>10.1.6 Inference for Model Parameters and Prediction</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#examples-random-effects-models-for-binary-data"><i class="fa fa-check"></i>10.2 Examples: Random Effects Models for Binary Data</a>
<ul>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#small-area-estimation-of-binomial-probabilities"><i class="fa fa-check"></i>10.2.1 Small-Area Estimation of Binomial Probabilities</a></li>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#example-estimating-basketball-free-throw-success"><i class="fa fa-check"></i>10.2.2 Example: Estimating Basketball Free Throw Success</a></li>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#example-opinions-about-legalizing-abortion-revised"><i class="fa fa-check"></i>10.2.3 Example: Opinions about Legalizing Abortion Revised</a></li>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#item-response-models-the-rasch-model"><i class="fa fa-check"></i>10.2.4 Item Response Models: The Rasch Model</a></li>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#choice-of-marginal-model-or-random-effects-model"><i class="fa fa-check"></i>10.2.5 Choice of Marginal Model or Random Effects Model</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#extensions-to-multinomial-responses-and-multiple-random-effect-terms"><i class="fa fa-check"></i>10.3 Extensions to Multinomial Responses and Multiple Random Effect Terms</a>
<ul>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#example-insomnia-study-revisited"><i class="fa fa-check"></i>10.3.1 Example: Insomnia Study Revisited</a></li>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#meta-analysis-bivariate-random-effects-for-association-heterogeneity"><i class="fa fa-check"></i>10.3.2 Meta-Analysis: Bivariate Random Effects for Association Heterogeneity</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#multilevel-hierarchical-models"><i class="fa fa-check"></i>10.4 Multilevel (Hierarchical) Models</a>
<ul>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#example-two-level-model-for-student-performance"><i class="fa fa-check"></i>10.4.1 Example: Two-Level Model for Student Performance</a></li>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#example-smoking-prevention-and-cessation-study"><i class="fa fa-check"></i>10.4.2 Example: Smoking Prevention and Cessation Study</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#latent-class-models"><i class="fa fa-check"></i>10.5 Latent Class Models *</a>
<ul>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#independence-given-a-latent-categorical-variable"><i class="fa fa-check"></i>10.5.1 Independence Given a Latent Categorical Variable</a></li>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#example-latent-class-model-for-rater-agreement"><i class="fa fa-check"></i>10.5.2 Example: Latent Class Model for Rater Agreement</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#exercises-2"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html"><i class="fa fa-check"></i>11 Classification and Smoothing</a>
<ul>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#classification-linear-discrinant-analysis"><i class="fa fa-check"></i>11.1 Classification: Linear Discrinant Analysis</a>
<ul>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#classification-with-fishers-linear-discriminant-function"><i class="fa fa-check"></i>11.1.1 Classification with Fisher’s Linear Discriminant Function</a></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#example-horseshoe-crab-satellites-revisited-1"><i class="fa fa-check"></i>11.1.2 Example: Horseshoe Crab Satellites Revisited</a></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#discriminant-analysis-versus-logistic-regression"><i class="fa fa-check"></i>11.1.3 Discriminant Analysis Versus Logistic Regression</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#classification-tree-based-prediction"><i class="fa fa-check"></i>11.2 Classification: Tree-Based Prediction</a>
<ul>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#classification-trees"><i class="fa fa-check"></i>11.2.1 Classification Trees</a></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#example-a-classification-tree-for-horseshoe-crab-mating"><i class="fa fa-check"></i>11.2.2 Example: A classification Tree for Horseshoe Crab Mating</a></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#how-does-the-classification-tree-grow"><i class="fa fa-check"></i>11.2.3 How Does the Classification Tree Grow?</a></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#pruning-a-tree-and-checking-prediction-accuracy"><i class="fa fa-check"></i>11.2.4 Pruning a Tree and Checking Prediction Accuracy</a></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#classification-trees-versus-logistic-regression-and-discriminant-analysis"><i class="fa fa-check"></i>11.2.5 Classification Trees Versus Logistic Regression and Discriminant Analysis</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#cluster-analysis-for-categorical-responses"><i class="fa fa-check"></i>11.3 Cluster Analysis for Categorical Responses</a>
<ul>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#measuring-dissimilarity-between-observations"><i class="fa fa-check"></i>11.3.1 Measuring Dissimilarity Between Observations</a></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#hierarchical-clustering-algorithm-and-dendrograms"><i class="fa fa-check"></i>11.3.2 Hierarchical Clustering Algorithm and Dendrograms</a></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#example-clustering-states-on-presidential-elections"><i class="fa fa-check"></i>11.3.3 Example: Clustering States on Presidential Elections</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#smoothing-generalized-additive-models"><i class="fa fa-check"></i>11.4 Smoothing: Generalized Additive Models</a>
<ul>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#generalized-additive-models"><i class="fa fa-check"></i>11.4.1 Generalized Additive Models</a></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#example-gams-for-horseshoe-crab-data"><i class="fa fa-check"></i>11.4.2 Example: GAMs for Horseshoe Crab Data</a></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#how-much-smoothing-the-biasvariance-tradeoff"><i class="fa fa-check"></i>11.4.3 How Much Smoothing? The Bias/Variance Tradeoff</a></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#example-smoothing-to-portray-probability-of-kyphosis"><i class="fa fa-check"></i>11.4.4 Example: Smoothing to Portray Probability of Kyphosis</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#regularization-for-high-dimensional-categorical-data-large-p"><i class="fa fa-check"></i>11.5 Regularization for High-Dimensional Categorical Data (Large <em>p</em>)</a>
<ul>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#penalized-likelihood-methods-and-l_q-norm-smoothing"><i class="fa fa-check"></i>11.5.1 Penalized-Likelihood Methods and <span class="math inline">\(L_q\)</span>-Norm Smoothing</a></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#implementing-the-lasso"><i class="fa fa-check"></i>11.5.2 Implementing the Lasso</a></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#example-predicting-option-on-abortion-with-student-survey"><i class="fa fa-check"></i>11.5.3 Example: Predicting Option on Abortion with Student Survey</a></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#why-shrink-ml-estimates-toward-0"><i class="fa fa-check"></i>11.5.4 Why Shrink ML Estimates Toward 0?</a></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#issues-in-variable-selection-dimension-reduction"><i class="fa fa-check"></i>11.5.5 Issues In variable Selection (Dimension Reduction)</a></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#controlling-the-false-discovery-rate"><i class="fa fa-check"></i>11.5.6 Controlling the False Discovery Rate</a></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#large-p-also-makes-bayesian-inference-challenging"><i class="fa fa-check"></i>11.5.7 Large <span class="math inline">\(p\)</span> also Makes Bayesian Inference Challenging</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="rmarkdown.html"><a href="rmarkdown.html"><i class="fa fa-check"></i>99 R Markdown</a>
<ul>
<li class="chapter" data-level="" data-path="rmarkdown.html"><a href="rmarkdown.html#formatting"><i class="fa fa-check"></i>Formatting</a></li>
<li class="chapter" data-level="" data-path="rmarkdown.html"><a href="rmarkdown.html#symbols"><i class="fa fa-check"></i>Symbols</a></li>
<li class="chapter" data-level="" data-path="rmarkdown.html"><a href="rmarkdown.html#markdown-highlighting"><i class="fa fa-check"></i>Markdown highlighting</a></li>
<li class="chapter" data-level="" data-path="rmarkdown.html"><a href="rmarkdown.html#text-coloring"><i class="fa fa-check"></i>Text coloring</a></li>
<li class="chapter" data-level="" data-path="rmarkdown.html"><a href="rmarkdown.html#equations"><i class="fa fa-check"></i>Equations</a></li>
<li class="chapter" data-level="" data-path="rmarkdown.html"><a href="rmarkdown.html#x99.4"><i class="fa fa-check"></i>Section references</a></li>
<li class="chapter" data-level="" data-path="rmarkdown.html"><a href="rmarkdown.html#footnotes"><i class="fa fa-check"></i>Footnotes</a></li>
<li class="chapter" data-level="" data-path="rmarkdown.html"><a href="rmarkdown.html#displaying-formula"><i class="fa fa-check"></i>Displaying Formula</a>
<ul>
<li class="chapter" data-level="" data-path="rmarkdown.html"><a href="rmarkdown.html#notation"><i class="fa fa-check"></i>Notation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="rmarkdown.html"><a href="rmarkdown.html#greek-letters"><i class="fa fa-check"></i>Greek letters</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">html</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="Loglinear" class="section level1 hasAnchor">
<h1>7 Loglinear Models for Contingency Tables and Counts<a href="Loglinear.html#Loglinear" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="loglinear-models-for-counts-in-contingency-tables" class="section level2 hasAnchor">
<h2>7.1 Loglinear Models for Counts in Contingency Tables<a href="Loglinear.html#loglinear-models-for-counts-in-contingency-tables" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><span class="math display">\[\pi_{ij} = P(X=i)P(Y=j) = \pi_{i+}\pi_{+j},\ i = 1, \dots, r,\ j = 1, \dots, c.\]</span></p>
<div id="loglinear-model-of-independence-for-two-way-contingency-tables" class="section level3 hasAnchor">
<h3>7.1.1 Loglinear Model of Independence for Two-Way Contingency Tables<a href="Loglinear.html#loglinear-model-of-independence-for-two-way-contingency-tables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="math display" id="eq:eq71">\[\begin{equation}
  P(Y=1) = \mathrm{log}\mu_{ij} = \lambda + \lambda_i^X + \lambda_j^Y,
  \tag{17}
\end{equation}\]</span></p>
</div>
<div id="interpretation-of-parameters-in-the-independence-model" class="section level3 hasAnchor">
<h3>7.1.2 Interpretation of Parameters in the Independence Model<a href="Loglinear.html#interpretation-of-parameters-in-the-independence-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="example-happiness-and-belief-in-heaven" class="section level3 hasAnchor">
<h3>7.1.3 Example: Happiness and Belief in Heaven<a href="Loglinear.html#example-happiness-and-belief-in-heaven" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb426"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb426-1"><a href="Loglinear.html#cb426-1" aria-hidden="true" tabindex="-1"></a>HappyHeaven <span class="ot">&lt;-</span>  </span>
<span id="cb426-2"><a href="Loglinear.html#cb426-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read.table</span>(<span class="st">&quot;http://users.stat.ufl.edu/~aa/cat/data/HappyHeaven.dat&quot;</span>,</span>
<span id="cb426-3"><a href="Loglinear.html#cb426-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">stringsAsFactors =</span> <span class="cn">TRUE</span>)</span>
<span id="cb426-4"><a href="Loglinear.html#cb426-4" aria-hidden="true" tabindex="-1"></a>HappyHeaven</span></code></pre></div>
<pre class="custom-output"><code>   happy heaven count
1    not     no    32
2    not    yes   190
3 pretty     no   113
4 pretty    yes   611
5   very     no    51
6   very    yes   326</code></pre>
<div class="sourceCode" id="cb428"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb428-1"><a href="Loglinear.html#cb428-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(HappyHeaven, </span>
<span id="cb428-2"><a href="Loglinear.html#cb428-2" aria-hidden="true" tabindex="-1"></a>  questionr<span class="sc">::</span><span class="fu">wtd.table</span>(happy, heaven, <span class="at">weight =</span> count)</span>
<span id="cb428-3"><a href="Loglinear.html#cb428-3" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre class="custom-output"><code>        no yes
not     32 190
pretty 113 611
very    51 326</code></pre>
<div class="sourceCode" id="cb430"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb430-1"><a href="Loglinear.html#cb430-1" aria-hidden="true" tabindex="-1"></a><span class="co"># canonical link for Poisson is log, so &quot;(link = log)&quot; is not necessary</span></span>
<span id="cb430-2"><a href="Loglinear.html#cb430-2" aria-hidden="true" tabindex="-1"></a><span class="co"># loglm() function in MASS library also fits loglinear models</span></span>
<span id="cb430-3"><a href="Loglinear.html#cb430-3" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(count <span class="sc">~</span> happy <span class="sc">+</span> heaven, <span class="at">family =</span> poisson, <span class="at">data =</span> HappyHeaven)</span>
<span id="cb430-4"><a href="Loglinear.html#cb430-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb430-5"><a href="Loglinear.html#cb430-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code></pre></div>
<pre class="custom-output"><code>
Call:
glm(formula = count ~ happy + heaven, family = poisson, data = HappyHeaven)

Deviance Residuals: 
       1         2         3         4         5         6  
-0.15570   0.06459   0.54947  -0.23152  -0.65897   0.27006  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  3.49313    0.09408   37.13  &lt; 2e-16 ***
happypretty  1.18211    0.07672   15.41  &lt; 2e-16 ***
happyvery    0.52957    0.08460    6.26 3.86e-10 ***
heavenyes    1.74920    0.07739   22.60  &lt; 2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 1019.87238  on 5  degrees of freedom
Residual deviance:    0.89111  on 2  degrees of freedom
AIC: 49.504

Number of Fisher Scoring iterations: 3</code></pre>
</div>
<div id="saturated-model-for-two-way-contingency-tables" class="section level3 hasAnchor">
<h3>7.1.4 Saturated Model for Two-Way Contingency Tables<a href="Loglinear.html#saturated-model-for-two-way-contingency-tables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="math display">\[
\mathrm{log}\mu_{ij} = \lambda + \lambda_i^X + \lambda_j^Y + \lambda_{ij}^{XY}
\]</span>
<span class="math display">\[\mathrm{log}\theta = \mathrm{log}\big( \frac{\mu_{11}\mu_{22}}{\mu_{12}\mu_{21}}\big) = \mathrm{log}\mu_{11} + \mathrm{log}\mu_{22} - \mathrm{log}\mu_{12} - \mathrm{log}\mu_{21}.\]</span></p>
</div>
<div id="loglinear-models-for-three-way-contingency-tables" class="section level3 hasAnchor">
<h3>7.1.5 Loglinear Models for Three-Way Contingency Tables<a href="Loglinear.html#loglinear-models-for-three-way-contingency-tables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="math display">\[\mathrm{log}\mu_{ijk} =\lambda + \lambda_i^X+ \lambda_j^Y + \lambda_k^Z +\lambda_{ik}^{XZ} + +\lambda_{jk}^{YZ}.\]</span>
<span class="math display">\[\mathrm{log}\mu_{ijk} =\lambda + \lambda_i^X+ \lambda_j^Y + \lambda_k^Z + \lambda_{ij}^{XY} +\lambda_{ik}^{XZ} + +\lambda_{jk}^{YZ}.\]</span></p>
</div>
<div id="two-factor-parameters-describe-conditional-associations" class="section level3 hasAnchor">
<h3>7.1.6 Two-Factor Parameters Describe Conditional Associations<a href="Loglinear.html#two-factor-parameters-describe-conditional-associations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="example-student-alcohol-cigarette-and-marijuana-use" class="section level3 hasAnchor">
<h3>7.1.7 Example: Student Alcohol, Cigarette, and Marijuana Use<a href="Loglinear.html#example-student-alcohol-cigarette-and-marijuana-use" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb432"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb432-1"><a href="Loglinear.html#cb432-1" aria-hidden="true" tabindex="-1"></a>Drugs <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;http://users.stat.ufl.edu/~aa/cat/data/Substance.dat&quot;</span>,</span>
<span id="cb432-2"><a href="Loglinear.html#cb432-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">stringsAsFactors =</span> <span class="cn">TRUE</span>)</span>
<span id="cb432-3"><a href="Loglinear.html#cb432-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb432-4"><a href="Loglinear.html#cb432-4" aria-hidden="true" tabindex="-1"></a>Drugs <span class="ot">&lt;-</span> Drugs <span class="sc">%&gt;%</span> </span>
<span id="cb432-5"><a href="Loglinear.html#cb432-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">A =</span> <span class="st">&quot;alcohol&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb432-6"><a href="Loglinear.html#cb432-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">C =</span> <span class="st">&quot;cigarettes&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb432-7"><a href="Loglinear.html#cb432-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">M =</span> <span class="st">&quot;marijuana&quot;</span>)</span>
<span id="cb432-8"><a href="Loglinear.html#cb432-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb432-9"><a href="Loglinear.html#cb432-9" aria-hidden="true" tabindex="-1"></a><span class="st">`</span><span class="at">Table 7.1</span><span class="st">`</span> <span class="ot">&lt;-</span>  <span class="fu">bind_cols</span>(<span class="st">`</span><span class="at">Alcohol Use</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="st">&quot;No&quot;</span>, <span class="st">&quot;&quot;</span>),</span>
<span id="cb432-10"><a href="Loglinear.html#cb432-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Defendants&#39; Race</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;No&quot;</span>),<span class="dv">2</span>),</span>
<span id="cb432-11"><a href="Loglinear.html#cb432-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">matrix</span>(Drugs<span class="sc">$</span>count, <span class="at">ncol =</span> <span class="dv">2</span>,<span class="at">byrow =</span> T,</span>
<span id="cb432-12"><a href="Loglinear.html#cb432-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="cn">NULL</span>,</span>
<span id="cb432-13"><a href="Loglinear.html#cb432-13" aria-hidden="true" tabindex="-1"></a>         <span class="fu">c</span>(<span class="st">&quot;Marijuana Use (Yes)&quot;</span>, <span class="st">&quot;Marijuana Use (No)&quot;</span>)))) </span>
<span id="cb432-14"><a href="Loglinear.html#cb432-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb432-15"><a href="Loglinear.html#cb432-15" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="st">`</span><span class="at">Table 7.1</span><span class="st">`</span>)</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
Alcohol Use
</th>
<th style="text-align:left;">
Defendants’ Race
</th>
<th style="text-align:right;">
Marijuana Use (Yes)
</th>
<th style="text-align:right;">
Marijuana Use (No)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
911
</td>
<td style="text-align:right;">
538
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:right;">
44
</td>
<td style="text-align:right;">
456
</td>
</tr>
<tr>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
43
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
279
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb433"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb433-1"><a href="Loglinear.html#cb433-1" aria-hidden="true" tabindex="-1"></a>A_C_M <span class="ot">&lt;-</span> <span class="fu">glm</span>(count <span class="sc">~</span> A <span class="sc">+</span> C <span class="sc">+</span> M, <span class="at">family =</span> poisson, <span class="at">data =</span> Drugs)</span>
<span id="cb433-2"><a href="Loglinear.html#cb433-2" aria-hidden="true" tabindex="-1"></a><span class="st">`</span><span class="at">(A, C, M)</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">exp</span>(<span class="fu">predict</span>(A_C_M, <span class="fu">data.frame</span>(Drugs))), <span class="dv">1</span>) </span>
<span id="cb433-3"><a href="Loglinear.html#cb433-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb433-4"><a href="Loglinear.html#cb433-4" aria-hidden="true" tabindex="-1"></a>AM_CM <span class="ot">&lt;-</span> <span class="fu">glm</span>(count <span class="sc">~</span> A <span class="sc">+</span> C <span class="sc">+</span> M <span class="sc">+</span> A<span class="sc">:</span>M <span class="sc">+</span> C<span class="sc">:</span>M, <span class="at">family =</span> poisson, <span class="at">data =</span> Drugs)</span>
<span id="cb433-5"><a href="Loglinear.html#cb433-5" aria-hidden="true" tabindex="-1"></a><span class="st">`</span><span class="at">(AM, CM)</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">exp</span>(<span class="fu">predict</span>(AM_CM, <span class="fu">data.frame</span>(Drugs))), <span class="dv">2</span>) </span>
<span id="cb433-6"><a href="Loglinear.html#cb433-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb433-7"><a href="Loglinear.html#cb433-7" aria-hidden="true" tabindex="-1"></a>AC_AM_CM <span class="ot">&lt;-</span> <span class="fu">glm</span>(count <span class="sc">~</span> A <span class="sc">+</span> C <span class="sc">+</span> M <span class="sc">+</span> A<span class="sc">:</span>C <span class="sc">+</span> A<span class="sc">:</span>M <span class="sc">+</span> C<span class="sc">:</span>M, <span class="at">family =</span> poisson, <span class="at">data =</span> Drugs)</span>
<span id="cb433-8"><a href="Loglinear.html#cb433-8" aria-hidden="true" tabindex="-1"></a><span class="st">`</span><span class="at">(AC, AM, CM)</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">exp</span>(<span class="fu">predict</span>(AC_AM_CM, <span class="fu">data.frame</span>(Drugs))), <span class="dv">1</span>) </span>
<span id="cb433-9"><a href="Loglinear.html#cb433-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb433-10"><a href="Loglinear.html#cb433-10" aria-hidden="true" tabindex="-1"></a>ACM <span class="ot">&lt;-</span> <span class="fu">glm</span>(count <span class="sc">~</span> A <span class="sc">+</span> C <span class="sc">+</span> M <span class="sc">+</span> A<span class="sc">:</span>C <span class="sc">+</span> A<span class="sc">:</span>C <span class="sc">+</span> A<span class="sc">:</span>M <span class="sc">+</span> C<span class="sc">:</span>M <span class="sc">+</span> A<span class="sc">:</span>C<span class="sc">:</span>M, <span class="at">family =</span> poisson, <span class="at">data =</span> Drugs)</span>
<span id="cb433-11"><a href="Loglinear.html#cb433-11" aria-hidden="true" tabindex="-1"></a><span class="st">`</span><span class="at">(ACM)</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">exp</span>(<span class="fu">predict</span>(ACM, <span class="fu">data.frame</span>(Drugs))), <span class="dv">1</span>)</span>
<span id="cb433-12"><a href="Loglinear.html#cb433-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb433-13"><a href="Loglinear.html#cb433-13" aria-hidden="true" tabindex="-1"></a><span class="st">`</span><span class="at">Table 7.2</span><span class="st">`</span> <span class="ot">&lt;-</span>  <span class="fu">bind_cols</span>(<span class="st">`</span><span class="at">Alcohol Use</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Yes&quot;</span>, <span class="fu">rep</span>(<span class="st">&quot;&quot;</span>, <span class="dv">3</span>), <span class="st">&quot;No&quot;</span>, <span class="fu">rep</span>(<span class="st">&quot;&quot;</span>,<span class="dv">3</span>)),</span>
<span id="cb433-14"><a href="Loglinear.html#cb433-14" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Cigarette Use</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;Yes&quot;</span>, <span class="st">&quot; &quot;</span>, <span class="st">&quot;No&quot;</span>, <span class="st">&quot;&quot;</span>),<span class="dv">2</span>),</span>
<span id="cb433-15"><a href="Loglinear.html#cb433-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Marijuana Use</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;No&quot;</span>), <span class="dv">4</span>),</span>
<span id="cb433-16"><a href="Loglinear.html#cb433-16" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">(A, C, M)</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">(A, C, M)</span><span class="st">`</span>,</span>
<span id="cb433-17"><a href="Loglinear.html#cb433-17" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">(AM, CM)</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">(AM, CM)</span><span class="st">`</span>,</span>
<span id="cb433-18"><a href="Loglinear.html#cb433-18" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">(AC, AM, CM)</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">(AC, AM, CM)</span><span class="st">`</span>,</span>
<span id="cb433-19"><a href="Loglinear.html#cb433-19" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">(ACM)</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">(ACM)</span><span class="st">`</span>) </span>
<span id="cb433-20"><a href="Loglinear.html#cb433-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb433-21"><a href="Loglinear.html#cb433-21" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="st">`</span><span class="at">Table 7.2</span><span class="st">`</span>)</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
Alcohol Use
</th>
<th style="text-align:left;">
Cigarette Use
</th>
<th style="text-align:left;">
Marijuana Use
</th>
<th style="text-align:right;">
(A, C, M)
</th>
<th style="text-align:right;">
(AM, CM)
</th>
<th style="text-align:right;">
(AC, AM, CM)
</th>
<th style="text-align:right;">
(ACM)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
540.0
</td>
<td style="text-align:right;">
909.24
</td>
<td style="text-align:right;">
910.4
</td>
<td style="text-align:right;">
911
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:right;">
740.2
</td>
<td style="text-align:right;">
438.84
</td>
<td style="text-align:right;">
538.6
</td>
<td style="text-align:right;">
538
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
282.1
</td>
<td style="text-align:right;">
45.76
</td>
<td style="text-align:right;">
44.6
</td>
<td style="text-align:right;">
44
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:right;">
386.7
</td>
<td style="text-align:right;">
555.16
</td>
<td style="text-align:right;">
455.4
</td>
<td style="text-align:right;">
456
</td>
</tr>
<tr>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
90.6
</td>
<td style="text-align:right;">
4.76
</td>
<td style="text-align:right;">
3.6
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:right;">
124.2
</td>
<td style="text-align:right;">
142.16
</td>
<td style="text-align:right;">
42.4
</td>
<td style="text-align:right;">
43
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
47.3
</td>
<td style="text-align:right;">
0.24
</td>
<td style="text-align:right;">
1.4
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:right;">
64.9
</td>
<td style="text-align:right;">
179.84
</td>
<td style="text-align:right;">
279.6
</td>
<td style="text-align:right;">
279
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb434"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb434-1"><a href="Loglinear.html#cb434-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Table 7.3</span></span>
<span id="cb434-2"><a href="Loglinear.html#cb434-2" aria-hidden="true" tabindex="-1"></a>line2 <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">exp</span>(<span class="fu">coef</span>(AM_CM)[<span class="fu">c</span>(<span class="st">&quot;Ayes:Myes&quot;</span>, <span class="st">&quot;Cyes:Myes&quot;</span>)]), <span class="dv">1</span>)</span>
<span id="cb434-3"><a href="Loglinear.html#cb434-3" aria-hidden="true" tabindex="-1"></a>line3 <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">exp</span>(<span class="fu">coef</span>(AC_AM_CM)[<span class="fu">c</span>(<span class="st">&quot;Ayes:Cyes&quot;</span>, <span class="st">&quot;Ayes:Myes&quot;</span>, <span class="st">&quot;Cyes:Myes&quot;</span>)]), <span class="dv">1</span>)</span>
<span id="cb434-4"><a href="Loglinear.html#cb434-4" aria-hidden="true" tabindex="-1"></a>line4 <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">exp</span>(<span class="fu">coef</span>(ACM)[<span class="fu">c</span>(<span class="st">&quot;Ayes:Cyes&quot;</span>, <span class="st">&quot;Ayes:Myes&quot;</span>, <span class="st">&quot;Cyes:Myes&quot;</span>)]), <span class="dv">1</span>)</span>
<span id="cb434-5"><a href="Loglinear.html#cb434-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb434-6"><a href="Loglinear.html#cb434-6" aria-hidden="true" tabindex="-1"></a><span class="st">`</span><span class="at">Table 7.3</span><span class="st">`</span> <span class="ot">&lt;-</span>  </span>
<span id="cb434-7"><a href="Loglinear.html#cb434-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="at">Model =</span> <span class="fu">c</span>(<span class="st">&quot;(A, C, M)&quot;</span>,  <span class="st">&quot;(AM, CM)&quot;</span>, <span class="st">&quot;(AC, AM, CM)&quot;</span>, <span class="st">&quot;(ACM)&quot;</span>),</span>
<span id="cb434-8"><a href="Loglinear.html#cb434-8" aria-hidden="true" tabindex="-1"></a>            <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span> (<span class="fl">1.0</span>, <span class="dv">3</span>), </span>
<span id="cb434-9"><a href="Loglinear.html#cb434-9" aria-hidden="true" tabindex="-1"></a>                     <span class="fl">1.0</span>, line2[<span class="st">&quot;Ayes:Myes&quot;</span>], line2[<span class="st">&quot;Cyes:Myes&quot;</span>],</span>
<span id="cb434-10"><a href="Loglinear.html#cb434-10" aria-hidden="true" tabindex="-1"></a>                     line3[<span class="st">&quot;Ayes:Cyes&quot;</span>], line3[<span class="st">&quot;Ayes:Myes&quot;</span>], line3[<span class="st">&quot;Cyes:Myes&quot;</span>],</span>
<span id="cb434-11"><a href="Loglinear.html#cb434-11" aria-hidden="true" tabindex="-1"></a>                     line4[<span class="st">&quot;Ayes:Cyes&quot;</span>], line4[<span class="st">&quot;Ayes:Myes&quot;</span>], line4[<span class="st">&quot;Cyes:Myes&quot;</span>]), </span>
<span id="cb434-12"><a href="Loglinear.html#cb434-12" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">byrow =</span> T,</span>
<span id="cb434-13"><a href="Loglinear.html#cb434-13" aria-hidden="true" tabindex="-1"></a>                   <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="cn">NULL</span>, <span class="fu">c</span>(<span class="st">&quot;AC&quot;</span>, <span class="st">&quot;AM&quot;</span>, <span class="st">&quot;CM&quot;</span>))))</span>
<span id="cb434-14"><a href="Loglinear.html#cb434-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb434-15"><a href="Loglinear.html#cb434-15" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="st">`</span><span class="at">Table 7.3</span><span class="st">`</span>)</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
Model
</th>
<th style="text-align:right;">
AC
</th>
<th style="text-align:right;">
AM
</th>
<th style="text-align:right;">
CM
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(A, C, M)
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:right;">
1.0
</td>
</tr>
<tr>
<td style="text-align:left;">
(AM, CM)
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:right;">
61.9
</td>
<td style="text-align:right;">
25.1
</td>
</tr>
<tr>
<td style="text-align:left;">
(AC, AM, CM)
</td>
<td style="text-align:right;">
7.8
</td>
<td style="text-align:right;">
19.8
</td>
<td style="text-align:right;">
17.3
</td>
</tr>
<tr>
<td style="text-align:left;">
(ACM)
</td>
<td style="text-align:right;">
7.7
</td>
<td style="text-align:right;">
13.5
</td>
<td style="text-align:right;">
9.7
</td>
</tr>
</tbody>
</table>
<p><span class="math display">\[2.7 = \frac{(909.24 + 438.84)*(0.24 + 179.84)}{(45.76 + 555.16)*(4.76 + 142.16)}.\]</span></p>
<div class="sourceCode" id="cb435"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb435-1"><a href="Loglinear.html#cb435-1" aria-hidden="true" tabindex="-1"></a>AM_CM <span class="ot">&lt;-</span> <span class="fu">glm</span>(count <span class="sc">~</span> A <span class="sc">+</span> C <span class="sc">+</span> M <span class="sc">+</span> A<span class="sc">:</span>M <span class="sc">+</span> C<span class="sc">:</span>M, <span class="at">family =</span> poisson, <span class="at">data =</span> Drugs)</span>
<span id="cb435-2"><a href="Loglinear.html#cb435-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">exp</span>(<span class="fu">predict</span>(AM_CM, <span class="fu">data.frame</span>(Drugs))), <span class="dv">2</span>)  <span class="co"># Table 7.2 </span></span>
<span id="cb435-3"><a href="Loglinear.html#cb435-3" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">exp</span>(<span class="fu">coef</span>(AM_CM)), <span class="dv">1</span>) <span class="co"># Table 7.3</span></span>
<span id="cb435-4"><a href="Loglinear.html#cb435-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb435-5"><a href="Loglinear.html#cb435-5" aria-hidden="true" tabindex="-1"></a>is2<span class="fl">.7</span> <span class="ot">&lt;-</span> ((<span class="fl">909.2395833</span> <span class="sc">+</span> <span class="fl">438.8404255</span>)<span class="sc">*</span>(<span class="fl">0.2395833</span> <span class="sc">+</span> <span class="fl">179.8404255</span>)) <span class="sc">/</span> </span>
<span id="cb435-6"><a href="Loglinear.html#cb435-6" aria-hidden="true" tabindex="-1"></a>  ((<span class="fl">45.7604167</span> <span class="sc">+</span> <span class="fl">555.1595745</span>)<span class="sc">*</span>(<span class="fl">4.7604167</span> <span class="sc">+</span> <span class="fl">142.1595745</span>))</span>
<span id="cb435-7"><a href="Loglinear.html#cb435-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb435-8"><a href="Loglinear.html#cb435-8" aria-hidden="true" tabindex="-1"></a><span class="co"># collapse over M</span></span>
<span id="cb435-9"><a href="Loglinear.html#cb435-9" aria-hidden="true" tabindex="-1"></a>AC <span class="ot">&lt;-</span></span>
<span id="cb435-10"><a href="Loglinear.html#cb435-10" aria-hidden="true" tabindex="-1"></a>  Drugs <span class="sc">%&gt;%</span> </span>
<span id="cb435-11"><a href="Loglinear.html#cb435-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(A, C) <span class="sc">%&gt;%</span> </span>
<span id="cb435-12"><a href="Loglinear.html#cb435-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Count2 =</span> <span class="fu">sum</span>(count), <span class="at">.groups =</span> <span class="st">&quot;drop_last&quot;</span>)</span>
<span id="cb435-13"><a href="Loglinear.html#cb435-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb435-14"><a href="Loglinear.html#cb435-14" aria-hidden="true" tabindex="-1"></a>AC_marginal <span class="ot">&lt;-</span> <span class="fu">glm</span>(Count2 <span class="sc">~</span> A <span class="sc">+</span> C <span class="sc">+</span> A<span class="sc">:</span>C, <span class="at">family =</span> poisson, <span class="at">data =</span> AC)</span>
<span id="cb435-15"><a href="Loglinear.html#cb435-15" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">exp</span>(<span class="fu">predict</span>(AC_marginal, <span class="fu">data.frame</span>(AC))), <span class="dv">2</span>)</span>
<span id="cb435-16"><a href="Loglinear.html#cb435-16" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">exp</span>(<span class="fu">coef</span>(AC_marginal)), <span class="dv">5</span>)</span>
<span id="cb435-17"><a href="Loglinear.html#cb435-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb435-18"><a href="Loglinear.html#cb435-18" aria-hidden="true" tabindex="-1"></a>(<span class="dv">1449</span><span class="sc">*</span><span class="dv">281</span>)<span class="sc">/</span>(<span class="dv">500</span><span class="sc">*</span><span class="dv">46</span>)</span></code></pre></div>
<div class="sourceCode" id="cb436"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb436-1"><a href="Loglinear.html#cb436-1" aria-hidden="true" tabindex="-1"></a>Drugs <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;http://users.stat.ufl.edu/~aa/cat/data/Substance.dat&quot;</span>,</span>
<span id="cb436-2"><a href="Loglinear.html#cb436-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">stringsAsFactors =</span> <span class="cn">TRUE</span>)</span>
<span id="cb436-3"><a href="Loglinear.html#cb436-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb436-4"><a href="Loglinear.html#cb436-4" aria-hidden="true" tabindex="-1"></a>Drugs <span class="sc">%&gt;%</span> </span>
<span id="cb436-5"><a href="Loglinear.html#cb436-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">row_number</span>() <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fu">n</span>()))</span></code></pre></div>
<pre class="custom-output"><code>  alcohol cigarettes marijuana count
1     yes        yes       yes   911
2      no         no        no   279</code></pre>
<div class="sourceCode" id="cb438"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb438-1"><a href="Loglinear.html#cb438-1" aria-hidden="true" tabindex="-1"></a>Drugs <span class="ot">&lt;-</span> Drugs <span class="sc">%&gt;%</span> </span>
<span id="cb438-2"><a href="Loglinear.html#cb438-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">A =</span> <span class="st">&quot;alcohol&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb438-3"><a href="Loglinear.html#cb438-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">C =</span> <span class="st">&quot;cigarettes&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb438-4"><a href="Loglinear.html#cb438-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">M =</span> <span class="st">&quot;marijuana&quot;</span>)</span>
<span id="cb438-5"><a href="Loglinear.html#cb438-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb438-6"><a href="Loglinear.html#cb438-6" aria-hidden="true" tabindex="-1"></a><span class="co">#A &lt;- Drugs$alcohol</span></span>
<span id="cb438-7"><a href="Loglinear.html#cb438-7" aria-hidden="true" tabindex="-1"></a><span class="co">#C &lt;- Drugs$cigarettes</span></span>
<span id="cb438-8"><a href="Loglinear.html#cb438-8" aria-hidden="true" tabindex="-1"></a><span class="co">#M &lt;- Drugs$marijuana</span></span>
<span id="cb438-9"><a href="Loglinear.html#cb438-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb438-10"><a href="Loglinear.html#cb438-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb438-11"><a href="Loglinear.html#cb438-11" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(count <span class="sc">~</span> A <span class="sc">+</span> C <span class="sc">+</span> M <span class="sc">+</span> A<span class="sc">:</span>C <span class="sc">+</span> A<span class="sc">:</span>M <span class="sc">+</span> C<span class="sc">:</span>M, <span class="at">family =</span> poisson, <span class="at">data =</span> Drugs)</span>
<span id="cb438-12"><a href="Loglinear.html#cb438-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code></pre></div>
<pre class="custom-output"><code>
Call:
glm(formula = count ~ A + C + M + A:C + A:M + C:M, family = poisson, 
    data = Drugs)

Deviance Residuals: 
       1         2         3         4         5         6         7         8  
 0.02044  -0.02658  -0.09256   0.02890  -0.33428   0.09452   0.49134  -0.03690  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  5.63342    0.05970  94.361  &lt; 2e-16 ***
Ayes         0.48772    0.07577   6.437 1.22e-10 ***
Cyes        -1.88667    0.16270 -11.596  &lt; 2e-16 ***
Myes        -5.30904    0.47520 -11.172  &lt; 2e-16 ***
Ayes:Cyes    2.05453    0.17406  11.803  &lt; 2e-16 ***
Ayes:Myes    2.98601    0.46468   6.426 1.31e-10 ***
Cyes:Myes    2.84789    0.16384  17.382  &lt; 2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 2851.46098  on 7  degrees of freedom
Residual deviance:    0.37399  on 1  degrees of freedom
AIC: 63.417

Number of Fisher Scoring iterations: 4</code></pre>
</div>
</div>
<div id="statistical-inference-for-loglinear-models" class="section level2 hasAnchor">
<h2>7.2 Statistical Inference for Loglinear Models<a href="Loglinear.html#statistical-inference-for-loglinear-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="chi-squared-goodness-of-fit-tests" class="section level3 hasAnchor">
<h3>7.2.1 Chi-Squared Goodness-of-Fit Tests<a href="Loglinear.html#chi-squared-goodness-of-fit-tests" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb440"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb440-1"><a href="Loglinear.html#cb440-1" aria-hidden="true" tabindex="-1"></a><span class="co"># p-value for the (AC, AM, CM) model</span></span>
<span id="cb440-2"><a href="Loglinear.html#cb440-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb440-3"><a href="Loglinear.html#cb440-3" aria-hidden="true" tabindex="-1"></a>AC_AM <span class="ot">&lt;-</span> <span class="fu">glm</span>(count <span class="sc">~</span> A <span class="sc">+</span> C <span class="sc">+</span> M <span class="sc">+</span> A<span class="sc">:</span>C <span class="sc">+</span> A<span class="sc">:</span>M, <span class="at">family =</span> poisson, <span class="at">data =</span> Drugs)</span>
<span id="cb440-4"><a href="Loglinear.html#cb440-4" aria-hidden="true" tabindex="-1"></a>AC_CM <span class="ot">&lt;-</span> <span class="fu">glm</span>(count <span class="sc">~</span> A <span class="sc">+</span> C <span class="sc">+</span> M <span class="sc">+</span> A<span class="sc">:</span>C <span class="sc">+</span> C<span class="sc">:</span>M, <span class="at">family =</span> poisson, <span class="at">data =</span> Drugs)</span>
<span id="cb440-5"><a href="Loglinear.html#cb440-5" aria-hidden="true" tabindex="-1"></a>AM_CM <span class="ot">&lt;-</span> <span class="fu">glm</span>(count <span class="sc">~</span> A <span class="sc">+</span> C <span class="sc">+</span> M <span class="sc">+</span> A<span class="sc">:</span>M <span class="sc">+</span> C<span class="sc">:</span>M, <span class="at">family =</span> poisson, <span class="at">data =</span> Drugs)</span>
<span id="cb440-6"><a href="Loglinear.html#cb440-6" aria-hidden="true" tabindex="-1"></a>AC_AM_CM <span class="ot">&lt;-</span> <span class="fu">glm</span>(count <span class="sc">~</span> A <span class="sc">+</span> C <span class="sc">+</span> M <span class="sc">+</span> A<span class="sc">:</span>C <span class="sc">+</span> A<span class="sc">:</span>M <span class="sc">+</span> C<span class="sc">:</span>M, <span class="at">family =</span> poisson, <span class="at">data =</span> Drugs)</span>
<span id="cb440-7"><a href="Loglinear.html#cb440-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb440-8"><a href="Loglinear.html#cb440-8" aria-hidden="true" tabindex="-1"></a><span class="co"># function to convert to a p-value and return &quot;&lt; 0.0...&quot; with a digit threshold </span></span>
<span id="cb440-9"><a href="Loglinear.html#cb440-9" aria-hidden="true" tabindex="-1"></a>residualP <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">digits =</span> <span class="dv">2</span>){</span>
<span id="cb440-10"><a href="Loglinear.html#cb440-10" aria-hidden="true" tabindex="-1"></a>  pValue <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">pchisq</span>(<span class="fu">deviance</span>(x), <span class="fu">df.residual</span>(x))</span>
<span id="cb440-11"><a href="Loglinear.html#cb440-11" aria-hidden="true" tabindex="-1"></a>  value <span class="ot">&lt;-</span> <span class="fu">format</span>(<span class="fu">round</span>(pValue, digits), <span class="at">scientific =</span> <span class="cn">FALSE</span>)</span>
<span id="cb440-12"><a href="Loglinear.html#cb440-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(value <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb440-13"><a href="Loglinear.html#cb440-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">&quot;&lt; 0.&quot;</span>, <span class="fu">strrep</span>(<span class="st">&quot;0&quot;</span>, digits<span class="dv">-1</span>), <span class="st">&quot;1&quot;</span>)</span>
<span id="cb440-14"><a href="Loglinear.html#cb440-14" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb440-15"><a href="Loglinear.html#cb440-15" aria-hidden="true" tabindex="-1"></a>      value</span>
<span id="cb440-16"><a href="Loglinear.html#cb440-16" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb440-17"><a href="Loglinear.html#cb440-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb440-18"><a href="Loglinear.html#cb440-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb440-19"><a href="Loglinear.html#cb440-19" aria-hidden="true" tabindex="-1"></a><span class="st">`</span><span class="at">Table 7.4</span><span class="st">`</span> <span class="ot">&lt;-</span>  </span>
<span id="cb440-20"><a href="Loglinear.html#cb440-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="at">Model =</span> <span class="fu">c</span>(<span class="st">&quot;(AC, AM)&quot;</span>, <span class="st">&quot;(AC, CM)&quot;</span>, <span class="st">&quot;(AM, CM)&quot;</span>, <span class="st">&quot;(AC, AM, CM)&quot;</span>),</span>
<span id="cb440-21"><a href="Loglinear.html#cb440-21" aria-hidden="true" tabindex="-1"></a>            <span class="at">Deviance =</span> <span class="fu">c</span>(<span class="fu">deviance</span>(AC_AM), <span class="fu">deviance</span>(AC_CM), <span class="fu">deviance</span>(AM_CM), <span class="fu">deviance</span>(AC_AM_CM)),</span>
<span id="cb440-22"><a href="Loglinear.html#cb440-22" aria-hidden="true" tabindex="-1"></a>            <span class="at">df =</span> <span class="fu">c</span>(<span class="fu">df.residual</span>(AC_AM), <span class="fu">df.residual</span>(AC_CM), <span class="fu">df.residual</span>(AC_AM), <span class="fu">df.residual</span>(AC_AM_CM)),</span>
<span id="cb440-23"><a href="Loglinear.html#cb440-23" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">P-value</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">residualP</span>(AC_AM, <span class="dv">4</span>), <span class="fu">residualP</span>(AC_CM, <span class="dv">4</span>), <span class="fu">residualP</span>(AC_AM, <span class="dv">4</span>), <span class="fu">residualP</span>(AC_AM_CM))) <span class="sc">%&gt;%</span> </span>
<span id="cb440-24"><a href="Loglinear.html#cb440-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Deviance =</span> <span class="fu">round</span>(Deviance, <span class="dv">1</span>))</span>
<span id="cb440-25"><a href="Loglinear.html#cb440-25" aria-hidden="true" tabindex="-1"></a>              </span>
<span id="cb440-26"><a href="Loglinear.html#cb440-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb440-27"><a href="Loglinear.html#cb440-27" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="st">`</span><span class="at">Table 7.4</span><span class="st">`</span>)</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
Model
</th>
<th style="text-align:right;">
Deviance
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:left;">
P-value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(AC, AM)
</td>
<td style="text-align:right;">
497.4
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
&lt; 0.0001
</td>
</tr>
<tr>
<td style="text-align:left;">
(AC, CM)
</td>
<td style="text-align:right;">
92.0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
&lt; 0.0001
</td>
</tr>
<tr>
<td style="text-align:left;">
(AM, CM)
</td>
<td style="text-align:right;">
187.8
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
&lt; 0.0001
</td>
</tr>
<tr>
<td style="text-align:left;">
(AC, AM, CM)
</td>
<td style="text-align:right;">
0.4
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
0.54
</td>
</tr>
</tbody>
</table>
</div>
<div id="x7.2.2" class="section level3 hasAnchor">
<h3>7.2.2 Cell Standardized Residuals for Loglinear Models<a href="Loglinear.html#x7.2.2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb441"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb441-1"><a href="Loglinear.html#cb441-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(count <span class="sc">~</span> A <span class="sc">+</span> C <span class="sc">+</span> M <span class="sc">+</span> A<span class="sc">:</span>C <span class="sc">+</span> A<span class="sc">:</span>M <span class="sc">+</span> C<span class="sc">:</span>M, <span class="at">family =</span> poisson, <span class="at">data =</span> Drugs)</span>
<span id="cb441-2"><a href="Loglinear.html#cb441-2" aria-hidden="true" tabindex="-1"></a>fit2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(count <span class="sc">~</span> A <span class="sc">+</span> C <span class="sc">+</span> M <span class="sc">+</span> A<span class="sc">:</span>M <span class="sc">+</span> C<span class="sc">:</span>M, <span class="at">family =</span> poisson, <span class="at">data =</span> Drugs)</span>
<span id="cb441-3"><a href="Loglinear.html#cb441-3" aria-hidden="true" tabindex="-1"></a><span class="fu">deviance</span>(fit)</span></code></pre></div>
<pre class="custom-output"><code>[1] 0.3739859</code></pre>
<div class="sourceCode" id="cb443"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb443-1"><a href="Loglinear.html#cb443-1" aria-hidden="true" tabindex="-1"></a><span class="fu">deviance</span>(fit2)</span></code></pre></div>
<pre class="custom-output"><code>[1] 187.7543</code></pre>
<div class="sourceCode" id="cb445"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb445-1"><a href="Loglinear.html#cb445-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">rstandard</span>(fit, <span class="at">type =</span> <span class="st">&quot;pearson&quot;</span>), <span class="dv">3</span>)</span>
<span id="cb445-2"><a href="Loglinear.html#cb445-2" aria-hidden="true" tabindex="-1"></a>res2 <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">rstandard</span>(fit2, <span class="at">type =</span> <span class="st">&quot;pearson&quot;</span>), <span class="dv">3</span>)</span>
<span id="cb445-3"><a href="Loglinear.html#cb445-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb445-4"><a href="Loglinear.html#cb445-4" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">Alcohol =</span> Drugs<span class="sc">$</span>A, <span class="at">Cigarettes =</span> Drugs<span class="sc">$</span>C, <span class="at">Marijuana =</span> Drugs<span class="sc">$</span>M, </span>
<span id="cb445-5"><a href="Loglinear.html#cb445-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">Count =</span> Drugs<span class="sc">$</span>count, </span>
<span id="cb445-6"><a href="Loglinear.html#cb445-6" aria-hidden="true" tabindex="-1"></a>           <span class="st">&quot;Fitted from fit&quot;</span> <span class="ot">=</span> <span class="fu">fitted</span>(fit), </span>
<span id="cb445-7"><a href="Loglinear.html#cb445-7" aria-hidden="true" tabindex="-1"></a>           <span class="st">&quot;Std. Resid. from fit&quot;</span> <span class="ot">=</span> <span class="fu">rstandard</span>(fit, <span class="at">type =</span> <span class="st">&quot;pearson&quot;</span>),</span>
<span id="cb445-8"><a href="Loglinear.html#cb445-8" aria-hidden="true" tabindex="-1"></a>           <span class="st">&quot;Fitted from fi2&quot;</span> <span class="ot">=</span> <span class="fu">fitted</span>(fit2), </span>
<span id="cb445-9"><a href="Loglinear.html#cb445-9" aria-hidden="true" tabindex="-1"></a>           <span class="st">&quot;Std. Resid. from fit2&quot;</span> <span class="ot">=</span> <span class="fu">rstandard</span>(fit2, <span class="at">type =</span> <span class="st">&quot;pearson&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb445-10"><a href="Loglinear.html#cb445-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">contains</span>(<span class="st">&quot;fit&quot;</span>), round, <span class="dv">3</span>))</span></code></pre></div>
<pre class="custom-output"><code># A tibble: 8 × 8
  Alcohol Cigarettes Marijuana Count `Fitted from fit` Std. Re…¹ Fitte…² Std. …³
  &lt;fct&gt;   &lt;fct&gt;      &lt;fct&gt;     &lt;int&gt;             &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
1 yes     yes        yes         911            910.       0.633  909.      3.70
2 yes     yes        no          538            539.      -0.633  439.     12.8 
3 yes     no         yes          44             44.6     -0.633   45.8    -3.70
4 yes     no         no          456            455.       0.633  555.    -12.8 
5 no      yes        yes           3              3.62    -0.633    4.76   -3.70
6 no      yes        no           43             42.4      0.633  142.    -12.8 
7 no      no         yes           2              1.38     0.633    0.24    3.70
8 no      no         no          279            280.      -0.633  180.     12.8 
# … with abbreviated variable names ¹​`Std. Resid. from fit`,
#   ²​`Fitted from fi2`, ³​`Std. Resid. from fit2`</code></pre>
</div>
<div id="significance-tests-about-conditional-associations" class="section level3 hasAnchor">
<h3>7.2.3 Significance Tests about Conditional Associations<a href="Loglinear.html#significance-tests-about-conditional-associations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb447"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb447-1"><a href="Loglinear.html#cb447-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb447-2"><a href="Loglinear.html#cb447-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(fit)</span></code></pre></div>
<pre class="custom-output"><code>Analysis of Deviance Table (Type II tests)

Response: count
    LR Chisq Df Pr(&gt;Chisq)    
A    1281.71  1  &lt; 2.2e-16 ***
C     227.81  1  &lt; 2.2e-16 ***
M      55.91  1  7.575e-14 ***
A:C   187.38  1  &lt; 2.2e-16 ***
A:M    91.64  1  &lt; 2.2e-16 ***
C:M   497.00  1  &lt; 2.2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="confidence-intervals-for-conditional-odds-ratios" class="section level3 hasAnchor">
<h3>7.2.4 Confidence Intervals for Conditional Odds Ratios<a href="Loglinear.html#confidence-intervals-for-conditional-odds-ratios" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb449"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb449-1"><a href="Loglinear.html#cb449-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(count <span class="sc">~</span> A <span class="sc">+</span> C <span class="sc">+</span> M <span class="sc">+</span> A<span class="sc">:</span>C <span class="sc">+</span> A<span class="sc">:</span>M <span class="sc">+</span> C<span class="sc">:</span>M, <span class="at">family =</span> poisson, <span class="at">data =</span> Drugs)</span>
<span id="cb449-2"><a href="Loglinear.html#cb449-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code></pre></div>
<pre class="custom-output"><code>
Call:
glm(formula = count ~ A + C + M + A:C + A:M + C:M, family = poisson, 
    data = Drugs)

Deviance Residuals: 
       1         2         3         4         5         6         7         8  
 0.02044  -0.02658  -0.09256   0.02890  -0.33428   0.09452   0.49134  -0.03690  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  5.63342    0.05970  94.361  &lt; 2e-16 ***
Ayes         0.48772    0.07577   6.437 1.22e-10 ***
Cyes        -1.88667    0.16270 -11.596  &lt; 2e-16 ***
Myes        -5.30904    0.47520 -11.172  &lt; 2e-16 ***
Ayes:Cyes    2.05453    0.17406  11.803  &lt; 2e-16 ***
Ayes:Myes    2.98601    0.46468   6.426 1.31e-10 ***
Cyes:Myes    2.84789    0.16384  17.382  &lt; 2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 2851.46098  on 7  degrees of freedom
Residual deviance:    0.37399  on 1  degrees of freedom
AIC: 63.417

Number of Fisher Scoring iterations: 4</code></pre>
<div class="sourceCode" id="cb451"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb451-1"><a href="Loglinear.html#cb451-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">confint</span>(fit))</span></code></pre></div>
<pre><code>Waiting for profiling to be done...</code></pre>
<pre class="custom-output"><code>                   2.5 %       97.5 %
(Intercept) 2.481623e+02 313.62395491
Ayes        1.404993e+00   1.89112888
Cyes        1.087964e-01   0.20616472
Myes        1.700562e-03   0.01136462
Ayes:Cyes   5.601452e+00  11.09714777
Ayes:Myes   8.814046e+00  56.64359514
Cyes:Myes   1.264576e+01  24.06925090</code></pre>
<blockquote>
<p>Caution: Notice the LCL is in scientific notation and UCL is not.</p>
</blockquote>
</div>
<div id="bayesian-fitting-of-loglinear-models" class="section level3 hasAnchor">
<h3>7.2.5 Bayesian Fitting of Loglinear Models<a href="Loglinear.html#bayesian-fitting-of-loglinear-models" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb454"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb454-1"><a href="Loglinear.html#cb454-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  library(MCMCpack)</span></span>
<span id="cb454-2"><a href="Loglinear.html#cb454-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb454-3"><a href="Loglinear.html#cb454-3" aria-hidden="true" tabindex="-1"></a>fitBayes <span class="ot">&lt;-</span> MCMCpack<span class="sc">::</span><span class="fu">MCMCpoisson</span>(count <span class="sc">~</span> A <span class="sc">+</span> C <span class="sc">+</span> M <span class="sc">+</span> A<span class="sc">:</span>C <span class="sc">+</span> A<span class="sc">:</span>M <span class="sc">+</span> C<span class="sc">:</span>M, </span>
<span id="cb454-4"><a href="Loglinear.html#cb454-4" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">family =</span> poisson, <span class="at">data =</span> Drugs)</span>
<span id="cb454-5"><a href="Loglinear.html#cb454-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fitBayes)</span></code></pre></div>
<pre class="custom-output"><code>
Iterations = 1001:11000
Thinning interval = 1 
Number of chains = 1 
Sample size per chain = 10000 

1. Empirical mean and standard deviation for each variable,
   plus standard error of the mean:

               Mean      SD  Naive SE Time-series SE
(Intercept)  5.6317 0.06074 0.0006074       0.002972
Ayes         0.4887 0.07724 0.0007724       0.003819
Cyes        -1.9087 0.16429 0.0016429       0.008122
Myes        -5.4132 0.52796 0.0052796       0.028710
Ayes:Cyes    2.0777 0.17597 0.0017597       0.008503
Ayes:Myes    3.0854 0.51755 0.0051755       0.028275
Cyes:Myes    2.8521 0.16623 0.0016623       0.008234

2. Quantiles for each variable:

              2.5%     25%     50%     75%   97.5%
(Intercept)  5.514  5.5910  5.6335  5.6734  5.7516
Ayes         0.341  0.4368  0.4876  0.5405  0.6403
Cyes        -2.236 -2.0164 -1.9130 -1.7984 -1.5781
Myes        -6.630 -5.7281 -5.3880 -5.0329 -4.5381
Ayes:Cyes    1.724  1.9634  2.0824  2.1995  2.4190
Ayes:Myes    2.200  2.7239  3.0505  3.3822  4.2256
Cyes:Myes    2.542  2.7370  2.8498  2.9643  3.1767</code></pre>
<div class="sourceCode" id="cb456"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb456-1"><a href="Loglinear.html#cb456-1" aria-hidden="true" tabindex="-1"></a><span class="co"># posterior prob. that AM log odds ratio &lt; 0 </span></span>
<span id="cb456-2"><a href="Loglinear.html#cb456-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (parameter 6 in model is AM log odds ratio)</span></span>
<span id="cb456-3"><a href="Loglinear.html#cb456-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(fitBayes[, <span class="dv">6</span>] <span class="sc">&lt;</span> <span class="dv">0</span>)</span></code></pre></div>
<pre class="custom-output"><code>[1] 0</code></pre>
</div>
<div id="loglinear-models-for-higher-dimensional-contingency-tables" class="section level3 hasAnchor">
<h3>7.2.6 Loglinear Models for Higher-Dimensional Contingency Tables<a href="Loglinear.html#loglinear-models-for-higher-dimensional-contingency-tables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="example-automobile-accidents-and-seat-belts" class="section level3 hasAnchor">
<h3>7.2.7 Example: Automobile Accidents and Seat Belts<a href="Loglinear.html#example-automobile-accidents-and-seat-belts" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="interpreting-three-factor-interaction-terms" class="section level3 hasAnchor">
<h3>7.2.8 Interpreting Three-Factor Interaction Terms<a href="Loglinear.html#interpreting-three-factor-interaction-terms" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb458"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb458-1"><a href="Loglinear.html#cb458-1" aria-hidden="true" tabindex="-1"></a>Accidents <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;http://users.stat.ufl.edu/~aa/cat/data/Accidents2.dat&quot;</span>,</span>
<span id="cb458-2"><a href="Loglinear.html#cb458-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">stringsAsFactors =</span> <span class="cn">TRUE</span>)</span>
<span id="cb458-3"><a href="Loglinear.html#cb458-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb458-4"><a href="Loglinear.html#cb458-4" aria-hidden="true" tabindex="-1"></a>Accidents <span class="sc">%&gt;%</span> </span>
<span id="cb458-5"><a href="Loglinear.html#cb458-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">row_number</span>() <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fu">n</span>())) </span></code></pre></div>
<pre class="custom-output"><code>  gender location seatbelt injury count
1 female    rural       no     no  3246
2   male    urban      yes    yes   380</code></pre>
<div class="sourceCode" id="cb460"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb460-1"><a href="Loglinear.html#cb460-1" aria-hidden="true" tabindex="-1"></a>Accidents <span class="ot">&lt;-</span> </span>
<span id="cb460-2"><a href="Loglinear.html#cb460-2" aria-hidden="true" tabindex="-1"></a>  Accidents <span class="sc">%&gt;%</span> </span>
<span id="cb460-3"><a href="Loglinear.html#cb460-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">&quot;G&quot;</span> <span class="ot">=</span> gender, <span class="st">&quot;L&quot;</span> <span class="ot">=</span> location, <span class="st">&quot;S&quot;</span> <span class="ot">=</span> seatbelt, <span class="st">&quot;I&quot;</span> <span class="ot">=</span> injury)</span>
<span id="cb460-4"><a href="Loglinear.html#cb460-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb460-5"><a href="Loglinear.html#cb460-5" aria-hidden="true" tabindex="-1"></a><span class="co"># G*I = G + I + G:I</span></span>
<span id="cb460-6"><a href="Loglinear.html#cb460-6" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(count <span class="sc">~</span> G<span class="sc">*</span>L<span class="sc">*</span>S <span class="sc">+</span> G<span class="sc">*</span>I <span class="sc">+</span> L<span class="sc">*</span>I <span class="sc">+</span> S<span class="sc">*</span>I, <span class="at">family =</span> poisson, <span class="at">data =</span> Accidents)</span>
<span id="cb460-7"><a href="Loglinear.html#cb460-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code></pre></div>
<pre class="custom-output"><code>
Call:
glm(formula = count ~ G * L * S + G * I + L * I + S * I, family = poisson, 
    data = Accidents)

Deviance Residuals: 
       1         2         3         4         5         6         7         8  
-0.15190   0.27851   0.51823  -1.44646   0.16160  -0.43483  -0.42327   1.69037  
       9        10        11        12        13        14        15        16  
-0.34700   0.83292  -0.05675   0.20564   0.21675  -0.76754   0.09329  -0.49684  

Coefficients:
                  Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)        8.08784    0.01654 488.884  &lt; 2e-16 ***
Gmale              0.63640    0.02015  31.579  &lt; 2e-16 ***
Lurban             0.80411    0.01966  40.891  &lt; 2e-16 ***
Syes               0.62713    0.02027  30.940  &lt; 2e-16 ***
Iyes              -1.21640    0.02649 -45.918  &lt; 2e-16 ***
Gmale:Lurban      -0.28274    0.02441 -11.584  &lt; 2e-16 ***
Gmale:Syes        -0.54186    0.02590 -20.925  &lt; 2e-16 ***
Lurban:Syes       -0.15752    0.02441  -6.453 1.09e-10 ***
Gmale:Iyes        -0.54483    0.02727 -19.982  &lt; 2e-16 ***
Lurban:Iyes       -0.75806    0.02697 -28.105  &lt; 2e-16 ***
Syes:Iyes         -0.81710    0.02765 -29.551  &lt; 2e-16 ***
Gmale:Lurban:Syes  0.12858    0.03228   3.984 6.78e-05 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 61709.5207  on 15  degrees of freedom
Residual deviance:     7.4645  on  4  degrees of freedom
AIC: 184.92

Number of Fisher Scoring iterations: 3</code></pre>
</div>
<div id="statistical-versus-practical-significance-dissimilarity-index" class="section level3 hasAnchor">
<h3>7.2.9 Statistical Versus Practical Significance: Dissimilarity Index<a href="Loglinear.html#statistical-versus-practical-significance-dissimilarity-index" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="math display">\[D = \sum |n_i - \hat\mu_i|/2n = \sum |p_i - \hat\pi_i|/2.\]</span></p>
<div class="sourceCode" id="cb462"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb462-1"><a href="Loglinear.html#cb462-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(count <span class="sc">~</span> G<span class="sc">*</span>L<span class="sc">*</span>S <span class="sc">+</span> G<span class="sc">*</span>I <span class="sc">+</span> L<span class="sc">*</span>I <span class="sc">+</span> S<span class="sc">*</span>I, <span class="at">family =</span> poisson, <span class="at">data =</span> Accidents)</span>
<span id="cb462-2"><a href="Loglinear.html#cb462-2" aria-hidden="true" tabindex="-1"></a><span class="co"># dissimilarity index for loglinear model (GLS, GI, LI, SI)</span></span>
<span id="cb462-3"><a href="Loglinear.html#cb462-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb462-4"><a href="Loglinear.html#cb462-4" aria-hidden="true" tabindex="-1"></a>DI <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">abs</span>(Accidents<span class="sc">$</span>count <span class="sc">-</span> <span class="fu">fitted</span>(fit)))<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span><span class="fu">sum</span>(Accidents<span class="sc">$</span>count))</span>
<span id="cb462-5"><a href="Loglinear.html#cb462-5" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(DI, <span class="dv">5</span>)</span></code></pre></div>
<pre class="custom-output"><code>[1] 0.00251</code></pre>
<div class="sourceCode" id="cb464"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb464-1"><a href="Loglinear.html#cb464-1" aria-hidden="true" tabindex="-1"></a>fit2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(count <span class="sc">~</span> G<span class="sc">*</span>L <span class="sc">+</span> G<span class="sc">*</span>S <span class="sc">+</span> G<span class="sc">*</span>I <span class="sc">+</span> L<span class="sc">*</span>S <span class="sc">+</span> L<span class="sc">*</span>I <span class="sc">+</span> S<span class="sc">*</span>I, <span class="at">family =</span> poisson, </span>
<span id="cb464-2"><a href="Loglinear.html#cb464-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> Accidents)</span>
<span id="cb464-3"><a href="Loglinear.html#cb464-3" aria-hidden="true" tabindex="-1"></a><span class="co"># dissimilarity index for loglinear model (GLS, GI, LI, SI)</span></span>
<span id="cb464-4"><a href="Loglinear.html#cb464-4" aria-hidden="true" tabindex="-1"></a>DI2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">abs</span>(Accidents<span class="sc">$</span>count <span class="sc">-</span> <span class="fu">fitted</span>(fit2)))<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span><span class="fu">sum</span>(Accidents<span class="sc">$</span>count))</span>
<span id="cb464-5"><a href="Loglinear.html#cb464-5" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(DI2, <span class="dv">5</span>)</span></code></pre></div>
<pre class="custom-output"><code>[1] 0.00822</code></pre>
</div>
</div>
<div id="the-loglinear---logistic-model-connection" class="section level2 hasAnchor">
<h2>7.3 The Loglinear - Logistic Model Connection<a href="Loglinear.html#the-loglinear---logistic-model-connection" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="using-logistic-models-to-interpret-loglinear-models" class="section level3 hasAnchor">
<h3>7.3.1 Using Logistic Models to Interpret Loglinear Models<a href="Loglinear.html#using-logistic-models-to-interpret-loglinear-models" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="example-auto-accident-data-revisited" class="section level3 hasAnchor">
<h3>7.3.2 Example: Auto Accident Data Revisited<a href="Loglinear.html#example-auto-accident-data-revisited" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="math display" id="eq:eq72">\[\begin{equation}
  \mathrm{logit}[P(I=1)]=\alpha + \beta_g^G + \beta_l^L + \beta_s^S.
  \tag{18}
\end{equation}\]</span></p>
<div class="sourceCode" id="cb466"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb466-1"><a href="Loglinear.html#cb466-1" aria-hidden="true" tabindex="-1"></a>Injury <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;http://users.stat.ufl.edu/~aa/cat/data/Injury_binom.dat&quot;</span>,</span>
<span id="cb466-2"><a href="Loglinear.html#cb466-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">stringsAsFactors =</span> <span class="cn">TRUE</span>)</span>
<span id="cb466-3"><a href="Loglinear.html#cb466-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb466-4"><a href="Loglinear.html#cb466-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 8 lines in data file, one for each binomial on injury given (G, L, S)</span></span>
<span id="cb466-5"><a href="Loglinear.html#cb466-5" aria-hidden="true" tabindex="-1"></a>Injury <span class="sc">%&gt;%</span> </span>
<span id="cb466-6"><a href="Loglinear.html#cb466-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">row_number</span>() <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="fu">n</span>())) </span></code></pre></div>
<pre class="custom-output"><code>  gender location seatbelt    no yes
1 female    urban       no  7287 996
2 female    urban      yes 11587 759
3   male    rural      yes  6693 513</code></pre>
<div class="sourceCode" id="cb468"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb468-1"><a href="Loglinear.html#cb468-1" aria-hidden="true" tabindex="-1"></a>Injury <span class="ot">&lt;-</span> Injury <span class="sc">%&gt;%</span> </span>
<span id="cb468-2"><a href="Loglinear.html#cb468-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">&quot;G&quot;</span> <span class="ot">=</span> gender,</span>
<span id="cb468-3"><a href="Loglinear.html#cb468-3" aria-hidden="true" tabindex="-1"></a>         <span class="st">&quot;L&quot;</span> <span class="ot">=</span> location,</span>
<span id="cb468-4"><a href="Loglinear.html#cb468-4" aria-hidden="true" tabindex="-1"></a>         <span class="st">&quot;S&quot;</span> <span class="ot">=</span> seatbelt)</span>
<span id="cb468-5"><a href="Loglinear.html#cb468-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb468-6"><a href="Loglinear.html#cb468-6" aria-hidden="true" tabindex="-1"></a>fit2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(yes<span class="sc">/</span>(no <span class="sc">+</span> yes) <span class="sc">~</span> G <span class="sc">+</span> L <span class="sc">+</span> S, <span class="at">family =</span> binomial, <span class="at">weights =</span> no<span class="sc">+</span>yes, </span>
<span id="cb468-7"><a href="Loglinear.html#cb468-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> Injury)</span>
<span id="cb468-8"><a href="Loglinear.html#cb468-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb468-9"><a href="Loglinear.html#cb468-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit2)</span></code></pre></div>
<pre class="custom-output"><code>
Call:
glm(formula = yes/(no + yes) ~ G + L + S, family = binomial, 
    data = Injury, weights = no + yes)

Deviance Residuals: 
      1        2        3        4        5        6        7        8  
-0.4639   1.7426   0.3172  -1.5365  -0.7976  -0.5055   0.9023   0.2133  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -1.21640    0.02649  -45.92   &lt;2e-16 ***
Gmale       -0.54483    0.02727  -19.98   &lt;2e-16 ***
Lurban      -0.75806    0.02697  -28.11   &lt;2e-16 ***
Syes        -0.81710    0.02765  -29.55   &lt;2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1912.4532  on 7  degrees of freedom
Residual deviance:    7.4645  on 4  degrees of freedom
AIC: 82.167

Number of Fisher Scoring iterations: 3</code></pre>
</div>
<div id="condition-for-equivalent-loglinear-and-logistic-models" class="section level3 hasAnchor">
<h3>7.3.3 Condition for Equivalent Loglinear and Logistic Models<a href="Loglinear.html#condition-for-equivalent-loglinear-and-logistic-models" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="loglinearlogistic-model-selection-issues" class="section level3 hasAnchor">
<h3>7.3.4 Loglinear/Logistic Model Selection Issues<a href="Loglinear.html#loglinearlogistic-model-selection-issues" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="independence-graphs-and-collapsibility" class="section level2 hasAnchor">
<h2>7.4 Independence Graphs and Collapsibility<a href="Loglinear.html#independence-graphs-and-collapsibility" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="independence-graphs" class="section level3 hasAnchor">
<h3>7.4.1 Independence Graphs<a href="Loglinear.html#independence-graphs" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb470"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb470-1"><a href="Loglinear.html#cb470-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb470-2"><a href="Loglinear.html#cb470-2" aria-hidden="true" tabindex="-1"></a><span class="co"># pairs of vertices to connect </span></span>
<span id="cb470-3"><a href="Loglinear.html#cb470-3" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">graph</span>(<span class="fu">c</span>(<span class="st">&quot;W&quot;</span>,<span class="st">&quot;X&quot;</span>,  <span class="st">&quot;Y&quot;</span>,<span class="st">&quot;Z&quot;</span>,  <span class="st">&quot;Y&quot;</span>,<span class="st">&quot;W&quot;</span>,  <span class="st">&quot;Z&quot;</span>,<span class="st">&quot;W&quot;</span>), <span class="at">directed =</span> <span class="cn">FALSE</span>)</span>
<span id="cb470-4"><a href="Loglinear.html#cb470-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb470-5"><a href="Loglinear.html#cb470-5" aria-hidden="true" tabindex="-1"></a>LO <span class="ot">&lt;-</span> <span class="fu">layout_nicely</span>(g) <span class="co"># original layout</span></span>
<span id="cb470-6"><a href="Loglinear.html#cb470-6" aria-hidden="true" tabindex="-1"></a>angle <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>pi <span class="sc">*</span> <span class="fl">7.495</span><span class="sc">/</span><span class="dv">12</span>  <span class="co"># amount of clock face to rotate</span></span>
<span id="cb470-7"><a href="Loglinear.html#cb470-7" aria-hidden="true" tabindex="-1"></a>RotMat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fu">cos</span>(angle),<span class="fu">sin</span>(angle),<span class="sc">-</span><span class="fu">sin</span>(angle), <span class="fu">cos</span>(angle)), <span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb470-8"><a href="Loglinear.html#cb470-8" aria-hidden="true" tabindex="-1"></a>LO2 <span class="ot">&lt;-</span> LO <span class="sc">%*%</span> RotMat</span>
<span id="cb470-9"><a href="Loglinear.html#cb470-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb470-10"><a href="Loglinear.html#cb470-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(g, <span class="at">vertex.shape =</span> <span class="st">&quot;none&quot;</span>, <span class="at">layout =</span> LO2)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-83-1.png" width="672" /></p>
<div class="sourceCode" id="cb471"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb471-1"><a href="Loglinear.html#cb471-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Manually draw the plot</span></span>
<span id="cb471-2"><a href="Loglinear.html#cb471-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>), </span>
<span id="cb471-3"><a href="Loglinear.html#cb471-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>), </span>
<span id="cb471-4"><a href="Loglinear.html#cb471-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">name =</span> <span class="fu">c</span>(<span class="st">&quot;X&quot;</span>, <span class="st">&quot;W&quot;</span>, <span class="st">&quot;Y&quot;</span>, <span class="st">&quot;Z&quot;</span>, <span class="st">&quot;W&quot;</span>) ) <span class="sc">%&gt;%</span> </span>
<span id="cb471-5"><a href="Loglinear.html#cb471-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb471-6"><a href="Loglinear.html#cb471-6" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_path</span>() <span class="sc">+</span></span>
<span id="cb471-7"><a href="Loglinear.html#cb471-7" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">8</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb471-8"><a href="Loglinear.html#cb471-8" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb471-9"><a href="Loglinear.html#cb471-9" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>name), <span class="at">hjust=</span> .<span class="dv">5</span>, <span class="at">vjust=</span> .<span class="dv">4</span>)</span></code></pre></div>
<div class="sourceCode" id="cb472"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb472-1"><a href="Loglinear.html#cb472-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), </span>
<span id="cb472-2"><a href="Loglinear.html#cb472-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), </span>
<span id="cb472-3"><a href="Loglinear.html#cb472-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">name =</span> <span class="fu">c</span>(<span class="st">&quot;W&quot;</span>, <span class="st">&quot;X&quot;</span>, <span class="st">&quot;Y&quot;</span>, <span class="st">&quot;Z&quot;</span>) ) <span class="sc">%&gt;%</span> </span>
<span id="cb472-4"><a href="Loglinear.html#cb472-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb472-5"><a href="Loglinear.html#cb472-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>() <span class="sc">+</span></span>
<span id="cb472-6"><a href="Loglinear.html#cb472-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">8</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb472-7"><a href="Loglinear.html#cb472-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb472-8"><a href="Loglinear.html#cb472-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>name), <span class="at">hjust=</span> .<span class="dv">5</span>, <span class="at">vjust=</span> .<span class="dv">4</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-85-1.png" width="672" /></p>
</div>
<div id="collapsibility-conditions-for-contingency-tables" class="section level3 hasAnchor">
<h3>7.4.2 Collapsibility Conditions for Contingency Tables<a href="Loglinear.html#collapsibility-conditions-for-contingency-tables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb473"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb473-1"><a href="Loglinear.html#cb473-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>), </span>
<span id="cb473-2"><a href="Loglinear.html#cb473-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), </span>
<span id="cb473-3"><a href="Loglinear.html#cb473-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">name =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;M&quot;</span>, <span class="st">&quot;C&quot;</span>) ) <span class="sc">%&gt;%</span> </span>
<span id="cb473-4"><a href="Loglinear.html#cb473-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb473-5"><a href="Loglinear.html#cb473-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>() <span class="sc">+</span></span>
<span id="cb473-6"><a href="Loglinear.html#cb473-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">8</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb473-7"><a href="Loglinear.html#cb473-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb473-8"><a href="Loglinear.html#cb473-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>name), <span class="at">hjust=</span> .<span class="dv">5</span>, <span class="at">vjust=</span> .<span class="dv">4</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-86-1.png" width="672" /></p>
<div class="sourceCode" id="cb474"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb474-1"><a href="Loglinear.html#cb474-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>), </span>
<span id="cb474-2"><a href="Loglinear.html#cb474-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), </span>
<span id="cb474-3"><a href="Loglinear.html#cb474-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">name =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>) ) <span class="sc">%&gt;%</span> </span>
<span id="cb474-4"><a href="Loglinear.html#cb474-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb474-5"><a href="Loglinear.html#cb474-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>() <span class="sc">+</span></span>
<span id="cb474-6"><a href="Loglinear.html#cb474-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">8</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb474-7"><a href="Loglinear.html#cb474-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb474-8"><a href="Loglinear.html#cb474-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>name), <span class="at">hjust=</span> .<span class="dv">5</span>, <span class="at">vjust=</span> .<span class="dv">4</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-87-1.png" width="672" /></p>
</div>
<div id="example-loglinear-model-building-for-student-substance-use" class="section level3 hasAnchor">
<h3>7.4.3 Example: Loglinear Model Building for Student Substance Use<a href="Loglinear.html#example-loglinear-model-building-for-student-substance-use" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb475"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb475-1"><a href="Loglinear.html#cb475-1" aria-hidden="true" tabindex="-1"></a>Drugs2 <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;http://users.stat.ufl.edu/~aa/cat/data/Substance2.dat&quot;</span>,</span>
<span id="cb475-2"><a href="Loglinear.html#cb475-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">stringsAsFactors =</span> <span class="cn">TRUE</span>)</span>
<span id="cb475-3"><a href="Loglinear.html#cb475-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb475-4"><a href="Loglinear.html#cb475-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb475-5"><a href="Loglinear.html#cb475-5" aria-hidden="true" tabindex="-1"></a><span class="st">`</span><span class="at">Table 7.5</span><span class="st">`</span> <span class="ot">&lt;-</span>  <span class="fu">bind_cols</span>(<span class="st">`</span><span class="at">Alcohol Use</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="st">&quot;No&quot;</span>, <span class="st">&quot;&quot;</span>),</span>
<span id="cb475-6"><a href="Loglinear.html#cb475-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Cigarette Use</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;No&quot;</span>),<span class="dv">2</span>),</span>
<span id="cb475-7"><a href="Loglinear.html#cb475-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">matrix</span>(Drugs2<span class="sc">$</span>count, <span class="at">ncol =</span> <span class="dv">8</span>,<span class="at">byrow =</span> T,</span>
<span id="cb475-8"><a href="Loglinear.html#cb475-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="cn">NULL</span>,</span>
<span id="cb475-9"><a href="Loglinear.html#cb475-9" aria-hidden="true" tabindex="-1"></a>         <span class="fu">c</span>(<span class="st">&quot;Y_F_W&quot;</span>, <span class="st">&quot;N_F_W&quot;</span>, <span class="st">&quot;Y_M_W&quot;</span>, <span class="st">&quot;N_M_W&quot;</span>, <span class="co"># Yes/No Female/Male whites</span></span>
<span id="cb475-10"><a href="Loglinear.html#cb475-10" aria-hidden="true" tabindex="-1"></a>           <span class="st">&quot;Y_F_O&quot;</span>, <span class="st">&quot;N_F_O&quot;</span>, <span class="st">&quot;Y_M_O&quot;</span>, <span class="st">&quot;N_M_O&quot;</span>))))  <span class="co"># whites</span></span>
<span id="cb475-11"><a href="Loglinear.html#cb475-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb475-12"><a href="Loglinear.html#cb475-12" aria-hidden="true" tabindex="-1"></a><span class="co">#knitr::kable(`Table 7.5`)</span></span>
<span id="cb475-13"><a href="Loglinear.html#cb475-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb475-14"><a href="Loglinear.html#cb475-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb475-15"><a href="Loglinear.html#cb475-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(flextable)</span>
<span id="cb475-16"><a href="Loglinear.html#cb475-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb475-17"><a href="Loglinear.html#cb475-17" aria-hidden="true" tabindex="-1"></a>my_header <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb475-18"><a href="Loglinear.html#cb475-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">col_keys=</span> <span class="fu">colnames</span>(<span class="st">`</span><span class="at">Table 7.5</span><span class="st">`</span>),</span>
<span id="cb475-19"><a href="Loglinear.html#cb475-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">line1 =</span> <span class="fu">c</span>(<span class="st">&quot;Alcohol Use&quot;</span>, <span class="st">&quot;Cigarette Use&quot;</span>, <span class="fu">rep</span>(<span class="st">&quot;Marijuna Use&quot;</span>, <span class="dv">8</span>)),</span>
<span id="cb475-20"><a href="Loglinear.html#cb475-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">line2 =</span> <span class="fu">c</span>(<span class="st">&quot;Alcohol Use&quot;</span>, <span class="st">&quot;Cigarette Use&quot;</span>, <span class="fu">rep</span>(<span class="st">&quot;White&quot;</span>, <span class="dv">4</span>), <span class="fu">rep</span>(<span class="st">&quot;Other&quot;</span>, <span class="dv">4</span>)),</span>
<span id="cb475-21"><a href="Loglinear.html#cb475-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">line3 =</span> <span class="fu">c</span>(<span class="st">&quot;Alcohol Use&quot;</span>, <span class="st">&quot;Cigarette Use&quot;</span>, <span class="fu">rep</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;Female&quot;</span>, <span class="dv">2</span>), <span class="fu">rep</span>(<span class="st">&quot;Male&quot;</span>, <span class="dv">2</span>)),<span class="dv">2</span>)),</span>
<span id="cb475-22"><a href="Loglinear.html#cb475-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">line4 =</span> <span class="fu">c</span>(<span class="st">&quot;Alcohol Use&quot;</span>, <span class="st">&quot;Cigarette Use&quot;</span>, <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;No&quot;</span>), <span class="dv">4</span>))</span>
<span id="cb475-23"><a href="Loglinear.html#cb475-23" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb475-24"><a href="Loglinear.html#cb475-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb475-25"><a href="Loglinear.html#cb475-25" aria-hidden="true" tabindex="-1"></a><span class="fu">flextable</span>(<span class="st">`</span><span class="at">Table 7.5</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb475-26"><a href="Loglinear.html#cb475-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_header_df</span>(</span>
<span id="cb475-27"><a href="Loglinear.html#cb475-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> my_header,</span>
<span id="cb475-28"><a href="Loglinear.html#cb475-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">key =</span> <span class="st">&quot;col_keys&quot;</span></span>
<span id="cb475-29"><a href="Loglinear.html#cb475-29" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb475-30"><a href="Loglinear.html#cb475-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_booktabs</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb475-31"><a href="Loglinear.html#cb475-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">merge_v</span>(<span class="at">part =</span> <span class="st">&quot;header&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb475-32"><a href="Loglinear.html#cb475-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">merge_h</span>(<span class="at">part =</span> <span class="st">&quot;header&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb475-33"><a href="Loglinear.html#cb475-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">align</span>(<span class="at">align =</span> <span class="st">&quot;center&quot;</span>, <span class="at">part =</span> <span class="st">&quot;all&quot;</span>)</span></code></pre></div>
<div class="tabwid"><style>.cl-ed211d8a{}.cl-ed1ae820{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-ed1d754a{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-ed1d87ec{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ed1d87f6{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ed1d87f7{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ed1d8800{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ed1d8801{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-ed211d8a'><thead><tr style="overflow-wrap:break-word;"><th  rowspan="4"class="cl-ed1d87ec"><p class="cl-ed1d754a"><span class="cl-ed1ae820">Alcohol Use</span></p></th><th  rowspan="4"class="cl-ed1d87ec"><p class="cl-ed1d754a"><span class="cl-ed1ae820">Cigarette Use</span></p></th><th  colspan="8"class="cl-ed1d87ec"><p class="cl-ed1d754a"><span class="cl-ed1ae820">Marijuna Use</span></p></th></tr><tr style="overflow-wrap:break-word;"><th  colspan="4"class="cl-ed1d87f6"><p class="cl-ed1d754a"><span class="cl-ed1ae820">White</span></p></th><th  colspan="4"class="cl-ed1d87f6"><p class="cl-ed1d754a"><span class="cl-ed1ae820">Other</span></p></th></tr><tr style="overflow-wrap:break-word;"><th  colspan="2"class="cl-ed1d87f6"><p class="cl-ed1d754a"><span class="cl-ed1ae820">Female</span></p></th><th  colspan="2"class="cl-ed1d87f6"><p class="cl-ed1d754a"><span class="cl-ed1ae820">Male</span></p></th><th  colspan="2"class="cl-ed1d87f6"><p class="cl-ed1d754a"><span class="cl-ed1ae820">Female</span></p></th><th  colspan="2"class="cl-ed1d87f6"><p class="cl-ed1d754a"><span class="cl-ed1ae820">Male</span></p></th></tr><tr style="overflow-wrap:break-word;"><th class="cl-ed1d87f7"><p class="cl-ed1d754a"><span class="cl-ed1ae820">Yes</span></p></th><th class="cl-ed1d87f7"><p class="cl-ed1d754a"><span class="cl-ed1ae820">No</span></p></th><th class="cl-ed1d87f7"><p class="cl-ed1d754a"><span class="cl-ed1ae820">Yes</span></p></th><th class="cl-ed1d87f7"><p class="cl-ed1d754a"><span class="cl-ed1ae820">No</span></p></th><th class="cl-ed1d87f7"><p class="cl-ed1d754a"><span class="cl-ed1ae820">Yes</span></p></th><th class="cl-ed1d87f7"><p class="cl-ed1d754a"><span class="cl-ed1ae820">No</span></p></th><th class="cl-ed1d87f7"><p class="cl-ed1d754a"><span class="cl-ed1ae820">Yes</span></p></th><th class="cl-ed1d87f7"><p class="cl-ed1d754a"><span class="cl-ed1ae820">No</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-ed1d8800"><p class="cl-ed1d754a"><span class="cl-ed1ae820">Yes</span></p></td><td class="cl-ed1d8800"><p class="cl-ed1d754a"><span class="cl-ed1ae820">Yes</span></p></td><td class="cl-ed1d8800"><p class="cl-ed1d754a"><span class="cl-ed1ae820">405</span></p></td><td class="cl-ed1d8800"><p class="cl-ed1d754a"><span class="cl-ed1ae820">268</span></p></td><td class="cl-ed1d8800"><p class="cl-ed1d754a"><span class="cl-ed1ae820">453</span></p></td><td class="cl-ed1d8800"><p class="cl-ed1d754a"><span class="cl-ed1ae820">228</span></p></td><td class="cl-ed1d8800"><p class="cl-ed1d754a"><span class="cl-ed1ae820">23</span></p></td><td class="cl-ed1d8800"><p class="cl-ed1d754a"><span class="cl-ed1ae820">23</span></p></td><td class="cl-ed1d8800"><p class="cl-ed1d754a"><span class="cl-ed1ae820">30</span></p></td><td class="cl-ed1d8800"><p class="cl-ed1d754a"><span class="cl-ed1ae820">19</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ed1d8800"><p class="cl-ed1d754a"><span class="cl-ed1ae820"></span></p></td><td class="cl-ed1d8800"><p class="cl-ed1d754a"><span class="cl-ed1ae820">No</span></p></td><td class="cl-ed1d8800"><p class="cl-ed1d754a"><span class="cl-ed1ae820">13</span></p></td><td class="cl-ed1d8800"><p class="cl-ed1d754a"><span class="cl-ed1ae820">218</span></p></td><td class="cl-ed1d8800"><p class="cl-ed1d754a"><span class="cl-ed1ae820">28</span></p></td><td class="cl-ed1d8800"><p class="cl-ed1d754a"><span class="cl-ed1ae820">201</span></p></td><td class="cl-ed1d8800"><p class="cl-ed1d754a"><span class="cl-ed1ae820">2</span></p></td><td class="cl-ed1d8800"><p class="cl-ed1d754a"><span class="cl-ed1ae820">19</span></p></td><td class="cl-ed1d8800"><p class="cl-ed1d754a"><span class="cl-ed1ae820">1</span></p></td><td class="cl-ed1d8800"><p class="cl-ed1d754a"><span class="cl-ed1ae820">18</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ed1d8800"><p class="cl-ed1d754a"><span class="cl-ed1ae820">No</span></p></td><td class="cl-ed1d8800"><p class="cl-ed1d754a"><span class="cl-ed1ae820">Yes</span></p></td><td class="cl-ed1d8800"><p class="cl-ed1d754a"><span class="cl-ed1ae820">1</span></p></td><td class="cl-ed1d8800"><p class="cl-ed1d754a"><span class="cl-ed1ae820">17</span></p></td><td class="cl-ed1d8800"><p class="cl-ed1d754a"><span class="cl-ed1ae820">1</span></p></td><td class="cl-ed1d8800"><p class="cl-ed1d754a"><span class="cl-ed1ae820">17</span></p></td><td class="cl-ed1d8800"><p class="cl-ed1d754a"><span class="cl-ed1ae820">0</span></p></td><td class="cl-ed1d8800"><p class="cl-ed1d754a"><span class="cl-ed1ae820">1</span></p></td><td class="cl-ed1d8800"><p class="cl-ed1d754a"><span class="cl-ed1ae820">1</span></p></td><td class="cl-ed1d8800"><p class="cl-ed1d754a"><span class="cl-ed1ae820">8</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ed1d8801"><p class="cl-ed1d754a"><span class="cl-ed1ae820"></span></p></td><td class="cl-ed1d8801"><p class="cl-ed1d754a"><span class="cl-ed1ae820">No</span></p></td><td class="cl-ed1d8801"><p class="cl-ed1d754a"><span class="cl-ed1ae820">1</span></p></td><td class="cl-ed1d8801"><p class="cl-ed1d754a"><span class="cl-ed1ae820">117</span></p></td><td class="cl-ed1d8801"><p class="cl-ed1d754a"><span class="cl-ed1ae820">1</span></p></td><td class="cl-ed1d8801"><p class="cl-ed1d754a"><span class="cl-ed1ae820">133</span></p></td><td class="cl-ed1d8801"><p class="cl-ed1d754a"><span class="cl-ed1ae820">0</span></p></td><td class="cl-ed1d8801"><p class="cl-ed1d754a"><span class="cl-ed1ae820">12</span></p></td><td class="cl-ed1d8801"><p class="cl-ed1d754a"><span class="cl-ed1ae820">0</span></p></td><td class="cl-ed1d8801"><p class="cl-ed1d754a"><span class="cl-ed1ae820">17</span></p></td></tr></tbody></table></div>
<div class="sourceCode" id="cb476"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb476-1"><a href="Loglinear.html#cb476-1" aria-hidden="true" tabindex="-1"></a>Drugs2 <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;http://users.stat.ufl.edu/~aa/cat/data/Substance2.dat&quot;</span>,</span>
<span id="cb476-2"><a href="Loglinear.html#cb476-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">stringsAsFactors =</span> <span class="cn">TRUE</span>)</span>
<span id="cb476-3"><a href="Loglinear.html#cb476-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb476-4"><a href="Loglinear.html#cb476-4" aria-hidden="true" tabindex="-1"></a><span class="co">#A &lt;- Drugs$alcohol</span></span>
<span id="cb476-5"><a href="Loglinear.html#cb476-5" aria-hidden="true" tabindex="-1"></a><span class="co">#C &lt;- Drugs$cigarettes</span></span>
<span id="cb476-6"><a href="Loglinear.html#cb476-6" aria-hidden="true" tabindex="-1"></a><span class="co">#M &lt;- Drugs$marijuana</span></span>
<span id="cb476-7"><a href="Loglinear.html#cb476-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb476-8"><a href="Loglinear.html#cb476-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb476-9"><a href="Loglinear.html#cb476-9" aria-hidden="true" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(count <span class="sc">~</span> A <span class="sc">+</span> C <span class="sc">+</span> M <span class="sc">+</span> R <span class="sc">+</span> G <span class="sc">+</span> G<span class="sc">:</span>R, <span class="at">family =</span> poisson, <span class="at">data =</span> Drugs2)</span>
<span id="cb476-10"><a href="Loglinear.html#cb476-10" aria-hidden="true" tabindex="-1"></a>fit2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(count <span class="sc">~</span> (A <span class="sc">+</span> C <span class="sc">+</span> M <span class="sc">+</span> R <span class="sc">+</span> G)<span class="sc">^</span><span class="dv">2</span>, <span class="at">family =</span> poisson, <span class="at">data =</span> Drugs2)</span>
<span id="cb476-11"><a href="Loglinear.html#cb476-11" aria-hidden="true" tabindex="-1"></a>fit3 <span class="ot">&lt;-</span> <span class="fu">glm</span>(count <span class="sc">~</span> (A <span class="sc">+</span> C <span class="sc">+</span> M <span class="sc">+</span> R <span class="sc">+</span> G)<span class="sc">^</span><span class="dv">3</span>, <span class="at">family =</span> poisson, <span class="at">data =</span> Drugs2)</span>
<span id="cb476-12"><a href="Loglinear.html#cb476-12" aria-hidden="true" tabindex="-1"></a>fit4 <span class="ot">&lt;-</span> <span class="fu">glm</span>(count <span class="sc">~</span> A <span class="sc">+</span> C <span class="sc">+</span> M <span class="sc">+</span> R <span class="sc">+</span> G <span class="sc">+</span> A<span class="sc">:</span>C <span class="sc">+</span> A<span class="sc">:</span>M <span class="sc">+</span> C<span class="sc">:</span>G <span class="sc">+</span> C<span class="sc">:</span>M <span class="sc">+</span> A<span class="sc">:</span>G <span class="sc">+</span> A<span class="sc">:</span>R <span class="sc">+</span> G<span class="sc">:</span>M <span class="sc">+</span> G<span class="sc">:</span>R <span class="sc">+</span> M<span class="sc">:</span>R, <span class="at">family =</span> poisson, <span class="at">data =</span> Drugs2)</span>
<span id="cb476-13"><a href="Loglinear.html#cb476-13" aria-hidden="true" tabindex="-1"></a>fit5 <span class="ot">&lt;-</span> <span class="fu">glm</span>(count <span class="sc">~</span> A <span class="sc">+</span> C <span class="sc">+</span> M <span class="sc">+</span> R <span class="sc">+</span> G <span class="sc">+</span> A<span class="sc">:</span>C <span class="sc">+</span> A<span class="sc">:</span>M <span class="sc">+</span>       C<span class="sc">:</span>M <span class="sc">+</span> A<span class="sc">:</span>G <span class="sc">+</span> A<span class="sc">:</span>R <span class="sc">+</span> G<span class="sc">:</span>M <span class="sc">+</span> G<span class="sc">:</span>R <span class="sc">+</span> M<span class="sc">:</span>R, <span class="at">family =</span> poisson, <span class="at">data =</span> Drugs2)</span>
<span id="cb476-14"><a href="Loglinear.html#cb476-14" aria-hidden="true" tabindex="-1"></a>fit6 <span class="ot">&lt;-</span> <span class="fu">glm</span>(count <span class="sc">~</span> A <span class="sc">+</span> C <span class="sc">+</span> M <span class="sc">+</span> R <span class="sc">+</span> G <span class="sc">+</span> A<span class="sc">:</span>C <span class="sc">+</span> A<span class="sc">:</span>M <span class="sc">+</span>       C<span class="sc">:</span>M <span class="sc">+</span> A<span class="sc">:</span>G <span class="sc">+</span> A<span class="sc">:</span>R <span class="sc">+</span> G<span class="sc">:</span>M <span class="sc">+</span> G<span class="sc">:</span>R, <span class="at">family =</span> poisson, <span class="at">data =</span> Drugs2)</span>
<span id="cb476-15"><a href="Loglinear.html#cb476-15" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(fit1)</span></span>
<span id="cb476-16"><a href="Loglinear.html#cb476-16" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(fit2)</span></span>
<span id="cb476-17"><a href="Loglinear.html#cb476-17" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(fit3)</span></span>
<span id="cb476-18"><a href="Loglinear.html#cb476-18" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(fit4)</span></span>
<span id="cb476-19"><a href="Loglinear.html#cb476-19" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(fit5)</span></span>
<span id="cb476-20"><a href="Loglinear.html#cb476-20" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(fit6)</span></span>
<span id="cb476-21"><a href="Loglinear.html#cb476-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb476-22"><a href="Loglinear.html#cb476-22" aria-hidden="true" tabindex="-1"></a><span class="st">`</span><span class="at">Table 7.9</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">Model =</span> <span class="fu">c</span>(<span class="st">&quot;1. Mutual independence + GR&quot;</span>, </span>
<span id="cb476-23"><a href="Loglinear.html#cb476-23" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;2. Homogeneous association&quot;</span>, </span>
<span id="cb476-24"><a href="Loglinear.html#cb476-24" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;3. All three-factor terms&quot;</span>,</span>
<span id="cb476-25"><a href="Loglinear.html#cb476-25" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;4. AC, AM, CG, CM, AG, AR, GM, GR, MR&quot;</span>,</span>
<span id="cb476-26"><a href="Loglinear.html#cb476-26" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;5. AC, AM,     CM, AG, AR, GM, GR, MR&quot;</span>,</span>
<span id="cb476-27"><a href="Loglinear.html#cb476-27" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;6. AC, AM,     CM, AG, AR, GM, GR&quot;</span>),</span>
<span id="cb476-28"><a href="Loglinear.html#cb476-28" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Deviance =</span> <span class="fu">c</span>(<span class="fu">deviance</span>(fit1), <span class="fu">deviance</span>(fit2), </span>
<span id="cb476-29"><a href="Loglinear.html#cb476-29" aria-hidden="true" tabindex="-1"></a>                                   <span class="fu">deviance</span>(fit3), <span class="fu">deviance</span>(fit4),</span>
<span id="cb476-30"><a href="Loglinear.html#cb476-30" aria-hidden="true" tabindex="-1"></a>                                   <span class="fu">deviance</span>(fit5), <span class="fu">deviance</span>(fit6)),</span>
<span id="cb476-31"><a href="Loglinear.html#cb476-31" aria-hidden="true" tabindex="-1"></a>                      <span class="at">df =</span> <span class="fu">c</span>(<span class="fu">df.residual</span>(fit1), <span class="fu">df.residual</span>(fit2), </span>
<span id="cb476-32"><a href="Loglinear.html#cb476-32" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">df.residual</span>(fit3), <span class="fu">df.residual</span>(fit4),</span>
<span id="cb476-33"><a href="Loglinear.html#cb476-33" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">df.residual</span>(fit5), <span class="fu">df.residual</span>(fit6))) <span class="sc">%&gt;%</span> </span>
<span id="cb476-34"><a href="Loglinear.html#cb476-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Deviance =</span> <span class="fu">round</span>(Deviance, <span class="dv">2</span>))</span>
<span id="cb476-35"><a href="Loglinear.html#cb476-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb476-36"><a href="Loglinear.html#cb476-36" aria-hidden="true" tabindex="-1"></a><span class="st">`</span><span class="at">Table 7.9</span><span class="st">`</span></span></code></pre></div>
<pre class="custom-output"><code># A tibble: 6 × 3
  Model                                 Deviance    df
  &lt;chr&gt;                                    &lt;dbl&gt; &lt;int&gt;
1 1. Mutual independence + GR            1325.      25
2 2. Homogeneous association               15.3     16
3 3. All three-factor terms                 5.27     6
4 4. AC, AM, CG, CM, AG, AR, GM, GR, MR    15.8     17
5 5. AC, AM,     CM, AG, AR, GM, GR, MR    16.7     18
6 6. AC, AM,     CM, AG, AR, GM, GR        19.9     19</code></pre>
</div>
<div id="collapsibility-and-logistic-models" class="section level3 hasAnchor">
<h3>7.4.4 Collapsibility and Logistic Models<a href="Loglinear.html#collapsibility-and-logistic-models" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="modeling-ordinal-associations-in-contingency-tables" class="section level2 hasAnchor">
<h2>7.5 Modeling Ordinal Associations in Contingency Tables<a href="Loglinear.html#modeling-ordinal-associations-in-contingency-tables" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb478"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb478-1"><a href="Loglinear.html#cb478-1" aria-hidden="true" tabindex="-1"></a>Teenagers <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;http://users.stat.ufl.edu/~aa/cat/data/Teenagers.dat&quot;</span>,</span>
<span id="cb478-2"><a href="Loglinear.html#cb478-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">stringsAsFactors =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb478-3"><a href="Loglinear.html#cb478-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Premarital Sex</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">recode_factor</span>(sex, <span class="st">&quot;1&quot;</span> <span class="ot">=</span> <span class="st">&quot;Always wrong&quot;</span>, </span>
<span id="cb478-4"><a href="Loglinear.html#cb478-4" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&quot;2&quot;</span> <span class="ot">=</span> <span class="st">&quot;Almost always wrong&quot;</span>,</span>
<span id="cb478-5"><a href="Loglinear.html#cb478-5" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&quot;3&quot;</span> <span class="ot">=</span> <span class="st">&quot;Wrong only sometimes&quot;</span>,</span>
<span id="cb478-6"><a href="Loglinear.html#cb478-6" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&quot;4&quot;</span> <span class="ot">=</span> <span class="st">&quot;Not wrong at all&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb478-7"><a href="Loglinear.html#cb478-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Teenage Birth Control</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">recode_factor</span>(birth, <span class="st">&quot;1&quot;</span> <span class="ot">=</span> <span class="st">&quot;Strongly Disagree&quot;</span>, </span>
<span id="cb478-8"><a href="Loglinear.html#cb478-8" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">&quot;2&quot;</span> <span class="ot">=</span> <span class="st">&quot;Disagree&quot;</span>,</span>
<span id="cb478-9"><a href="Loglinear.html#cb478-9" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">&quot;3&quot;</span> <span class="ot">=</span> <span class="st">&quot;Agree&quot;</span>,</span>
<span id="cb478-10"><a href="Loglinear.html#cb478-10" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">&quot;4&quot;</span> <span class="ot">=</span> <span class="st">&quot;Strongly Agree&quot;</span>))</span>
<span id="cb478-11"><a href="Loglinear.html#cb478-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb478-12"><a href="Loglinear.html#cb478-12" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(count <span class="sc">~</span> <span class="fu">factor</span>(sex) <span class="sc">+</span> <span class="fu">factor</span>(birth), <span class="at">family=</span>poisson, </span>
<span id="cb478-13"><a href="Loglinear.html#cb478-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">data =</span> Teenagers)</span>
<span id="cb478-14"><a href="Loglinear.html#cb478-14" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(fit)  # shows Residual deviance: 127.65  on  9  degrees of freedom</span></span>
<span id="cb478-15"><a href="Loglinear.html#cb478-15" aria-hidden="true" tabindex="-1"></a><span class="co">#fitted(fit)</span></span>
<span id="cb478-16"><a href="Loglinear.html#cb478-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb478-17"><a href="Loglinear.html#cb478-17" aria-hidden="true" tabindex="-1"></a>fitLinear <span class="ot">&lt;-</span> <span class="fu">glm</span>(count <span class="sc">~</span> <span class="fu">factor</span>(sex) <span class="sc">+</span> <span class="fu">factor</span>(birth) <span class="sc">+</span> sex<span class="sc">:</span>birth, <span class="at">family=</span>poisson, </span>
<span id="cb478-18"><a href="Loglinear.html#cb478-18" aria-hidden="true" tabindex="-1"></a>           <span class="at">data =</span> Teenagers)</span>
<span id="cb478-19"><a href="Loglinear.html#cb478-19" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(fitLinear)  # Residual deviance:  11.534  on  8  degrees of freedom</span></span>
<span id="cb478-20"><a href="Loglinear.html#cb478-20" aria-hidden="true" tabindex="-1"></a><span class="co">#fitted(fitLinear)</span></span>
<span id="cb478-21"><a href="Loglinear.html#cb478-21" aria-hidden="true" tabindex="-1"></a><span class="co"># raw data </span></span>
<span id="cb478-22"><a href="Loglinear.html#cb478-22" aria-hidden="true" tabindex="-1"></a><span class="co"># xtabs(Teenagers$count ~ Teenagers$sex + Teenagers$birth)</span></span>
<span id="cb478-23"><a href="Loglinear.html#cb478-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb478-24"><a href="Loglinear.html#cb478-24" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(Teenagers, <span class="fu">xtabs</span>(count <span class="sc">~</span> <span class="st">`</span><span class="at">Premarital Sex</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">Teenage Birth Control</span><span class="st">`</span>))</span></code></pre></div>
<pre class="custom-output"><code>                      Teenage Birth Control
Premarital Sex         Strongly Disagree Disagree Agree Strongly Agree
  Always wrong                        81       68    60             38
  Almost always wrong                 24       26    29             14
  Wrong only sometimes                18       41    74             42
  Not wrong at all                    36       57   161            157</code></pre>
<div class="sourceCode" id="cb480"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb480-1"><a href="Loglinear.html#cb480-1" aria-hidden="true" tabindex="-1"></a>TeenagersPlus <span class="ot">&lt;-</span> <span class="fu">bind_cols</span>(Teenagers, <span class="at">independence =</span> <span class="fu">round</span>(<span class="fu">fitted</span>(fit), <span class="dv">1</span>), </span>
<span id="cb480-2"><a href="Loglinear.html#cb480-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">linear =</span> <span class="fu">round</span>(<span class="fu">fitted</span>(fitLinear), <span class="dv">1</span>))</span>
<span id="cb480-3"><a href="Loglinear.html#cb480-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb480-4"><a href="Loglinear.html#cb480-4" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(TeenagersPlus, <span class="fu">xtabs</span>(independence <span class="sc">~</span> <span class="st">`</span><span class="at">Premarital Sex</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">Teenage Birth Control</span><span class="st">`</span>))</span></code></pre></div>
<pre class="custom-output"><code>                      Teenage Birth Control
Premarital Sex         Strongly Disagree Disagree Agree Strongly Agree
  Always wrong                      42.4     51.2  86.4           67.0
  Almost always wrong               16.0     19.3  32.5           25.2
  Wrong only sometimes              30.0     36.3  61.2           47.4
  Not wrong at all                  70.6     85.2 143.8          111.4</code></pre>
<div class="sourceCode" id="cb482"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb482-1"><a href="Loglinear.html#cb482-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(TeenagersPlus, <span class="fu">xtabs</span>(linear <span class="sc">~</span> <span class="st">`</span><span class="at">Premarital Sex</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">Teenage Birth Control</span><span class="st">`</span>))</span></code></pre></div>
<pre class="custom-output"><code>                      Teenage Birth Control
Premarital Sex         Strongly Disagree Disagree Agree Strongly Agree
  Always wrong                      80.9     67.7  69.4           29.1
  Almost always wrong               20.8     23.1  31.5           17.6
  Wrong only sometimes              24.4     36.2  65.7           48.8
  Not wrong at all                  33.0     65.1 157.4          155.5</code></pre>
<div id="linear-by-linear-association-model" class="section level3 hasAnchor">
<h3>7.5.1 Linear-by-Linear Association Model<a href="Loglinear.html#linear-by-linear-association-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="math display">\[\mathrm{log}\mu_{ij}= \lambda + \lambda_i^X + \lambda_j^Y + \beta\upsilon_i\nu_j.\]</span>
<span class="math display" id="eq:eq73">\[\begin{equation}
  \frac{\mu_{ab}\mu_{cd}}{\mu_{ad}\mu_{cg}} = \mathrm{exp}[\beta(\upsilon_c - \upsilon_a)(\nu_d - \nu_b)]
  \tag{19}
\end{equation}\]</span></p>
</div>
<div id="example-linear-by-linear-association-for-sex-opinions" class="section level3 hasAnchor">
<h3>7.5.2 Example: Linear-by-Linear Association for Sex Opinions<a href="Loglinear.html#example-linear-by-linear-association-for-sex-opinions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb484"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb484-1"><a href="Loglinear.html#cb484-1" aria-hidden="true" tabindex="-1"></a>Teenagers <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;http://users.stat.ufl.edu/~aa/cat/data/Teenagers.dat&quot;</span>,</span>
<span id="cb484-2"><a href="Loglinear.html#cb484-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">stringsAsFactors =</span> <span class="cn">TRUE</span>)</span>
<span id="cb484-3"><a href="Loglinear.html#cb484-3" aria-hidden="true" tabindex="-1"></a>Teenagers <span class="sc">%&gt;%</span> </span>
<span id="cb484-4"><a href="Loglinear.html#cb484-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">row_number</span>() <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="fu">n</span>())) </span></code></pre></div>
<pre class="custom-output"><code>  sex birth count
1   1     1    81
2   1     2    68
3   4     4   157</code></pre>
<div class="sourceCode" id="cb486"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb486-1"><a href="Loglinear.html#cb486-1" aria-hidden="true" tabindex="-1"></a><span class="co"># quantitative sex-by birth interaction term</span></span>
<span id="cb486-2"><a href="Loglinear.html#cb486-2" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(count <span class="sc">~</span> <span class="fu">factor</span>(sex) <span class="sc">+</span> <span class="fu">factor</span>(birth) <span class="sc">+</span> sex<span class="sc">:</span>birth, <span class="at">family=</span>poisson, </span>
<span id="cb486-3"><a href="Loglinear.html#cb486-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">data =</span> Teenagers)</span>
<span id="cb486-4"><a href="Loglinear.html#cb486-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code></pre></div>
<pre class="custom-output"><code>
Call:
glm(formula = count ~ factor(sex) + factor(birth) + sex:birth, 
    family = poisson, data = Teenagers)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-1.35834  -0.91606   0.07972   0.61648   1.57618  

Coefficients:
               Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)     4.10684    0.08951  45.881  &lt; 2e-16 ***
factor(sex)2   -1.64596    0.13473 -12.216  &lt; 2e-16 ***
factor(sex)3   -1.77002    0.16464 -10.751  &lt; 2e-16 ***
factor(sex)4   -1.75369    0.23432  -7.484 7.20e-14 ***
factor(birth)2 -0.46411    0.11952  -3.883 0.000103 ***
factor(birth)3 -0.72452    0.16201  -4.472 7.74e-06 ***
factor(birth)4 -1.87966    0.24910  -7.546 4.50e-14 ***
sex:birth       0.28584    0.02824  10.122  &lt; 2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 431.078  on 15  degrees of freedom
Residual deviance:  11.534  on  8  degrees of freedom
AIC: 118.21

Number of Fisher Scoring iterations: 4</code></pre>
<div class="sourceCode" id="cb488"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb488-1"><a href="Loglinear.html#cb488-1" aria-hidden="true" tabindex="-1"></a><span class="co"># interaction is likelihood ratio test for L x L association term</span></span>
<span id="cb488-2"><a href="Loglinear.html#cb488-2" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(fit)</span></code></pre></div>
<pre class="custom-output"><code>Analysis of Deviance Table (Type II tests)

Response: count
              LR Chisq Df Pr(&gt;Chisq)    
factor(sex)    201.042  3  &lt; 2.2e-16 ***
factor(birth)   91.243  3  &lt; 2.2e-16 ***
sex:birth      116.119  1  &lt; 2.2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p><span class="math display">\[\mathrm{exp}[\beta(\upsilon_4 - \upsilon_1)(\nu_4 - \nu_1)] = \mathrm{exp}[0.286(4-1)(4-1) = 13.1\]</span></p>
</div>
<div id="ordinal-significance-tests-of-independence" class="section level3 hasAnchor">
<h3>7.5.3 Ordinal Significance Tests of Independence<a href="Loglinear.html#ordinal-significance-tests-of-independence" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="loglinear-modeling-of-count-response-variables" class="section level2 hasAnchor">
<h2>7.6 Loglinear Modeling of Count Response Variables *<a href="Loglinear.html#loglinear-modeling-of-count-response-variables" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="count-regressoin-modeling-of-rate-data" class="section level3 hasAnchor">
<h3>7.6.1 Count Regressoin Modeling of Rate Data<a href="Loglinear.html#count-regressoin-modeling-of-rate-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="math display">\[\mathrm{log}(\mu/t)= \alpha + \beta_1 x_1 + \cdots + \beta_p x_p.\]</span></p>
<p><span class="math display">\[\mathrm{log} \mu - \mathrm{log} t = \alpha + \beta_1 x_1 + \cdots + \beta_p x_p.\]</span></p>
<p><span class="math display">\[\mu = t\ \mathrm{exp}(\alpha + \beta_1 x_1 + \cdots + \beta_p x_p).\]</span></p>
</div>
<div id="example-death-rates-for-lung-cancer-patients" class="section level3 hasAnchor">
<h3>7.6.2 Example: Death Rates for Lung Cancer Patients<a href="Loglinear.html#example-death-rates-for-lung-cancer-patients" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb490"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb490-1"><a href="Loglinear.html#cb490-1" aria-hidden="true" tabindex="-1"></a>Cancer <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;http://users.stat.ufl.edu/~aa/cat/data/Cancer.dat&quot;</span>,</span>
<span id="cb490-2"><a href="Loglinear.html#cb490-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">stringsAsFactors =</span> <span class="cn">TRUE</span>)</span>
<span id="cb490-3"><a href="Loglinear.html#cb490-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb490-4"><a href="Loglinear.html#cb490-4" aria-hidden="true" tabindex="-1"></a>cancerCountWide <span class="ot">&lt;-</span> Cancer <span class="sc">%&gt;%</span> </span>
<span id="cb490-5"><a href="Loglinear.html#cb490-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>risktime) <span class="sc">%&gt;%</span> </span>
<span id="cb490-6"><a href="Loglinear.html#cb490-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">id_cols =</span> time, <span class="at">names_from =</span> <span class="fu">c</span>(histology, stage), </span>
<span id="cb490-7"><a href="Loglinear.html#cb490-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from=</span>count) <span class="sc">%&gt;%</span> </span>
<span id="cb490-8"><a href="Loglinear.html#cb490-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">time =</span> <span class="fu">case_when</span>(time <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">&quot;0-2&quot;</span>,</span>
<span id="cb490-9"><a href="Loglinear.html#cb490-9" aria-hidden="true" tabindex="-1"></a>                          time <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="st">&quot;2-4&quot;</span>,</span>
<span id="cb490-10"><a href="Loglinear.html#cb490-10" aria-hidden="true" tabindex="-1"></a>                          time <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="st">&quot;4-6&quot;</span>,</span>
<span id="cb490-11"><a href="Loglinear.html#cb490-11" aria-hidden="true" tabindex="-1"></a>                          time <span class="sc">==</span> <span class="dv">4</span> <span class="sc">~</span> <span class="st">&quot;6-8&quot;</span>,</span>
<span id="cb490-12"><a href="Loglinear.html#cb490-12" aria-hidden="true" tabindex="-1"></a>                          time <span class="sc">==</span> <span class="dv">5</span> <span class="sc">~</span> <span class="st">&quot;8-10&quot;</span>,</span>
<span id="cb490-13"><a href="Loglinear.html#cb490-13" aria-hidden="true" tabindex="-1"></a>                          time <span class="sc">==</span> <span class="dv">6</span> <span class="sc">~</span> <span class="st">&quot;10-12&quot;</span>,</span>
<span id="cb490-14"><a href="Loglinear.html#cb490-14" aria-hidden="true" tabindex="-1"></a>                          time <span class="sc">==</span> <span class="dv">7</span> <span class="sc">~</span> <span class="st">&quot;12+&quot;</span>,)) <span class="sc">%&gt;%</span> </span>
<span id="cb490-15"><a href="Loglinear.html#cb490-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">histo</span><span class="st">`</span> <span class="ot">=</span> <span class="st">&quot; &quot;</span>) <span class="sc">%&gt;%</span> <span class="co"># blank column for column headings</span></span>
<span id="cb490-16"><a href="Loglinear.html#cb490-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(time, histo, <span class="fu">everything</span>())</span>
<span id="cb490-17"><a href="Loglinear.html#cb490-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb490-18"><a href="Loglinear.html#cb490-18" aria-hidden="true" tabindex="-1"></a>cancerRiskTimeWide <span class="ot">&lt;-</span> Cancer <span class="sc">%&gt;%</span> </span>
<span id="cb490-19"><a href="Loglinear.html#cb490-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>count) <span class="sc">%&gt;%</span> </span>
<span id="cb490-20"><a href="Loglinear.html#cb490-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">risktime =</span> <span class="fu">paste0</span>(<span class="st">&quot;(&quot;</span>, risktime, <span class="st">&quot;)&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb490-21"><a href="Loglinear.html#cb490-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">id_cols =</span> time, <span class="at">names_from =</span> <span class="fu">c</span>(histology, stage), </span>
<span id="cb490-22"><a href="Loglinear.html#cb490-22" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from=</span>risktime) <span class="sc">%&gt;%</span> </span>
<span id="cb490-23"><a href="Loglinear.html#cb490-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">time =</span> <span class="fu">case_when</span>(time <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">&quot;0-2&quot;</span>,</span>
<span id="cb490-24"><a href="Loglinear.html#cb490-24" aria-hidden="true" tabindex="-1"></a>                          time <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="st">&quot;2-4&quot;</span>,</span>
<span id="cb490-25"><a href="Loglinear.html#cb490-25" aria-hidden="true" tabindex="-1"></a>                          time <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="st">&quot;4-6&quot;</span>,</span>
<span id="cb490-26"><a href="Loglinear.html#cb490-26" aria-hidden="true" tabindex="-1"></a>                          time <span class="sc">==</span> <span class="dv">4</span> <span class="sc">~</span> <span class="st">&quot;6-8&quot;</span>,</span>
<span id="cb490-27"><a href="Loglinear.html#cb490-27" aria-hidden="true" tabindex="-1"></a>                          time <span class="sc">==</span> <span class="dv">5</span> <span class="sc">~</span> <span class="st">&quot;8-10&quot;</span>,</span>
<span id="cb490-28"><a href="Loglinear.html#cb490-28" aria-hidden="true" tabindex="-1"></a>                          time <span class="sc">==</span> <span class="dv">6</span> <span class="sc">~</span> <span class="st">&quot;10-12&quot;</span>,</span>
<span id="cb490-29"><a href="Loglinear.html#cb490-29" aria-hidden="true" tabindex="-1"></a>                          time <span class="sc">==</span> <span class="dv">7</span> <span class="sc">~</span> <span class="st">&quot;12+&quot;</span>,)) <span class="sc">%&gt;%</span> </span>
<span id="cb490-30"><a href="Loglinear.html#cb490-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">histo</span><span class="st">`</span> <span class="ot">=</span> <span class="st">&quot; &quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb490-31"><a href="Loglinear.html#cb490-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(time, histo, <span class="fu">everything</span>())</span>
<span id="cb490-32"><a href="Loglinear.html#cb490-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb490-33"><a href="Loglinear.html#cb490-33" aria-hidden="true" tabindex="-1"></a><span class="co"># function to interleave two matrices</span></span>
<span id="cb490-34"><a href="Loglinear.html#cb490-34" aria-hidden="true" tabindex="-1"></a><span class="co"># https://stackoverflow.com/questions/19781723/interleave-rows-of-matrix-stored-in-a-list-in-r</span></span>
<span id="cb490-35"><a href="Loglinear.html#cb490-35" aria-hidden="true" tabindex="-1"></a><span class="co"># https://gist.github.com/mrdwab/7313857</span></span>
<span id="cb490-36"><a href="Loglinear.html#cb490-36" aria-hidden="true" tabindex="-1"></a>Interleave <span class="ot">&lt;-</span> <span class="cf">function</span>(myList, <span class="at">append.source =</span> <span class="cn">TRUE</span>, <span class="at">sep =</span> <span class="st">&quot;: &quot;</span>, <span class="at">drop =</span> <span class="cn">FALSE</span>) {</span>
<span id="cb490-37"><a href="Loglinear.html#cb490-37" aria-hidden="true" tabindex="-1"></a>  sources <span class="ot">&lt;-</span> myList</span>
<span id="cb490-38"><a href="Loglinear.html#cb490-38" aria-hidden="true" tabindex="-1"></a>  sources[<span class="fu">sapply</span>(sources, is.null)] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb490-39"><a href="Loglinear.html#cb490-39" aria-hidden="true" tabindex="-1"></a>  sources <span class="ot">&lt;-</span> <span class="fu">lapply</span>(sources, <span class="cf">function</span>(x) {</span>
<span id="cb490-40"><a href="Loglinear.html#cb490-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">is.matrix</span>(x) <span class="sc">||</span> <span class="fu">is.data.frame</span>(x)) {</span>
<span id="cb490-41"><a href="Loglinear.html#cb490-41" aria-hidden="true" tabindex="-1"></a>      x</span>
<span id="cb490-42"><a href="Loglinear.html#cb490-42" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb490-43"><a href="Loglinear.html#cb490-43" aria-hidden="true" tabindex="-1"></a>      <span class="fu">t</span>(x)</span>
<span id="cb490-44"><a href="Loglinear.html#cb490-44" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb490-45"><a href="Loglinear.html#cb490-45" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb490-46"><a href="Loglinear.html#cb490-46" aria-hidden="true" tabindex="-1"></a>  nrows <span class="ot">&lt;-</span> <span class="fu">sapply</span>(sources, nrow)</span>
<span id="cb490-47"><a href="Loglinear.html#cb490-47" aria-hidden="true" tabindex="-1"></a>  mrows <span class="ot">&lt;-</span> <span class="fu">max</span>(nrows)</span>
<span id="cb490-48"><a href="Loglinear.html#cb490-48" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(nrows <span class="sc">!=</span> mrows <span class="sc">&amp;</span> nrows <span class="sc">!=</span> <span class="dv">1</span>)) {</span>
<span id="cb490-49"><a href="Loglinear.html#cb490-49" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;Arguments have differening numbers of rows.&quot;</span>)</span>
<span id="cb490-50"><a href="Loglinear.html#cb490-50" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb490-51"><a href="Loglinear.html#cb490-51" aria-hidden="true" tabindex="-1"></a>  sources <span class="ot">&lt;-</span> <span class="fu">lapply</span>(sources, <span class="cf">function</span>(x) {</span>
<span id="cb490-52"><a href="Loglinear.html#cb490-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(x) <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb490-53"><a href="Loglinear.html#cb490-53" aria-hidden="true" tabindex="-1"></a>      x[<span class="fu">rep</span>(<span class="dv">1</span>, mrows), , drop <span class="ot">=</span> drop]</span>
<span id="cb490-54"><a href="Loglinear.html#cb490-54" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb490-55"><a href="Loglinear.html#cb490-55" aria-hidden="true" tabindex="-1"></a>      x</span>
<span id="cb490-56"><a href="Loglinear.html#cb490-56" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb490-57"><a href="Loglinear.html#cb490-57" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb490-58"><a href="Loglinear.html#cb490-58" aria-hidden="true" tabindex="-1"></a>  tmp <span class="ot">&lt;-</span> <span class="fu">do.call</span>(<span class="st">&quot;rbind&quot;</span>, sources)</span>
<span id="cb490-59"><a href="Loglinear.html#cb490-59" aria-hidden="true" tabindex="-1"></a>  nsources <span class="ot">&lt;-</span> <span class="fu">length</span>(sources)</span>
<span id="cb490-60"><a href="Loglinear.html#cb490-60" aria-hidden="true" tabindex="-1"></a>  indexes <span class="ot">&lt;-</span> <span class="fu">outer</span>((<span class="dv">0</span><span class="sc">:</span>(nsources <span class="sc">-</span> <span class="dv">1</span>)) <span class="sc">*</span> mrows, <span class="dv">1</span><span class="sc">:</span>mrows, <span class="st">&quot;+&quot;</span>)</span>
<span id="cb490-61"><a href="Loglinear.html#cb490-61" aria-hidden="true" tabindex="-1"></a>  retval <span class="ot">&lt;-</span> tmp[indexes, , drop <span class="ot">=</span> drop]</span>
<span id="cb490-62"><a href="Loglinear.html#cb490-62" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (append.source <span class="sc">&amp;&amp;</span> <span class="sc">!</span><span class="fu">is.null</span>(<span class="fu">names</span>(sources))) {</span>
<span id="cb490-63"><a href="Loglinear.html#cb490-63" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(<span class="fu">row.names</span>(tmp))) {</span>
<span id="cb490-64"><a href="Loglinear.html#cb490-64" aria-hidden="true" tabindex="-1"></a>      <span class="fu">row.names</span>(retval) <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="fu">format</span>(<span class="fu">row.names</span>(retval)),</span>
<span id="cb490-65"><a href="Loglinear.html#cb490-65" aria-hidden="true" tabindex="-1"></a>        <span class="fu">format</span>(<span class="fu">names</span>(sources)),</span>
<span id="cb490-66"><a href="Loglinear.html#cb490-66" aria-hidden="true" tabindex="-1"></a>        <span class="at">sep =</span> sep</span>
<span id="cb490-67"><a href="Loglinear.html#cb490-67" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb490-68"><a href="Loglinear.html#cb490-68" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb490-69"><a href="Loglinear.html#cb490-69" aria-hidden="true" tabindex="-1"></a>      <span class="fu">row.names</span>(retval) <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">names</span>(sources), mrows)</span>
<span id="cb490-70"><a href="Loglinear.html#cb490-70" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb490-71"><a href="Loglinear.html#cb490-71" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb490-72"><a href="Loglinear.html#cb490-72" aria-hidden="true" tabindex="-1"></a>  retval</span>
<span id="cb490-73"><a href="Loglinear.html#cb490-73" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb490-74"><a href="Loglinear.html#cb490-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb490-75"><a href="Loglinear.html#cb490-75" aria-hidden="true" tabindex="-1"></a><span class="co"># objects to interleave</span></span>
<span id="cb490-76"><a href="Loglinear.html#cb490-76" aria-hidden="true" tabindex="-1"></a>l <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">a=</span><span class="fu">as.matrix</span>(cancerCountWide),<span class="at">b=</span><span class="fu">as.matrix</span>(cancerRiskTimeWide))</span>
<span id="cb490-77"><a href="Loglinear.html#cb490-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb490-78"><a href="Loglinear.html#cb490-78" aria-hidden="true" tabindex="-1"></a><span class="co"># interleave counts and risk time</span></span>
<span id="cb490-79"><a href="Loglinear.html#cb490-79" aria-hidden="true" tabindex="-1"></a>bigMatrix <span class="ot">&lt;-</span> <span class="fu">Interleave</span>(l)</span>
<span id="cb490-80"><a href="Loglinear.html#cb490-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb490-81"><a href="Loglinear.html#cb490-81" aria-hidden="true" tabindex="-1"></a><span class="co"># add columns for titles</span></span>
<span id="cb490-82"><a href="Loglinear.html#cb490-82" aria-hidden="true" tabindex="-1"></a>biggerMatrix <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">cbind</span>(bigMatrix[,<span class="dv">1</span>], bigMatrix[,<span class="dv">2</span><span class="sc">:</span><span class="dv">11</span>]))</span>
<span id="cb490-83"><a href="Loglinear.html#cb490-83" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(biggerMatrix) <span class="ot">&lt;-</span> <span class="fu">names</span>(cancerCountWide)</span>
<span id="cb490-84"><a href="Loglinear.html#cb490-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb490-85"><a href="Loglinear.html#cb490-85" aria-hidden="true" tabindex="-1"></a>my_header <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb490-86"><a href="Loglinear.html#cb490-86" aria-hidden="true" tabindex="-1"></a>  <span class="at">col_keys =</span> <span class="fu">c</span>(<span class="st">&quot;time&quot;</span>, <span class="st">&quot;histo&quot;</span>, <span class="st">&quot;blank1&quot;</span>, </span>
<span id="cb490-87"><a href="Loglinear.html#cb490-87" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;1_1&quot;</span>, <span class="st">&quot;2_1&quot;</span>, <span class="st">&quot;3_1&quot;</span>, <span class="st">&quot;blank2&quot;</span>, </span>
<span id="cb490-88"><a href="Loglinear.html#cb490-88" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;1_2&quot;</span>, <span class="st">&quot;2_2&quot;</span>, <span class="st">&quot;3_2&quot;</span>, <span class="st">&quot;blank3&quot;</span>, </span>
<span id="cb490-89"><a href="Loglinear.html#cb490-89" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;1_3&quot;</span>, <span class="st">&quot;2_3&quot;</span>,<span class="st">&quot;3_3&quot;</span>),</span>
<span id="cb490-90"><a href="Loglinear.html#cb490-90" aria-hidden="true" tabindex="-1"></a>  <span class="at">line2 =</span> <span class="fu">c</span>(<span class="st">&quot;Follow-up&quot;</span>, <span class="st">&quot;Histology&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="fu">rep</span>(<span class="st">&quot;I&quot;</span>, <span class="dv">3</span>), <span class="st">&quot;&quot;</span>, <span class="fu">rep</span>(<span class="st">&quot;II&quot;</span>, <span class="dv">3</span>), <span class="st">&quot;&quot;</span>, </span>
<span id="cb490-91"><a href="Loglinear.html#cb490-91" aria-hidden="true" tabindex="-1"></a>            <span class="fu">rep</span>(<span class="st">&quot;III&quot;</span>, <span class="dv">3</span>)),</span>
<span id="cb490-92"><a href="Loglinear.html#cb490-92" aria-hidden="true" tabindex="-1"></a>  <span class="at">line3 =</span> <span class="fu">c</span>(<span class="st">&quot;Follow-up&quot;</span>, <span class="st">&quot;Disease Stage&quot;</span>, <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;&quot;</span>, <span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>, <span class="st">&quot;3&quot;</span>), <span class="dv">3</span>))</span>
<span id="cb490-93"><a href="Loglinear.html#cb490-93" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb490-94"><a href="Loglinear.html#cb490-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb490-95"><a href="Loglinear.html#cb490-95" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(officer)</span>
<span id="cb490-96"><a href="Loglinear.html#cb490-96" aria-hidden="true" tabindex="-1"></a>big_border <span class="ot">=</span> <span class="fu">fp_border</span>(<span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">width =</span> <span class="dv">2</span>)</span>
<span id="cb490-97"><a href="Loglinear.html#cb490-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb490-98"><a href="Loglinear.html#cb490-98" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(flextable)</span>
<span id="cb490-99"><a href="Loglinear.html#cb490-99" aria-hidden="true" tabindex="-1"></a><span class="fu">flextable</span>(biggerMatrix, <span class="at">col_keys =</span> my_header<span class="sc">$</span>col_keys) <span class="sc">%&gt;%</span> </span>
<span id="cb490-100"><a href="Loglinear.html#cb490-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_header_df</span>(</span>
<span id="cb490-101"><a href="Loglinear.html#cb490-101" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping =</span> my_header,</span>
<span id="cb490-102"><a href="Loglinear.html#cb490-102" aria-hidden="true" tabindex="-1"></a>    <span class="at">key =</span> <span class="st">&quot;col_keys&quot;</span></span>
<span id="cb490-103"><a href="Loglinear.html#cb490-103" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb490-104"><a href="Loglinear.html#cb490-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_booktabs</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb490-105"><a href="Loglinear.html#cb490-105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">merge_v</span>(<span class="at">part =</span> <span class="st">&quot;header&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb490-106"><a href="Loglinear.html#cb490-106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">merge_h</span>(<span class="at">part =</span> <span class="st">&quot;header&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb490-107"><a href="Loglinear.html#cb490-107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">merge_v</span>(<span class="at">part =</span> <span class="st">&quot;body&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb490-108"><a href="Loglinear.html#cb490-108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">align</span>(<span class="at">align =</span> <span class="st">&quot;center&quot;</span>, <span class="at">part =</span> <span class="st">&quot;all&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb490-109"><a href="Loglinear.html#cb490-109" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autofit</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb490-110"><a href="Loglinear.html#cb490-110" aria-hidden="true" tabindex="-1"></a>  <span class="fu">empty_blanks</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb490-111"><a href="Loglinear.html#cb490-111" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hline_top</span>(<span class="at">part=</span><span class="st">&quot;header&quot;</span>, <span class="at">border =</span> big_border) <span class="sc">%&gt;%</span> </span>
<span id="cb490-112"><a href="Loglinear.html#cb490-112" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hline_bottom</span>(<span class="at">part=</span><span class="st">&quot;body&quot;</span>, <span class="at">border =</span> big_border) <span class="sc">%&gt;%</span> </span>
<span id="cb490-113"><a href="Loglinear.html#cb490-113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fix_border_issues</span>()</span></code></pre></div>
<div class="tabwid"><style>.cl-ee60995a{}.cl-ee57b2b8{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-ee5c3f90{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-ee5c52fa{width:0.947in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ee5c5304{width:1.279in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ee5c530e{width:0.05in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 2pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ee5c530f{width:0.642in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ee5c5310{width:0.557in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ee5c5311{width:0.947in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ee5c5318{width:1.279in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ee5c5319{width:0.05in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ee5c531a{width:0.642in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ee5c5322{width:0.557in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ee5c5323{width:0.947in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ee5c532c{width:1.279in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ee5c532d{width:0.05in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ee5c5336{width:0.642in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ee5c5337{width:0.557in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ee5c5338{width:0.947in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ee5c5340{width:1.279in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ee5c5341{width:0.05in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ee5c5342{width:0.642in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ee5c534a{width:0.557in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ee5c534b{width:0.947in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ee5c534c{width:1.279in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ee5c5354{width:0.05in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ee5c5355{width:0.642in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ee5c5356{width:0.557in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ee5c535e{width:0.947in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ee5c535f{width:1.279in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ee5c5360{width:0.05in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ee5c5368{width:0.642in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ee5c5369{width:0.557in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ee5c536a{width:0.947in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ee5c5372{width:1.279in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ee5c5373{width:0.05in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ee5c5374{width:0.642in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ee5c537c{width:0.557in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ee5c537d{width:0.947in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ee5c537e{width:1.279in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ee5c5386{width:0.05in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ee5c5387{width:0.642in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ee5c5388{width:0.557in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ee5c5389{width:0.947in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ee5c5390{width:1.279in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ee5c5391{width:0.05in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ee5c539a{width:0.642in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ee5c539b{width:0.557in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ee5c539c{width:0.947in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ee5c53a4{width:1.279in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ee5c53a5{width:0.05in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ee5c53a6{width:0.642in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ee5c53a7{width:0.557in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-ee60995a'><thead><tr style="overflow-wrap:break-word;"><th  rowspan="2"class="cl-ee5c52fa"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">Follow-up</span></p></th><th class="cl-ee5c5304"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">Histology</span></p></th><th class="cl-ee5c530e"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8"></span></p></th><th  colspan="3"class="cl-ee5c530f"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">I</span></p></th><th class="cl-ee5c530e"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8"></span></p></th><th  colspan="3"class="cl-ee5c530f"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">II</span></p></th><th class="cl-ee5c530e"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8"></span></p></th><th  colspan="3"class="cl-ee5c530f"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">III</span></p></th></tr><tr style="overflow-wrap:break-word;"><th class="cl-ee5c5318"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">Disease Stage</span></p></th><th class="cl-ee5c5319"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8"></span></p></th><th class="cl-ee5c531a"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">1</span></p></th><th class="cl-ee5c5322"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">2</span></p></th><th class="cl-ee5c5322"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">3</span></p></th><th class="cl-ee5c5319"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8"></span></p></th><th class="cl-ee5c531a"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">1</span></p></th><th class="cl-ee5c5322"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">2</span></p></th><th class="cl-ee5c5322"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">3</span></p></th><th class="cl-ee5c5319"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8"></span></p></th><th class="cl-ee5c531a"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">1</span></p></th><th class="cl-ee5c531a"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">2</span></p></th><th class="cl-ee5c531a"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">3</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td  rowspan="2"class="cl-ee5c5323"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">0-2</span></p></td><td  rowspan="14"class="cl-ee5c532c"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8"> </span></p></td><td class="cl-ee5c532d"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8"></span></p></td><td class="cl-ee5c5336"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8"> 9</span></p></td><td class="cl-ee5c5337"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">5</span></p></td><td class="cl-ee5c5337"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">1</span></p></td><td class="cl-ee5c532d"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8"></span></p></td><td class="cl-ee5c5336"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">12</span></p></td><td class="cl-ee5c5337"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">4</span></p></td><td class="cl-ee5c5337"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">1</span></p></td><td class="cl-ee5c532d"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8"></span></p></td><td class="cl-ee5c5336"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">42</span></p></td><td class="cl-ee5c5336"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">28</span></p></td><td class="cl-ee5c5336"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">19</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ee5c5341"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8"></span></p></td><td class="cl-ee5c5342"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">(157)</span></p></td><td class="cl-ee5c534a"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">(77)</span></p></td><td class="cl-ee5c534a"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">(21)</span></p></td><td class="cl-ee5c5341"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8"></span></p></td><td class="cl-ee5c5342"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">(134)</span></p></td><td class="cl-ee5c534a"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">(71)</span></p></td><td class="cl-ee5c534a"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">(22)</span></p></td><td class="cl-ee5c5341"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8"></span></p></td><td class="cl-ee5c5342"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">(212)</span></p></td><td class="cl-ee5c5342"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">(130)</span></p></td><td class="cl-ee5c5342"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">(101)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td  rowspan="2"class="cl-ee5c534b"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">2-4</span></p></td><td class="cl-ee5c5354"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8"></span></p></td><td class="cl-ee5c5355"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8"> 2</span></p></td><td class="cl-ee5c5356"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">2</span></p></td><td class="cl-ee5c5356"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">1</span></p></td><td class="cl-ee5c5354"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8"></span></p></td><td class="cl-ee5c5355"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8"> 7</span></p></td><td class="cl-ee5c5356"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">3</span></p></td><td class="cl-ee5c5356"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">1</span></p></td><td class="cl-ee5c5354"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8"></span></p></td><td class="cl-ee5c5355"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">26</span></p></td><td class="cl-ee5c5355"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">19</span></p></td><td class="cl-ee5c5355"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">11</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ee5c5341"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8"></span></p></td><td class="cl-ee5c5342"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">(139)</span></p></td><td class="cl-ee5c534a"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">(68)</span></p></td><td class="cl-ee5c534a"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">(17)</span></p></td><td class="cl-ee5c5341"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8"></span></p></td><td class="cl-ee5c5342"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">(110)</span></p></td><td class="cl-ee5c534a"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">(63)</span></p></td><td class="cl-ee5c534a"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">(18)</span></p></td><td class="cl-ee5c5341"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8"></span></p></td><td class="cl-ee5c5342"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">(136)</span></p></td><td class="cl-ee5c5342"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">(72)</span></p></td><td class="cl-ee5c5342"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">(63)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td  rowspan="2"class="cl-ee5c534b"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">4-6</span></p></td><td class="cl-ee5c5354"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8"></span></p></td><td class="cl-ee5c5355"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8"> 9</span></p></td><td class="cl-ee5c5356"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">3</span></p></td><td class="cl-ee5c5356"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">1</span></p></td><td class="cl-ee5c5354"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8"></span></p></td><td class="cl-ee5c5355"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8"> 5</span></p></td><td class="cl-ee5c5356"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">5</span></p></td><td class="cl-ee5c5356"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">3</span></p></td><td class="cl-ee5c5354"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8"></span></p></td><td class="cl-ee5c5355"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">12</span></p></td><td class="cl-ee5c5355"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">10</span></p></td><td class="cl-ee5c5355"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8"> 7</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ee5c5341"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8"></span></p></td><td class="cl-ee5c5342"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">(126)</span></p></td><td class="cl-ee5c534a"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">(63)</span></p></td><td class="cl-ee5c534a"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">(14)</span></p></td><td class="cl-ee5c5341"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8"></span></p></td><td class="cl-ee5c5342"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">(96)</span></p></td><td class="cl-ee5c534a"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">(58)</span></p></td><td class="cl-ee5c534a"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">(14)</span></p></td><td class="cl-ee5c5341"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8"></span></p></td><td class="cl-ee5c5342"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">(90)</span></p></td><td class="cl-ee5c5342"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">(42)</span></p></td><td class="cl-ee5c5342"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">(43)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td  rowspan="2"class="cl-ee5c535e"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">6-8</span></p></td><td class="cl-ee5c5360"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8"></span></p></td><td class="cl-ee5c5368"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">10</span></p></td><td class="cl-ee5c5369"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">2</span></p></td><td class="cl-ee5c5369"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">1</span></p></td><td class="cl-ee5c5360"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8"></span></p></td><td class="cl-ee5c5368"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">10</span></p></td><td class="cl-ee5c5369"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">4</span></p></td><td class="cl-ee5c5369"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">1</span></p></td><td class="cl-ee5c5360"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8"></span></p></td><td class="cl-ee5c5368"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">10</span></p></td><td class="cl-ee5c5368"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8"> 5</span></p></td><td class="cl-ee5c5368"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8"> 6</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ee5c5341"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8"></span></p></td><td class="cl-ee5c5342"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">(102)</span></p></td><td class="cl-ee5c534a"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">(55)</span></p></td><td class="cl-ee5c534a"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">(12)</span></p></td><td class="cl-ee5c5341"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8"></span></p></td><td class="cl-ee5c5342"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">(86)</span></p></td><td class="cl-ee5c534a"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">(42)</span></p></td><td class="cl-ee5c534a"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">(10)</span></p></td><td class="cl-ee5c5341"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8"></span></p></td><td class="cl-ee5c5342"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">(64)</span></p></td><td class="cl-ee5c5342"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">(21)</span></p></td><td class="cl-ee5c5342"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">(32)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td  rowspan="2"class="cl-ee5c536a"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">8-10</span></p></td><td class="cl-ee5c5373"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8"></span></p></td><td class="cl-ee5c5374"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8"> 1</span></p></td><td class="cl-ee5c537c"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">2</span></p></td><td class="cl-ee5c537c"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">0</span></p></td><td class="cl-ee5c5373"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8"></span></p></td><td class="cl-ee5c5374"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8"> 4</span></p></td><td class="cl-ee5c537c"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">2</span></p></td><td class="cl-ee5c537c"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">0</span></p></td><td class="cl-ee5c5373"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8"></span></p></td><td class="cl-ee5c5374"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8"> 5</span></p></td><td class="cl-ee5c5374"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8"> 0</span></p></td><td class="cl-ee5c5374"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8"> 3</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ee5c5341"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8"></span></p></td><td class="cl-ee5c5342"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">(88)</span></p></td><td class="cl-ee5c534a"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">(50)</span></p></td><td class="cl-ee5c534a"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">(10)</span></p></td><td class="cl-ee5c5341"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8"></span></p></td><td class="cl-ee5c5342"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">(66)</span></p></td><td class="cl-ee5c534a"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">(35)</span></p></td><td class="cl-ee5c534a"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">(8)</span></p></td><td class="cl-ee5c5341"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8"></span></p></td><td class="cl-ee5c5342"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">(47)</span></p></td><td class="cl-ee5c5342"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">(14)</span></p></td><td class="cl-ee5c5342"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">(21)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td  rowspan="2"class="cl-ee5c537d"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">10-12</span></p></td><td class="cl-ee5c5386"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8"></span></p></td><td class="cl-ee5c5387"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8"> 3</span></p></td><td class="cl-ee5c5388"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">2</span></p></td><td class="cl-ee5c5388"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">1</span></p></td><td class="cl-ee5c5386"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8"></span></p></td><td class="cl-ee5c5387"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8"> 3</span></p></td><td class="cl-ee5c5388"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">1</span></p></td><td class="cl-ee5c5388"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">0</span></p></td><td class="cl-ee5c5386"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8"></span></p></td><td class="cl-ee5c5387"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8"> 4</span></p></td><td class="cl-ee5c5387"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8"> 3</span></p></td><td class="cl-ee5c5387"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8"> 3</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ee5c5341"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8"></span></p></td><td class="cl-ee5c5342"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">(82)</span></p></td><td class="cl-ee5c534a"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">(45)</span></p></td><td class="cl-ee5c534a"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">(8)</span></p></td><td class="cl-ee5c5341"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8"></span></p></td><td class="cl-ee5c5342"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">(59)</span></p></td><td class="cl-ee5c534a"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">(32)</span></p></td><td class="cl-ee5c534a"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">(8)</span></p></td><td class="cl-ee5c5341"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8"></span></p></td><td class="cl-ee5c5342"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">(39)</span></p></td><td class="cl-ee5c5342"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">(13)</span></p></td><td class="cl-ee5c5342"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">(14)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td  rowspan="2"class="cl-ee5c5389"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">12+</span></p></td><td class="cl-ee5c5391"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8"></span></p></td><td class="cl-ee5c539a"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8"> 1</span></p></td><td class="cl-ee5c539b"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">2</span></p></td><td class="cl-ee5c539b"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">0</span></p></td><td class="cl-ee5c5391"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8"></span></p></td><td class="cl-ee5c539a"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8"> 4</span></p></td><td class="cl-ee5c539b"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">4</span></p></td><td class="cl-ee5c539b"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">2</span></p></td><td class="cl-ee5c5391"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8"></span></p></td><td class="cl-ee5c539a"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8"> 1</span></p></td><td class="cl-ee5c539a"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8"> 2</span></p></td><td class="cl-ee5c539a"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8"> 3</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ee5c53a5"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8"></span></p></td><td class="cl-ee5c53a6"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">(76)</span></p></td><td class="cl-ee5c53a7"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">(42)</span></p></td><td class="cl-ee5c53a7"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">(6)</span></p></td><td class="cl-ee5c53a5"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8"></span></p></td><td class="cl-ee5c53a6"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">(51)</span></p></td><td class="cl-ee5c53a7"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">(28)</span></p></td><td class="cl-ee5c53a7"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">(6)</span></p></td><td class="cl-ee5c53a5"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8"></span></p></td><td class="cl-ee5c53a6"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">(29)</span></p></td><td class="cl-ee5c53a6"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">(7)</span></p></td><td class="cl-ee5c53a6"><p class="cl-ee5c3f90"><span class="cl-ee57b2b8">(10)</span></p></td></tr></tbody></table></div>
<p><span class="math display">\[\mathrm{log}(\mu_{ijk}/t_{ijk}) = \beta_0 + \beta_i^H + \beta_j^S + \beta_k^T,\]</span></p>
<div class="sourceCode" id="cb491"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb491-1"><a href="Loglinear.html#cb491-1" aria-hidden="true" tabindex="-1"></a>Cancer <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;http://users.stat.ufl.edu/~aa/cat/data/Cancer.dat&quot;</span>,</span>
<span id="cb491-2"><a href="Loglinear.html#cb491-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">stringsAsFactors =</span> <span class="cn">TRUE</span>)</span>
<span id="cb491-3"><a href="Loglinear.html#cb491-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb491-4"><a href="Loglinear.html#cb491-4" aria-hidden="true" tabindex="-1"></a>Cancer <span class="sc">%&gt;%</span> </span>
<span id="cb491-5"><a href="Loglinear.html#cb491-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">row_number</span>() <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fu">n</span>())) </span></code></pre></div>
<pre class="custom-output"><code>  time histology stage count risktime
1    1         1     1     9      157
2    7         3     3     3       10</code></pre>
<div class="sourceCode" id="cb493"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb493-1"><a href="Loglinear.html#cb493-1" aria-hidden="true" tabindex="-1"></a>Cancer <span class="ot">&lt;-</span> Cancer <span class="sc">%&gt;%</span> </span>
<span id="cb493-2"><a href="Loglinear.html#cb493-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">&quot;logrisktime&quot;</span> <span class="ot">=</span> <span class="fu">log</span>(Cancer<span class="sc">$</span>risktime))</span>
<span id="cb493-3"><a href="Loglinear.html#cb493-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb493-4"><a href="Loglinear.html#cb493-4" aria-hidden="true" tabindex="-1"></a><span class="co"># showing 6 time effects</span></span>
<span id="cb493-5"><a href="Loglinear.html#cb493-5" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(count <span class="sc">~</span> <span class="fu">factor</span>(histology) <span class="sc">+</span> <span class="fu">factor</span>(stage) <span class="sc">+</span> <span class="fu">factor</span>(time), </span>
<span id="cb493-6"><a href="Loglinear.html#cb493-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">family =</span> poisson, <span class="at">offset =</span> logrisktime, <span class="at">data =</span> Cancer)</span>
<span id="cb493-7"><a href="Loglinear.html#cb493-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code></pre></div>
<pre class="custom-output"><code>
Call:
glm(formula = count ~ factor(histology) + factor(stage) + factor(time), 
    family = poisson, data = Cancer, offset = logrisktime)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-2.00333  -0.74769  -0.03194   0.46468   1.70832  

Coefficients:
                   Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)        -3.00928    0.16651 -18.073  &lt; 2e-16 ***
factor(histology)2  0.16244    0.12195   1.332  0.18285    
factor(histology)3  0.10754    0.14745   0.729  0.46580    
factor(stage)2      0.47001    0.17444   2.694  0.00705 ** 
factor(stage)3      1.32431    0.15205   8.709  &lt; 2e-16 ***
factor(time)2      -0.12745    0.14908  -0.855  0.39259    
factor(time)3      -0.07973    0.16352  -0.488  0.62585    
factor(time)4       0.11892    0.17107   0.695  0.48694    
factor(time)5      -0.66511    0.26061  -2.552  0.01071 *  
factor(time)6      -0.35015    0.24348  -1.438  0.15040    
factor(time)7      -0.17518    0.24985  -0.701  0.48321    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 175.718  on 62  degrees of freedom
Residual deviance:  43.923  on 52  degrees of freedom
AIC: 251.74

Number of Fisher Scoring iterations: 5</code></pre>
<div class="sourceCode" id="cb495"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb495-1"><a href="Loglinear.html#cb495-1" aria-hidden="true" tabindex="-1"></a><span class="co"># likelihood-ratio test of effects, adjusting for the others</span></span>
<span id="cb495-2"><a href="Loglinear.html#cb495-2" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(fit)</span></code></pre></div>
<pre class="custom-output"><code>Analysis of Deviance Table (Type II tests)

Response: count
                  LR Chisq Df Pr(&gt;Chisq)    
factor(histology)    1.876  2    0.39132    
factor(stage)       99.155  2    &lt; 2e-16 ***
factor(time)        11.383  6    0.07724 .  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="negativee-binomial-regression-models" class="section level3 hasAnchor">
<h3>7.6.3 Negativee Binomial Regression Models<a href="Loglinear.html#negativee-binomial-regression-models" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="math display">\[E(Y) = \mu,\ \ \mathrm{var}(Y) = \mu + D\mu^2.\]</span></p>
</div>
<div id="example-female-horseshoe-crab-satelites-revisited" class="section level3 hasAnchor">
<h3>7.6.4 Example: Female Horseshoe Crab Satelites Revisited<a href="Loglinear.html#example-female-horseshoe-crab-satelites-revisited" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb497"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb497-1"><a href="Loglinear.html#cb497-1" aria-hidden="true" tabindex="-1"></a>Crabs <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;http://users.stat.ufl.edu/~aa/cat/data/Crabs.dat&quot;</span>,</span>
<span id="cb497-2"><a href="Loglinear.html#cb497-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">stringsAsFactors =</span> <span class="cn">TRUE</span>)</span>
<span id="cb497-3"><a href="Loglinear.html#cb497-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb497-4"><a href="Loglinear.html#cb497-4" aria-hidden="true" tabindex="-1"></a>Crabs <span class="sc">%&gt;%</span> </span>
<span id="cb497-5"><a href="Loglinear.html#cb497-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">row_number</span>() <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fu">n</span>())) </span></code></pre></div>
<pre class="custom-output"><code>  crab sat y weight width color spine
1    1   8 1   3.05  28.3     2     3
2  173   0 0   2.00  24.5     2     2</code></pre>
<div class="sourceCode" id="cb499"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb499-1"><a href="Loglinear.html#cb499-1" aria-hidden="true" tabindex="-1"></a>fit.pois <span class="ot">&lt;-</span> <span class="fu">glm</span>(sat <span class="sc">~</span> width, <span class="at">family =</span> poisson, <span class="at">data =</span> Crabs)</span>
<span id="cb499-2"><a href="Loglinear.html#cb499-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.pois)</span></code></pre></div>
<pre class="custom-output"><code>
Call:
glm(formula = sat ~ width, family = poisson, data = Crabs)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.8526  -1.9884  -0.4933   1.0970   4.9221  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -3.30476    0.54224  -6.095  1.1e-09 ***
width        0.16405    0.01997   8.216  &lt; 2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 632.79  on 172  degrees of freedom
Residual deviance: 567.88  on 171  degrees of freedom
AIC: 927.18

Number of Fisher Scoring iterations: 6</code></pre>
<div class="sourceCode" id="cb501"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb501-1"><a href="Loglinear.html#cb501-1" aria-hidden="true" tabindex="-1"></a>fit.negbin <span class="ot">&lt;-</span> MASS<span class="sc">::</span><span class="fu">glm.nb</span>(sat <span class="sc">~</span> width, <span class="at">data =</span> Crabs)</span>
<span id="cb501-2"><a href="Loglinear.html#cb501-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.negbin)</span></code></pre></div>
<pre class="custom-output"><code>
Call:
MASS::glm.nb(formula = sat ~ width, data = Crabs, init.theta = 0.90456808, 
    link = log)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.7798  -1.4110  -0.2502   0.4770   2.0177  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -4.05251    1.17143  -3.459 0.000541 ***
width        0.19207    0.04406   4.360  1.3e-05 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for Negative Binomial(0.9046) family taken to be 1)

    Null deviance: 213.05  on 172  degrees of freedom
Residual deviance: 195.81  on 171  degrees of freedom
AIC: 757.29

Number of Fisher Scoring iterations: 1

              Theta:  0.905 
          Std. Err.:  0.161 

 2 x log-likelihood:  -751.291 </code></pre>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="Multicategory.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="Matched.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": false
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
