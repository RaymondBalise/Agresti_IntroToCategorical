<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 Logistic Regression | Notes for Agresti’s Introduction to Categorical Data Analysis 3rd Edition</title>
  <meta name="description" content="Notes for Agresti’s Introduction to Categorical Data Analysis" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="4 Logistic Regression | Notes for Agresti’s Introduction to Categorical Data Analysis 3rd Edition" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Notes for Agresti’s Introduction to Categorical Data Analysis" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Logistic Regression | Notes for Agresti’s Introduction to Categorical Data Analysis 3rd Edition" />
  
  <meta name="twitter:description" content="Notes for Agresti’s Introduction to Categorical Data Analysis" />
  

<meta name="author" content="Raymond R. Balise with help from Wayne F. DeFreitas" />


<meta name="date" content="2021-01-09" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="Generalized.html"/>
<link rel="next" href="building-and-applying-logistic-regression-models.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/tabwid-1.0.0/tabwid.css" rel="stylesheet" />


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>1 Introduction</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#categorical-response-data"><i class="fa fa-check"></i>1.1 Categorical Response Data</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#response-variables-and-explanatory-variables"><i class="fa fa-check"></i>1.1.1 Response Variables and Explanatory Variables</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#binary-nominal-ordinal-scale-distinction"><i class="fa fa-check"></i>1.1.2 Binary-Nominal-Ordinal Scale Distinction</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#organization-of-this-book"><i class="fa fa-check"></i>1.1.3 Organization of this Book</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#probability-distributions-for-categorical-data"><i class="fa fa-check"></i>1.2 Probability Distributions for Categorical Data</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#binomial"><i class="fa fa-check"></i>1.2.1 Binomial Distribution</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#statistical-inference-for-a-proportion"><i class="fa fa-check"></i>1.3 Statistical Inference for a Proportion</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#likelihood-function-and-maximum-likelihood-estimation"><i class="fa fa-check"></i>1.3.1 Likelihood Function and Maximum Likelihood Estimation</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#significance-test-about-a-binomial-parameter"><i class="fa fa-check"></i>1.3.2 Significance Test about a Binomial Parameter</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#example-surveyed-opinions-about-legalized-abortion"><i class="fa fa-check"></i>1.3.3 Example: Surveyed Opinions About Legalized Abortion</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#confidence-intervals-for-a-binomial-parameter"><i class="fa fa-check"></i>1.3.4 Confidence Intervals for a Binomial Parameter</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#better-confidence-intervals-for-a-binomial-proportion"><i class="fa fa-check"></i>1.3.5 Better Confidence Intervals for a Binomial Proportion</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#statistical-inference-for-discrete-data"><i class="fa fa-check"></i>1.4 Statistical Inference for Discrete Data</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#x1.4.1"><i class="fa fa-check"></i>1.4.1 Wald, Likelihood-Ratio, and Score Tests</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#example-wald-score-and-likelihood-ratio-binomial-tests"><i class="fa fa-check"></i>1.4.2 Example Wald, Score and Likelihood-Ratio Binomial Tests</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#ssbi"><i class="fa fa-check"></i>1.4.3 Small-Sample Binomial Inference and the Mid P-Value</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#bayesian-inference-for-proportions"><i class="fa fa-check"></i>1.5 Bayesian Inference for Proportions</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#the-bayesian-approach-to-statistical-inference"><i class="fa fa-check"></i>1.5.1 The Bayesian Approach to Statistical Inference</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#bayesian-binomial-inference-beta-prior-distributions"><i class="fa fa-check"></i>1.5.2 Bayesian Binomial Inference: Beta Prior Distributions</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#example-opinions-about-legalized-abortion-revisited"><i class="fa fa-check"></i>1.5.3 Example: Opinions about Legalized Abortion, Revisited</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#other-prior-distributions"><i class="fa fa-check"></i>1.5.4 Other Prior Distributions</a></li>
</ul></li>
<li><a href="index.html#using-r-software-for-statistical-inference-about-proportions">1.6 Using <code>R</code> software for Statistical Inference about Proportions</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#reading-data-files-and-installing-packages"><i class="fa fa-check"></i>1.6.1 Reading Data Files and Installing Packages</a></li>
<li><a href="index.html#using-r-for-statistical-inference-about-proportions">1.6.2 Using <code>R</code> for Statistical Inference about Proportions</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#summary-choosing-an-inference-method"><i class="fa fa-check"></i>1.6.3 Summary: Choosing an Inference Method</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#exercises"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html"><i class="fa fa-check"></i>2 Analyzing Contingency Tables</a><ul>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#probability-structure-for-contingency-tables"><i class="fa fa-check"></i>2.1 Probability Structure for Contingency Tables</a><ul>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#joint-marginal-and-conditional-probabilities"><i class="fa fa-check"></i>2.1.1 Joint, Marginal, and Conditional Probabilities</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#binomial-and-multinomial-sampling"><i class="fa fa-check"></i>2.1.4 Binomial and Multinomial Sampling</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#comparing-proportions-in-2-x-2-contingency-tables"><i class="fa fa-check"></i>2.2 Comparing Proportions in 2 x 2 Contingency Tables</a><ul>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#difference-of-proportions"><i class="fa fa-check"></i>2.2.1 Difference of Proportions</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#table2-2"><i class="fa fa-check"></i>2.2.2 Example: Aspirin and incidence of Heart Attacks</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#ratio-of-proportions-relative-risk"><i class="fa fa-check"></i>2.2.3 Ratio of Proportions (Relative Risk)</a></li>
<li><a href="Contingency.html#using-r-for-comparing-proportions-in-2-x-2-tables">2.2.4 Using <code>R</code> for Comparing Proportions in 2 x 2 Tables</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#the-odds-ratio"><i class="fa fa-check"></i>2.3 The Odds Ratio</a><ul>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#properties-of-the-odds-ratio"><i class="fa fa-check"></i>2.3.1 Properties of the Odds Ratio</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#example-odds-ratio-for-aspirin-and-hart-attacks"><i class="fa fa-check"></i>2.3.2 Example: Odds Ratio for Aspirin and Hart Attacks</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#inference-for-odds-ratios-and-log-odds-ratios"><i class="fa fa-check"></i>2.3.3 Inference for Odds Ratios and Log Odds Ratios</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#relationship-between-odds-ratio-and-relative-risk"><i class="fa fa-check"></i>2.3.4 Relationship Between Odds Ratio and Relative Risk</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#x2.3.5"><i class="fa fa-check"></i>2.3.5 Example: The Odds Ratio Applies in Case-Control Studies</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#types-of-studies-observational-versus-experimental"><i class="fa fa-check"></i>2.3.6 Types of Studies Observational Versus Experimental</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#x2.4"><i class="fa fa-check"></i>2.4 Chi-Squared Tests of Independence</a><ul>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#x2.4.1"><i class="fa fa-check"></i>2.4.1 Pearson Statistic and the Chi-Squared Distribution</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#likelihood-ratio-statistic"><i class="fa fa-check"></i>2.4.2 likelihood-Ratio Statistic</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#testing-independence-in-two-way-contingency-tables"><i class="fa fa-check"></i>2.4.3 Testing Independence in Two-Way Contingency Tables</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#example-gender-gap-in-political-party-affiliation"><i class="fa fa-check"></i>2.4.4 Example: Gender Gap in Political Party Affiliation</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#residuals-for-cells-in-a-contingency-table"><i class="fa fa-check"></i>2.4.5 Residuals for Cells in a Contingency Table</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#partitioning-chi-squared-statistics"><i class="fa fa-check"></i>2.4.6 Partitioning Chi-Squared Statistics</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#limitations-of-chi-squared-tests"><i class="fa fa-check"></i>2.4.7 Limitations of Chi-Squared Tests</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#x2.5"><i class="fa fa-check"></i>2.5 Testing Independence for Ordinal Variables</a><ul>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#linear-trend-alternative-to-independence"><i class="fa fa-check"></i>2.5.1 Linear Trend Alternative to Independence</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#example-alcohol-use-and-infant-malformation"><i class="fa fa-check"></i>2.5.2 Example: Alcohol Use and Infant Malformation</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#ordinal-tests-usually-have-greater-power"><i class="fa fa-check"></i>2.5.3 Ordinal Tests Usually Have Greater Power</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#choice-of-scores"><i class="fa fa-check"></i>2.5.4 Choice of Scores</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#trend-tests-for-r-x-2-and-2-x-c-and-nominal-ordinal-tables"><i class="fa fa-check"></i>2.5.6 Trend Tests for r x 2 and 2 x c and Nominal-Ordinal Tables</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#exact-frequentist-and-bayesian-inference"><i class="fa fa-check"></i>2.6 Exact Frequentist and Bayesian Inference</a><ul>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#fishers-exact-test-for-2-x-2-tables"><i class="fa fa-check"></i>2.6.1 Fisher’s Exact Test for 2 x 2 Tables</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#example-fishers-tea-tasting-colleague"><i class="fa fa-check"></i>2.6.2 Example: Fisher’s Tea Tasting Colleague</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#conservatism-for-actual-ptype-i-error-mid-p-value"><i class="fa fa-check"></i>2.6.3 Conservatism for Actual P(Type I Error); Mid P-Value</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#small-sample-confidence-intervals-for-odds-ratio"><i class="fa fa-check"></i>2.6.4 Small-Sample Confidence Intervals for Odds Ratio</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#bayesian-estimation-for-association-measures"><i class="fa fa-check"></i>2.6.5 Bayesian Estimation for Association Measures</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#example-bayesian-inference-in-a-small-clinical-trial"><i class="fa fa-check"></i>2.6.6 Example: Bayesian Inference in a Small Clinical Trial</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#association-in-three-way-tables"><i class="fa fa-check"></i>2.7 Association in Three-Way Tables</a><ul>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#partial-tables"><i class="fa fa-check"></i>2.7.1 Partial Tables</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#example-death-penalty-verdicts-and-race"><i class="fa fa-check"></i>2.7.2 Example: Death Penalty Verdicts and Race</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#simpsons-paradox"><i class="fa fa-check"></i>2.7.3 Simpson’s Paradox</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#conditional-and-marginal-odds-ratios"><i class="fa fa-check"></i>2.7.4 Conditional and Marginal Odds Ratios</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#x2.7.5"><i class="fa fa-check"></i>2.7.5 Homogeneous Association</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#exercises-1"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html"><i class="fa fa-check"></i>3 Generalized Linear Models</a><ul>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#components-of-a-generalized-linear-model"><i class="fa fa-check"></i>3.1 Components of a Generalized Linear Model</a><ul>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#random-component"><i class="fa fa-check"></i>3.1.1 Random Component</a></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#linear-predictor"><i class="fa fa-check"></i>3.1.2 Linear Predictor</a></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#link-function"><i class="fa fa-check"></i>3.1.3 Link Function</a></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#ordinary-linear-model-glm-with-normal-random-component"><i class="fa fa-check"></i>3.1.4 Ordinary Linear Model: GLM with Normal Random Component</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#components-of-a-generalized-linear-model-1"><i class="fa fa-check"></i>3.2 Components of a Generalized Linear Model</a><ul>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#x3.2.1"><i class="fa fa-check"></i>3.2.1 Linear Probability Model</a></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#logistic-regression-model"><i class="fa fa-check"></i>3.2.2 Logistic Regression Model</a></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#x3.2.3"><i class="fa fa-check"></i>3.2.3 Example Snoring and Heart Disease</a></li>
<li><a href="Generalized.html#using-r-to-fit-generalized-lineare-models-for-binary-data">3.2.4 Using <code>R</code> to Fit Generalized Lineare Models for Binary Data</a></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#x3.2.5"><i class="fa fa-check"></i>3.2.5 Data Files: Ungrouped or Grouped Binary Data</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#x3.3"><i class="fa fa-check"></i>3.3 Generalized Linear Models for Binary Data</a><ul>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#poisson-distribution-for-counts"><i class="fa fa-check"></i>3.3.1 Poisson Distribution for Counts</a></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#poisson-loglinear-model"><i class="fa fa-check"></i>3.3.2 Poisson Loglinear Model</a></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#x3.3.3"><i class="fa fa-check"></i>3.3.3 Example: Female Horseshoe Crabs and their Satellites</a></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#x3.3.4"><i class="fa fa-check"></i>3.3.4 Overdispersion: Greater Variability than Expected</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#generalized-lineaer-models-for-counts-and-rates"><i class="fa fa-check"></i>3.4 Generalized Lineaer Models for Counts and Rates</a><ul>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#x3.4.1"><i class="fa fa-check"></i>3.4.1 Wald, Likelihood-Ratio, and Score Inference Use the Likelihood Function</a></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#example-political-ideology-and-belief-in-evolution"><i class="fa fa-check"></i>3.4.2 Example Political Ideology and Belief in Evolution</a></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#model-comparison-using-the-deviance"><i class="fa fa-check"></i>3.4.4 Model Comparison Using the Deviance</a></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#x3.4.5"><i class="fa fa-check"></i>3.4.5 Residuals Comparing Ovservations to the Model Fit</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#fitting-generalized-linear-models"><i class="fa fa-check"></i>3.5 Fitting Generalized Linear Models</a><ul>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#x3.5.1"><i class="fa fa-check"></i>3.5.1 The Fisher Scoring Algorithm Fits GLMs</a></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#bayesian-methods-for-generalized-lineare-models"><i class="fa fa-check"></i>3.5.2 Bayesian Methods for Generalized Lineare Models</a></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#glms-a-unified-approach-to-statistical-analysis"><i class="fa fa-check"></i>3.5.3 GLMs: A Unified Approach to Statistical Analysis</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html"><i class="fa fa-check"></i>4 Logistic Regression</a><ul>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#the-logistic-regression-model"><i class="fa fa-check"></i>4.1 The Logistic Regression Model</a><ul>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#the-logistic-regression-model-1"><i class="fa fa-check"></i>4.1.1 The Logistic Regression Model</a></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#odds-ratio-and-linear-approximaiton-interpreetations-4.1.2"><i class="fa fa-check"></i>4.1.2 Odds Ratio and Linear Approximaiton Interpreetations {#4.1.2}</a></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#x4.1.3"><i class="fa fa-check"></i>4.1.3 Example: Whethr a Female Horsehoe Crab Has Satelites</a></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#logistic-regression-with-retrospective-studies"><i class="fa fa-check"></i>4.1.4 Logistic Regression with Retrospective Studies</a></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#normally-distributed-x-implies-logistic-regression-for-y"><i class="fa fa-check"></i>4.1.5 Normally Distributed X Implies Logistic Regression for Y</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#x4.2"><i class="fa fa-check"></i>4.2 Statistical Inference for Logistic Regression</a><ul>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#x4.2.1"><i class="fa fa-check"></i>4.2.1 Confidence Intervals for Effects</a></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#x4.2.2"><i class="fa fa-check"></i>4.2.2 Significance Testing</a></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#fitted-values-and-confidence-intervals-for-probabilities"><i class="fa fa-check"></i>4.2.3 Fitted Values and Confidence Intervals for Probabilities</a></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#why-use-a-model-to-estimate-probabilities"><i class="fa fa-check"></i>4.2.4 Why Use a Model to Estimate Probabilities?</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#logistic-regression-with-categorical-predictors"><i class="fa fa-check"></i>4.3 Logistic Regression with Categorical Predictors</a><ul>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#indicator-variables-represent-categories-of-predictors"><i class="fa fa-check"></i>4.3.1 Indicator Variables Represent Categories of Predictors</a></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#example-survey-about-marijuana-use"><i class="fa fa-check"></i>4.3.2 Example: Survey about Marijuana Use</a></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#anova-type-model-representation-of-factors"><i class="fa fa-check"></i>4.3.3 ANOVA-Type Model Representation of Factors</a></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#tests-of-conditoinal-independence-and-of-homogeneity-for-three-way-contingency-tables"><i class="fa fa-check"></i>4.3.4 Tests of Conditoinal Independence and of Homogeneity for Three-Way Contingency Tables</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#multiple-logistic-regression"><i class="fa fa-check"></i>4.4 Multiple Logistic Regression</a><ul>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#x4.4.1"><i class="fa fa-check"></i>4.4.1 Example: Horseshoe Crabs with Color and Width Predictors</a></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#model-comparison-to-check-whether-a-term-is-needed"><i class="fa fa-check"></i>4.4.2 Model Comparison to Check Whether a Term is Needed</a></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#example-treating-color-as-quantitative-or-binary"><i class="fa fa-check"></i>4.4.3 Example: Treating Color as Quantitative or Binary</a></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#allowing-interaction-between-explanatory-variables"><i class="fa fa-check"></i>4.4.4 Allowing Interaction between Explanatory Variables</a></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#effects-depend-on-other-explanatory-variables-in-model"><i class="fa fa-check"></i>4.4.5 Effects Depend on Other Explanatory Variables in Model</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#summarizing-effects-in-logistic-regression"><i class="fa fa-check"></i>4.5 Summarizing Effects in Logistic Regression</a><ul>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#probability-based-interpretations"><i class="fa fa-check"></i>4.5.1 Probability-Based Interpretations</a></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#x4.5.2"><i class="fa fa-check"></i>4.5.2 Marginal Effects and Their Average</a></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#x4.5.3"><i class="fa fa-check"></i>4.5.3 Standardized Interpretations</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#summzarizing-predictive-power-classification-tables-roc-curves-and-multiple-correlation"><i class="fa fa-check"></i>4.6 Summzarizing Predictive Power: Classification Tables, ROC Curves and Multiple Correlation</a><ul>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#x4.6.1"><i class="fa fa-check"></i>4.6.1 Summarizing Predictive Power: Classification Tables</a></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#summarizing-predictive-power-roc-curves"><i class="fa fa-check"></i>4.6.2 Summarizing Predictive Power: ROC Curves</a></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#x4.6.3"><i class="fa fa-check"></i>4.6.3 Summarizing Predictive Power: Multiple Correlation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html"><i class="fa fa-check"></i>5 Building and Applying Logistic Regression Models</a><ul>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#strategies-in-model-selection"><i class="fa fa-check"></i>5.1 Strategies in Model Selection</a><ul>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#how-many-explanatory-variables-can-the-model-handle"><i class="fa fa-check"></i>5.1.1 How Many Explanatory Variables Can the Model Handle?</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#example-horseshoe-crab-satellites-revisited"><i class="fa fa-check"></i>5.1.2 Example: Horseshoe Crab Satellites Revisited</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#stepwise-variable-selection-algorithms"><i class="fa fa-check"></i>5.1.3 Stepwise Variable Selection Algorithms</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#surposeful-selection-of-explanatory-variables"><i class="fa fa-check"></i>5.1.4 Surposeful Selection of Explanatory Variables</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#example-variable-selection-for-horseshoe-crabs"><i class="fa fa-check"></i>5.1.5 Example: Variable Selection for Horseshoe Crabs</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#aic-and-the-biasvariance-tradeoff"><i class="fa fa-check"></i>5.1.6 AIC and the Bias/Variance Tradeoff</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#model-checking"><i class="fa fa-check"></i>5.2 Model Checking</a><ul>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#x5.2.1"><i class="fa fa-check"></i>5.2.1 Goodness of Fit: Model Comparison Using the Deviance</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#x5.2.2"><i class="fa fa-check"></i>5.2.2 Example: Goodness of Fit for Marijuana Use Survey</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#goodness-of-fit-grouped-versus-ungrouped-data-and-continuous-predictors"><i class="fa fa-check"></i>5.2.3 Goodness of Fit: Grouped versus Ungrouped Data and Continuous Predictors</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#residuals-for-logistic-models-with-categorical-predictors"><i class="fa fa-check"></i>5.2.4 Residuals for Logistic Models with Categorical Predictors</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#standardized-versus-pearson-and-deviance-residuals"><i class="fa fa-check"></i>5.2.6 Standardized versus Pearson and Deviance Residuals</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#influence-diagnostics-for-logistic-regression"><i class="fa fa-check"></i>5.2.7 Influence Diagnostics for Logistic Regression</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#example-heart-disease-and-blood-pressure"><i class="fa fa-check"></i>5.2.8 Example: Heart Disease and Blood Pressure</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#infinite-estimates-in-logistic-regression"><i class="fa fa-check"></i>5.3 Infinite Estimates in Logistic Regression</a><ul>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#complete-and-quasi-complete-separation-perfeect-discrination"><i class="fa fa-check"></i>5.3.1 Complete and Quasi-Complete Separation: Perfeect Discrination</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#example-infinite-estimate-for-toy-example"><i class="fa fa-check"></i>5.3.2 Example: Infinite Estimate for Toy Example</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#sparse-data-and-infinite-effects-with-categorical-predictors"><i class="fa fa-check"></i>5.3.3 Sparse Data and Infinite Effects with Categorical Predictors</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#x5.3.5"><i class="fa fa-check"></i>5.3.4 Example: Risk Factors for Endometrial Cancer Grade</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#x5.4"><i class="fa fa-check"></i>5.4 Bayesian Inference, Penalized Likelihood, and Conditional Likelihood for Logistic Regression *</a><ul>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#bayesian-modeling-specification-of-prior-distributions"><i class="fa fa-check"></i>5.4.1 Bayesian Modeling: Specification of Prior Distributions</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#example-risk-factors-for-endometrial-caner-revisited"><i class="fa fa-check"></i>5.4.2 Example: Risk Factors for Endometrial Caner Revisited</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#penalized-likelihood-reduces-bias-in-logistic-regression"><i class="fa fa-check"></i>5.4.3 Penalized Likelihood Reduces Bias in Logistic Regression</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#example-risk-factors-for-endometrial-cancer-revisited"><i class="fa fa-check"></i>5.4.4 Example: Risk Factors for Endometrial Cancer Revisited</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#x5.4.5"><i class="fa fa-check"></i>5.4.5 Conditional Likelihood and Conditional Logistic Regression</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#conditional-logistic-regression-and-exact-tests-for-contingency-tables"><i class="fa fa-check"></i>5.4.6 Conditional Logistic Regression and Exact Tests for Contingency Tables</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#alternative-link-functions-linear-probability-and-probit-models"><i class="fa fa-check"></i>5.5 Alternative Link Functions: Linear Probability and Probit Models *</a><ul>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#linar-probability-model"><i class="fa fa-check"></i>5.5.1 Linar Probability Model</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#example-political-ideology-and-belief-in-evolution-1"><i class="fa fa-check"></i>5.5.2 Example: Political Ideology and Belief in Evolution</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#x5.5.3"><i class="fa fa-check"></i>5.5.3 Probit Model and Normal Latent Variable Model</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#example-snoring-and-heart-disease-revisited"><i class="fa fa-check"></i>5.5.4 Example: Snoring and Heart Disease Revisited</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#latent-variable-models-imply-binary-regression-models"><i class="fa fa-check"></i>5.5.5 Latent Variable Models Imply Binary Regression Models</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#cdfs-and-shapes-of-curves-for-binary-reegressoin-models"><i class="fa fa-check"></i>5.5.6 CDFs and Shapes of Curves for Binary Reegressoin Models</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#sample-size-and-power-for-logistic-regression"><i class="fa fa-check"></i>5.6 Sample Size and Power for Logistic Regression *</a><ul>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#sample-size-for-comparing-two-proportions"><i class="fa fa-check"></i>5.6.1 Sample Size for Comparing Two Proportions</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#sample-size-in-logistic-regression-modeling"><i class="fa fa-check"></i>5.6.2 Sample Size in Logistic Regression Modeling</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#example-modeling-the-probability-of-heart-disease"><i class="fa fa-check"></i>5.6.3 Example: Modeling the Probability of Heart Disease</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html"><i class="fa fa-check"></i>6 Multicategory Logit Models</a><ul>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#baseline-category-logit-models-for-nominal-responses"><i class="fa fa-check"></i>6.1 Baseline-Category Logit Models for Nominal Responses</a><ul>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#baseline-category-logits"><i class="fa fa-check"></i>6.1.1 Baseline-Category Logits</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#example-what-do-alligators-eat"><i class="fa fa-check"></i>6.1.2 Example: What Do Alligators Eat?</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#estimating-response-probabilities"><i class="fa fa-check"></i>6.1.3 Estimating Response Probabilities</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#checking-multinomial-model-goodness-of-fit"><i class="fa fa-check"></i>6.1.4 Checking multinomial Model Goodness of Fit</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#example-belief-in-afterlife"><i class="fa fa-check"></i>6.1.5 Example: Belief in Afterlife</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#discrete-choice-models"><i class="fa fa-check"></i>6.1.6 Discrete Choice Models*</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#example-shopping-destination-choice"><i class="fa fa-check"></i>6.1.7 Example: Shopping Destination Choice*</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#cumulative-logit-models-for-ordinal-responses-x6.2"><i class="fa fa-check"></i>6.2 Cumulative Logit Models for Ordinal Responses {x6.2}</a><ul>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#x6.2.1"><i class="fa fa-check"></i>6.2.1 Cumulative Logit Models with Proportional Odds</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#x6.2.2"><i class="fa fa-check"></i>6.2.2 Example: Political Ideology and Political Party Affiliation</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#inference-about-cumulative-logit-model-parameters"><i class="fa fa-check"></i>6.2.3 Inference about Cumulative Logit Model Parameters</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#increased-power-for-ordinal-analyses"><i class="fa fa-check"></i>6.2.4 Increased Power for Ordinal Analyses</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#example-happiness-and-family-income"><i class="fa fa-check"></i>6.2.5 Example: Happiness and Family Income</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#x6.2.6"><i class="fa fa-check"></i>6.2.6 Latent Variable Linear Models Imply Cumulative Link Models</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#invariance-to-choice-of-response-categories"><i class="fa fa-check"></i>6.2.7 Invariance to Choice of Response Categories</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#cumulative-link-models-model-checking-and-extensions"><i class="fa fa-check"></i>6.3 Cumulative Link Models: Model Checking and Extensions *</a><ul>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#checking-ordinal-model-goodness-of-fit"><i class="fa fa-check"></i>6.3.1 Checking Ordinal Model Goodness of Fit</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#cumulative-logit-model-without-proportional-odds"><i class="fa fa-check"></i>6.3.2 Cumulative Logit Model without Proportional Odds</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#simpler-interpretatoins-using-probabiliteis"><i class="fa fa-check"></i>6.3.3 Simpler Interpretatoins Using Probabiliteis</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#example-modeling-mental-impairment"><i class="fa fa-check"></i>6.3.4 Example: Modeling Mental Impairment</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#a-latent-variable-probability-comparison-of-groups"><i class="fa fa-check"></i>6.3.5 A Latent Variable Probability Comparison of Groups</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#cumulative-probit-model"><i class="fa fa-check"></i>6.3.6 Cumulative Probit Model</a></li>
<li><a href="Multicategory.html#r2-based-on-latent-variable-model">6.3.7 <span class="math inline">\(R^2\)</span> Based on Latent Variable Model</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#bayesian-inference-for-multinomial-models"><i class="fa fa-check"></i>6.3.8 Bayesian Inference for Multinomial Models</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#example-modeling-mental-impairment-revisited"><i class="fa fa-check"></i>6.3.9 Example: Modeling Mental Impairment Revisited</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#paired-category-logit-modeling-of-ordinal-response"><i class="fa fa-check"></i>6.4 Paired-Category Logit Modeling of Ordinal Response *</a><ul>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#adjacent-categories-logits"><i class="fa fa-check"></i>6.4.1 Adjacent-Categories Logits</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#example-political-ideology-revisited"><i class="fa fa-check"></i>6.4.2 Example: Political Ideology Revisited</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#sequential-logits"><i class="fa fa-check"></i>6.4.3 Sequential Logits</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#example-tonsil-size-and-streptococcus"><i class="fa fa-check"></i>6.4.4 Example: Tonsil Size and Streptococcus</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html"><i class="fa fa-check"></i>7 Loglinear Models for Contingency Tables and Counts</a><ul>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#loglinear-models-for-counts-in-contingency-tables"><i class="fa fa-check"></i>7.1 Loglinear Models for Counts in Contingency Tables</a><ul>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#loglinear-model-of-independence-for-two-way-contingency-tables"><i class="fa fa-check"></i>7.1.1 Loglinear Model of Independence for Two-Way Contingency Tables</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#interpretation-of-parameters-in-the-independence-model"><i class="fa fa-check"></i>7.1.2 Interpretation of Parameters in the Independence Model</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#example-happiness-and-belief-in-heaven"><i class="fa fa-check"></i>7.1.3 Example: Happiness and Belief in Heaven</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#saturated-model-for-two-way-contingency-tables"><i class="fa fa-check"></i>7.1.4 Saturated Model for Two-Way Contingency Tables</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#loglinear-models-for-three-way-contingency-tables"><i class="fa fa-check"></i>7.1.5 Loglinear Models for Three-Way Contingency Tables</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#two-factor-parameters-describe-conditional-associations"><i class="fa fa-check"></i>7.1.6 Two-Factor Parameters Describe Conditional Associations</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#example-student-alcohol-cigarette-and-marijuana-use"><i class="fa fa-check"></i>7.1.7 Example: Student Alcohol, Cigarette, and Marijuana Use</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#statistical-inference-for-loglinear-models"><i class="fa fa-check"></i>7.2 Statistical Inference for Loglinear Models</a><ul>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#chi-squared-goodness-of-fit-tests"><i class="fa fa-check"></i>7.2.1 Chi-Squared Goodness-of-Fit Tests</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#x7.2.2"><i class="fa fa-check"></i>7.2.2 Cell Standardized Residuals for Loglinear Models</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#significance-tests-about-conditional-associations"><i class="fa fa-check"></i>7.2.3 Significance Tests about Conditional Associations</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#confidence-intervals-for-conditional-odds-ratios"><i class="fa fa-check"></i>7.2.4 Confidence Intervals for Conditional Odds Ratios</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#bayesian-fitting-of-loglinear-models"><i class="fa fa-check"></i>7.2.5 Bayesian Fitting of Loglinear Models</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#loglinear-models-for-higher-dimensional-contingency-tables"><i class="fa fa-check"></i>7.2.6 Loglinear Models for Higher-Dimensional Contingency Tables</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#example-automobile-accidents-and-seat-belts"><i class="fa fa-check"></i>7.2.7 Example: Automobile Accidents and Seat Belts</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#interpreting-three-factor-interaction-terms"><i class="fa fa-check"></i>7.2.8 Interpreting Three-Factor Interaction Terms</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#statistical-versus-practical-significance-dissimilarity-index"><i class="fa fa-check"></i>7.2.9 Statistical Versus Practical Significance: Dissimilarity Index</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#the-loglinear---logistic-model-connection"><i class="fa fa-check"></i>7.3 The Loglinear - Logistic Model Connection</a><ul>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#using-logistic-models-to-interpret-loglinear-models"><i class="fa fa-check"></i>7.3.1 Using Logistic Models to Interpret Loglinear Models</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#example-auto-accident-data-revisited"><i class="fa fa-check"></i>7.3.2 Example: Auto Accident Data Revisited</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#condition-for-equivalent-loglinear-and-logistic-models"><i class="fa fa-check"></i>7.3.3 Condition for Equivalent Loglinear and Logistic Models</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#loglinearlogistic-model-selection-issues"><i class="fa fa-check"></i>7.3.4 Loglinear/Logistic Model Selection Issues</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#independence-graphs-and-collapsibility"><i class="fa fa-check"></i>7.4 Independence Graphs and Collapsibility</a><ul>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#independence-graphs"><i class="fa fa-check"></i>7.4.1 Independence Graphs</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#collapsibility-conditions-for-contingency-tables"><i class="fa fa-check"></i>7.4.2 Collapsibility Conditions for Contingency Tables</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#example-loglinear-model-building-for-student-substance-use"><i class="fa fa-check"></i>7.4.3 Example: Loglinear Model Building for Student Substance Use</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#collapsibility-and-logistic-models"><i class="fa fa-check"></i>7.4.4 Collapsibility and Logistic Models</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#modeling-ordinal-associations-in-contingency-tables"><i class="fa fa-check"></i>7.5 Modeling Ordinal Associations in Contingency Tables</a><ul>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#linear-by-linear-association-model"><i class="fa fa-check"></i>7.5.1 Linear-by-Linear Association Model</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#example-linear-by-linear-association-for-sex-opinions"><i class="fa fa-check"></i>7.5.2 Example: Linear-by-Linear Association for Sex Opinions</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#ordinal-significance-tests-of-independence"><i class="fa fa-check"></i>7.5.3 Ordinal Significance Tests of Independence</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#loglinear-modeling-of-count-response-variables"><i class="fa fa-check"></i>7.6 Loglinear Modeling of Count Response Variables *</a><ul>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#count-regressoin-modeling-of-rate-data"><i class="fa fa-check"></i>7.6.1 Count Regressoin Modeling of Rate Data</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#example-death-rates-for-lung-cancer-patients"><i class="fa fa-check"></i>7.6.2 Example: Death Rates for Lung Cancer Patients</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#negativee-binomial-regression-models"><i class="fa fa-check"></i>7.6.3 Negativee Binomial Regression Models</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#example-female-horseshoe-crab-satelites-revisited"><i class="fa fa-check"></i>7.6.4 Example: Female Horseshoe Crab Satelites Revisited</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html"><i class="fa fa-check"></i>8 Models for Matched Pairs</a><ul>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#x8.1"><i class="fa fa-check"></i>8.1 Comparing Dependent Proporitons for Binary Mached Pairs</a><ul>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#mcnemar-test-comparing-marginal-proportions"><i class="fa fa-check"></i>8.1.1 McNemar Test Comparing Marginal Proportions</a></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#estimating-the-difference-between-dependent-proportions"><i class="fa fa-check"></i>8.1.2 Estimating the difference between Dependent Proportions</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#x8.2"><i class="fa fa-check"></i>8.2 Marginal Models and Subject-Specific Models for Matched Pairs</a><ul>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#x8.2.1"><i class="fa fa-check"></i>8.2.1 Marginal Models for Marginal Proportions</a></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#example-enironmental-options-revisted"><i class="fa fa-check"></i>8.2.2 Example: Enironmental Options Revisted</a></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#x8.2.3"><i class="fa fa-check"></i>8.2.3 Subject-Specific and Population-Averaging Tables</a></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#x8.2.4"><i class="fa fa-check"></i>8.2.4 Conditional Logistic Regression for Matched-Pairs*</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#comparing-proportions-for-nominal-matched-pairs-responses"><i class="fa fa-check"></i>8.3 Comparing Proportions for Nominal Matched-Pairs Responses</a><ul>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#marginal-homogeneity-for-baseline-category-logit-models"><i class="fa fa-check"></i>8.3.1 Marginal Homogeneity for Baseline-Category Logit Models</a></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#using-cochran-mantel-haenszel-test-to-test-marinal-homogeneity"><i class="fa fa-check"></i>8.3.3 Using Cochran-Mantel-Haenszel Test to Test marinal Homogeneity*</a></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#x8.3.4"><i class="fa fa-check"></i>8.3.4 Symmetry and Quasi-Symmetry Models for Square Contingency Tables</a></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#example-coffee-brand-market-share-revisited"><i class="fa fa-check"></i>8.3.5 Example: Coffee Brand market Share Revisited</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#comparing-proportions-for-ordinal-matched-pairs-responses"><i class="fa fa-check"></i>8.4 Comparing Proportions for Ordinal Matched-Pairs Responses</a><ul>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#marginal-homogeneity-and-cummulative-logit-marginal-model"><i class="fa fa-check"></i>8.4.1 Marginal Homogeneity and Cummulative Logit Marginal Model</a></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#x8.4.2"><i class="fa fa-check"></i>8.4.2 Example: Recycle or Drive Less to Help the Environment?</a></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#an-ordinal-quasi-symmetry-model"><i class="fa fa-check"></i>8.4.3 An Ordinal Quasi-Symmetry Model *</a></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#example-recycle-or-drive-less-revisited"><i class="fa fa-check"></i>8.4.4 Example: Recycle or Drive Less Revisited?</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#analyzing-rater-agreement"><i class="fa fa-check"></i>8.5 Analyzing Rater Agreement *</a><ul>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#example-agreement-on-carcinoma-diagnosis"><i class="fa fa-check"></i>8.5.1 Example: Agreement on Carcinoma Diagnosis</a></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#cell-residuals-for-independence-model"><i class="fa fa-check"></i>8.5.2 Cell Residuals for Independence Model</a></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#quasi-independence-model"><i class="fa fa-check"></i>8.5.3 Quasi-Independence Model</a></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#quasi-independence-and-odds-ratios-summarizing-agreement"><i class="fa fa-check"></i>8.5.4 Quasi Independence and Odds Ratios Summarizing Agreement</a></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#kappa-summary-measure-of-agreement"><i class="fa fa-check"></i>8.5.5 Kappa Summary Measure of Agreement</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#bradley-terry-model-for-paired-preferences"><i class="fa fa-check"></i>8.6 Bradley-Terry Model for Paired Preferences *</a><ul>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#the-bradley-terry-model-of-quasi-symmetry"><i class="fa fa-check"></i>8.6.1 The Bradley-Terry Model of Quasi-Symmetry</a></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#example-ranking-men-tennis-players"><i class="fa fa-check"></i>8.6.2 Example: Ranking Men Tennis Players</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html"><i class="fa fa-check"></i>9 Marginal Modeling of Correlated, Clustered Responses</a><ul>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html#marginal-models-vs-subject-specific-models"><i class="fa fa-check"></i>9.1 Marginal Models Vs Subject-Specific Models</a><ul>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html#marginal-models-for-a-clustered-binary-response"><i class="fa fa-check"></i>9.1.1 Marginal Models for a Clustered Binary Response</a></li>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html#x9.1.2"><i class="fa fa-check"></i>9.1.2 Example: Repeated Responses on Similar Survey Questions</a></li>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html#subject-specific-models-for-a-repeated-response"><i class="fa fa-check"></i>9.1.3 Subject-Specific Models for a Repeated Response</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html#marginal-modeling-the-generalized-estimating-equations-gee-approach"><i class="fa fa-check"></i>9.2 Marginal Modeling: The Generalized Estimating Equations (GEE) Approach</a><ul>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html#quasi-likelihood-methods"><i class="fa fa-check"></i>9.2.1 Quasi-Likelihood Methods</a></li>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html#generalized-estimating-equation-methodology-basic-ideas"><i class="fa fa-check"></i>9.2.2 Generalized Estimating Equation Methodology: Basic Ideas</a></li>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html#x9.2.3"><i class="fa fa-check"></i>9.2.3 Example: Opinion about Legalized Abortion Revisited</a></li>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html#limitations-of-gee-compared-to-ml"><i class="fa fa-check"></i>9.2.4 Limitations of GEE Compared to ML</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html#marginal-modeling-for-clustered-multinomial-responses"><i class="fa fa-check"></i>9.3 Marginal Modeling for Clustered Multinomial Responses</a><ul>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html#x9.3.1"><i class="fa fa-check"></i>9.3.1 Example: Insomnia Study</a></li>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html#alternative-gee-specification-of-working-association"><i class="fa fa-check"></i>9.3.2 Alternative GEE Specification of Working Association</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html#transitional-modeling-given-the-past"><i class="fa fa-check"></i>9.4 Transitional Modeling, Given the Past</a><ul>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html#transitional-models-with-explanatory-variables"><i class="fa fa-check"></i>9.4.1 Transitional Models with Explanatory Variables</a></li>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html#example-respiratory-illness-and-maternal-smoking"><i class="fa fa-check"></i>9.4.2 Example: Respiratory Illness and Maternal Smoking</a></li>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html#x9.4.3"><i class="fa fa-check"></i>9.4.3 Group Comparisons Treating Initial Response as Covariate</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html#dealing-with-missing-data"><i class="fa fa-check"></i>9.5 Dealing with Missing Data *</a><ul>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html#missing-at-random-impact-on-ml-and-gee-methods"><i class="fa fa-check"></i>9.5.1 Missing at Random: Impact on ML and GEE Methods</a></li>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html#multiple-imputation-monte-carlo-prediction-of-missing-data"><i class="fa fa-check"></i>9.5.2 Multiple Imputation: Monte Carlo Prediction of missing Data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html"><i class="fa fa-check"></i>10 Random Effects: Generalized Linear Mixed Models</a><ul>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#random-effects-modeling-of-clustered-categorical-data"><i class="fa fa-check"></i>10.1 Random Effects Modeling of Clustered Categorical Data</a><ul>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#the-generalized-linear-mixed-model-glmm"><i class="fa fa-check"></i>10.1.1 The Generalized Linear Mixed Model (GLMM)</a></li>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#a-logistic-glmm-for-binary-matched-pairs"><i class="fa fa-check"></i>10.1.2 A Logistic GLMM for Binary Matched Pairs</a></li>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#example-environmental-opinions-revised"><i class="fa fa-check"></i>10.1.3 Example: Environmental Opinions Revised</a></li>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#differing-effects-in-glmms-and-marginal-models"><i class="fa fa-check"></i>10.1.4 Differing Effects in GLMMs and Marginal Models</a></li>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#model-fitting-for-glmms"><i class="fa fa-check"></i>10.1.5 Model Fitting for GLMMs</a></li>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#inference-for-model-parameters-and-prediction"><i class="fa fa-check"></i>10.1.6 Inference for Model Parameters and Prediction</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#examples-random-effects-models-for-binary-data"><i class="fa fa-check"></i>10.2 Examples: Random Effects Models for Binary Data</a><ul>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#small-area-estimation-of-binomial-probabilities"><i class="fa fa-check"></i>10.2.1 Small-Area Estimation of Binomial Probabilities</a></li>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#example-estimating-basketball-free-throw-success"><i class="fa fa-check"></i>10.2.2 Example: Estimating Basketball Free Throw Success</a></li>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#example-opinions-about-legalizing-abortion-revised"><i class="fa fa-check"></i>10.2.3 Example: Opinions about Legalizing Abortion Revised</a></li>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#item-response-models-the-rasch-model"><i class="fa fa-check"></i>10.2.4 Item Response Models: The Rasch Model</a></li>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#choice-of-marginal-model-or-random-effects-model"><i class="fa fa-check"></i>10.2.5 Choice of Marginal Model or Random Effects Model</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#extensions-to-multinomial-responses-and-multiple-random-effect-terms"><i class="fa fa-check"></i>10.3 Extensions to Multinomial Responses and Multiple Random Effect Terms</a><ul>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#example-insomnia-study-revisited"><i class="fa fa-check"></i>10.3.1 Example: Insomnia Study Revisited</a></li>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#meta-analysis-bivariate-random-effects-for-association-heterogeneity"><i class="fa fa-check"></i>10.3.2 Meta-Analysis: Bivariate Random Effects for Association Heterogeneity</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#multilevel-hierarchical-models"><i class="fa fa-check"></i>10.4 Multilevel (Hierarchical) Models</a><ul>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#example-two-level-model-for-student-performance"><i class="fa fa-check"></i>10.4.1 Example: Two-Level Model for Student Performance</a></li>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#example-smoking-prevention-and-cessation-study"><i class="fa fa-check"></i>10.4.2 Example: Smoking Prevention and Cessation Study</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#latent-class-models"><i class="fa fa-check"></i>10.5 Latent Class Models *</a><ul>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#independence-given-a-latent-categorical-variable"><i class="fa fa-check"></i>10.5.1 Independence Given a Latent Categorical Variable</a></li>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#example-latent-class-model-for-rater-agreement"><i class="fa fa-check"></i>10.5.2 Example: Latent Class Model for Rater Agreement</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#exercises-2"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html"><i class="fa fa-check"></i>11 Classification and Smoothing</a><ul>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#classification-linear-discrinant-analysis"><i class="fa fa-check"></i>11.1 Classification: Linear Discrinant Analysis</a><ul>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#classification-with-fishers-linear-discriminant-function"><i class="fa fa-check"></i>11.1.1 Classification with Fisher’s Linear Discriminant Function</a></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#example-horseshoe-crab-satellites-revisited-1"><i class="fa fa-check"></i>11.1.2 Example: Horseshoe Crab Satellites Revisited</a></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#discriminant-analysis-versus-logistic-regression"><i class="fa fa-check"></i>11.1.3 Discriminant Analysis Versus Logistic Regression</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#classification-tree-based-prediction"><i class="fa fa-check"></i>11.2 Classification: Tree-Based Prediction</a><ul>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#classification-trees"><i class="fa fa-check"></i>11.2.1 Classification Trees</a></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#example-a-classification-tree-for-horseshoe-crab-mating"><i class="fa fa-check"></i>11.2.2 Example: A classification Tree for Horseshoe Crab Mating</a></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#how-does-the-classification-tree-grow"><i class="fa fa-check"></i>11.2.3 How Does the Classification Tree Grow?</a></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#pruning-a-tree-and-checking-prediction-accuracy"><i class="fa fa-check"></i>11.2.4 Pruning a Tree and Checking Prediction Accuracy</a></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#classification-trees-versus-logistic-regression-and-discriminant-analysis"><i class="fa fa-check"></i>11.2.5 Classification Trees Versus Logistic Regression and Discriminant Analysis</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#cluster-analysis-for-categorical-responses"><i class="fa fa-check"></i>11.3 Cluster Analysis for Categorical Responses</a><ul>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#measuring-dissimilarity-between-observations"><i class="fa fa-check"></i>11.3.1 Measuring Dissimilarity Between Observations</a></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#hierarchical-clustering-algorithm-and-dendrograms"><i class="fa fa-check"></i>11.3.2 Hierarchical Clustering Algorithm and Dendrograms</a></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#example-clustering-states-on-presidential-elections"><i class="fa fa-check"></i>11.3.3 Example: Clustering States on Presidential Elections</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#smoothing-generalized-additive-models"><i class="fa fa-check"></i>11.4 Smoothing: Generalized Additive Models</a><ul>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#generalized-additive-models"><i class="fa fa-check"></i>11.4.1 Generalized Additive Models</a></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#example-gams-for-horseshoe-crab-data"><i class="fa fa-check"></i>11.4.2 Example: GAMs for Horseshoe Crab Data</a></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#how-much-smoothing-the-biasvariance-tradeoff"><i class="fa fa-check"></i>11.4.3 How Much Smoothing? The Bias/Variance Tradeoff</a></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#example-smoothing-to-portray-probability-of-kyphosis"><i class="fa fa-check"></i>11.4.4 Example: Smoothing to Portray Probability of Kyphosis</a></li>
</ul></li>
<li><a href="Classification.html#regularization-for-high-dimensional-categorical-data-large-p">11.5 Regularization for High-Dimensional Categorical Data (Large <em>p</em>)</a><ul>
<li><a href="Classification.html#penalized-likelihood-methods-and-l_q-norm-smoothing">11.5.1 Penalized-Likelihood Methods and <span class="math inline">\(L_q\)</span>-Norm Smoothing</a></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#implementing-the-lasso"><i class="fa fa-check"></i>11.5.2 Implementing the Lasso</a></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#example-predicting-option-on-abortion-with-student-survey"><i class="fa fa-check"></i>11.5.3 Example: Predicting Option on Abortion with Student Survey</a></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#why-shrink-ml-estimates-toward-0"><i class="fa fa-check"></i>11.5.4 Why Shrink ML Estimates Toward 0?</a></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#issues-in-variable-selection-dimension-reduction"><i class="fa fa-check"></i>11.5.5 Issues In variable Selection (Dimension Reduction)</a></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#controlling-the-false-discovery-rate"><i class="fa fa-check"></i>11.5.6 Controlling the False Discovery Rate</a></li>
<li><a href="Classification.html#large-p-also-makes-bayesian-inference-challenging">11.5.7 Large <span class="math inline">\(p\)</span> also Makes Bayesian Inference Challenging</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="rmarkdown.html"><a href="rmarkdown.html"><i class="fa fa-check"></i>99 R Markdown</a><ul>
<li class="chapter" data-level="" data-path="rmarkdown.html"><a href="rmarkdown.html#formatting"><i class="fa fa-check"></i>Formatting</a></li>
<li class="chapter" data-level="" data-path="rmarkdown.html"><a href="rmarkdown.html#symbols"><i class="fa fa-check"></i>Symbols</a></li>
<li class="chapter" data-level="" data-path="rmarkdown.html"><a href="rmarkdown.html#markdown-highlighting"><i class="fa fa-check"></i>Markdown highlighting</a></li>
<li class="chapter" data-level="" data-path="rmarkdown.html"><a href="rmarkdown.html#text-coloring"><i class="fa fa-check"></i>Text coloring</a></li>
<li class="chapter" data-level="" data-path="rmarkdown.html"><a href="rmarkdown.html#equations"><i class="fa fa-check"></i>Equations</a></li>
<li class="chapter" data-level="" data-path="rmarkdown.html"><a href="rmarkdown.html#x99.4"><i class="fa fa-check"></i>Section references</a></li>
<li class="chapter" data-level="" data-path="rmarkdown.html"><a href="rmarkdown.html#footnotes"><i class="fa fa-check"></i>Footnotes</a></li>
<li class="chapter" data-level="" data-path="rmarkdown.html"><a href="rmarkdown.html#displaying-formula"><i class="fa fa-check"></i>Displaying Formula</a><ul>
<li class="chapter" data-level="" data-path="rmarkdown.html"><a href="rmarkdown.html#notation"><i class="fa fa-check"></i>Notation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="rmarkdown.html"><a href="rmarkdown.html#greek-letters"><i class="fa fa-check"></i>Greek letters</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Notes for Agresti’s Introduction to Categorical Data Analysis 3rd Edition</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="Logistic" class="section level1">
<h1>4 Logistic Regression</h1>
<div id="the-logistic-regression-model" class="section level2">
<h2>4.1 The Logistic Regression Model</h2>
<div id="the-logistic-regression-model-1" class="section level3">
<h3>4.1.1 The Logistic Regression Model</h3>
<p><span class="math display" id="eq:logitOfSuccess">\[\begin{equation} 
  \mathrm{logit}[\pi(x)] = \mathrm{log}\left[\frac{\pi(x)}{1=\pi(x)}\right]= \alpha + \beta x.
  \tag{6}
\end{equation}\]</span></p>
<p><span class="math display" id="eq:exponentialFunction">\[\begin{equation} 
  \pi(x) = \frac{e^{\alpha + \beta x}}{1+e^{\alpha + \beta x}}.
  \tag{7}
\end{equation}\]</span></p>
</div>
<div id="odds-ratio-and-linear-approximaiton-interpreetations-4.1.2" class="section level3">
<h3>4.1.2 Odds Ratio and Linear Approximaiton Interpreetations {#4.1.2}</h3>
<p><span class="math display">\[\frac{\pi(x)}{1-\pi(x)}=\mathrm{exp}(\alpha + \beta x) = e^\alpha(e^\beta)^x.\]</span></p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="Logistic.html#cb158-1"></a>Crabs &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;http://users.stat.ufl.edu/~aa/cat/data/Crabs.dat&quot;</span>,</span>
<span id="cb158-2"><a href="Logistic.html#cb158-2"></a>  <span class="dt">header =</span> <span class="ot">TRUE</span></span>
<span id="cb158-3"><a href="Logistic.html#cb158-3"></a>)</span>
<span id="cb158-4"><a href="Logistic.html#cb158-4"></a><span class="kw">library</span>(RColorBrewer)</span>
<span id="cb158-5"><a href="Logistic.html#cb158-5"></a>colors &lt;-<span class="st"> </span><span class="kw">brewer.pal</span>(<span class="dt">n =</span> <span class="dv">4</span>, <span class="dt">name =</span> <span class="st">&quot;Dark2&quot;</span>)</span>
<span id="cb158-6"><a href="Logistic.html#cb158-6"></a></span>
<span id="cb158-7"><a href="Logistic.html#cb158-7"></a>fit &lt;-<span class="st"> </span><span class="kw">glm</span>(y <span class="op">~</span><span class="st"> </span>width, <span class="dt">family =</span> binomial, <span class="dt">data =</span> Crabs)</span>
<span id="cb158-8"><a href="Logistic.html#cb158-8"></a><span class="kw">summary</span>(fit)</span></code></pre></div>
<pre class="custom-output"><code>
Call:
glm(formula = y ~ width, family = binomial, data = Crabs)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.0281  -1.0458   0.5480   0.9066   1.6942  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -12.3508     2.6287  -4.698 2.62e-06 ***
width         0.4972     0.1017   4.887 1.02e-06 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 225.76  on 172  degrees of freedom
Residual deviance: 194.45  on 171  degrees of freedom
AIC: 198.45

Number of Fisher Scoring iterations: 4</code></pre>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="Logistic.html#cb160-1"></a>at28 &lt;-<span class="st"> </span><span class="kw">predict</span>(fit, <span class="kw">data.frame</span>(<span class="dt">width =</span> <span class="dv">28</span>), <span class="dt">type =</span> <span class="st">&quot;resp&quot;</span>)</span>
<span id="cb160-2"><a href="Logistic.html#cb160-2"></a>at29 &lt;-<span class="st"> </span><span class="kw">predict</span>(fit, <span class="kw">data.frame</span>(<span class="dt">width =</span> <span class="dv">29</span>), <span class="dt">type =</span> <span class="st">&quot;resp&quot;</span>)</span>
<span id="cb160-3"><a href="Logistic.html#cb160-3"></a></span>
<span id="cb160-4"><a href="Logistic.html#cb160-4"></a>x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">20</span>, <span class="dv">34</span>, <span class="dt">by =</span> <span class="fl">.01</span>)</span>
<span id="cb160-5"><a href="Logistic.html#cb160-5"></a></span>
<span id="cb160-6"><a href="Logistic.html#cb160-6"></a>df &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">x =</span> x) <span class="op">%&gt;%</span></span>
<span id="cb160-7"><a href="Logistic.html#cb160-7"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">y =</span> <span class="kw">predict</span>(fit, <span class="kw">data.frame</span>(<span class="dt">width =</span> x), <span class="dt">type =</span> <span class="st">&quot;resp&quot;</span>))</span>
<span id="cb160-8"><a href="Logistic.html#cb160-8"></a></span>
<span id="cb160-9"><a href="Logistic.html#cb160-9"></a></span>
<span id="cb160-10"><a href="Logistic.html#cb160-10"></a>spl &lt;-<span class="st"> </span><span class="kw">smooth.spline</span>(df<span class="op">$</span>x, df<span class="op">$</span>y, <span class="dt">spar =</span> <span class="fl">0.3</span>)</span>
<span id="cb160-11"><a href="Logistic.html#cb160-11"></a>newx &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="kw">min</span>(df<span class="op">$</span>x), <span class="kw">max</span>(df<span class="op">$</span>x), <span class="fl">0.1</span>)</span>
<span id="cb160-12"><a href="Logistic.html#cb160-12"></a>pred &lt;-<span class="st"> </span><span class="kw">predict</span>(spl, <span class="dt">x =</span> newx, <span class="dt">deriv =</span> <span class="dv">0</span>)</span>
<span id="cb160-13"><a href="Logistic.html#cb160-13"></a></span>
<span id="cb160-14"><a href="Logistic.html#cb160-14"></a><span class="co"># solve for tangent at a given x</span></span>
<span id="cb160-15"><a href="Logistic.html#cb160-15"></a>newx &lt;-<span class="st"> </span><span class="dv">28</span></span>
<span id="cb160-16"><a href="Logistic.html#cb160-16"></a>pred0 &lt;-<span class="st"> </span><span class="kw">predict</span>(spl, <span class="dt">x =</span> newx, <span class="dt">deriv =</span> <span class="dv">0</span>)</span>
<span id="cb160-17"><a href="Logistic.html#cb160-17"></a>pred1 &lt;-<span class="st"> </span><span class="kw">predict</span>(spl, <span class="dt">x =</span> newx, <span class="dt">deriv =</span> <span class="dv">1</span>)</span>
<span id="cb160-18"><a href="Logistic.html#cb160-18"></a>yint &lt;-<span class="st"> </span>pred0<span class="op">$</span>y <span class="op">-</span><span class="st"> </span>(pred1<span class="op">$</span>y <span class="op">*</span><span class="st"> </span>newx)</span>
<span id="cb160-19"><a href="Logistic.html#cb160-19"></a>xint &lt;-<span class="st"> </span><span class="op">-</span>yint <span class="op">/</span><span class="st"> </span>pred1<span class="op">$</span>y</span>
<span id="cb160-20"><a href="Logistic.html#cb160-20"></a></span>
<span id="cb160-21"><a href="Logistic.html#cb160-21"></a>tang &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">x =</span> df<span class="op">$</span>x) <span class="op">%&gt;%</span></span>
<span id="cb160-22"><a href="Logistic.html#cb160-22"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">y =</span> yint <span class="op">+</span><span class="st"> </span>pred1<span class="op">$</span>y <span class="op">*</span><span class="st"> </span>x) <span class="op">%&gt;%</span></span>
<span id="cb160-23"><a href="Logistic.html#cb160-23"></a><span class="st">  </span><span class="kw">filter</span>(x <span class="op">&gt;</span><span class="st"> </span><span class="fl">25.5</span> <span class="op">&amp;</span><span class="st"> </span>x <span class="op">&lt;</span><span class="st"> </span><span class="fl">30.5</span>)</span>
<span id="cb160-24"><a href="Logistic.html#cb160-24"></a></span>
<span id="cb160-25"><a href="Logistic.html#cb160-25"></a><span class="kw">library</span>(ggthemes)</span>
<span id="cb160-26"><a href="Logistic.html#cb160-26"></a></span>
<span id="cb160-27"><a href="Logistic.html#cb160-27"></a>aLabel &lt;-<span class="st"> </span><span class="kw">as.vector</span>(<span class="kw">expression</span>(<span class="kw">paste</span>(beta, pi, <span class="st">&quot;(1-&quot;</span>, pi, <span class="st">&quot;)&quot;</span>)))</span>
<span id="cb160-28"><a href="Logistic.html#cb160-28"></a></span>
<span id="cb160-29"><a href="Logistic.html#cb160-29"></a><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb160-30"><a href="Logistic.html#cb160-30"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">data =</span> df, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y)) <span class="op">+</span></span>
<span id="cb160-31"><a href="Logistic.html#cb160-31"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">data =</span> tang, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y)) <span class="op">+</span></span>
<span id="cb160-32"><a href="Logistic.html#cb160-32"></a><span class="st">  </span><span class="kw">annotate</span>(</span>
<span id="cb160-33"><a href="Logistic.html#cb160-33"></a>    <span class="dt">geom =</span> <span class="st">&quot;segment&quot;</span>, <span class="dt">x =</span> <span class="dv">28</span>, <span class="dt">y =</span> at28, <span class="dt">xend =</span> <span class="dv">28</span>, <span class="dt">yend =</span> at29,</span>
<span id="cb160-34"><a href="Logistic.html#cb160-34"></a>    <span class="dt">color =</span> colors[<span class="dv">1</span>]</span>
<span id="cb160-35"><a href="Logistic.html#cb160-35"></a>  ) <span class="op">+</span></span>
<span id="cb160-36"><a href="Logistic.html#cb160-36"></a><span class="st">  </span><span class="kw">annotate</span>(</span>
<span id="cb160-37"><a href="Logistic.html#cb160-37"></a>    <span class="dt">geom =</span> <span class="st">&quot;segment&quot;</span>, <span class="dt">x =</span> <span class="dv">28</span>, <span class="dt">y =</span> at29, <span class="dt">xend =</span> <span class="dv">29</span>, <span class="dt">yend =</span> at29,</span>
<span id="cb160-38"><a href="Logistic.html#cb160-38"></a>    <span class="dt">color =</span> colors[<span class="dv">1</span>]</span>
<span id="cb160-39"><a href="Logistic.html#cb160-39"></a>  ) <span class="op">+</span></span>
<span id="cb160-40"><a href="Logistic.html#cb160-40"></a><span class="st">  </span><span class="kw">annotate</span>(</span>
<span id="cb160-41"><a href="Logistic.html#cb160-41"></a>    <span class="dt">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="fl">26.35</span>, <span class="dt">y =</span> at28 <span class="op">+</span><span class="st"> </span><span class="fl">.02</span>,</span>
<span id="cb160-42"><a href="Logistic.html#cb160-42"></a>    <span class="dt">label =</span> <span class="st">&#39;paste(beta, pi, &quot;(1-&quot; , pi, &quot;)&quot;)&#39;</span>, <span class="dt">parse =</span> <span class="ot">TRUE</span>,</span>
<span id="cb160-43"><a href="Logistic.html#cb160-43"></a>    <span class="dt">hjust =</span> <span class="st">&quot;left&quot;</span>,</span>
<span id="cb160-44"><a href="Logistic.html#cb160-44"></a>    <span class="dt">color =</span> colors[<span class="dv">1</span>]</span>
<span id="cb160-45"><a href="Logistic.html#cb160-45"></a>  ) <span class="op">+</span></span>
<span id="cb160-46"><a href="Logistic.html#cb160-46"></a><span class="st">  </span><span class="kw">annotate</span>(</span>
<span id="cb160-47"><a href="Logistic.html#cb160-47"></a>    <span class="dt">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="fl">28.3</span>, <span class="dt">y =</span> at29 <span class="op">+</span><span class="st"> </span><span class="fl">.03</span>,</span>
<span id="cb160-48"><a href="Logistic.html#cb160-48"></a>    <span class="dt">label =</span> <span class="st">&quot;1&quot;</span>,</span>
<span id="cb160-49"><a href="Logistic.html#cb160-49"></a>    <span class="dt">hjust =</span> <span class="st">&quot;left&quot;</span>,</span>
<span id="cb160-50"><a href="Logistic.html#cb160-50"></a>    <span class="dt">color =</span> colors[<span class="dv">1</span>]</span>
<span id="cb160-51"><a href="Logistic.html#cb160-51"></a>  ) <span class="op">+</span></span>
<span id="cb160-52"><a href="Logistic.html#cb160-52"></a><span class="st">  </span><span class="kw">theme_few</span>() <span class="op">+</span></span>
<span id="cb160-53"><a href="Logistic.html#cb160-53"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">0</span>, <span class="dt">vjust =</span> <span class="fl">.5</span>)) <span class="op">+</span></span>
<span id="cb160-54"><a href="Logistic.html#cb160-54"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">20</span>, <span class="dv">34</span>, <span class="dt">by =</span> <span class="dv">2</span>)) <span class="op">+</span></span>
<span id="cb160-55"><a href="Logistic.html#cb160-55"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">by =</span> <span class="fl">.2</span>)) <span class="op">+</span></span>
<span id="cb160-56"><a href="Logistic.html#cb160-56"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Figure 4.1&quot;</span>) <span class="op">+</span></span>
<span id="cb160-57"><a href="Logistic.html#cb160-57"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Width&quot;</span>) <span class="op">+</span></span>
<span id="cb160-58"><a href="Logistic.html#cb160-58"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Probability&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-36-1.png" width="672" /></p>
</div>
<div id="x4.1.3" class="section level3">
<h3>4.1.3 Example: Whethr a Female Horsehoe Crab Has Satelites</h3>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="Logistic.html#cb161-1"></a>Crabs &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;http://users.stat.ufl.edu/~aa/cat/data/Crabs.dat&quot;</span>,</span>
<span id="cb161-2"><a href="Logistic.html#cb161-2"></a>  <span class="dt">header =</span> <span class="ot">TRUE</span></span>
<span id="cb161-3"><a href="Logistic.html#cb161-3"></a>)</span>
<span id="cb161-4"><a href="Logistic.html#cb161-4"></a></span>
<span id="cb161-5"><a href="Logistic.html#cb161-5"></a>Crabs <span class="op">%&gt;%</span></span>
<span id="cb161-6"><a href="Logistic.html#cb161-6"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">row_number</span>() <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="kw">n</span>()))</span></code></pre></div>
<pre class="custom-output"><code>  crab sat y weight width color spine
1    1   8 1   3.05  28.3     2     3
2    2   0 0   1.55  22.5     3     3
3  173   0 0   2.00  24.5     2     2</code></pre>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="Logistic.html#cb163-1"></a><span class="kw">library</span>(RColorBrewer)</span>
<span id="cb163-2"><a href="Logistic.html#cb163-2"></a>colors &lt;-<span class="st"> </span><span class="kw">brewer.pal</span>(<span class="dt">n =</span> <span class="dv">4</span>, <span class="dt">name =</span> <span class="st">&quot;Dark2&quot;</span>)</span>
<span id="cb163-3"><a href="Logistic.html#cb163-3"></a></span>
<span id="cb163-4"><a href="Logistic.html#cb163-4"></a><span class="kw">library</span>(gam)</span>
<span id="cb163-5"><a href="Logistic.html#cb163-5"></a>gam.fit &lt;-<span class="st"> </span><span class="kw">gam</span>(y <span class="op">~</span><span class="st"> </span><span class="kw">s</span>(width), <span class="dt">family =</span> binomial, <span class="dt">data =</span> Crabs)</span>
<span id="cb163-6"><a href="Logistic.html#cb163-6"></a>fit &lt;-<span class="st"> </span><span class="kw">glm</span>(y <span class="op">~</span><span class="st"> </span>width, <span class="dt">family =</span> binomial, <span class="dt">data =</span> Crabs)</span>
<span id="cb163-7"><a href="Logistic.html#cb163-7"></a></span>
<span id="cb163-8"><a href="Logistic.html#cb163-8"></a><span class="kw">plot</span>(<span class="kw">jitter</span>(y, <span class="fl">0.08</span>) <span class="op">~</span><span class="st"> </span>width, <span class="dt">data =</span> Crabs, <span class="dt">xlab =</span> <span class="st">&quot;Width&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Satellites&quot;</span>)</span>
<span id="cb163-9"><a href="Logistic.html#cb163-9"></a><span class="kw">curve</span>(<span class="kw">predict</span>(gam.fit, <span class="kw">data.frame</span>(<span class="dt">width =</span> x), <span class="dt">type =</span> <span class="st">&quot;resp&quot;</span>),</span>
<span id="cb163-10"><a href="Logistic.html#cb163-10"></a>  <span class="dt">col =</span> colors[<span class="dv">1</span>], <span class="dt">add =</span> <span class="ot">TRUE</span></span>
<span id="cb163-11"><a href="Logistic.html#cb163-11"></a>)</span>
<span id="cb163-12"><a href="Logistic.html#cb163-12"></a><span class="kw">curve</span>(<span class="kw">predict</span>(fit, <span class="kw">data.frame</span>(<span class="dt">width =</span> x), <span class="dt">type =</span> <span class="st">&quot;resp&quot;</span>),</span>
<span id="cb163-13"><a href="Logistic.html#cb163-13"></a>  <span class="dt">col =</span> colors[<span class="dv">2</span>], <span class="dt">add =</span> <span class="ot">TRUE</span></span>
<span id="cb163-14"><a href="Logistic.html#cb163-14"></a>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-37-1.png" width="672" /></p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="Logistic.html#cb164-1"></a><span class="kw">summary</span>(fit)</span></code></pre></div>
<pre class="custom-output"><code>
Call:
glm(formula = y ~ width, family = binomial, data = Crabs)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.0281  -1.0458   0.5480   0.9066   1.6942  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -12.3508     2.6287  -4.698 2.62e-06 ***
width         0.4972     0.1017   4.887 1.02e-06 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 225.76  on 172  degrees of freedom
Residual deviance: 194.45  on 171  degrees of freedom
AIC: 198.45

Number of Fisher Scoring iterations: 4</code></pre>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="Logistic.html#cb166-1"></a><span class="co"># estimated probability of satellite at width = 21.0</span></span>
<span id="cb166-2"><a href="Logistic.html#cb166-2"></a><span class="kw">predict</span>(fit, <span class="kw">data.frame</span>(<span class="dt">width =</span> <span class="fl">21.0</span>), <span class="dt">type =</span> <span class="st">&quot;resp&quot;</span>)</span></code></pre></div>
<pre class="custom-output"><code>       1 
0.129096 </code></pre>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="Logistic.html#cb168-1"></a><span class="kw">predict</span>(fit, <span class="kw">data.frame</span>(<span class="dt">width =</span> <span class="kw">mean</span>(Crabs<span class="op">$</span>width)), <span class="dt">type =</span> <span class="st">&quot;resp&quot;</span>)</span></code></pre></div>
<pre class="custom-output"><code>        1 
0.6738768 </code></pre>
<p><span class="math display">\[\mathrm{logit}[\hat\pi(x)] = -12.351 + 0.497 x.\]</span></p>
<p><span class="math display">\[\hat\pi(x) =\frac{\mathrm{exp}(-12.351 + 0.497 x)}{1+\mathrm{exp}(-12.351 + 0.497 x)}.\]</span></p>
<p><span class="math display">\[\frac{\mathrm{exp}[-12.351 + 0.497 (21.0)]}{1+\mathrm{exp}[-12.351 + 0.497 (21.0)]} = 0.129.\]</span></p>
</div>
<div id="logistic-regression-with-retrospective-studies" class="section level3">
<h3>4.1.4 Logistic Regression with Retrospective Studies</h3>
</div>
<div id="normally-distributed-x-implies-logistic-regression-for-y" class="section level3">
<h3>4.1.5 Normally Distributed X Implies Logistic Regression for Y</h3>
</div>
</div>
<div id="x4.2" class="section level2">
<h2>4.2 Statistical Inference for Logistic Regression</h2>
<div id="x4.2.1" class="section level3">
<h3>4.2.1 Confidence Intervals for Effects</h3>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="Logistic.html#cb170-1"></a>Crabs &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;http://users.stat.ufl.edu/~aa/cat/data/Crabs.dat&quot;</span>,</span>
<span id="cb170-2"><a href="Logistic.html#cb170-2"></a>  <span class="dt">header =</span> <span class="ot">TRUE</span></span>
<span id="cb170-3"><a href="Logistic.html#cb170-3"></a>)</span>
<span id="cb170-4"><a href="Logistic.html#cb170-4"></a></span>
<span id="cb170-5"><a href="Logistic.html#cb170-5"></a>fit &lt;-<span class="st"> </span><span class="kw">glm</span>(y <span class="op">~</span><span class="st"> </span>width, <span class="dt">family =</span> binomial, <span class="dt">data =</span> Crabs)</span>
<span id="cb170-6"><a href="Logistic.html#cb170-6"></a><span class="kw">summary</span>(fit) <span class="co"># z value &amp; p-value Wald test</span></span></code></pre></div>
<pre class="custom-output"><code>
Call:
glm(formula = y ~ width, family = binomial, data = Crabs)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.0281  -1.0458   0.5480   0.9066   1.6942  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -12.3508     2.6287  -4.698 2.62e-06 ***
width         0.4972     0.1017   4.887 1.02e-06 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 225.76  on 172  degrees of freedom
Residual deviance: 194.45  on 171  degrees of freedom
AIC: 198.45

Number of Fisher Scoring iterations: 4</code></pre>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="Logistic.html#cb172-1"></a><span class="kw">suppressMessages</span>(</span>
<span id="cb172-2"><a href="Logistic.html#cb172-2"></a>  <span class="kw">confint</span>(fit) <span class="co"># profile likelihood confidence interval</span></span>
<span id="cb172-3"><a href="Logistic.html#cb172-3"></a>)</span></code></pre></div>
<pre class="custom-output"><code>                  2.5 %     97.5 %
(Intercept) -17.8100090 -7.4572470
width         0.3083806  0.7090167</code></pre>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="Logistic.html#cb174-1"></a><span class="kw">suppressPackageStartupMessages</span>(<span class="kw">library</span>(car))</span>
<span id="cb174-2"><a href="Logistic.html#cb174-2"></a><span class="kw">Anova</span>(fit) <span class="co"># likelihood-ratio test of width effect</span></span></code></pre></div>
<pre class="custom-output"><code>Analysis of Deviance Table (Type II tests)

Response: y
      LR Chisq Df Pr(&gt;Chisq)    
width   31.306  1  2.204e-08 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="x4.2.2" class="section level3">
<h3>4.2.2 Significance Testing</h3>
</div>
<div id="fitted-values-and-confidence-intervals-for-probabilities" class="section level3">
<h3>4.2.3 Fitted Values and Confidence Intervals for Probabilities</h3>
<p><span class="math display">\[\hat P(Y=1)=\mathrm{exp}(\hat\alpha + \hat\beta x)/[1 + (\hat\alpha + \hat\beta x)],\]</span></p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="Logistic.html#cb176-1"></a>Crabs &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;http://users.stat.ufl.edu/~aa/cat/data/Crabs.dat&quot;</span>,</span>
<span id="cb176-2"><a href="Logistic.html#cb176-2"></a>  <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">stringsAsFactors =</span> <span class="ot">TRUE</span></span>
<span id="cb176-3"><a href="Logistic.html#cb176-3"></a>)</span>
<span id="cb176-4"><a href="Logistic.html#cb176-4"></a></span>
<span id="cb176-5"><a href="Logistic.html#cb176-5"></a>fit &lt;-<span class="st"> </span><span class="kw">glm</span>(y <span class="op">~</span><span class="st"> </span>width, <span class="dt">family =</span> binomial, <span class="dt">data =</span> Crabs)</span>
<span id="cb176-6"><a href="Logistic.html#cb176-6"></a>pred.prob &lt;-<span class="st"> </span><span class="kw">fitted</span>(fit) <span class="co"># ML fitted value estimate of P(Y = 1)</span></span>
<span id="cb176-7"><a href="Logistic.html#cb176-7"></a>lp &lt;-<span class="st"> </span><span class="kw">predict</span>(fit, <span class="dt">se.fit =</span> <span class="ot">TRUE</span>) <span class="co"># linear predictor</span></span>
<span id="cb176-8"><a href="Logistic.html#cb176-8"></a>LB &lt;-<span class="st"> </span>lp<span class="op">$</span>fit <span class="op">-</span><span class="st"> </span><span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span>lp<span class="op">$</span>se.fit <span class="co"># confidence bounds for linear predictor</span></span>
<span id="cb176-9"><a href="Logistic.html#cb176-9"></a>LB &lt;-<span class="st"> </span>lp<span class="op">$</span>fit <span class="op">+</span><span class="st"> </span><span class="kw">qnorm</span>(<span class="fl">0.025</span>) <span class="op">*</span><span class="st"> </span>lp<span class="op">$</span>se.fit <span class="co"># better confidence bound</span></span>
<span id="cb176-10"><a href="Logistic.html#cb176-10"></a>UB &lt;-<span class="st"> </span>lp<span class="op">$</span>fit <span class="op">+</span><span class="st"> </span><span class="kw">qnorm</span>(<span class="fl">0.975</span>) <span class="op">*</span><span class="st"> </span>lp<span class="op">$</span>se.fit</span>
<span id="cb176-11"><a href="Logistic.html#cb176-11"></a>LB.p &lt;-<span class="st"> </span><span class="kw">exp</span>(LB) <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw">exp</span>(LB)) <span class="co"># confidence bounds for P(Y = 1)</span></span>
<span id="cb176-12"><a href="Logistic.html#cb176-12"></a>UB.p &lt;-<span class="st"> </span><span class="kw">exp</span>(UB) <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw">exp</span>(UB))</span>
<span id="cb176-13"><a href="Logistic.html#cb176-13"></a></span>
<span id="cb176-14"><a href="Logistic.html#cb176-14"></a></span>
<span id="cb176-15"><a href="Logistic.html#cb176-15"></a><span class="kw">library</span>(dplyr) <span class="co"># bind_cols, filter, row_number</span></span>
<span id="cb176-16"><a href="Logistic.html#cb176-16"></a>predictions &lt;-</span>
<span id="cb176-17"><a href="Logistic.html#cb176-17"></a><span class="st">  </span><span class="kw">bind_cols</span>(</span>
<span id="cb176-18"><a href="Logistic.html#cb176-18"></a>    <span class="dt">Width =</span> Crabs<span class="op">$</span>width,</span>
<span id="cb176-19"><a href="Logistic.html#cb176-19"></a>    <span class="st">`</span><span class="dt">Predicted probaility</span><span class="st">`</span> =<span class="st"> </span>pred.prob,</span>
<span id="cb176-20"><a href="Logistic.html#cb176-20"></a>    <span class="st">`</span><span class="dt">Lower CB</span><span class="st">`</span> =<span class="st"> </span>LB.p,</span>
<span id="cb176-21"><a href="Logistic.html#cb176-21"></a>    <span class="st">`</span><span class="dt">Upper CB</span><span class="st">`</span> =<span class="st"> </span>UB.p</span>
<span id="cb176-22"><a href="Logistic.html#cb176-22"></a>  )</span>
<span id="cb176-23"><a href="Logistic.html#cb176-23"></a></span>
<span id="cb176-24"><a href="Logistic.html#cb176-24"></a>predictions <span class="op">%&gt;%</span></span>
<span id="cb176-25"><a href="Logistic.html#cb176-25"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">row_number</span>() <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">7</span>, <span class="kw">n</span>()))</span></code></pre></div>
<pre class="custom-output"><code># A tibble: 3 x 4
  Width `Predicted probaility` `Lower CB` `Upper CB`
  &lt;dbl&gt;                  &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;
1  28.3                  0.848      0.753      0.911
2  26.5                  0.695      0.612      0.768
3  24.5                  0.458      0.356      0.564</code></pre>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="Logistic.html#cb178-1"></a>fit &lt;-<span class="st"> </span><span class="kw">glm</span>(y <span class="op">~</span><span class="st"> </span>width, <span class="dt">family =</span> binomial, <span class="dt">data =</span> Crabs)</span>
<span id="cb178-2"><a href="Logistic.html#cb178-2"></a></span>
<span id="cb178-3"><a href="Logistic.html#cb178-3"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb178-4"><a href="Logistic.html#cb178-4"></a>data.plot &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">width =</span> <span class="dv">18</span><span class="op">:</span><span class="dv">34</span>)</span>
<span id="cb178-5"><a href="Logistic.html#cb178-5"></a>lp &lt;-<span class="st"> </span><span class="kw">predict</span>(fit, <span class="dt">newdata =</span> data.plot, <span class="dt">se.fit =</span> <span class="ot">TRUE</span>)</span>
<span id="cb178-6"><a href="Logistic.html#cb178-6"></a></span>
<span id="cb178-7"><a href="Logistic.html#cb178-7"></a><span class="kw">library</span>(ggthemes)</span>
<span id="cb178-8"><a href="Logistic.html#cb178-8"></a>data.plot &lt;-<span class="st"> </span>data.plot <span class="op">%&gt;%</span></span>
<span id="cb178-9"><a href="Logistic.html#cb178-9"></a><span class="st">  </span><span class="kw">mutate</span>(</span>
<span id="cb178-10"><a href="Logistic.html#cb178-10"></a>    <span class="dt">pred.prob =</span> <span class="kw">exp</span>(lp<span class="op">$</span>fit) <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw">exp</span>(lp<span class="op">$</span>fit)),</span>
<span id="cb178-11"><a href="Logistic.html#cb178-11"></a>    <span class="dt">LB =</span> lp<span class="op">$</span>fit <span class="op">+</span><span class="st"> </span><span class="kw">qnorm</span>(<span class="fl">0.025</span>) <span class="op">*</span><span class="st"> </span>lp<span class="op">$</span>se.fit,</span>
<span id="cb178-12"><a href="Logistic.html#cb178-12"></a>    <span class="dt">UB =</span> lp<span class="op">$</span>fit <span class="op">+</span><span class="st"> </span><span class="kw">qnorm</span>(<span class="fl">0.975</span>) <span class="op">*</span><span class="st"> </span>lp<span class="op">$</span>se.fit,</span>
<span id="cb178-13"><a href="Logistic.html#cb178-13"></a>    <span class="dt">LB.p =</span> <span class="kw">exp</span>(LB) <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw">exp</span>(LB)),</span>
<span id="cb178-14"><a href="Logistic.html#cb178-14"></a>    <span class="dt">UB.p =</span> <span class="kw">exp</span>(UB) <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw">exp</span>(UB))</span>
<span id="cb178-15"><a href="Logistic.html#cb178-15"></a>  )</span>
<span id="cb178-16"><a href="Logistic.html#cb178-16"></a></span>
<span id="cb178-17"><a href="Logistic.html#cb178-17"></a>data.plot <span class="op">%&gt;%</span></span>
<span id="cb178-18"><a href="Logistic.html#cb178-18"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> width)) <span class="op">+</span></span>
<span id="cb178-19"><a href="Logistic.html#cb178-19"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> Crabs, <span class="kw">aes</span>(<span class="dt">x =</span> width, <span class="dt">y =</span> <span class="kw">jitter</span>(y, <span class="fl">.1</span>))) <span class="op">+</span></span>
<span id="cb178-20"><a href="Logistic.html#cb178-20"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> pred.prob)) <span class="op">+</span></span>
<span id="cb178-21"><a href="Logistic.html#cb178-21"></a><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> LB.p, <span class="dt">ymax =</span> UB.p), <span class="dt">fill =</span> <span class="st">&quot;gray&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span></span>
<span id="cb178-22"><a href="Logistic.html#cb178-22"></a><span class="st">  </span><span class="kw">theme_few</span>() <span class="op">+</span></span>
<span id="cb178-23"><a href="Logistic.html#cb178-23"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Probability (satellites)&quot;</span>) <span class="op">+</span></span>
<span id="cb178-24"><a href="Logistic.html#cb178-24"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">by =</span> <span class="fl">.2</span>)) <span class="op">+</span></span>
<span id="cb178-25"><a href="Logistic.html#cb178-25"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Width&quot;</span>) <span class="op">+</span></span>
<span id="cb178-26"><a href="Logistic.html#cb178-26"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Figure 4.3&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-40-1.png" width="672" /></p>
</div>
<div id="why-use-a-model-to-estimate-probabilities" class="section level3">
<h3>4.2.4 Why Use a Model to Estimate Probabilities?</h3>
</div>
</div>
<div id="logistic-regression-with-categorical-predictors" class="section level2">
<h2>4.3 Logistic Regression with Categorical Predictors</h2>
<div id="indicator-variables-represent-categories-of-predictors" class="section level3">
<h3>4.3.1 Indicator Variables Represent Categories of Predictors</h3>
<p><span class="math display">\[\mathrm{logit}[P(Y = 1)] = \alpha + \beta_1 x + \beta_2 z\]</span></p>
<table>
<thead>
<tr class="header">
<th align="center">x</th>
<th align="center">z</th>
<th align="center">Logit</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0</td>
<td align="center">0</td>
<td align="center"><span class="math inline">\(\alpha\)</span></td>
</tr>
<tr class="even">
<td align="center">1</td>
<td align="center">0</td>
<td align="center"><span class="math inline">\(\alpha + \beta_1\)</span></td>
</tr>
<tr class="odd">
<td align="center">0</td>
<td align="center">0</td>
<td align="center"><span class="math inline">\(\alpha + \beta_2\)</span></td>
</tr>
<tr class="even">
<td align="center">0</td>
<td align="center">0</td>
<td align="center"><span class="math inline">\(\alpha + \beta_1 + \beta_2\)</span></td>
</tr>
</tbody>
</table>
<p><span class="math display">\[ = [\alpha + \beta_1 (1) + \beta_2 z] - [\alpha + \beta_1 (0) + \beta_2 z] = \beta_a.\]</span></p>
</div>
<div id="example-survey-about-marijuana-use" class="section level3">
<h3>4.3.2 Example: Survey about Marijuana Use</h3>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="Logistic.html#cb179-1"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb179-2"><a href="Logistic.html#cb179-2"></a>Marijuana &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;http://users.stat.ufl.edu/~aa/cat/data/Marijuana.dat&quot;</span>,</span>
<span id="cb179-3"><a href="Logistic.html#cb179-3"></a>  <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">stringsAsFactors =</span> <span class="ot">TRUE</span></span>
<span id="cb179-4"><a href="Logistic.html#cb179-4"></a>)</span>
<span id="cb179-5"><a href="Logistic.html#cb179-5"></a></span>
<span id="cb179-6"><a href="Logistic.html#cb179-6"></a>Marijuana</span></code></pre></div>
<pre class="custom-output"><code>   race gender yes  no
1 white female 420 620
2 white   male 483 579
3 other female  25  55
4 other   male  32  62</code></pre>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="Logistic.html#cb181-1"></a>fit &lt;-<span class="st"> </span><span class="kw">glm</span>(yes <span class="op">/</span><span class="st"> </span>(yes <span class="op">+</span><span class="st"> </span>no) <span class="op">~</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span>race,</span>
<span id="cb181-2"><a href="Logistic.html#cb181-2"></a>  <span class="dt">weights =</span> yes <span class="op">+</span><span class="st"> </span>no, <span class="dt">family =</span> binomial,</span>
<span id="cb181-3"><a href="Logistic.html#cb181-3"></a>  <span class="dt">data =</span> Marijuana</span>
<span id="cb181-4"><a href="Logistic.html#cb181-4"></a>)</span>
<span id="cb181-5"><a href="Logistic.html#cb181-5"></a></span>
<span id="cb181-6"><a href="Logistic.html#cb181-6"></a>theFit &lt;-<span class="st"> </span><span class="kw">summary</span>(fit)</span>
<span id="cb181-7"><a href="Logistic.html#cb181-7"></a>theFit</span></code></pre></div>
<pre class="custom-output"><code>
Call:
glm(formula = yes/(yes + no) ~ gender + race, family = binomial, 
    data = Marijuana, weights = yes + no)

Deviance Residuals: 
       1         2         3         4  
-0.04513   0.04402   0.17321  -0.15493  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -0.83035    0.16854  -4.927 8.37e-07 ***
gendermale   0.20261    0.08519   2.378  0.01739 *  
racewhite    0.44374    0.16766   2.647  0.00813 ** 
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 12.752784  on 3  degrees of freedom
Residual deviance:  0.057982  on 1  degrees of freedom
AIC: 30.414

Number of Fisher Scoring iterations: 3</code></pre>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="Logistic.html#cb183-1"></a><span class="co"># pull the 2nd and 3rd element from the &quot;Estimate&quot; column, exponentiate &amp; round</span></span>
<span id="cb183-2"><a href="Logistic.html#cb183-2"></a><span class="kw">round</span>(<span class="kw">exp</span>(theFit<span class="op">$</span>coefficients[<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>, <span class="st">&quot;Estimate&quot;</span>]), <span class="dv">2</span>)</span></code></pre></div>
<pre class="custom-output"><code>gendermale  racewhite 
      1.22       1.56 </code></pre>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="Logistic.html#cb185-1"></a><span class="co"># easier to follow syntax</span></span>
<span id="cb185-2"><a href="Logistic.html#cb185-2"></a>theCoef &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">coef</span>(theFit))</span>
<span id="cb185-3"><a href="Logistic.html#cb185-3"></a>theCoef <span class="op">%&gt;%</span></span>
<span id="cb185-4"><a href="Logistic.html#cb185-4"></a><span class="st">  </span><span class="kw">rownames_to_column</span>(<span class="dt">var =</span> <span class="st">&quot;Effect&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb185-5"><a href="Logistic.html#cb185-5"></a><span class="st">  </span><span class="kw">select</span>(<span class="st">&quot;Effect&quot;</span>, <span class="st">&quot;Estimate&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb185-6"><a href="Logistic.html#cb185-6"></a><span class="st">  </span><span class="kw">filter</span>(Effect <span class="op">!=</span><span class="st"> &quot;(Intercept)&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb185-7"><a href="Logistic.html#cb185-7"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">Odds Ratio</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(Estimate)) <span class="op">%&gt;%</span></span>
<span id="cb185-8"><a href="Logistic.html#cb185-8"></a><span class="st">  </span><span class="kw">mutate_if</span>(is.numeric, round, <span class="dt">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
<pre class="custom-output"><code>      Effect Estimate Odds Ratio
1 gendermale     0.20       1.22
2  racewhite     0.44       1.56</code></pre>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="Logistic.html#cb187-1"></a><span class="co"># library(car)</span></span>
<span id="cb187-2"><a href="Logistic.html#cb187-2"></a>car<span class="op">::</span><span class="kw">Anova</span>(fit) <span class="co"># likelihood-ratio test for individual explanatory variables</span></span></code></pre></div>
<pre class="custom-output"><code>Analysis of Deviance Table (Type II tests)

Response: yes/(yes + no)
       LR Chisq Df Pr(&gt;Chisq)   
gender   5.6662  1   0.017295 * 
race     7.2770  1   0.006984 **
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="anova-type-model-representation-of-factors" class="section level3">
<h3>4.3.3 ANOVA-Type Model Representation of Factors</h3>
<p><span class="math display">\[\mathrm{logit}[P(Y=1)] = \alpha + \beta_i^x + \beta_k^z\]</span></p>
</div>
<div id="tests-of-conditoinal-independence-and-of-homogeneity-for-three-way-contingency-tables" class="section level3">
<h3>4.3.4 Tests of Conditoinal Independence and of Homogeneity for Three-Way Contingency Tables</h3>
<p><span class="math display">\[\mathrm{logit}[P(Y = 1)] = \alpha + \beta x + \beta_k^z,\]</span></p>
</div>
</div>
<div id="multiple-logistic-regression" class="section level2">
<h2>4.4 Multiple Logistic Regression</h2>
<p><span class="math display">\[\mathrm{logit}[P(Y=1)] = \alpha + \beta_1 x_1 + \beta_2 x_2 + \cdots + \beta_p x_p.\]</span></p>
<div id="x4.4.1" class="section level3">
<h3>4.4.1 Example: Horseshoe Crabs with Color and Width Predictors</h3>
<p><span class="math display" id="eq:eq4dot3">\[\begin{equation} 
  \mathrm{logit}[P(Y=1)] = \alpha + \beta_1 x + \beta_2 c_2 + \beta_3 c_3 + \beta_4 c_4.
  \tag{8}
\end{equation}\]</span></p>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="Logistic.html#cb189-1"></a>Crabs &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;http://users.stat.ufl.edu/~aa/cat/data/Crabs.dat&quot;</span>,</span>
<span id="cb189-2"><a href="Logistic.html#cb189-2"></a>  <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">stringsAsFactors =</span> <span class="ot">TRUE</span></span>
<span id="cb189-3"><a href="Logistic.html#cb189-3"></a>)</span>
<span id="cb189-4"><a href="Logistic.html#cb189-4"></a></span>
<span id="cb189-5"><a href="Logistic.html#cb189-5"></a>fit &lt;-<span class="st"> </span><span class="kw">glm</span>(y <span class="op">~</span><span class="st"> </span>width <span class="op">+</span><span class="st"> </span><span class="kw">factor</span>(color), <span class="dt">family =</span> binomial, <span class="dt">data =</span> Crabs)</span>
<span id="cb189-6"><a href="Logistic.html#cb189-6"></a><span class="kw">summary</span>(fit)</span></code></pre></div>
<pre class="custom-output"><code>
Call:
glm(formula = y ~ width + factor(color), family = binomial, data = Crabs)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.1124  -0.9848   0.5243   0.8513   2.1413  

Coefficients:
                Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)    -11.38519    2.87346  -3.962 7.43e-05 ***
width            0.46796    0.10554   4.434 9.26e-06 ***
factor(color)2   0.07242    0.73989   0.098    0.922    
factor(color)3  -0.22380    0.77708  -0.288    0.773    
factor(color)4  -1.32992    0.85252  -1.560    0.119    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 225.76  on 172  degrees of freedom
Residual deviance: 187.46  on 168  degrees of freedom
AIC: 197.46

Number of Fisher Scoring iterations: 4</code></pre>
<p><span class="math display">\[\mathrm{exp}[12.715 + 0.468(26.3)]/\{1 + \mathrm{exp}[12.715 + 0.468(26.3)]\}=0.399.\]</span><br />
<span class="math display">\[\mathrm{exp}[11.385 + 0.468(26.3)]/\{1 + \mathrm{exp}[11.385 + 0.468(26.3)]\} = 0.715.\]</span></p>
</div>
<div id="model-comparison-to-check-whether-a-term-is-needed" class="section level3">
<h3>4.4.2 Model Comparison to Check Whether a Term is Needed</h3>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="Logistic.html#cb191-1"></a><span class="kw">summary</span>(<span class="kw">glm</span>(y <span class="op">~</span><span class="st"> </span>width, <span class="dt">family =</span> binomial, <span class="dt">data =</span> Crabs))</span></code></pre></div>
<pre class="custom-output"><code>
Call:
glm(formula = y ~ width, family = binomial, data = Crabs)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.0281  -1.0458   0.5480   0.9066   1.6942  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -12.3508     2.6287  -4.698 2.62e-06 ***
width         0.4972     0.1017   4.887 1.02e-06 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 225.76  on 172  degrees of freedom
Residual deviance: 194.45  on 171  degrees of freedom
AIC: 198.45

Number of Fisher Scoring iterations: 4</code></pre>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="Logistic.html#cb193-1"></a><span class="co"># compare deviance = 194.45 vs 187.46 with color also in model</span></span>
<span id="cb193-2"><a href="Logistic.html#cb193-2"></a><span class="kw">library</span>(car)</span>
<span id="cb193-3"><a href="Logistic.html#cb193-3"></a><span class="kw">Anova</span>(<span class="kw">glm</span>(y <span class="op">~</span><span class="st"> </span>width <span class="op">+</span><span class="st"> </span><span class="kw">factor</span>(color), <span class="dt">family =</span> binomial, <span class="dt">data =</span> Crabs))</span></code></pre></div>
<pre class="custom-output"><code>Analysis of Deviance Table (Type II tests)

Response: y
              LR Chisq Df Pr(&gt;Chisq)    
width          24.6038  1  7.041e-07 ***
factor(color)   6.9956  3    0.07204 .  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="example-treating-color-as-quantitative-or-binary" class="section level3">
<h3>4.4.3 Example: Treating Color as Quantitative or Binary</h3>
<p><span class="math display" id="eq:eq4dot4">\[\begin{equation} 
  \mathrm{logit}[P(Y=1)] = \alpha + \beta_1 x + \beta_2 c.
  \tag{9}
\end{equation}\]</span></p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="Logistic.html#cb195-1"></a>fit2 &lt;-<span class="st"> </span>(<span class="kw">glm</span>(y <span class="op">~</span><span class="st"> </span>width <span class="op">+</span><span class="st"> </span>color, <span class="dt">family =</span> binomial, <span class="dt">data =</span> Crabs))</span>
<span id="cb195-2"><a href="Logistic.html#cb195-2"></a><span class="kw">summary</span>(fit2)</span></code></pre></div>
<pre class="custom-output"><code>
Call:
glm(formula = y ~ width + color, family = binomial, data = Crabs)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.1692  -0.9889   0.5429   0.8700   1.9742  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -10.0708     2.8068  -3.588 0.000333 ***
width         0.4583     0.1040   4.406 1.05e-05 ***
color        -0.5090     0.2237  -2.276 0.022860 *  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 225.76  on 172  degrees of freedom
Residual deviance: 189.12  on 170  degrees of freedom
AIC: 195.12

Number of Fisher Scoring iterations: 4</code></pre>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="Logistic.html#cb197-1"></a><span class="kw">anova</span>(fit2, fit, <span class="dt">test =</span> <span class="st">&quot;LRT&quot;</span>) <span class="co"># likelihood-ratio test comparing models</span></span></code></pre></div>
<pre class="custom-output"><code>Analysis of Deviance Table

Model 1: y ~ width + color
Model 2: y ~ width + factor(color)
  Resid. Df Resid. Dev Df Deviance Pr(&gt;Chi)
1       170     189.12                     
2       168     187.46  2   1.6641   0.4351</code></pre>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="Logistic.html#cb199-1"></a>Crabs<span class="op">$</span>c4 &lt;-<span class="st"> </span><span class="kw">ifelse</span>(Crabs<span class="op">$</span>color <span class="op">==</span><span class="st"> </span><span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb199-2"><a href="Logistic.html#cb199-2"></a><span class="co"># Crabs$c4 &lt;- I(Crabs$color == 4)</span></span>
<span id="cb199-3"><a href="Logistic.html#cb199-3"></a></span>
<span id="cb199-4"><a href="Logistic.html#cb199-4"></a>fit3 &lt;-<span class="st"> </span><span class="kw">glm</span>(y <span class="op">~</span><span class="st"> </span>width <span class="op">+</span><span class="st"> </span>c4, <span class="dt">family =</span> binomial, <span class="dt">data =</span> Crabs)</span>
<span id="cb199-5"><a href="Logistic.html#cb199-5"></a><span class="kw">summary</span>(fit3)</span></code></pre></div>
<pre class="custom-output"><code>
Call:
glm(formula = y ~ width + c4, family = binomial, data = Crabs)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.0821  -0.9932   0.5274   0.8606   2.1553  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -11.6790     2.6925  -4.338 1.44e-05 ***
width         0.4782     0.1041   4.592 4.39e-06 ***
c4           -1.3005     0.5259  -2.473   0.0134 *  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 225.76  on 172  degrees of freedom
Residual deviance: 187.96  on 170  degrees of freedom
AIC: 193.96

Number of Fisher Scoring iterations: 4</code></pre>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="Logistic.html#cb201-1"></a><span class="kw">anova</span>(fit3, fit, <span class="dt">test =</span> <span class="st">&quot;LRT&quot;</span>)</span></code></pre></div>
<pre class="custom-output"><code>Analysis of Deviance Table

Model 1: y ~ width + c4
Model 2: y ~ width + factor(color)
  Resid. Df Resid. Dev Df Deviance Pr(&gt;Chi)
1       170     187.96                     
2       168     187.46  2  0.50085   0.7785</code></pre>
</div>
<div id="allowing-interaction-between-explanatory-variables" class="section level3">
<h3>4.4.4 Allowing Interaction between Explanatory Variables</h3>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="Logistic.html#cb203-1"></a>(interaction &lt;-<span class="st"> </span><span class="kw">glm</span>(y <span class="op">~</span><span class="st"> </span>width <span class="op">+</span><span class="st"> </span>c4 <span class="op">+</span><span class="st"> </span>width<span class="op">:</span>c4, <span class="dt">family =</span> binomial, <span class="dt">data =</span> Crabs))</span></code></pre></div>
<pre class="custom-output"><code>
Call:  glm(formula = y ~ width + c4 + width:c4, family = binomial, data = Crabs)

Coefficients:
(Intercept)        width           c4     width:c4  
   -12.8117       0.5222       6.9578      -0.3217  

Degrees of Freedom: 172 Total (i.e. Null);  169 Residual
Null Deviance:      225.8 
Residual Deviance: 186.8    AIC: 194.8</code></pre>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="Logistic.html#cb205-1"></a><span class="kw">summary</span>(interaction)</span></code></pre></div>
<pre class="custom-output"><code>
Call:
glm(formula = y ~ width + c4 + width:c4, family = binomial, data = Crabs)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.1366  -0.9344   0.4996   0.8554   1.7753  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -12.8117     2.9576  -4.332 1.48e-05 ***
width         0.5222     0.1146   4.556 5.21e-06 ***
c4            6.9578     7.3182   0.951    0.342    
width:c4     -0.3217     0.2857  -1.126    0.260    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 225.76  on 172  degrees of freedom
Residual deviance: 186.79  on 169  degrees of freedom
AIC: 194.79

Number of Fisher Scoring iterations: 4</code></pre>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="Logistic.html#cb207-1"></a><span class="co"># P-value 0.28 from last paragraph of 4.4.4</span></span>
<span id="cb207-2"><a href="Logistic.html#cb207-2"></a>car<span class="op">::</span><span class="kw">Anova</span>(interaction)</span></code></pre></div>
<pre class="custom-output"><code>Analysis of Deviance Table (Type II tests)

Response: y
         LR Chisq Df Pr(&gt;Chisq)    
width     26.8351  1  2.216e-07 ***
c4         6.4948  1    0.01082 *  
width:c4   1.1715  1    0.27909    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="effects-depend-on-other-explanatory-variables-in-model" class="section level3">
<h3>4.4.5 Effects Depend on Other Explanatory Variables in Model</h3>
</div>
</div>
<div id="summarizing-effects-in-logistic-regression" class="section level2">
<h2>4.5 Summarizing Effects in Logistic Regression</h2>
<div id="probability-based-interpretations" class="section level3">
<h3>4.5.1 Probability-Based Interpretations</h3>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="Logistic.html#cb209-1"></a>fit3 &lt;-<span class="st"> </span><span class="kw">glm</span>(y <span class="op">~</span><span class="st"> </span>width <span class="op">+</span><span class="st"> </span>c4, <span class="dt">family =</span> binomial, <span class="dt">data =</span> Crabs)</span>
<span id="cb209-2"><a href="Logistic.html#cb209-2"></a></span>
<span id="cb209-3"><a href="Logistic.html#cb209-3"></a><span class="kw">round</span>(</span>
<span id="cb209-4"><a href="Logistic.html#cb209-4"></a>  <span class="kw">predict</span>(fit3,</span>
<span id="cb209-5"><a href="Logistic.html#cb209-5"></a>    <span class="kw">data.frame</span>(<span class="dt">c4 =</span> <span class="dv">1</span>, <span class="dt">width =</span> <span class="kw">mean</span>(Crabs<span class="op">$</span>width)),</span>
<span id="cb209-6"><a href="Logistic.html#cb209-6"></a>    <span class="dt">type =</span> <span class="st">&quot;response&quot;</span></span>
<span id="cb209-7"><a href="Logistic.html#cb209-7"></a>  ),</span>
<span id="cb209-8"><a href="Logistic.html#cb209-8"></a>  <span class="dv">3</span></span>
<span id="cb209-9"><a href="Logistic.html#cb209-9"></a>)</span></code></pre></div>
<pre class="custom-output"><code>    1 
0.401 </code></pre>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="Logistic.html#cb211-1"></a><span class="kw">round</span>(</span>
<span id="cb211-2"><a href="Logistic.html#cb211-2"></a>  <span class="kw">predict</span>(fit3,</span>
<span id="cb211-3"><a href="Logistic.html#cb211-3"></a>    <span class="kw">data.frame</span>(<span class="dt">c4 =</span> <span class="dv">0</span>, <span class="dt">width =</span> <span class="kw">mean</span>(Crabs<span class="op">$</span>width)),</span>
<span id="cb211-4"><a href="Logistic.html#cb211-4"></a>    <span class="dt">type =</span> <span class="st">&quot;response&quot;</span></span>
<span id="cb211-5"><a href="Logistic.html#cb211-5"></a>  ),</span>
<span id="cb211-6"><a href="Logistic.html#cb211-6"></a>  <span class="dv">3</span></span>
<span id="cb211-7"><a href="Logistic.html#cb211-7"></a>)</span></code></pre></div>
<pre class="custom-output"><code>   1 
0.71 </code></pre>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="Logistic.html#cb213-1"></a><span class="kw">round</span>(</span>
<span id="cb213-2"><a href="Logistic.html#cb213-2"></a>  <span class="kw">predict</span>(fit3, <span class="kw">data.frame</span>(<span class="dt">c4 =</span> <span class="kw">mean</span>(Crabs<span class="op">$</span>c4), <span class="dt">width =</span> <span class="kw">quantile</span>(Crabs<span class="op">$</span>width)),</span>
<span id="cb213-3"><a href="Logistic.html#cb213-3"></a>    <span class="dt">type =</span> <span class="st">&quot;response&quot;</span></span>
<span id="cb213-4"><a href="Logistic.html#cb213-4"></a>  ),</span>
<span id="cb213-5"><a href="Logistic.html#cb213-5"></a>  <span class="dv">3</span></span>
<span id="cb213-6"><a href="Logistic.html#cb213-6"></a>)</span></code></pre></div>
<pre class="custom-output"><code>   0%   25%   50%   75%  100% 
0.142 0.516 0.654 0.803 0.985 </code></pre>
</div>
<div id="x4.5.2" class="section level3">
<h3>4.5.2 Marginal Effects and Their Average</h3>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="Logistic.html#cb215-1"></a>fit3 &lt;-<span class="st"> </span><span class="kw">glm</span>(y <span class="op">~</span><span class="st"> </span>width <span class="op">+</span><span class="st"> </span>c4, <span class="dt">family =</span> binomial, <span class="dt">data =</span> Crabs)</span>
<span id="cb215-2"><a href="Logistic.html#cb215-2"></a></span>
<span id="cb215-3"><a href="Logistic.html#cb215-3"></a><span class="kw">suppressPackageStartupMessages</span>(<span class="kw">library</span>(mfx))</span>
<span id="cb215-4"><a href="Logistic.html#cb215-4"></a></span>
<span id="cb215-5"><a href="Logistic.html#cb215-5"></a><span class="co"># with atmean = TRUE, finds effect only at the mean</span></span>
<span id="cb215-6"><a href="Logistic.html#cb215-6"></a><span class="kw">logitmfx</span>(fit3, <span class="dt">atmean =</span> <span class="ot">FALSE</span>, <span class="dt">data =</span> Crabs)</span></code></pre></div>
<pre class="custom-output"><code>Call:
logitmfx(formula = fit3, data = Crabs, atmean = FALSE)

Marginal Effects:
          dF/dx Std. Err.       z     P&gt;|z|    
width  0.087483  0.024472  3.5748 0.0003504 ***
c4    -0.261420  0.105690 -2.4735 0.0133809 *  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

dF/dx is for discrete change for the following variables:

[1] &quot;c4&quot;</code></pre>
</div>
<div id="x4.5.3" class="section level3">
<h3>4.5.3 Standardized Interpretations</h3>
</div>
</div>
<div id="summzarizing-predictive-power-classification-tables-roc-curves-and-multiple-correlation" class="section level2">
<h2>4.6 Summzarizing Predictive Power: Classification Tables, ROC Curves and Multiple Correlation</h2>
<div id="x4.6.1" class="section level3">
<h3>4.6.1 Summarizing Predictive Power: Classification Tables</h3>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="Logistic.html#cb217-1"></a>Crabs &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;http://users.stat.ufl.edu/~aa/cat/data/Crabs.dat&quot;</span>,</span>
<span id="cb217-2"><a href="Logistic.html#cb217-2"></a>  <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">stringsAsFactors =</span> <span class="ot">TRUE</span></span>
<span id="cb217-3"><a href="Logistic.html#cb217-3"></a>)</span>
<span id="cb217-4"><a href="Logistic.html#cb217-4"></a></span>
<span id="cb217-5"><a href="Logistic.html#cb217-5"></a>prop &lt;-<span class="st"> </span><span class="kw">sum</span>(Crabs<span class="op">$</span>y) <span class="op">/</span><span class="st"> </span><span class="kw">nrow</span>(Crabs)</span>
<span id="cb217-6"><a href="Logistic.html#cb217-6"></a>prop</span></code></pre></div>
<pre class="custom-output"><code>[1] 0.6416185</code></pre>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="Logistic.html#cb219-1"></a>fit &lt;-<span class="st"> </span><span class="kw">glm</span>(y <span class="op">~</span><span class="st"> </span>width <span class="op">+</span><span class="st"> </span><span class="kw">factor</span>(color), <span class="dt">family =</span> binomial, <span class="dt">data =</span> Crabs)</span>
<span id="cb219-2"><a href="Logistic.html#cb219-2"></a></span>
<span id="cb219-3"><a href="Logistic.html#cb219-3"></a>predicted &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">fitted</span>(fit) <span class="op">&gt;</span><span class="st"> </span>prop) <span class="co"># predict y=1 when est. &gt; 0.6416</span></span>
<span id="cb219-4"><a href="Logistic.html#cb219-4"></a></span>
<span id="cb219-5"><a href="Logistic.html#cb219-5"></a><span class="kw">xtabs</span>(<span class="op">~</span><span class="st"> </span>Crabs<span class="op">$</span>y <span class="op">+</span><span class="st"> </span>predicted)</span></code></pre></div>
<pre class="custom-output"><code>       predicted
Crabs$y  0  1
      0 43 19
      1 36 75</code></pre>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="Logistic.html#cb221-1"></a><span class="co"># Make Table 4.4</span></span>
<span id="cb221-2"><a href="Logistic.html#cb221-2"></a></span>
<span id="cb221-3"><a href="Logistic.html#cb221-3"></a>predicted50 &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">fitted</span>(fit) <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.50</span>) <span class="co"># predict y=1 when est. &gt; 0.50</span></span>
<span id="cb221-4"><a href="Logistic.html#cb221-4"></a><span class="kw">xtabs</span>(<span class="op">~</span><span class="st"> </span>Crabs<span class="op">$</span>y <span class="op">+</span><span class="st"> </span>predicted50)</span></code></pre></div>
<pre class="custom-output"><code>       predicted50
Crabs$y  0  1
      0 31 31
      1 15 96</code></pre>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="Logistic.html#cb223-1"></a><span class="co"># reorder levels to flip rows and columns</span></span>
<span id="cb223-2"><a href="Logistic.html#cb223-2"></a>t1 &lt;-<span class="st"> </span><span class="kw">xtabs</span>(<span class="op">~</span><span class="st"> </span><span class="kw">relevel</span>(<span class="kw">as.factor</span>(Crabs<span class="op">$</span>y), <span class="st">&quot;1&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">relevel</span>(<span class="kw">as.factor</span>(predicted), <span class="st">&quot;1&quot;</span>))</span>
<span id="cb223-3"><a href="Logistic.html#cb223-3"></a>t1df &lt;-<span class="st"> </span><span class="kw">as.data.frame.matrix</span>(t1) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb223-4"><a href="Logistic.html#cb223-4"></a><span class="st">  </span><span class="kw">rename</span>(<span class="st">&quot;t1_1&quot;</span> =<span class="st"> `</span><span class="dt">1</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb223-5"><a href="Logistic.html#cb223-5"></a><span class="st">  </span><span class="kw">rename</span>(<span class="st">&quot;t1_0&quot;</span> =<span class="st"> `</span><span class="dt">0</span><span class="st">`</span>) </span>
<span id="cb223-6"><a href="Logistic.html#cb223-6"></a>  </span>
<span id="cb223-7"><a href="Logistic.html#cb223-7"></a>t2 &lt;-<span class="st"> </span><span class="kw">xtabs</span>(<span class="op">~</span><span class="st"> </span><span class="kw">relevel</span>(<span class="kw">as.factor</span>(Crabs<span class="op">$</span>y), <span class="st">&quot;1&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">relevel</span>(<span class="kw">as.factor</span>(predicted50), <span class="st">&quot;1&quot;</span>))</span>
<span id="cb223-8"><a href="Logistic.html#cb223-8"></a>t2df &lt;-<span class="st"> </span><span class="kw">as.data.frame.matrix</span>(t2) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb223-9"><a href="Logistic.html#cb223-9"></a><span class="st">  </span><span class="kw">rename</span>(<span class="st">&quot;t2_1&quot;</span> =<span class="st"> `</span><span class="dt">1</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb223-10"><a href="Logistic.html#cb223-10"></a><span class="st">  </span><span class="kw">rename</span>(<span class="st">&quot;t2_0&quot;</span> =<span class="st"> `</span><span class="dt">0</span><span class="st">`</span>) </span>
<span id="cb223-11"><a href="Logistic.html#cb223-11"></a></span>
<span id="cb223-12"><a href="Logistic.html#cb223-12"></a>Actual &lt;-<span class="kw">tibble</span>(<span class="dt">Actual =</span> <span class="kw">c</span>(<span class="st">&quot;y = 1&quot;</span>, <span class="st">&quot;y = 0&quot;</span>)) </span>
<span id="cb223-13"><a href="Logistic.html#cb223-13"></a>Total &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">Total =</span> <span class="kw">c</span>(<span class="dv">111</span>, <span class="dv">62</span>))  </span>
<span id="cb223-14"><a href="Logistic.html#cb223-14"></a>  </span>
<span id="cb223-15"><a href="Logistic.html#cb223-15"></a></span>
<span id="cb223-16"><a href="Logistic.html#cb223-16"></a><span class="kw">library</span>(officer) <span class="co"># for fp_border() this needs to load before flextable</span></span>
<span id="cb223-17"><a href="Logistic.html#cb223-17"></a></span>
<span id="cb223-18"><a href="Logistic.html#cb223-18"></a><span class="kw">library</span>(flextable)</span>
<span id="cb223-19"><a href="Logistic.html#cb223-19"></a><span class="kw">suppressMessages</span>(<span class="kw">conflict_prefer</span>(<span class="st">&quot;compose&quot;</span>, <span class="st">&quot;flextable&quot;</span>))</span>
<span id="cb223-20"><a href="Logistic.html#cb223-20"></a></span>
<span id="cb223-21"><a href="Logistic.html#cb223-21"></a><span class="kw">library</span>(dplyr)  <span class="co"># for bind_cols()</span></span>
<span id="cb223-22"><a href="Logistic.html#cb223-22"></a></span>
<span id="cb223-23"><a href="Logistic.html#cb223-23"></a></span>
<span id="cb223-24"><a href="Logistic.html#cb223-24"></a><span class="co"># Make analysis table</span></span>
<span id="cb223-25"><a href="Logistic.html#cb223-25"></a><span class="st">`</span><span class="dt">Table 4.4</span><span class="st">`</span> &lt;-<span class="st"> </span><span class="kw">bind_cols</span>(Actual, t1df, t2df, Total)</span>
<span id="cb223-26"><a href="Logistic.html#cb223-26"></a></span>
<span id="cb223-27"><a href="Logistic.html#cb223-27"></a><span class="co"># The header needs blank columns for spaces in actual table.</span></span>
<span id="cb223-28"><a href="Logistic.html#cb223-28"></a><span class="co"># The wide column labels use Unicode characters for pi. Those details are </span></span>
<span id="cb223-29"><a href="Logistic.html#cb223-29"></a><span class="co">#   replaced later with the compose() function.</span></span>
<span id="cb223-30"><a href="Logistic.html#cb223-30"></a>theHeader &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</span>
<span id="cb223-31"><a href="Logistic.html#cb223-31"></a>  <span class="dt">col_keys =</span> <span class="kw">c</span>(<span class="st">&quot;Actual&quot;</span>, <span class="st">&quot;blank&quot;</span>, <span class="st">&quot;t1_1&quot;</span>, <span class="st">&quot;t1_0&quot;</span>,</span>
<span id="cb223-32"><a href="Logistic.html#cb223-32"></a>               <span class="st">&quot;blank2&quot;</span>, <span class="st">&quot;t2_1&quot;</span>, <span class="st">&quot;t2_0&quot;</span>, </span>
<span id="cb223-33"><a href="Logistic.html#cb223-33"></a>               <span class="st">&quot;blank3&quot;</span>, <span class="st">&quot;Total&quot;</span>),</span>
<span id="cb223-34"><a href="Logistic.html#cb223-34"></a>  <span class="dt">line1 =</span> <span class="kw">c</span>(<span class="st">&quot;Actual&quot;</span>, <span class="st">&quot;&quot;</span>, </span>
<span id="cb223-35"><a href="Logistic.html#cb223-35"></a>            <span class="kw">rep</span>(<span class="st">&quot;Prediction, \U1D70B = 0.6416&quot;</span>, <span class="dv">2</span>), <span class="st">&quot;&quot;</span>, </span>
<span id="cb223-36"><a href="Logistic.html#cb223-36"></a>            <span class="kw">rep</span>(<span class="st">&quot;Prediction, \U1D70B = 0.50&quot;</span>, <span class="dv">2</span>), <span class="st">&quot;&quot;</span>,</span>
<span id="cb223-37"><a href="Logistic.html#cb223-37"></a>            <span class="st">&quot;Total&quot;</span>),</span>
<span id="cb223-38"><a href="Logistic.html#cb223-38"></a>  <span class="dt">line2 =</span> <span class="kw">c</span>(<span class="st">&quot;Actual&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="st">&quot;t1_1&quot;</span>, <span class="st">&quot;t1_0&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="st">&quot;t2_1&quot;</span>, <span class="st">&quot;t2_0&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="st">&quot;Total&quot;</span>))</span>
<span id="cb223-39"><a href="Logistic.html#cb223-39"></a></span>
<span id="cb223-40"><a href="Logistic.html#cb223-40"></a><span class="co"># Border lines</span></span>
<span id="cb223-41"><a href="Logistic.html#cb223-41"></a>big_border &lt;-<span class="st"> </span><span class="kw">fp_border</span>(<span class="dt">color=</span><span class="st">&quot;black&quot;</span>, <span class="dt">width =</span> <span class="dv">2</span>)</span>
<span id="cb223-42"><a href="Logistic.html#cb223-42"></a></span>
<span id="cb223-43"><a href="Logistic.html#cb223-43"></a><span class="co"># Make the table - compose uses Unicode character </span></span>
<span id="cb223-44"><a href="Logistic.html#cb223-44"></a><span class="co"># https://stackoverflow.com/questions/64088118/in-r-flextable-can-complex-symbols-appear-in-column-headings</span></span>
<span id="cb223-45"><a href="Logistic.html#cb223-45"></a><span class="kw">flextable</span>(<span class="st">`</span><span class="dt">Table 4.4</span><span class="st">`</span>, <span class="dt">col_keys =</span> theHeader<span class="op">$</span>col_keys) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb223-46"><a href="Logistic.html#cb223-46"></a><span class="st">  </span><span class="kw">set_header_df</span>(<span class="dt">mapping =</span> theHeader, <span class="dt">key =</span> <span class="st">&quot;col_keys&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb223-47"><a href="Logistic.html#cb223-47"></a><span class="st">  </span><span class="kw">theme_booktabs</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb223-48"><a href="Logistic.html#cb223-48"></a><span class="st">  </span><span class="kw">merge_v</span>(<span class="dt">part =</span> <span class="st">&quot;header&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb223-49"><a href="Logistic.html#cb223-49"></a><span class="st">  </span><span class="kw">merge_h</span>(<span class="dt">part =</span> <span class="st">&quot;header&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb223-50"><a href="Logistic.html#cb223-50"></a><span class="st">  </span><span class="kw">align</span>(<span class="dt">align =</span> <span class="st">&quot;center&quot;</span>, <span class="dt">part =</span> <span class="st">&quot;all&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb223-51"><a href="Logistic.html#cb223-51"></a><span class="st">  </span><span class="kw">empty_blanks</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb223-52"><a href="Logistic.html#cb223-52"></a><span class="st">  </span><span class="kw">fix_border_issues</span>()  <span class="op">%&gt;%</span></span>
<span id="cb223-53"><a href="Logistic.html#cb223-53"></a><span class="st">  </span><span class="kw">set_caption</span>(<span class="dt">caption =</span> <span class="st">&quot;Classification tables for horseshoe crab data with width and factor color predictors.&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb223-54"><a href="Logistic.html#cb223-54"></a><span class="st">  </span><span class="kw">set_table_properties</span>(<span class="dt">width =</span> <span class="dv">1</span>, <span class="dt">layout =</span> <span class="st">&quot;autofit&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb223-55"><a href="Logistic.html#cb223-55"></a><span class="st">  </span><span class="kw">hline_top</span>(<span class="dt">part=</span><span class="st">&quot;header&quot;</span>, <span class="dt">border =</span> big_border) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb223-56"><a href="Logistic.html#cb223-56"></a><span class="st">  </span><span class="kw">hline_bottom</span>(<span class="dt">part=</span><span class="st">&quot;body&quot;</span>, <span class="dt">border =</span> big_border)  <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb223-57"><a href="Logistic.html#cb223-57"></a><span class="st">  </span><span class="co"># i = 1 refers to top row of column headerings</span></span>
<span id="cb223-58"><a href="Logistic.html#cb223-58"></a><span class="st">  </span><span class="kw">compose</span>(<span class="dt">i =</span> <span class="dv">1</span>, <span class="dt">j =</span> <span class="st">&quot;t1_1&quot;</span>, <span class="dt">part =</span> <span class="st">&quot;header&quot;</span>,</span>
<span id="cb223-59"><a href="Logistic.html#cb223-59"></a>          <span class="dt">value =</span> <span class="kw">as_paragraph</span>(<span class="st">&quot;Prediction, \U1D70B&quot;</span>,  </span>
<span id="cb223-60"><a href="Logistic.html#cb223-60"></a>                               <span class="kw">as_sub</span>(<span class="st">&quot;0&quot;</span>), <span class="st">&quot;= 0.6416&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb223-61"><a href="Logistic.html#cb223-61"></a><span class="st">  </span><span class="kw">compose</span>(<span class="dt">i =</span> <span class="dv">1</span>, <span class="dt">j =</span> <span class="st">&quot;t2_1&quot;</span>, <span class="dt">part =</span> <span class="st">&quot;header&quot;</span>,</span>
<span id="cb223-62"><a href="Logistic.html#cb223-62"></a>          <span class="dt">value =</span> <span class="kw">as_paragraph</span>(<span class="st">&quot;Prediction, \U1D70B&quot;</span>,  </span>
<span id="cb223-63"><a href="Logistic.html#cb223-63"></a>                               <span class="kw">as_sub</span>(<span class="st">&quot;0&quot;</span>), <span class="st">&quot;= 0.50&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb223-64"><a href="Logistic.html#cb223-64"></a><span class="st">  </span><span class="co"># i = 2 refers to second row of column headings</span></span>
<span id="cb223-65"><a href="Logistic.html#cb223-65"></a><span class="st">  </span><span class="kw">compose</span>(<span class="dt">part =</span> <span class="st">&quot;header&quot;</span>, <span class="dt">i =</span> <span class="dv">2</span>, <span class="dt">j =</span> <span class="st">&quot;t1_1&quot;</span>,  </span>
<span id="cb223-66"><a href="Logistic.html#cb223-66"></a>          <span class="dt">value =</span> <span class="kw">as_paragraph</span>(<span class="st">&quot;y\U0302 = 1&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb223-67"><a href="Logistic.html#cb223-67"></a><span class="st">  </span><span class="kw">compose</span>(<span class="dt">part =</span> <span class="st">&quot;header&quot;</span>, <span class="dt">i =</span> <span class="dv">2</span>, <span class="dt">j =</span> <span class="st">&quot;t1_0&quot;</span>, </span>
<span id="cb223-68"><a href="Logistic.html#cb223-68"></a>          <span class="dt">value =</span> <span class="kw">as_paragraph</span>(<span class="st">&quot;y\U0302 = 0&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb223-69"><a href="Logistic.html#cb223-69"></a><span class="st">  </span><span class="kw">compose</span>(<span class="dt">part =</span> <span class="st">&quot;header&quot;</span>, <span class="dt">i =</span> <span class="dv">2</span>, <span class="dt">j =</span> <span class="st">&quot;t2_1&quot;</span>, </span>
<span id="cb223-70"><a href="Logistic.html#cb223-70"></a>          <span class="dt">value =</span> <span class="kw">as_paragraph</span>(<span class="st">&quot;y\U0302 = 1&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb223-71"><a href="Logistic.html#cb223-71"></a><span class="st">  </span><span class="kw">compose</span>(<span class="dt">part =</span> <span class="st">&quot;header&quot;</span>, <span class="dt">i =</span> <span class="dv">2</span>, <span class="dt">j =</span> <span class="st">&quot;t2_0&quot;</span>, </span>
<span id="cb223-72"><a href="Logistic.html#cb223-72"></a>          <span class="dt">value =</span> <span class="kw">as_paragraph</span>(<span class="st">&quot;y\U0302 = 0&quot;</span>))</span></code></pre></div>
<template id="2b1546fc-eb9e-43f2-9bbf-ceb1a083f67b"><style>
.tabwid table{
  border-collapse:collapse;
  line-height:1;
  margin-left:auto;
  margin-right:auto;
  border-width: 0;
  display: table;
  margin-top: 5px;
  margin-bottom: 5px;
  table-layout: fixed;
  border-spacing: 0;
  border-color: transparent;
}
.tabwid_left table{
  margin-left:0;
}
.tabwid_right table{
  margin-right:0;
}
.tabwid td {
    padding: 0;
}
.tabwid a {
  text-decoration: none;
}
.tabwid thead {
    background-color: transparent;
}
.tabwid tfoot {
    background-color: transparent;
}
.tabwid table tr {
background-color: transparent;
}
</style><div class="tabwid"><style>.cl-8cbc7424{table-layout:auto;border-collapse:collapse;width:100%;}.cl-8cb73360{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-8cb7337e{font-family:'Arial';font-size:10pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-8cb73388{font-family:'Helvetica';font-size:7pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;position: relative;top:3pt;}.cl-8cb74b66{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:3pt;padding-top:3pt;padding-left:3pt;padding-right:3pt;line-height: 1;background-color:transparent;}.cl-8cb785d6{width:54pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8cb785ea{width:54pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8cb785f4{width:54pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 2pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8cb785fe{width:54pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 2pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8cb785ff{width:54pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 2pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8cb78608{width:54pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8cb78612{width:54pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table class='cl-8cbc7424'>
<caption class="Table Caption">
<span id="tab:unnamed-chunk-52">Table 1: </span>Classification tables for horseshoe crab data with width and factor color predictors.
</caption>
<thead><tr style="overflow-wrap:break-word;"><td  rowspan="2"class="cl-8cb785f4"><p class="cl-8cb74b66"><span class="cl-8cb73360">Actual</span></p></td><td  rowspan="2"class="cl-8cb785ff"><p class="cl-8cb74b66"><span class="cl-8cb7337e"></span></p></td><td  colspan="2"class="cl-8cb785fe"><p class="cl-8cb74b66"><span class="cl-8cb73360">Prediction, 𝜋</span><span class="cl-8cb73388">0</span><span class="cl-8cb73360">= 0.6416</span></p></td><td  rowspan="2"class="cl-8cb785ff"><p class="cl-8cb74b66"><span class="cl-8cb7337e"></span></p></td><td  colspan="2"class="cl-8cb785fe"><p class="cl-8cb74b66"><span class="cl-8cb73360">Prediction, 𝜋</span><span class="cl-8cb73388">0</span><span class="cl-8cb73360">= 0.50</span></p></td><td  rowspan="2"class="cl-8cb785ff"><p class="cl-8cb74b66"><span class="cl-8cb7337e"></span></p></td><td  rowspan="2"class="cl-8cb785f4"><p class="cl-8cb74b66"><span class="cl-8cb73360">Total</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8cb78608"><p class="cl-8cb74b66"><span class="cl-8cb73360">ŷ = 1</span></p></td><td class="cl-8cb78608"><p class="cl-8cb74b66"><span class="cl-8cb73360">ŷ = 0</span></p></td><td class="cl-8cb78608"><p class="cl-8cb74b66"><span class="cl-8cb73360">ŷ = 1</span></p></td><td class="cl-8cb78608"><p class="cl-8cb74b66"><span class="cl-8cb73360">ŷ = 0</span></p></td></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-8cb785d6"><p class="cl-8cb74b66"><span class="cl-8cb73360">y = 1</span></p></td><td class="cl-8cb785d6"><p class="cl-8cb74b66"><span class="cl-8cb7337e"></span></p></td><td class="cl-8cb785d6"><p class="cl-8cb74b66"><span class="cl-8cb73360">75</span></p></td><td class="cl-8cb785d6"><p class="cl-8cb74b66"><span class="cl-8cb73360">36</span></p></td><td class="cl-8cb785d6"><p class="cl-8cb74b66"><span class="cl-8cb7337e"></span></p></td><td class="cl-8cb785d6"><p class="cl-8cb74b66"><span class="cl-8cb73360">96</span></p></td><td class="cl-8cb785d6"><p class="cl-8cb74b66"><span class="cl-8cb73360">15</span></p></td><td class="cl-8cb785d6"><p class="cl-8cb74b66"><span class="cl-8cb7337e"></span></p></td><td class="cl-8cb785d6"><p class="cl-8cb74b66"><span class="cl-8cb73360">111</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8cb785ea"><p class="cl-8cb74b66"><span class="cl-8cb73360">y = 0</span></p></td><td class="cl-8cb785ea"><p class="cl-8cb74b66"><span class="cl-8cb7337e"></span></p></td><td class="cl-8cb785ea"><p class="cl-8cb74b66"><span class="cl-8cb73360">19</span></p></td><td class="cl-8cb785ea"><p class="cl-8cb74b66"><span class="cl-8cb73360">43</span></p></td><td class="cl-8cb785ea"><p class="cl-8cb74b66"><span class="cl-8cb7337e"></span></p></td><td class="cl-8cb785ea"><p class="cl-8cb74b66"><span class="cl-8cb73360">31</span></p></td><td class="cl-8cb785ea"><p class="cl-8cb74b66"><span class="cl-8cb73360">31</span></p></td><td class="cl-8cb785ea"><p class="cl-8cb74b66"><span class="cl-8cb7337e"></span></p></td><td class="cl-8cb785ea"><p class="cl-8cb74b66"><span class="cl-8cb73360">62</span></p></td></tr></tbody></table></div></template>
<div id="ee9ae382-8fa8-47e6-96cb-8f3049e15000"></div>
<script>
var dest = document.getElementById("ee9ae382-8fa8-47e6-96cb-8f3049e15000");
var template = document.getElementById("2b1546fc-eb9e-43f2-9bbf-ceb1a083f67b");
var caption = template.content.querySelector("caption");
if(caption) {
  caption.style.cssText = "display:block;"
  var newcapt = document.createElement("p");
  newcapt.appendChild(caption)
  dest.parentNode.insertBefore(newcapt, dest.previousSibling);
}
var fantome = dest.attachShadow({mode: 'open'});
var templateContent = template.content;
fantome.appendChild(templateContent);
fantome.appendChild(templateContent);
</script>

<p><span class="math display">\[\mathrm{Sensitivity} = P(\hat y = 1 | y = 1), \ \ \ \ \  \mathrm{Sensitivity} = P(\hat y = 0 | y = 0)\]</span></p>
<p><span class="math display">\[P(\mathrm{correct\ classif.}) = \mathrm{sensitivity}[P(y = 1)] + \mathrm{specificity}[1 - P(y = 1)],\]</span></p>
</div>
<div id="summarizing-predictive-power-roc-curves" class="section level3">
<h3>4.6.2 Summarizing Predictive Power: ROC Curves</h3>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="Logistic.html#cb224-1"></a>fit &lt;-<span class="st"> </span><span class="kw">glm</span>(y <span class="op">~</span><span class="st"> </span>width <span class="op">+</span><span class="st"> </span><span class="kw">factor</span>(color), <span class="dt">family =</span> binomial, <span class="dt">data =</span> Crabs)</span>
<span id="cb224-2"><a href="Logistic.html#cb224-2"></a></span>
<span id="cb224-3"><a href="Logistic.html#cb224-3"></a><span class="kw">suppressMessages</span>(<span class="kw">library</span>(pROC))</span>
<span id="cb224-4"><a href="Logistic.html#cb224-4"></a><span class="kw">suppressMessages</span>(</span>
<span id="cb224-5"><a href="Logistic.html#cb224-5"></a>  rocPlot &lt;-<span class="st"> </span><span class="kw">roc</span>(y <span class="op">~</span><span class="st"> </span><span class="kw">fitted</span>(fit), <span class="dt">data =</span> Crabs)  </span>
<span id="cb224-6"><a href="Logistic.html#cb224-6"></a>)</span>
<span id="cb224-7"><a href="Logistic.html#cb224-7"></a></span>
<span id="cb224-8"><a href="Logistic.html#cb224-8"></a>x &lt;-<span class="st"> </span><span class="kw">data.frame</span>(rocPlot<span class="op">$</span>sensitivities,rocPlot<span class="op">$</span>specificities, rocPlot<span class="op">$</span>thresholds)</span>
<span id="cb224-9"><a href="Logistic.html#cb224-9"></a></span>
<span id="cb224-10"><a href="Logistic.html#cb224-10"></a>thePar &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="dt">pty =</span> <span class="st">&quot;s&quot;</span>)</span>
<span id="cb224-11"><a href="Logistic.html#cb224-11"></a><span class="kw">plot.roc</span>(rocPlot, <span class="dt">legacy.axes =</span> <span class="ot">TRUE</span>, <span class="dt">asp =</span> F)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-53-1.png" width="672" /></p>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="Logistic.html#cb225-1"></a><span class="kw">par</span>(thePar)</span>
<span id="cb225-2"><a href="Logistic.html#cb225-2"></a></span>
<span id="cb225-3"><a href="Logistic.html#cb225-3"></a><span class="kw">auc</span>(rocPlot)</span></code></pre></div>
<pre class="custom-output"><code>Area under the curve: 0.7714</code></pre>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="Logistic.html#cb227-1"></a><span class="co"># Make a prettier ROC plot including the probability cut points</span></span>
<span id="cb227-2"><a href="Logistic.html#cb227-2"></a>model &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">outcome =</span> Crabs<span class="op">$</span>y, </span>
<span id="cb227-3"><a href="Logistic.html#cb227-3"></a>                    <span class="dt">predicted =</span> <span class="kw">predict</span>(fit, Crabs, <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>))  </span>
<span id="cb227-4"><a href="Logistic.html#cb227-4"></a></span>
<span id="cb227-5"><a href="Logistic.html#cb227-5"></a><span class="kw">suppressMessages</span>(<span class="kw">library</span>(plotROC))</span>
<span id="cb227-6"><a href="Logistic.html#cb227-6"></a><span class="co"># `d` (disease) holds the known truth</span></span>
<span id="cb227-7"><a href="Logistic.html#cb227-7"></a><span class="co"># `m` (marker) holds the predictor values </span></span>
<span id="cb227-8"><a href="Logistic.html#cb227-8"></a><span class="kw">ggplot</span>(model, <span class="kw">aes</span>(<span class="dt">d =</span> outcome, <span class="dt">m =</span> predicted)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb227-9"><a href="Logistic.html#cb227-9"></a><span class="st">  </span><span class="kw">geom_roc</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb227-10"><a href="Logistic.html#cb227-10"></a><span class="st">  </span><span class="kw">style_roc</span>(<span class="dt">xlab =</span> <span class="st">&quot;1-Specificity&quot;</span>,</span>
<span id="cb227-11"><a href="Logistic.html#cb227-11"></a>            <span class="dt">ylab =</span><span class="st">&quot;Sensitivity&quot;</span>,</span>
<span id="cb227-12"><a href="Logistic.html#cb227-12"></a>            <span class="dt">minor.breaks =</span> <span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">0</span>, <span class="fl">0.1</span>, <span class="dt">by =</span> <span class="fl">0.02</span>), <span class="kw">seq</span>(<span class="fl">0.9</span>, <span class="dv">1</span>, <span class="dt">by =</span> <span class="fl">0.02</span>))) <span class="op">+</span><span class="st"> </span></span>
<span id="cb227-13"><a href="Logistic.html#cb227-13"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;ROC curve with probabilty cutpoints&quot;</span>) <span class="op">+</span></span>
<span id="cb227-14"><a href="Logistic.html#cb227-14"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">aspect.ratio=</span><span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb227-15"><a href="Logistic.html#cb227-15"></a><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">slope =</span> <span class="dv">1</span>, <span class="dt">color =</span> <span class="st">&quot;grey92&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-53-2.png" width="672" /></p>
</div>
<div id="x4.6.3" class="section level3">
<h3>4.6.3 Summarizing Predictive Power: Multiple Correlation</h3>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="Generalized.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="building-and-applying-logistic-regression-models.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": false
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
