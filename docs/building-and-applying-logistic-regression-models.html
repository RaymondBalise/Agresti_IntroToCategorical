<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 Building and Applying Logistic Regression Models | Notes for Agresti’s Introduction to Categorical Data Analysis 3rd Edition</title>
  <meta name="description" content="Notes for Agresti’s Introduction to Categorical Data Analysis" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="5 Building and Applying Logistic Regression Models | Notes for Agresti’s Introduction to Categorical Data Analysis 3rd Edition" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Notes for Agresti’s Introduction to Categorical Data Analysis" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 Building and Applying Logistic Regression Models | Notes for Agresti’s Introduction to Categorical Data Analysis 3rd Edition" />
  
  <meta name="twitter:description" content="Notes for Agresti’s Introduction to Categorical Data Analysis" />
  

<meta name="author" content="Raymond R. Balise and Wayne F. DeFreitas" />


<meta name="date" content="2021-01-08" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="Logistic.html"/>
<link rel="next" href="Multicategory.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/tabwid-1.0.0/tabwid.css" rel="stylesheet" />


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>1 Introduction</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#categorical-response-data"><i class="fa fa-check"></i>1.1 Categorical Response Data</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#response-variables-and-explanatory-variables"><i class="fa fa-check"></i>1.1.1 Response Variables and Explanatory Variables</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#binary-nominal-ordinal-scale-distinction"><i class="fa fa-check"></i>1.1.2 Binary-Nominal-Ordinal Scale Distinction</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#organization-of-this-book"><i class="fa fa-check"></i>1.1.3 Organization of this Book</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#probability-distributions-for-categorical-data"><i class="fa fa-check"></i>1.2 Probability Distributions for Categorical Data</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#binomial"><i class="fa fa-check"></i>1.2.1 Binomial Distribution</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#statistical-inference-for-a-proportion"><i class="fa fa-check"></i>1.3 Statistical Inference for a Proportion</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#likelihood-function-and-maximum-likelihood-estimation"><i class="fa fa-check"></i>1.3.1 Likelihood Function and Maximum Likelihood Estimation</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#significance-test-about-a-binomial-parameter"><i class="fa fa-check"></i>1.3.2 Significance Test about a Binomial Parameter</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#example-surveyed-opinions-about-legalized-abortion"><i class="fa fa-check"></i>1.3.3 Example: Surveyed Opinions About Legalized Abortion</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#confidence-intervals-for-a-binomial-parameter"><i class="fa fa-check"></i>1.3.4 Confidence Intervals for a Binomial Parameter</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#better-confidence-intervals-for-a-binomial-proportion"><i class="fa fa-check"></i>1.3.5 Better Confidence Intervals for a Binomial Proportion</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#statistical-inference-for-discrete-data"><i class="fa fa-check"></i>1.4 Statistical Inference for Discrete Data</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#x1.4.1"><i class="fa fa-check"></i>1.4.1 Wald, Likelihood-Ratio, and Score Tests</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#example-wald-score-and-likelihood-ratio-binomial-tests"><i class="fa fa-check"></i>1.4.2 Example Wald, Score and Likelihood-Ratio Binomial Tests</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#ssbi"><i class="fa fa-check"></i>1.4.3 Small-Sample Binomial Inference and the Mid P-Value</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#bayesian-inference-for-proportions"><i class="fa fa-check"></i>1.5 Bayesian Inference for Proportions</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#the-bayesian-approach-to-statistical-inference"><i class="fa fa-check"></i>1.5.1 The Bayesian Approach to Statistical Inference</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#bayesian-binomial-inference-beta-prior-distributions"><i class="fa fa-check"></i>1.5.2 Bayesian Binomial Inference: Beta Prior Distributions</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#example-opinions-about-legalized-abortion-revisited"><i class="fa fa-check"></i>1.5.3 Example: Opinions about Legalized Abortion, Revisited</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#other-prior-distributions"><i class="fa fa-check"></i>1.5.4 Other Prior Distributions</a></li>
</ul></li>
<li><a href="index.html#using-r-software-for-statistical-inference-about-proportions">1.6 Using <code>R</code> software for Statistical Inference about Proportions</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#reading-data-files-and-installing-packages"><i class="fa fa-check"></i>1.6.1 Reading Data Files and Installing Packages</a></li>
<li><a href="index.html#using-r-for-statistical-inference-about-proportions">1.6.2 Using <code>R</code> for Statistical Inference about Proportions</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#summary-choosing-an-inference-method"><i class="fa fa-check"></i>1.6.3 Summary: Choosing an Inference Method</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#exercises"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html"><i class="fa fa-check"></i>2 Analyzing Contingency Tables</a><ul>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#probability-structure-for-contingency-tables"><i class="fa fa-check"></i>2.1 Probability Structure for Contingency Tables</a><ul>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#joint-marginal-and-conditional-probabilities"><i class="fa fa-check"></i>2.1.1 Joint, Marginal, and Conditional Probabilities</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#binomial-and-multinomial-sampling"><i class="fa fa-check"></i>2.1.4 Binomial and Multinomial Sampling</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#comparing-proportions-in-2-x-2-contingency-tables"><i class="fa fa-check"></i>2.2 Comparing Proportions in 2 x 2 Contingency Tables</a><ul>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#difference-of-proportions"><i class="fa fa-check"></i>2.2.1 Difference of Proportions</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#table2-2"><i class="fa fa-check"></i>2.2.2 Example: Aspirin and incidence of Heart Attacks</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#ratio-of-proportions-relative-risk"><i class="fa fa-check"></i>2.2.3 Ratio of Proportions (Relative Risk)</a></li>
<li><a href="Contingency.html#using-r-for-comparing-proportions-in-2-x-2-tables">2.2.4 Using <code>R</code> for Comparing Proportions in 2 x 2 Tables</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#the-odds-ratio"><i class="fa fa-check"></i>2.3 The Odds Ratio</a><ul>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#properties-of-the-odds-ratio"><i class="fa fa-check"></i>2.3.1 Properties of the Odds Ratio</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#example-odds-ratio-for-aspirin-and-hart-attacks"><i class="fa fa-check"></i>2.3.2 Example: Odds Ratio for Aspirin and Hart Attacks</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#inference-for-odds-ratios-and-log-odds-ratios"><i class="fa fa-check"></i>2.3.3 Inference for Odds Ratios and Log Odds Ratios</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#relationship-between-odds-ratio-and-relative-risk"><i class="fa fa-check"></i>2.3.4 Relationship Between Odds Ratio and Relative Risk</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#x2.3.5"><i class="fa fa-check"></i>2.3.5 Example: The Odds Ratio Applies in Case-Control Studies</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#types-of-studies-observational-versus-experimental"><i class="fa fa-check"></i>2.3.6 Types of Studies Observational Versus Experimental</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#x2.4"><i class="fa fa-check"></i>2.4 Chi-Squared Tests of Independence</a><ul>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#x2.4.1"><i class="fa fa-check"></i>2.4.1 Pearson Statistic and the Chi-Squared Distribution</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#likelihood-ratio-statistic"><i class="fa fa-check"></i>2.4.2 likelihood-Ratio Statistic</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#testing-independence-in-two-way-contingency-tables"><i class="fa fa-check"></i>2.4.3 Testing Independence in Two-Way Contingency Tables</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#example-gender-gap-in-political-party-affiliation"><i class="fa fa-check"></i>2.4.4 Example: Gender Gap in Political Party Affiliation</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#residuals-for-cells-in-a-contingency-table"><i class="fa fa-check"></i>2.4.5 Residuals for Cells in a Contingency Table</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#partitioning-chi-squared-statistics"><i class="fa fa-check"></i>2.4.6 Partitioning Chi-Squared Statistics</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#limitations-of-chi-squared-tests"><i class="fa fa-check"></i>2.4.7 Limitations of Chi-Squared Tests</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#x2.5"><i class="fa fa-check"></i>2.5 Testing Independence for Ordinal Variables</a><ul>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#linear-trend-alternative-to-independence"><i class="fa fa-check"></i>2.5.1 Linear Trend Alternative to Independence</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#example-alcohol-use-and-infant-malformation"><i class="fa fa-check"></i>2.5.2 Example: Alcohol Use and Infant Malformation</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#ordinal-tests-usually-have-greater-power"><i class="fa fa-check"></i>2.5.3 Ordinal Tests Usually Have Greater Power</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#choice-of-scores"><i class="fa fa-check"></i>2.5.4 Choice of Scores</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#trend-tests-for-r-x-2-and-2-x-c-and-nominal-ordinal-tables"><i class="fa fa-check"></i>2.5.6 Trend Tests for r x 2 and 2 x c and Nominal-Ordinal Tables</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#exact-frequentist-and-bayesian-inference"><i class="fa fa-check"></i>2.6 Exact Frequentist and Bayesian Inference</a><ul>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#fishers-exact-test-for-2-x-2-tables"><i class="fa fa-check"></i>2.6.1 Fisher’s Exact Test for 2 x 2 Tables</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#example-fishers-tea-tasting-colleague"><i class="fa fa-check"></i>2.6.2 Example: Fisher’s Tea Tasting Colleague</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#conservatism-for-actual-ptype-i-error-mid-p-value"><i class="fa fa-check"></i>2.6.3 Conservatism for Actual P(Type I Error); Mid P-Value</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#small-sample-confidence-intervals-for-odds-ratio"><i class="fa fa-check"></i>2.6.4 Small-Sample Confidence Intervals for Odds Ratio</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#bayesian-estimation-for-association-measures"><i class="fa fa-check"></i>2.6.5 Bayesian Estimation for Association Measures</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#example-bayesian-inference-in-a-small-clinical-trial"><i class="fa fa-check"></i>2.6.6 Example: Bayesian Inference in a Small Clinical Trial</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#association-in-three-way-tables"><i class="fa fa-check"></i>2.7 Association in Three-Way Tables</a><ul>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#partial-tables"><i class="fa fa-check"></i>2.7.1 Partial Tables</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#example-death-penalty-verdicts-and-race"><i class="fa fa-check"></i>2.7.2 Example: Death Penalty Verdicts and Race</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#simpsons-paradox"><i class="fa fa-check"></i>2.7.3 Simpson’s Paradox</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#conditional-and-marginal-odds-ratios"><i class="fa fa-check"></i>2.7.4 Conditional and Marginal Odds Ratios</a></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#x2.7.5"><i class="fa fa-check"></i>2.7.5 Homogeneous Association</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Contingency.html"><a href="Contingency.html#exercises-1"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html"><i class="fa fa-check"></i>3 Generalized Linear Models</a><ul>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#components-of-a-generalized-linear-model"><i class="fa fa-check"></i>3.1 Components of a Generalized Linear Model</a><ul>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#random-component"><i class="fa fa-check"></i>3.1.1 Random Component</a></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#linear-predictor"><i class="fa fa-check"></i>3.1.2 Linear Predictor</a></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#link-function"><i class="fa fa-check"></i>3.1.3 Link Function</a></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#ordinary-linear-model-glm-with-normal-random-component"><i class="fa fa-check"></i>3.1.4 Ordinary Linear Model: GLM with Normal Random Component</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#components-of-a-generalized-linear-model-1"><i class="fa fa-check"></i>3.2 Components of a Generalized Linear Model</a><ul>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#x3.2.1"><i class="fa fa-check"></i>3.2.1 Linear Probability Model</a></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#logistic-regression-model"><i class="fa fa-check"></i>3.2.2 Logistic Regression Model</a></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#x3.2.3"><i class="fa fa-check"></i>3.2.3 Example Snoring and Heart Disease</a></li>
<li><a href="Generalized.html#using-r-to-fit-generalized-lineare-models-for-binary-data">3.2.4 Using <code>R</code> to Fit Generalized Lineare Models for Binary Data</a></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#x3.2.5"><i class="fa fa-check"></i>3.2.5 Data Files: Ungrouped or Grouped Binary Data</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#x3.3"><i class="fa fa-check"></i>3.3 Generalized Linear Models for Binary Data</a><ul>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#poisson-distribution-for-counts"><i class="fa fa-check"></i>3.3.1 Poisson Distribution for Counts</a></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#poisson-loglinear-model"><i class="fa fa-check"></i>3.3.2 Poisson Loglinear Model</a></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#x3.3.3"><i class="fa fa-check"></i>3.3.3 Example: Female Horseshoe Crabs and their Satellites</a></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#x3.3.4"><i class="fa fa-check"></i>3.3.4 Overdispersion: Greater Variability than Expected</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#generalized-lineaer-models-for-counts-and-rates"><i class="fa fa-check"></i>3.4 Generalized Lineaer Models for Counts and Rates</a><ul>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#x3.4.1"><i class="fa fa-check"></i>3.4.1 Wald, Likelihood-Ratio, and Score Inference Use the Likelihood Function</a></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#example-political-ideology-and-belief-in-evolution"><i class="fa fa-check"></i>3.4.2 Example Political Ideology and Belief in Evolution</a></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#model-comparison-using-the-deviance"><i class="fa fa-check"></i>3.4.4 Model Comparison Using the Deviance</a></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#x3.4.5"><i class="fa fa-check"></i>3.4.5 Residuals Comparing Ovservations to the Model Fit</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#fitting-generalized-linear-models"><i class="fa fa-check"></i>3.5 Fitting Generalized Linear Models</a><ul>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#x3.5.1"><i class="fa fa-check"></i>3.5.1 The Fisher Scoring Algorithm Fits GLMs</a></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#bayesian-methods-for-generalized-lineare-models"><i class="fa fa-check"></i>3.5.2 Bayesian Methods for Generalized Lineare Models</a></li>
<li class="chapter" data-level="" data-path="Generalized.html"><a href="Generalized.html#glms-a-unified-approach-to-statistical-analysis"><i class="fa fa-check"></i>3.5.3 GLMs: A Unified Approach to Statistical Analysis</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html"><i class="fa fa-check"></i>4 Logistic Regression</a><ul>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#the-logistic-regression-model"><i class="fa fa-check"></i>4.1 The Logistic Regression Model</a><ul>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#the-logistic-regression-model-1"><i class="fa fa-check"></i>4.1.1 The Logistic Regression Model</a></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#odds-ratio-and-linear-approximaiton-interpreetations-4.1.2"><i class="fa fa-check"></i>4.1.2 Odds Ratio and Linear Approximaiton Interpreetations {#4.1.2}</a></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#x4.1.3"><i class="fa fa-check"></i>4.1.3 Example: Whethr a Female Horsehoe Crab Has Satelites</a></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#logistic-regression-with-retrospective-studies"><i class="fa fa-check"></i>4.1.4 Logistic Regression with Retrospective Studies</a></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#normally-distributed-x-implies-logistic-regression-for-y"><i class="fa fa-check"></i>4.1.5 Normally Distributed X Implies Logistic Regression for Y</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#x4.2"><i class="fa fa-check"></i>4.2 Statistical Inference for Logistic Regression</a><ul>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#x4.2.1"><i class="fa fa-check"></i>4.2.1 Confidence Intervals for Effects</a></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#x4.2.2"><i class="fa fa-check"></i>4.2.2 Significance Testing</a></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#fitted-values-and-confidence-intervals-for-probabilities"><i class="fa fa-check"></i>4.2.3 Fitted Values and Confidence Intervals for Probabilities</a></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#why-use-a-model-to-estimate-probabilities"><i class="fa fa-check"></i>4.2.4 Why Use a Model to Estimate Probabilities?</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#logistic-regression-with-categorical-predictors"><i class="fa fa-check"></i>4.3 Logistic Regression with Categorical Predictors</a><ul>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#indicator-variables-represent-categories-of-predictors"><i class="fa fa-check"></i>4.3.1 Indicator Variables Represent Categories of Predictors</a></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#example-survey-about-marijuana-use"><i class="fa fa-check"></i>4.3.2 Example: Survey about Marijuana Use</a></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#anova-type-model-representation-of-factors"><i class="fa fa-check"></i>4.3.3 ANOVA-Type Model Representation of Factors</a></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#tests-of-conditoinal-independence-and-of-homogeneity-for-three-way-contingency-tables"><i class="fa fa-check"></i>4.3.4 Tests of Conditoinal Independence and of Homogeneity for Three-Way Contingency Tables</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#multiple-logistic-regression"><i class="fa fa-check"></i>4.4 Multiple Logistic Regression</a><ul>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#x4.4.1"><i class="fa fa-check"></i>4.4.1 Example: Horseshoe Crabs with Color and Width Predictors</a></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#model-comparison-to-check-whether-a-term-is-needed"><i class="fa fa-check"></i>4.4.2 Model Comparison to Check Whether a Term is Needed</a></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#example-treating-color-as-quantitative-or-binary"><i class="fa fa-check"></i>4.4.3 Example: Treating Color as Quantitative or Binary</a></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#allowing-interaction-between-explanatory-variables"><i class="fa fa-check"></i>4.4.4 Allowing Interaction between Explanatory Variables</a></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#effects-depend-on-other-explanatory-variables-in-model"><i class="fa fa-check"></i>4.4.5 Effects Depend on Other Explanatory Variables in Model</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#summarizing-effects-in-logistic-regression"><i class="fa fa-check"></i>4.5 Summarizing Effects in Logistic Regression</a><ul>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#probability-based-interpretations"><i class="fa fa-check"></i>4.5.1 Probability-Based Interpretations</a></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#x4.5.2"><i class="fa fa-check"></i>4.5.2 Marginal Effects and Their Average</a></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#x4.5.3"><i class="fa fa-check"></i>4.5.3 Standardized Interpretations</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#summzarizing-predictive-power-classification-tables-roc-curves-and-multiple-correlation"><i class="fa fa-check"></i>4.6 Summzarizing Predictive Power: Classification Tables, ROC Curves and Multiple Correlation</a><ul>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#x4.6.1"><i class="fa fa-check"></i>4.6.1 Summarizing Predictive Power: Classification Tables</a></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#summarizing-predictive-power-roc-curves"><i class="fa fa-check"></i>4.6.2 Summarizing Predictive Power: ROC Curves</a></li>
<li class="chapter" data-level="" data-path="Logistic.html"><a href="Logistic.html#x4.6.3"><i class="fa fa-check"></i>4.6.3 Summarizing Predictive Power: Multiple Correlation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html"><i class="fa fa-check"></i>5 Building and Applying Logistic Regression Models</a><ul>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#strategies-in-model-selection"><i class="fa fa-check"></i>5.1 Strategies in Model Selection</a><ul>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#how-many-explanatory-variables-can-the-model-handle"><i class="fa fa-check"></i>5.1.1 How Many Explanatory Variables Can the Model Handle?</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#example-horseshoe-crab-satellites-revisited"><i class="fa fa-check"></i>5.1.2 Example: Horseshoe Crab Satellites Revisited</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#stepwise-variable-selection-algorithms"><i class="fa fa-check"></i>5.1.3 Stepwise Variable Selection Algorithms</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#surposeful-selection-of-explanatory-variables"><i class="fa fa-check"></i>5.1.4 Surposeful Selection of Explanatory Variables</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#example-variable-selection-for-horseshoe-crabs"><i class="fa fa-check"></i>5.1.5 Example: Variable Selection for Horseshoe Crabs</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#aic-and-the-biasvariance-tradeoff"><i class="fa fa-check"></i>5.1.6 AIC and the Bias/Variance Tradeoff</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#model-checking"><i class="fa fa-check"></i>5.2 Model Checking</a><ul>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#x5.2.1"><i class="fa fa-check"></i>5.2.1 Goodness of Fit: Model Comparison Using the Deviance</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#x5.2.2"><i class="fa fa-check"></i>5.2.2 Example: Goodness of Fit for Marijuana Use Survey</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#goodness-of-fit-grouped-versus-ungrouped-data-and-continuous-predictors"><i class="fa fa-check"></i>5.2.3 Goodness of Fit: Grouped versus Ungrouped Data and Continuous Predictors</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#residuals-for-logistic-models-with-categorical-predictors"><i class="fa fa-check"></i>5.2.4 Residuals for Logistic Models with Categorical Predictors</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#standardized-versus-pearson-and-deviance-residuals"><i class="fa fa-check"></i>5.2.6 Standardized versus Pearson and Deviance Residuals</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#influence-diagnostics-for-logistic-regression"><i class="fa fa-check"></i>5.2.7 Influence Diagnostics for Logistic Regression</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#example-heart-disease-and-blood-pressure"><i class="fa fa-check"></i>5.2.8 Example: Heart Disease and Blood Pressure</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#infinite-estimates-in-logistic-regression"><i class="fa fa-check"></i>5.3 Infinite Estimates in Logistic Regression</a><ul>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#complete-and-quasi-complete-separation-perfeect-discrination"><i class="fa fa-check"></i>5.3.1 Complete and Quasi-Complete Separation: Perfeect Discrination</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#example-infinite-estimate-for-toy-example"><i class="fa fa-check"></i>5.3.2 Example: Infinite Estimate for Toy Example</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#sparse-data-and-infinite-effects-with-categorical-predictors"><i class="fa fa-check"></i>5.3.3 Sparse Data and Infinite Effects with Categorical Predictors</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#x5.3.5"><i class="fa fa-check"></i>5.3.4 Example: Risk Factors for Endometrial Cancer Grade</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#x5.4"><i class="fa fa-check"></i>5.4 Bayesian Inference, Penalized Likelihood, and Conditional Likelihood for Logistic Regression *</a><ul>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#bayesian-modeling-specification-of-prior-distributions"><i class="fa fa-check"></i>5.4.1 Bayesian Modeling: Specification of Prior Distributions</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#example-risk-factors-for-endometrial-caner-revisited"><i class="fa fa-check"></i>5.4.2 Example: Risk Factors for Endometrial Caner Revisited</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#penalized-likelihood-reduces-bias-in-logistic-regression"><i class="fa fa-check"></i>5.4.3 Penalized Likelihood Reduces Bias in Logistic Regression</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#example-risk-factors-for-endometrial-cancer-revisited"><i class="fa fa-check"></i>5.4.4 Example: Risk Factors for Endometrial Cancer Revisited</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#x5.4.5"><i class="fa fa-check"></i>5.4.5 Conditional Likelihood and Conditional Logistic Regression</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#conditional-logistic-regression-and-exact-tests-for-contingency-tables"><i class="fa fa-check"></i>5.4.6 Conditional Logistic Regression and Exact Tests for Contingency Tables</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#alternative-link-functions-linear-probability-and-probit-models"><i class="fa fa-check"></i>5.5 Alternative Link Functions: Linear Probability and Probit Models *</a><ul>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#linar-probability-model"><i class="fa fa-check"></i>5.5.1 Linar Probability Model</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#example-political-ideology-and-belief-in-evolution-1"><i class="fa fa-check"></i>5.5.2 Example: Political Ideology and Belief in Evolution</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#x5.5.3"><i class="fa fa-check"></i>5.5.3 Probit Model and Normal Latent Variable Model</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#example-snoring-and-heart-disease-revisited"><i class="fa fa-check"></i>5.5.4 Example: Snoring and Heart Disease Revisited</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#latent-variable-models-imply-binary-regression-models"><i class="fa fa-check"></i>5.5.5 Latent Variable Models Imply Binary Regression Models</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#cdfs-and-shapes-of-curves-for-binary-reegressoin-models"><i class="fa fa-check"></i>5.5.6 CDFs and Shapes of Curves for Binary Reegressoin Models</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#sample-size-and-power-for-logistic-regression"><i class="fa fa-check"></i>5.6 Sample Size and Power for Logistic Regression *</a><ul>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#sample-size-for-comparing-two-proportions"><i class="fa fa-check"></i>5.6.1 Sample Size for Comparing Two Proportions</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#sample-size-in-logistic-regression-modeling"><i class="fa fa-check"></i>5.6.2 Sample Size in Logistic Regression Modeling</a></li>
<li class="chapter" data-level="" data-path="building-and-applying-logistic-regression-models.html"><a href="building-and-applying-logistic-regression-models.html#example-modeling-the-probability-of-heart-disease"><i class="fa fa-check"></i>5.6.3 Example: Modeling the Probability of Heart Disease</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html"><i class="fa fa-check"></i>6 Multicategory Logit Models</a><ul>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#baseline-category-logit-models-for-nominal-responses"><i class="fa fa-check"></i>6.1 Baseline-Category Logit Models for Nominal Responses</a><ul>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#baseline-category-logits"><i class="fa fa-check"></i>6.1.1 Baseline-Category Logits</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#example-what-do-alligators-eat"><i class="fa fa-check"></i>6.1.2 Example: What Do Alligators Eat?</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#estimating-response-probabilities"><i class="fa fa-check"></i>6.1.3 Estimating Response Probabilities</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#checking-multinomial-model-goodness-of-fit"><i class="fa fa-check"></i>6.1.4 Checking multinomial Model Goodness of Fit</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#example-belief-in-afterlife"><i class="fa fa-check"></i>6.1.5 Example: Belief in Afterlife</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#discrete-choice-models"><i class="fa fa-check"></i>6.1.6 Discrete Choice Models*</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#example-shopping-destination-choice"><i class="fa fa-check"></i>6.1.7 Example: Shopping Destination Choice*</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#cumulative-logit-models-for-ordinal-responses-x6.2"><i class="fa fa-check"></i>6.2 Cumulative Logit Models for Ordinal Responses {x6.2}</a><ul>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#x6.2.1"><i class="fa fa-check"></i>6.2.1 Cumulative Logit Models with Proportional Odds</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#x6.2.2"><i class="fa fa-check"></i>6.2.2 Example: Political Ideology and Political Party Affiliation</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#inference-about-cumulative-logit-model-parameters"><i class="fa fa-check"></i>6.2.3 Inference about Cumulative Logit Model Parameters</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#increased-power-for-ordinal-analyses"><i class="fa fa-check"></i>6.2.4 Increased Power for Ordinal Analyses</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#example-happiness-and-family-income"><i class="fa fa-check"></i>6.2.5 Example: Happiness and Family Income</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#x6.2.6"><i class="fa fa-check"></i>6.2.6 Latent Variable Linear Models Imply Cumulative Link Models</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#invariance-to-choice-of-response-categories"><i class="fa fa-check"></i>6.2.7 Invariance to Choice of Response Categories</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#cumulative-link-models-model-checking-and-extensions"><i class="fa fa-check"></i>6.3 Cumulative Link Models: Model Checking and Extensions *</a><ul>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#checking-ordinal-model-goodness-of-fit"><i class="fa fa-check"></i>6.3.1 Checking Ordinal Model Goodness of Fit</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#cumulative-logit-model-without-proportional-odds"><i class="fa fa-check"></i>6.3.2 Cumulative Logit Model without Proportional Odds</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#simpler-interpretatoins-using-probabiliteis"><i class="fa fa-check"></i>6.3.3 Simpler Interpretatoins Using Probabiliteis</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#example-modeling-mental-impairment"><i class="fa fa-check"></i>6.3.4 Example: Modeling Mental Impairment</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#a-latent-variable-probability-comparison-of-groups"><i class="fa fa-check"></i>6.3.5 A Latent Variable Probability Comparison of Groups</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#cumulative-probit-model"><i class="fa fa-check"></i>6.3.6 Cumulative Probit Model</a></li>
<li><a href="Multicategory.html#r2-based-on-latent-variable-model">6.3.7 <span class="math inline">\(R^2\)</span> Based on Latent Variable Model</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#bayesian-inference-for-multinomial-models"><i class="fa fa-check"></i>6.3.8 Bayesian Inference for Multinomial Models</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#example-modeling-mental-impairment-revisited"><i class="fa fa-check"></i>6.3.9 Example: Modeling Mental Impairment Revisited</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#paired-category-logit-modeling-of-ordinal-response"><i class="fa fa-check"></i>6.4 Paired-Category Logit Modeling of Ordinal Response *</a><ul>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#adjacent-categories-logits"><i class="fa fa-check"></i>6.4.1 Adjacent-Categories Logits</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#example-political-ideology-revisited"><i class="fa fa-check"></i>6.4.2 Example: Political Ideology Revisited</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#sequential-logits"><i class="fa fa-check"></i>6.4.3 Sequential Logits</a></li>
<li class="chapter" data-level="" data-path="Multicategory.html"><a href="Multicategory.html#example-tonsil-size-and-streptococcus"><i class="fa fa-check"></i>6.4.4 Example: Tonsil Size and Streptococcus</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html"><i class="fa fa-check"></i>7 Loglinear Models for Contingency Tables and Counts</a><ul>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#loglinear-models-for-counts-in-contingency-tables"><i class="fa fa-check"></i>7.1 Loglinear Models for Counts in Contingency Tables</a><ul>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#loglinear-model-of-independence-for-two-way-contingency-tables"><i class="fa fa-check"></i>7.1.1 Loglinear Model of Independence for Two-Way Contingency Tables</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#interpretation-of-parameters-in-the-independence-model"><i class="fa fa-check"></i>7.1.2 Interpretation of Parameters in the Independence Model</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#example-happiness-and-belief-in-heaven"><i class="fa fa-check"></i>7.1.3 Example: Happiness and Belief in Heaven</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#saturated-model-for-two-way-contingency-tables"><i class="fa fa-check"></i>7.1.4 Saturated Model for Two-Way Contingency Tables</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#loglinear-models-for-three-way-contingency-tables"><i class="fa fa-check"></i>7.1.5 Loglinear Models for Three-Way Contingency Tables</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#two-factor-parameters-describe-conditional-associations"><i class="fa fa-check"></i>7.1.6 Two-Factor Parameters Describe Conditional Associations</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#example-student-alcohol-cigarette-and-marijuana-use"><i class="fa fa-check"></i>7.1.7 Example: Student Alcohol, Cigarette, and Marijuana Use</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#statistical-inference-for-loglinear-models"><i class="fa fa-check"></i>7.2 Statistical Inference for Loglinear Models</a><ul>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#chi-squared-goodness-of-fit-tests"><i class="fa fa-check"></i>7.2.1 Chi-Squared Goodness-of-Fit Tests</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#x7.2.2"><i class="fa fa-check"></i>7.2.2 Cell Standardized Residuals for Loglinear Models</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#significance-tests-about-conditional-associations"><i class="fa fa-check"></i>7.2.3 Significance Tests about Conditional Associations</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#confidence-intervals-for-conditional-odds-ratios"><i class="fa fa-check"></i>7.2.4 Confidence Intervals for Conditional Odds Ratios</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#bayesian-fitting-of-loglinear-models"><i class="fa fa-check"></i>7.2.5 Bayesian Fitting of Loglinear Models</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#loglinear-models-for-higher-dimensional-contingency-tables"><i class="fa fa-check"></i>7.2.6 Loglinear Models for Higher-Dimensional Contingency Tables</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#example-automobile-accidents-and-seat-belts"><i class="fa fa-check"></i>7.2.7 Example: Automobile Accidents and Seat Belts</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#interpreting-three-factor-interaction-terms"><i class="fa fa-check"></i>7.2.8 Interpreting Three-Factor Interaction Terms</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#statistical-versus-practical-significance-dissimilarity-index"><i class="fa fa-check"></i>7.2.9 Statistical Versus Practical Significance: Dissimilarity Index</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#the-loglinear---logistic-model-connection"><i class="fa fa-check"></i>7.3 The Loglinear - Logistic Model Connection</a><ul>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#using-logistic-models-to-interpret-loglinear-models"><i class="fa fa-check"></i>7.3.1 Using Logistic Models to Interpret Loglinear Models</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#example-auto-accident-data-revisited"><i class="fa fa-check"></i>7.3.2 Example: Auto Accident Data Revisited</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#condition-for-equivalent-loglinear-and-logistic-models"><i class="fa fa-check"></i>7.3.3 Condition for Equivalent Loglinear and Logistic Models</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#loglinearlogistic-model-selection-issues"><i class="fa fa-check"></i>7.3.4 Loglinear/Logistic Model Selection Issues</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#independence-graphs-and-collapsibility"><i class="fa fa-check"></i>7.4 Independence Graphs and Collapsibility</a><ul>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#independence-graphs"><i class="fa fa-check"></i>7.4.1 Independence Graphs</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#collapsibility-conditions-for-contingency-tables"><i class="fa fa-check"></i>7.4.2 Collapsibility Conditions for Contingency Tables</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#example-loglinear-model-building-for-student-substance-use"><i class="fa fa-check"></i>7.4.3 Example: Loglinear Model Building for Student Substance Use</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#collapsibility-and-logistic-models"><i class="fa fa-check"></i>7.4.4 Collapsibility and Logistic Models</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#modeling-ordinal-associations-in-contingency-tables"><i class="fa fa-check"></i>7.5 Modeling Ordinal Associations in Contingency Tables</a><ul>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#linear-by-linear-association-model"><i class="fa fa-check"></i>7.5.1 Linear-by-Linear Association Model</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#example-linear-by-linear-association-for-sex-opinions"><i class="fa fa-check"></i>7.5.2 Example: Linear-by-Linear Association for Sex Opinions</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#ordinal-significance-tests-of-independence"><i class="fa fa-check"></i>7.5.3 Ordinal Significance Tests of Independence</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#loglinear-modeling-of-count-response-variables"><i class="fa fa-check"></i>7.6 Loglinear Modeling of Count Response Variables *</a><ul>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#count-regressoin-modeling-of-rate-data"><i class="fa fa-check"></i>7.6.1 Count Regressoin Modeling of Rate Data</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#example-death-rates-for-lung-cancer-patients"><i class="fa fa-check"></i>7.6.2 Example: Death Rates for Lung Cancer Patients</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#negativee-binomial-regression-models"><i class="fa fa-check"></i>7.6.3 Negativee Binomial Regression Models</a></li>
<li class="chapter" data-level="" data-path="Loglinear.html"><a href="Loglinear.html#example-female-horseshoe-crab-satelites-revisited"><i class="fa fa-check"></i>7.6.4 Example: Female Horseshoe Crab Satelites Revisited</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html"><i class="fa fa-check"></i>8 Models for Matched Pairs</a><ul>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#x8.1"><i class="fa fa-check"></i>8.1 Comparing Dependent Proporitons for Binary Mached Pairs</a><ul>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#mcnemar-test-comparing-marginal-proportions"><i class="fa fa-check"></i>8.1.1 McNemar Test Comparing Marginal Proportions</a></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#estimating-the-difference-between-dependent-proportions"><i class="fa fa-check"></i>8.1.2 Estimating the difference between Dependent Proportions</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#x8.2"><i class="fa fa-check"></i>8.2 Marginal Models and Subject-Specific Models for Matched Pairs</a><ul>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#x8.2.1"><i class="fa fa-check"></i>8.2.1 Marginal Models for Marginal Proportions</a></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#example-enironmental-options-revisted"><i class="fa fa-check"></i>8.2.2 Example: Enironmental Options Revisted</a></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#x8.2.3"><i class="fa fa-check"></i>8.2.3 Subject-Specific and Population-Averaging Tables</a></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#x8.2.4"><i class="fa fa-check"></i>8.2.4 Conditional Logistic Regression for Matched-Pairs*</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#comparing-proportions-for-nominal-matched-pairs-responses"><i class="fa fa-check"></i>8.3 Comparing Proportions for Nominal Matched-Pairs Responses</a><ul>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#marginal-homogeneity-for-baseline-category-logit-models"><i class="fa fa-check"></i>8.3.1 Marginal Homogeneity for Baseline-Category Logit Models</a></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#using-cochran-mantel-haenszel-test-to-test-marinal-homogeneity"><i class="fa fa-check"></i>8.3.3 Using Cochran-Mantel-Haenszel Test to Test marinal Homogeneity*</a></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#x8.3.4"><i class="fa fa-check"></i>8.3.4 Symmetry and Quasi-Symmetry Models for Square Contingency Tables</a></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#example-coffee-brand-market-share-revisited"><i class="fa fa-check"></i>8.3.5 Example: Coffee Brand market Share Revisited</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#comparing-proportions-for-ordinal-matched-pairs-responses"><i class="fa fa-check"></i>8.4 Comparing Proportions for Ordinal Matched-Pairs Responses</a><ul>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#marginal-homogeneity-and-cummulative-logit-marginal-model"><i class="fa fa-check"></i>8.4.1 Marginal Homogeneity and Cummulative Logit Marginal Model</a></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#x8.4.2"><i class="fa fa-check"></i>8.4.2 Example: Recycle or Drive Less to Help the Environment?</a></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#an-ordinal-quasi-symmetry-model"><i class="fa fa-check"></i>8.4.3 An Ordinal Quasi-Symmetry Model *</a></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#example-recycle-or-drive-less-revisited"><i class="fa fa-check"></i>8.4.4 Example: Recycle or Drive Less Revisited?</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#analyzing-rater-agreement"><i class="fa fa-check"></i>8.5 Analyzing Rater Agreement *</a><ul>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#example-agreement-on-carcinoma-diagnosis"><i class="fa fa-check"></i>8.5.1 Example: Agreement on Carcinoma Diagnosis</a></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#cell-residuals-for-independence-model"><i class="fa fa-check"></i>8.5.2 Cell Residuals for Independence Model</a></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#quasi-independence-model"><i class="fa fa-check"></i>8.5.3 Quasi-Independence Model</a></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#quasi-independence-and-odds-ratios-summarizing-agreement"><i class="fa fa-check"></i>8.5.4 Quasi Independence and Odds Ratios Summarizing Agreement</a></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#kappa-summary-measure-of-agreement"><i class="fa fa-check"></i>8.5.5 Kappa Summary Measure of Agreement</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#bradley-terry-model-for-paired-preferences"><i class="fa fa-check"></i>8.6 Bradley-Terry Model for Paired Preferences *</a><ul>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#the-bradley-terry-model-of-quasi-symmetry"><i class="fa fa-check"></i>8.6.1 The Bradley-Terry Model of Quasi-Symmetry</a></li>
<li class="chapter" data-level="" data-path="Matched.html"><a href="Matched.html#example-ranking-men-tennis-players"><i class="fa fa-check"></i>8.6.2 Example: Ranking Men Tennis Players</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html"><i class="fa fa-check"></i>9 Marginal Modeling of Correlated, Clustered Responses</a><ul>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html#marginal-models-vs-subject-specific-models"><i class="fa fa-check"></i>9.1 Marginal Models Vs Subject-Specific Models</a><ul>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html#marginal-models-for-a-clustered-binary-response"><i class="fa fa-check"></i>9.1.1 Marginal Models for a Clustered Binary Response</a></li>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html#x9.1.2"><i class="fa fa-check"></i>9.1.2 Example: Repeated Responses on Similar Survey Questions</a></li>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html#subject-specific-models-for-a-repeated-response"><i class="fa fa-check"></i>9.1.3 Subject-Specific Models for a Repeated Response</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html#marginal-modeling-the-generalized-estimating-equations-gee-approach"><i class="fa fa-check"></i>9.2 Marginal Modeling: The Generalized Estimating Equations (GEE) Approach</a><ul>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html#quasi-likelihood-methods"><i class="fa fa-check"></i>9.2.1 Quasi-Likelihood Methods</a></li>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html#generalized-estimating-equation-methodology-basic-ideas"><i class="fa fa-check"></i>9.2.2 Generalized Estimating Equation Methodology: Basic Ideas</a></li>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html#x9.2.3"><i class="fa fa-check"></i>9.2.3 Example: Opinion about Legalized Abortion Revisited</a></li>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html#limitations-of-gee-compared-to-ml"><i class="fa fa-check"></i>9.2.4 Limitations of GEE Compared to ML</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html#marginal-modeling-for-clustered-multinomial-responses"><i class="fa fa-check"></i>9.3 Marginal Modeling for Clustered Multinomial Responses</a><ul>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html#x9.3.1"><i class="fa fa-check"></i>9.3.1 Example: Insomnia Study</a></li>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html#alternative-gee-specification-of-working-association"><i class="fa fa-check"></i>9.3.2 Alternative GEE Specification of Working Association</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html#transitional-modeling-given-the-past"><i class="fa fa-check"></i>9.4 Transitional Modeling, Given the Past</a><ul>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html#transitional-models-with-explanatory-variables"><i class="fa fa-check"></i>9.4.1 Transitional Models with Explanatory Variables</a></li>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html#example-respiratory-illness-and-maternal-smoking"><i class="fa fa-check"></i>9.4.2 Example: Respiratory Illness and Maternal Smoking</a></li>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html#x9.4.3"><i class="fa fa-check"></i>9.4.3 Group Comparisons Treating Initial Response as Covariate</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html#dealing-with-missing-data"><i class="fa fa-check"></i>9.5 Dealing with Missing Data *</a><ul>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html#missing-at-random-impact-on-ml-and-gee-methods"><i class="fa fa-check"></i>9.5.1 Missing at Random: Impact on ML and GEE Methods</a></li>
<li class="chapter" data-level="" data-path="Marginal.html"><a href="Marginal.html#multiple-imputation-monte-carlo-prediction-of-missing-data"><i class="fa fa-check"></i>9.5.2 Multiple Imputation: Monte Carlo Prediction of missing Data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html"><i class="fa fa-check"></i>10 Random Effects: Generalized Linear Mixed Models</a><ul>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#random-effects-modeling-of-clustered-categorical-data"><i class="fa fa-check"></i>10.1 Random Effects Modeling of Clustered Categorical Data</a><ul>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#the-generalized-linear-mixed-model-glmm"><i class="fa fa-check"></i>10.1.1 The Generalized Linear Mixed Model (GLMM)</a></li>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#a-logistic-glmm-for-binary-matched-pairs"><i class="fa fa-check"></i>10.1.2 A Logistic GLMM for Binary Matched Pairs</a></li>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#example-environmental-opinions-revised"><i class="fa fa-check"></i>10.1.3 Example: Environmental Opinions Revised</a></li>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#differing-effects-in-glmms-and-marginal-models"><i class="fa fa-check"></i>10.1.4 Differing Effects in GLMMs and Marginal Models</a></li>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#model-fitting-for-glmms"><i class="fa fa-check"></i>10.1.5 Model Fitting for GLMMs</a></li>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#inference-for-model-parameters-and-prediction"><i class="fa fa-check"></i>10.1.6 Inference for Model Parameters and Prediction</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#examples-random-effects-models-for-binary-data"><i class="fa fa-check"></i>10.2 Examples: Random Effects Models for Binary Data</a><ul>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#small-area-estimation-of-binomial-probabilities"><i class="fa fa-check"></i>10.2.1 Small-Area Estimation of Binomial Probabilities</a></li>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#example-estimating-basketball-free-throw-success"><i class="fa fa-check"></i>10.2.2 Example: Estimating Basketball Free Throw Success</a></li>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#example-opinions-about-legalizing-abortion-revised"><i class="fa fa-check"></i>10.2.3 Example: Opinions about Legalizing Abortion Revised</a></li>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#item-response-models-the-rasch-model"><i class="fa fa-check"></i>10.2.4 Item Response Models: The Rasch Model</a></li>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#choice-of-marginal-model-or-random-effects-model"><i class="fa fa-check"></i>10.2.5 Choice of Marginal Model or Random Effects Model</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#extensions-to-multinomial-responses-and-multiple-random-effect-terms"><i class="fa fa-check"></i>10.3 Extensions to Multinomial Responses and Multiple Random Effect Terms</a><ul>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#example-insomnia-study-revisited"><i class="fa fa-check"></i>10.3.1 Example: Insomnia Study Revisited</a></li>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#meta-analysis-bivariate-random-effects-for-association-heterogeneity"><i class="fa fa-check"></i>10.3.2 Meta-Analysis: Bivariate Random Effects for Association Heterogeneity</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#multilevel-hierarchical-models"><i class="fa fa-check"></i>10.4 Multilevel (Hierarchical) Models</a><ul>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#example-two-level-model-for-student-performance"><i class="fa fa-check"></i>10.4.1 Example: Two-Level Model for Student Performance</a></li>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#example-smoking-prevention-and-cessation-study"><i class="fa fa-check"></i>10.4.2 Example: Smoking Prevention and Cessation Study</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#latent-class-models"><i class="fa fa-check"></i>10.5 Latent Class Models *</a><ul>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#independence-given-a-latent-categorical-variable"><i class="fa fa-check"></i>10.5.1 Independence Given a Latent Categorical Variable</a></li>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#example-latent-class-model-for-rater-agreement"><i class="fa fa-check"></i>10.5.2 Example: Latent Class Model for Rater Agreement</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Random.html"><a href="Random.html#exercises-2"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html"><i class="fa fa-check"></i>11 Classification and Smoothing</a><ul>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#classification-linear-discrinant-analysis"><i class="fa fa-check"></i>11.1 Classification: Linear Discrinant Analysis</a><ul>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#classification-with-fishers-linear-discriminant-function"><i class="fa fa-check"></i>11.1.1 Classification with Fisher’s Linear Discriminant Function</a></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#example-horseshoe-crab-satellites-revisited-1"><i class="fa fa-check"></i>11.1.2 Example: Horseshoe Crab Satellites Revisited</a></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#discriminant-analysis-versus-logistic-regression"><i class="fa fa-check"></i>11.1.3 Discriminant Analysis Versus Logistic Regression</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#classification-tree-based-prediction"><i class="fa fa-check"></i>11.2 Classification: Tree-Based Prediction</a><ul>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#classification-trees"><i class="fa fa-check"></i>11.2.1 Classification Trees</a></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#example-a-classification-tree-for-horseshoe-crab-mating"><i class="fa fa-check"></i>11.2.2 Example: A classification Tree for Horseshoe Crab Mating</a></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#how-does-the-classification-tree-grow"><i class="fa fa-check"></i>11.2.3 How Does the Classification Tree Grow?</a></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#pruning-a-tree-and-checking-prediction-accuracy"><i class="fa fa-check"></i>11.2.4 Pruning a Tree and Checking Prediction Accuracy</a></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#classification-trees-versus-logistic-regression-and-discriminant-analysis"><i class="fa fa-check"></i>11.2.5 Classification Trees Versus Logistic Regression and Discriminant Analysis</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#cluster-analysis-for-categorical-responses"><i class="fa fa-check"></i>11.3 Cluster Analysis for Categorical Responses</a><ul>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#measuring-dissimilarity-between-observations"><i class="fa fa-check"></i>11.3.1 Measuring Dissimilarity Between Observations</a></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#hierarchical-clustering-algorithm-and-dendrograms"><i class="fa fa-check"></i>11.3.2 Hierarchical Clustering Algorithm and Dendrograms</a></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#example-clustering-states-on-presidential-elections"><i class="fa fa-check"></i>11.3.3 Example: Clustering States on Presidential Elections</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#smoothing-generalized-additive-models"><i class="fa fa-check"></i>11.4 Smoothing: Generalized Additive Models</a><ul>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#generalized-additive-models"><i class="fa fa-check"></i>11.4.1 Generalized Additive Models</a></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#example-gams-for-horseshoe-crab-data"><i class="fa fa-check"></i>11.4.2 Example: GAMs for Horseshoe Crab Data</a></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#how-much-smoothing-the-biasvariance-tradeoff"><i class="fa fa-check"></i>11.4.3 How Much Smoothing? The Bias/Variance Tradeoff</a></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#example-smoothing-to-portray-probability-of-kyphosis"><i class="fa fa-check"></i>11.4.4 Example: Smoothing to Portray Probability of Kyphosis</a></li>
</ul></li>
<li><a href="Classification.html#regularization-for-high-dimensional-categorical-data-large-p">11.5 Regularization for High-Dimensional Categorical Data (Large <em>p</em>)</a><ul>
<li><a href="Classification.html#penalized-likelihood-methods-and-l_q-norm-smoothing">11.5.1 Penalized-Likelihood Methods and <span class="math inline">\(L_q\)</span>-Norm Smoothing</a></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#implementing-the-lasso"><i class="fa fa-check"></i>11.5.2 Implementing the Lasso</a></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#example-predicting-option-on-abortion-with-student-survey"><i class="fa fa-check"></i>11.5.3 Example: Predicting Option on Abortion with Student Survey</a></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#why-shrink-ml-estimates-toward-0"><i class="fa fa-check"></i>11.5.4 Why Shrink ML Estimates Toward 0?</a></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#issues-in-variable-selection-dimension-reduction"><i class="fa fa-check"></i>11.5.5 Issues In variable Selection (Dimension Reduction)</a></li>
<li class="chapter" data-level="" data-path="Classification.html"><a href="Classification.html#controlling-the-false-discovery-rate"><i class="fa fa-check"></i>11.5.6 Controlling the False Discovery Rate</a></li>
<li><a href="Classification.html#large-p-also-makes-bayesian-inference-challenging">11.5.7 Large <span class="math inline">\(p\)</span> also Makes Bayesian Inference Challenging</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="rmarkdown.html"><a href="rmarkdown.html"><i class="fa fa-check"></i>99 R Markdown</a><ul>
<li class="chapter" data-level="" data-path="rmarkdown.html"><a href="rmarkdown.html#formatting"><i class="fa fa-check"></i>Formatting</a></li>
<li class="chapter" data-level="" data-path="rmarkdown.html"><a href="rmarkdown.html#symbols"><i class="fa fa-check"></i>Symbols</a></li>
<li class="chapter" data-level="" data-path="rmarkdown.html"><a href="rmarkdown.html#markdown-highlighting"><i class="fa fa-check"></i>Markdown highlighting</a></li>
<li class="chapter" data-level="" data-path="rmarkdown.html"><a href="rmarkdown.html#text-coloring"><i class="fa fa-check"></i>Text coloring</a></li>
<li class="chapter" data-level="" data-path="rmarkdown.html"><a href="rmarkdown.html#equations"><i class="fa fa-check"></i>Equations</a></li>
<li class="chapter" data-level="" data-path="rmarkdown.html"><a href="rmarkdown.html#x99.4"><i class="fa fa-check"></i>Section references</a></li>
<li class="chapter" data-level="" data-path="rmarkdown.html"><a href="rmarkdown.html#footnotes"><i class="fa fa-check"></i>Footnotes</a></li>
<li class="chapter" data-level="" data-path="rmarkdown.html"><a href="rmarkdown.html#displaying-formula"><i class="fa fa-check"></i>Displaying Formula</a><ul>
<li class="chapter" data-level="" data-path="rmarkdown.html"><a href="rmarkdown.html#notation"><i class="fa fa-check"></i>Notation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="rmarkdown.html"><a href="rmarkdown.html#greek-letters"><i class="fa fa-check"></i>Greek letters</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Notes for Agresti’s Introduction to Categorical Data Analysis 3rd Edition</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="building-and-applying-logistic-regression-models" class="section level1">
<h1>5 Building and Applying Logistic Regression Models</h1>
<div id="strategies-in-model-selection" class="section level2">
<h2>5.1 Strategies in Model Selection</h2>
<div id="how-many-explanatory-variables-can-the-model-handle" class="section level3">
<h3>5.1.1 How Many Explanatory Variables Can the Model Handle?</h3>
</div>
<div id="example-horseshoe-crab-satellites-revisited" class="section level3">
<h3>5.1.2 Example: Horseshoe Crab Satellites Revisited</h3>
<p><span class="math display">\[\mathrm{logit}[P(Y=1)] = \alpha + \beta_1 weight + \beta_2 width + \beta_3 c_2 + \beta_4 c_3 + \beta_5 c_4 + \beta_6 s_2 + \beta_7 s_3\]</span></p>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="building-and-applying-logistic-regression-models.html#cb228-1"></a>Crabs &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;http://users.stat.ufl.edu/~aa/cat/data/Crabs.dat&quot;</span>,</span>
<span id="cb228-2"><a href="building-and-applying-logistic-regression-models.html#cb228-2"></a>  <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">stringsAsFactors =</span> <span class="ot">TRUE</span></span>
<span id="cb228-3"><a href="building-and-applying-logistic-regression-models.html#cb228-3"></a>)</span>
<span id="cb228-4"><a href="building-and-applying-logistic-regression-models.html#cb228-4"></a></span>
<span id="cb228-5"><a href="building-and-applying-logistic-regression-models.html#cb228-5"></a>fit &lt;-<span class="st"> </span><span class="kw">glm</span>(y <span class="op">~</span><span class="st"> </span>weight <span class="op">+</span><span class="st"> </span>width <span class="op">+</span><span class="st"> </span><span class="kw">factor</span>(color) <span class="op">+</span><span class="st"> </span><span class="kw">factor</span>(spine),</span>
<span id="cb228-6"><a href="building-and-applying-logistic-regression-models.html#cb228-6"></a>  <span class="dt">family =</span> binomial, <span class="dt">data =</span> Crabs</span>
<span id="cb228-7"><a href="building-and-applying-logistic-regression-models.html#cb228-7"></a>)</span>
<span id="cb228-8"><a href="building-and-applying-logistic-regression-models.html#cb228-8"></a></span>
<span id="cb228-9"><a href="building-and-applying-logistic-regression-models.html#cb228-9"></a><span class="kw">summary</span>(fit)</span></code></pre></div>
<pre class="custom-output"><code>
Call:
glm(formula = y ~ weight + width + factor(color) + factor(spine), 
    family = binomial, data = Crabs)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.1977  -0.9424   0.4849   0.8491   2.1198  

Coefficients:
               Estimate Std. Error z value Pr(&gt;|z|)  
(Intercept)    -8.06501    3.92855  -2.053   0.0401 *
weight          0.82578    0.70383   1.173   0.2407  
width           0.26313    0.19530   1.347   0.1779  
factor(color)2 -0.10290    0.78259  -0.131   0.8954  
factor(color)3 -0.48886    0.85312  -0.573   0.5666  
factor(color)4 -1.60867    0.93553  -1.720   0.0855 .
factor(spine)2 -0.09598    0.70337  -0.136   0.8915  
factor(spine)3  0.40029    0.50270   0.796   0.4259  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 225.76  on 172  degrees of freedom
Residual deviance: 185.20  on 165  degrees of freedom
AIC: 201.2

Number of Fisher Scoring iterations: 4</code></pre>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="building-and-applying-logistic-regression-models.html#cb230-1"></a>pValue &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">pchisq</span>(<span class="fl">225.76</span> <span class="op">-</span><span class="st"> </span><span class="fl">185.20</span>, <span class="dv">172</span> <span class="op">-</span><span class="st"> </span><span class="dv">165</span>)</span>
<span id="cb230-2"><a href="building-and-applying-logistic-regression-models.html#cb230-2"></a><span class="kw">format</span>(<span class="kw">round</span>(pValue, <span class="dv">8</span>), <span class="dt">scientific =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<pre class="custom-output"><code>[1] &quot;0.00000098&quot;</code></pre>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="building-and-applying-logistic-regression-models.html#cb232-1"></a><span class="kw">library</span>(car)</span>
<span id="cb232-2"><a href="building-and-applying-logistic-regression-models.html#cb232-2"></a><span class="kw">Anova</span>(fit)</span></code></pre></div>
<pre class="custom-output"><code>Analysis of Deviance Table (Type II tests)

Response: y
              LR Chisq Df Pr(&gt;Chisq)  
weight          1.4099  1    0.23507  
width           1.7968  1    0.18010  
factor(color)   7.5958  3    0.05515 .
factor(spine)   1.0091  2    0.60377  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="stepwise-variable-selection-algorithms" class="section level3">
<h3>5.1.3 Stepwise Variable Selection Algorithms</h3>
</div>
<div id="surposeful-selection-of-explanatory-variables" class="section level3">
<h3>5.1.4 Surposeful Selection of Explanatory Variables</h3>
</div>
<div id="example-variable-selection-for-horseshoe-crabs" class="section level3">
<h3>5.1.5 Example: Variable Selection for Horseshoe Crabs</h3>
</div>
<div id="aic-and-the-biasvariance-tradeoff" class="section level3">
<h3>5.1.6 AIC and the Bias/Variance Tradeoff</h3>
<p><span class="math display">\[\mathrm{AIC = -2(log\ likelihood) + 2(number\ of\ parameters\ in\ model).}\]</span></p>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="building-and-applying-logistic-regression-models.html#cb234-1"></a>Crabs &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;http://users.stat.ufl.edu/~aa/cat/data/Crabs.dat&quot;</span>,</span>
<span id="cb234-2"><a href="building-and-applying-logistic-regression-models.html#cb234-2"></a>  <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">stringsAsFactors =</span> <span class="ot">TRUE</span></span>
<span id="cb234-3"><a href="building-and-applying-logistic-regression-models.html#cb234-3"></a>)</span>
<span id="cb234-4"><a href="building-and-applying-logistic-regression-models.html#cb234-4"></a></span>
<span id="cb234-5"><a href="building-and-applying-logistic-regression-models.html#cb234-5"></a>fit &lt;-<span class="st"> </span><span class="kw">glm</span>(y <span class="op">~</span><span class="st"> </span>width <span class="op">+</span><span class="st"> </span><span class="kw">factor</span>(color), <span class="dt">family =</span> binomial, <span class="dt">data =</span> Crabs)</span>
<span id="cb234-6"><a href="building-and-applying-logistic-regression-models.html#cb234-6"></a></span>
<span id="cb234-7"><a href="building-and-applying-logistic-regression-models.html#cb234-7"></a><span class="dv">-2</span><span class="op">*</span><span class="kw">logLik</span>(fit)</span></code></pre></div>
<pre class="custom-output"><code>&#39;log Lik.&#39; 187.457 (df=5)</code></pre>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="building-and-applying-logistic-regression-models.html#cb236-1"></a><span class="kw">AIC</span>(fit)  <span class="co"># adds 2(number of parameters) = 2(5) = 10  to -2*logLik(fit)</span></span></code></pre></div>
<pre class="custom-output"><code>[1] 197.457</code></pre>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="building-and-applying-logistic-regression-models.html#cb238-1"></a>fit &lt;-<span class="st"> </span><span class="kw">glm</span>(y <span class="op">~</span><span class="st"> </span>width <span class="op">+</span><span class="st"> </span><span class="kw">factor</span>(color) <span class="op">+</span><span class="st"> </span><span class="kw">factor</span>(spine), </span>
<span id="cb238-2"><a href="building-and-applying-logistic-regression-models.html#cb238-2"></a>           <span class="dt">family =</span> binomial, <span class="dt">data =</span> Crabs)</span>
<span id="cb238-3"><a href="building-and-applying-logistic-regression-models.html#cb238-3"></a></span>
<span id="cb238-4"><a href="building-and-applying-logistic-regression-models.html#cb238-4"></a><span class="kw">library</span>(MASS)</span>
<span id="cb238-5"><a href="building-and-applying-logistic-regression-models.html#cb238-5"></a><span class="kw">stepAIC</span>(fit)</span></code></pre></div>
<pre class="custom-output"><code>Start:  AIC=200.61
y ~ width + factor(color) + factor(spine)

                Df Deviance    AIC
- factor(spine)  2   187.46 197.46
&lt;none&gt;               186.61 200.61
- factor(color)  3   194.43 202.43
- width          1   208.83 220.83

Step:  AIC=197.46
y ~ width + factor(color)

                Df Deviance    AIC
&lt;none&gt;               187.46 197.46
- factor(color)  3   194.45 198.45
- width          1   212.06 220.06</code></pre>
<pre class="custom-output"><code>
Call:  glm(formula = y ~ width + factor(color), family = binomial, data = Crabs)

Coefficients:
   (Intercept)           width  factor(color)2  factor(color)3  factor(color)4  
     -11.38519         0.46796         0.07242        -0.22380        -1.32992  

Degrees of Freedom: 172 Total (i.e. Null);  168 Residual
Null Deviance:      225.8 
Residual Deviance: 187.5    AIC: 197.5</code></pre>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="building-and-applying-logistic-regression-models.html#cb241-1"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb241-2"><a href="building-and-applying-logistic-regression-models.html#cb241-2"></a><span class="co"># need response variable in last column of data file</span></span>
<span id="cb241-3"><a href="building-and-applying-logistic-regression-models.html#cb241-3"></a>Crabs2 &lt;-<span class="st"> </span>Crabs <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb241-4"><a href="building-and-applying-logistic-regression-models.html#cb241-4"></a><span class="st">  </span><span class="kw">select</span>(weight, width, color, spine, y)</span>
<span id="cb241-5"><a href="building-and-applying-logistic-regression-models.html#cb241-5"></a></span>
<span id="cb241-6"><a href="building-and-applying-logistic-regression-models.html#cb241-6"></a><span class="kw">library</span>(leaps)</span>
<span id="cb241-7"><a href="building-and-applying-logistic-regression-models.html#cb241-7"></a><span class="kw">library</span>(bestglm)</span>
<span id="cb241-8"><a href="building-and-applying-logistic-regression-models.html#cb241-8"></a><span class="kw">bestglm</span>(Crabs2, <span class="dt">family =</span> binomial, <span class="dt">IC =</span> <span class="st">&quot;AIC&quot;</span>)  <span class="co"># can also use IC=&quot;BIC&quot;</span></span></code></pre></div>
<pre><code>Morgan-Tatar search since family is non-gaussian.</code></pre>
<pre class="custom-output"><code>AIC
BICq equivalent for q in (0.477740316103793, 0.876695783647898)
Best Model:
               Estimate Std. Error   z value     Pr(&gt;|z|)
(Intercept) -10.0708390  2.8068339 -3.587971 3.332611e-04
width         0.4583097  0.1040181  4.406056 1.052696e-05
color        -0.5090467  0.2236817 -2.275763 2.286018e-02</code></pre>
</div>
</div>
<div id="model-checking" class="section level2">
<h2>5.2 Model Checking</h2>
<div id="x5.2.1" class="section level3">
<h3>5.2.1 Goodness of Fit: Model Comparison Using the Deviance</h3>
<p><span class="math display">\[G^2 = 2\sum\mathrm{observed[log(observed/fitted)]}\]</span></p>
</div>
<div id="x5.2.2" class="section level3">
<h3>5.2.2 Example: Goodness of Fit for Marijuana Use Survey</h3>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="building-and-applying-logistic-regression-models.html#cb244-1"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb244-2"><a href="building-and-applying-logistic-regression-models.html#cb244-2"></a>Marijuana &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;http://users.stat.ufl.edu/~aa/cat/data/Marijuana.dat&quot;</span>,</span>
<span id="cb244-3"><a href="building-and-applying-logistic-regression-models.html#cb244-3"></a>                        <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">stringsAsFactors =</span> <span class="ot">TRUE</span>)</span>
<span id="cb244-4"><a href="building-and-applying-logistic-regression-models.html#cb244-4"></a>Marijuana</span></code></pre></div>
<pre class="custom-output"><code>   race gender yes  no
1 white female 420 620
2 white   male 483 579
3 other female  25  55
4 other   male  32  62</code></pre>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="building-and-applying-logistic-regression-models.html#cb246-1"></a>fit &lt;-<span class="st"> </span><span class="kw">glm</span>(yes<span class="op">/</span>(yes<span class="op">+</span>no) <span class="op">~</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span>race, <span class="dt">weights =</span> yes <span class="op">+</span><span class="st"> </span>no, <span class="dt">family =</span> binomial, </span>
<span id="cb246-2"><a href="building-and-applying-logistic-regression-models.html#cb246-2"></a>           <span class="dt">data =</span> Marijuana)</span>
<span id="cb246-3"><a href="building-and-applying-logistic-regression-models.html#cb246-3"></a><span class="kw">summary</span>(fit)  <span class="co"># deviance info is extracted on the next two lines</span></span></code></pre></div>
<pre class="custom-output"><code>
Call:
glm(formula = yes/(yes + no) ~ gender + race, family = binomial, 
    data = Marijuana, weights = yes + no)

Deviance Residuals: 
       1         2         3         4  
-0.04513   0.04402   0.17321  -0.15493  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -0.83035    0.16854  -4.927 8.37e-07 ***
gendermale   0.20261    0.08519   2.378  0.01739 *  
racewhite    0.44374    0.16766   2.647  0.00813 ** 
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 12.752784  on 3  degrees of freedom
Residual deviance:  0.057982  on 1  degrees of freedom
AIC: 30.414

Number of Fisher Scoring iterations: 3</code></pre>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="building-and-applying-logistic-regression-models.html#cb248-1"></a>fit<span class="op">$</span>deviance  <span class="co"># deviance goodness-of-fit statistic</span></span></code></pre></div>
<pre class="custom-output"><code>[1] 0.05798151</code></pre>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="building-and-applying-logistic-regression-models.html#cb250-1"></a>fit<span class="op">$</span>df.residual  <span class="co"># residual df</span></span></code></pre></div>
<pre class="custom-output"><code>[1] 1</code></pre>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="building-and-applying-logistic-regression-models.html#cb252-1"></a><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">pchisq</span>(fit<span class="op">$</span>deviance, fit<span class="op">$</span>df.residual )</span></code></pre></div>
<pre class="custom-output"><code>[1] 0.8097152</code></pre>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="building-and-applying-logistic-regression-models.html#cb254-1"></a><span class="kw">fitted</span>(fit)</span></code></pre></div>
<pre class="custom-output"><code>        1         2         3         4 
0.4045330 0.4541297 0.3035713 0.3480244 </code></pre>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="building-and-applying-logistic-regression-models.html#cb256-1"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb256-2"><a href="building-and-applying-logistic-regression-models.html#cb256-2"></a></span>
<span id="cb256-3"><a href="building-and-applying-logistic-regression-models.html#cb256-3"></a>Marijuana <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb256-4"><a href="building-and-applying-logistic-regression-models.html#cb256-4"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">fit.yes =</span> (yes<span class="op">+</span>no)<span class="op">*</span><span class="kw">fitted</span>(fit)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb256-5"><a href="building-and-applying-logistic-regression-models.html#cb256-5"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">fit.no =</span> (yes<span class="op">+</span>no)<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">fitted</span>(fit))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb256-6"><a href="building-and-applying-logistic-regression-models.html#cb256-6"></a><span class="st">  </span><span class="kw">select</span>(race, gender, yes, fit.yes, no, fit.no)</span></code></pre></div>
<pre class="custom-output"><code>   race gender yes   fit.yes  no    fit.no
1 white female 420 420.71429 620 619.28571
2 white   male 483 482.28571 579 579.71429
3 other female  25  24.28571  55  55.71429
4 other   male  32  32.71429  62  61.28571</code></pre>
</div>
<div id="goodness-of-fit-grouped-versus-ungrouped-data-and-continuous-predictors" class="section level3">
<h3>5.2.3 Goodness of Fit: Grouped versus Ungrouped Data and Continuous Predictors</h3>
</div>
<div id="residuals-for-logistic-models-with-categorical-predictors" class="section level3">
<h3>5.2.4 Residuals for Logistic Models with Categorical Predictors</h3>
<p><span class="math display">\[\mathrm{Standardized\ residual} = \frac{y_i-n_i\hat\pi_i}{SE}.\]</span>
### 5.2.5 Example: Graduate Admissoins at University of Florida</p>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="building-and-applying-logistic-regression-models.html#cb258-1"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb258-2"><a href="building-and-applying-logistic-regression-models.html#cb258-2"></a>Admissions &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;http://users.stat.ufl.edu/~aa/cat/data/Admissions.dat&quot;</span>,</span>
<span id="cb258-3"><a href="building-and-applying-logistic-regression-models.html#cb258-3"></a>                        <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">stringsAsFactors =</span> <span class="ot">TRUE</span>)</span>
<span id="cb258-4"><a href="building-and-applying-logistic-regression-models.html#cb258-4"></a></span>
<span id="cb258-5"><a href="building-and-applying-logistic-regression-models.html#cb258-5"></a>theModel &lt;-<span class="st"> </span><span class="kw">glm</span>(yes<span class="op">/</span>(yes<span class="op">+</span>no) <span class="op">~</span><span class="st"> </span>department, <span class="dt">family =</span> binomial, </span>
<span id="cb258-6"><a href="building-and-applying-logistic-regression-models.html#cb258-6"></a>                <span class="dt">data =</span> Admissions, </span>
<span id="cb258-7"><a href="building-and-applying-logistic-regression-models.html#cb258-7"></a>                <span class="dt">weights =</span> yes<span class="op">+</span>no)</span>
<span id="cb258-8"><a href="building-and-applying-logistic-regression-models.html#cb258-8"></a></span>
<span id="cb258-9"><a href="building-and-applying-logistic-regression-models.html#cb258-9"></a>theResiduals &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="st">`</span><span class="dt">Std. Res.</span><span class="st">`</span> =<span class="st"> </span><span class="kw">rstandard</span>(theModel, <span class="dt">type =</span> <span class="st">&quot;pearson&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb258-10"><a href="building-and-applying-logistic-regression-models.html#cb258-10"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">Std. Res.</span><span class="st">`</span> =<span class="st"> </span><span class="kw">round</span>(<span class="st">`</span><span class="dt">Std. Res.</span><span class="st">`</span>, <span class="dv">2</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb258-11"><a href="building-and-applying-logistic-regression-models.html#cb258-11"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">row_number</span>() <span class="op">%%</span><span class="st"> </span><span class="dv">2</span> <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)  <span class="co"># every other record is female</span></span>
<span id="cb258-12"><a href="building-and-applying-logistic-regression-models.html#cb258-12"></a></span>
<span id="cb258-13"><a href="building-and-applying-logistic-regression-models.html#cb258-13"></a></span>
<span id="cb258-14"><a href="building-and-applying-logistic-regression-models.html#cb258-14"></a>theTable &lt;-<span class="st"> </span>Admissions <span class="op">%&gt;%</span><span class="st">                  </span></span>
<span id="cb258-15"><a href="building-and-applying-logistic-regression-models.html#cb258-15"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">gender =</span> <span class="kw">case_when</span>(gender <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">~</span><span class="st"> &quot;Female&quot;</span>,</span>
<span id="cb258-16"><a href="building-and-applying-logistic-regression-models.html#cb258-16"></a>                            gender <span class="op">==</span><span class="st"> </span><span class="dv">0</span> <span class="op">~</span><span class="st"> &quot;Male&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb258-17"><a href="building-and-applying-logistic-regression-models.html#cb258-17"></a><span class="st">  </span><span class="kw">pivot_wider</span>(<span class="dt">id_cols =</span> department, <span class="dt">names_from =</span> gender, </span>
<span id="cb258-18"><a href="building-and-applying-logistic-regression-models.html#cb258-18"></a>              <span class="dt">values_from =</span> <span class="kw">c</span>(yes, no), <span class="dt">names_sep =</span> <span class="st">&quot;&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb258-19"><a href="building-and-applying-logistic-regression-models.html#cb258-19"></a><span class="st">  </span><span class="kw">select</span>(department, yesFemale, noFemale, yesMale, noMale) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb258-20"><a href="building-and-applying-logistic-regression-models.html#cb258-20"></a><span class="st">  </span><span class="kw">rename</span>(<span class="st">&quot;Dept&quot;</span> =<span class="st"> </span>department, <span class="st">&quot;Females (Yes)&quot;</span> =<span class="st"> </span>yesFemale, <span class="st">&quot;Females (No)&quot;</span> =</span>
<span id="cb258-21"><a href="building-and-applying-logistic-regression-models.html#cb258-21"></a><span class="st">           </span>noFemale, <span class="st">&quot;Males (Yes)&quot;</span> =<span class="st"> </span>yesMale, <span class="st">&quot;Males (No)&quot;</span> =<span class="st"> </span>noMale) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb258-22"><a href="building-and-applying-logistic-regression-models.html#cb258-22"></a><span class="st">  </span><span class="kw">bind_cols</span>(theResiduals)</span>
<span id="cb258-23"><a href="building-and-applying-logistic-regression-models.html#cb258-23"></a></span>
<span id="cb258-24"><a href="building-and-applying-logistic-regression-models.html#cb258-24"></a>knitr<span class="op">::</span><span class="kw">kable</span>(theTable)</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
Dept
</th>
<th style="text-align:right;">
Females (Yes)
</th>
<th style="text-align:right;">
Females (No)
</th>
<th style="text-align:right;">
Males (Yes)
</th>
<th style="text-align:right;">
Males (No)
</th>
<th style="text-align:right;">
Std. Res.
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
anthropol
</td>
<td style="text-align:right;">
32
</td>
<td style="text-align:right;">
81
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
41
</td>
<td style="text-align:right;">
-0.76
</td>
</tr>
<tr>
<td style="text-align:left;">
astronomy
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
2.87
</td>
</tr>
<tr>
<td style="text-align:left;">
chemistry
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
43
</td>
<td style="text-align:right;">
34
</td>
<td style="text-align:right;">
110
</td>
<td style="text-align:right;">
-0.27
</td>
</tr>
<tr>
<td style="text-align:left;">
classics
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
-1.07
</td>
</tr>
<tr>
<td style="text-align:left;">
communicat
</td>
<td style="text-align:right;">
52
</td>
<td style="text-align:right;">
149
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
-0.63
</td>
</tr>
<tr>
<td style="text-align:left;">
computersci
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
1.16
</td>
</tr>
<tr>
<td style="text-align:left;">
english
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
112
</td>
<td style="text-align:right;">
0.94
</td>
</tr>
<tr>
<td style="text-align:left;">
geography
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
2.17
</td>
</tr>
<tr>
<td style="text-align:left;">
geology
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
-0.26
</td>
</tr>
<tr>
<td style="text-align:left;">
germanic
</td>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.89
</td>
</tr>
<tr>
<td style="text-align:left;">
history
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
-0.18
</td>
</tr>
<tr>
<td style="text-align:left;">
latinamer
</td>
<td style="text-align:right;">
26
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
1.65
</td>
</tr>
<tr>
<td style="text-align:left;">
linguistics
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
1.37
</td>
</tr>
<tr>
<td style="text-align:left;">
mathematics
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
31
</td>
<td style="text-align:right;">
37
</td>
<td style="text-align:right;">
1.29
</td>
</tr>
<tr>
<td style="text-align:left;">
philosophy
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
1.34
</td>
</tr>
<tr>
<td style="text-align:left;">
physics
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
53
</td>
<td style="text-align:right;">
1.32
</td>
</tr>
<tr>
<td style="text-align:left;">
polisci
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
34
</td>
<td style="text-align:right;">
39
</td>
<td style="text-align:right;">
49
</td>
<td style="text-align:right;">
-0.23
</td>
</tr>
<tr>
<td style="text-align:left;">
psychology
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
123
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
41
</td>
<td style="text-align:right;">
-2.27
</td>
</tr>
<tr>
<td style="text-align:left;">
religion
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1.26
</td>
</tr>
<tr>
<td style="text-align:left;">
romancelang
</td>
<td style="text-align:right;">
29
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0.14
</td>
</tr>
<tr>
<td style="text-align:left;">
sociology
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
33
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
0.30
</td>
</tr>
<tr>
<td style="text-align:left;">
statistics
</td>
<td style="text-align:right;">
23
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
36
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
-0.01
</td>
</tr>
<tr>
<td style="text-align:left;">
zoology
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
62
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
54
</td>
<td style="text-align:right;">
-1.76
</td>
</tr>
</tbody>
</table>
<p><span class="math display">\[logit(\pi_{ik}) = \alpha + \beta_k.\]</span></p>
</div>
<div id="standardized-versus-pearson-and-deviance-residuals" class="section level3">
<h3>5.2.6 Standardized versus Pearson and Deviance Residuals</h3>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="building-and-applying-logistic-regression-models.html#cb259-1"></a>fit &lt;-<span class="st"> </span><span class="kw">glm</span>(yes<span class="op">/</span>(yes<span class="op">+</span>no) <span class="op">~</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span>race, <span class="dt">weights =</span> yes <span class="op">+</span><span class="st"> </span>no, <span class="dt">family =</span> binomial, </span>
<span id="cb259-2"><a href="building-and-applying-logistic-regression-models.html#cb259-2"></a>           <span class="dt">data =</span> Marijuana)</span>
<span id="cb259-3"><a href="building-and-applying-logistic-regression-models.html#cb259-3"></a></span>
<span id="cb259-4"><a href="building-and-applying-logistic-regression-models.html#cb259-4"></a><span class="kw">summary</span>(fit)</span></code></pre></div>
<pre class="custom-output"><code>
Call:
glm(formula = yes/(yes + no) ~ gender + race, family = binomial, 
    data = Marijuana, weights = yes + no)

Deviance Residuals: 
       1         2         3         4  
-0.04513   0.04402   0.17321  -0.15493  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -0.83035    0.16854  -4.927 8.37e-07 ***
gendermale   0.20261    0.08519   2.378  0.01739 *  
racewhite    0.44374    0.16766   2.647  0.00813 ** 
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 12.752784  on 3  degrees of freedom
Residual deviance:  0.057982  on 1  degrees of freedom
AIC: 30.414

Number of Fisher Scoring iterations: 3</code></pre>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="building-and-applying-logistic-regression-models.html#cb261-1"></a>knitr<span class="op">::</span><span class="kw">kable</span>(</span>
<span id="cb261-2"><a href="building-and-applying-logistic-regression-models.html#cb261-2"></a><span class="kw">bind_cols</span>(<span class="dt">Standardized =</span> <span class="kw">rstandard</span>(fit, <span class="dt">type =</span> <span class="st">&quot;pearson&quot;</span>), </span>
<span id="cb261-3"><a href="building-and-applying-logistic-regression-models.html#cb261-3"></a>          <span class="dt">Pearson =</span> <span class="kw">residuals</span>(fit, <span class="dt">type =</span> <span class="st">&quot;pearson&quot;</span>),</span>
<span id="cb261-4"><a href="building-and-applying-logistic-regression-models.html#cb261-4"></a>          <span class="dt">deviance =</span> <span class="kw">residuals</span>(fit, <span class="dt">type =</span> <span class="st">&quot;deviance&quot;</span>), </span>
<span id="cb261-5"><a href="building-and-applying-logistic-regression-models.html#cb261-5"></a>          <span class="st">`</span><span class="dt">std dev.</span><span class="st">`</span> =<span class="st"> </span><span class="kw">rstandard</span>(fit, <span class="dt">type =</span> <span class="st">&quot;deviance&quot;</span>),</span>
<span id="cb261-6"><a href="building-and-applying-logistic-regression-models.html#cb261-6"></a>          <span class="dt">Race =</span> Marijuana<span class="op">$</span>race, <span class="dt">Gender =</span> Marijuana<span class="op">$</span>gender) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb261-7"><a href="building-and-applying-logistic-regression-models.html#cb261-7"></a><span class="st">  </span><span class="kw">mutate_if</span>(is.numeric, round, <span class="dt">digits =</span> <span class="dv">3</span>)</span>
<span id="cb261-8"><a href="building-and-applying-logistic-regression-models.html#cb261-8"></a>)</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:right;">
Standardized
</th>
<th style="text-align:right;">
Pearson
</th>
<th style="text-align:right;">
deviance
</th>
<th style="text-align:right;">
std dev.
</th>
<th style="text-align:left;">
Race
</th>
<th style="text-align:left;">
Gender
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
-0.241
</td>
<td style="text-align:right;">
-0.045
</td>
<td style="text-align:right;">
-0.045
</td>
<td style="text-align:right;">
-0.241
</td>
<td style="text-align:left;">
white
</td>
<td style="text-align:left;">
female
</td>
</tr>
<tr>
<td style="text-align:right;">
0.241
</td>
<td style="text-align:right;">
0.044
</td>
<td style="text-align:right;">
0.044
</td>
<td style="text-align:right;">
0.241
</td>
<td style="text-align:left;">
white
</td>
<td style="text-align:left;">
male
</td>
</tr>
<tr>
<td style="text-align:right;">
0.241
</td>
<td style="text-align:right;">
0.174
</td>
<td style="text-align:right;">
0.173
</td>
<td style="text-align:right;">
0.240
</td>
<td style="text-align:left;">
other
</td>
<td style="text-align:left;">
female
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.241
</td>
<td style="text-align:right;">
-0.155
</td>
<td style="text-align:right;">
-0.155
</td>
<td style="text-align:right;">
-0.241
</td>
<td style="text-align:left;">
other
</td>
<td style="text-align:left;">
male
</td>
</tr>
</tbody>
</table>
</div>
<div id="influence-diagnostics-for-logistic-regression" class="section level3">
<h3>5.2.7 Influence Diagnostics for Logistic Regression</h3>
</div>
<div id="example-heart-disease-and-blood-pressure" class="section level3">
<h3>5.2.8 Example: Heart Disease and Blood Pressure</h3>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="building-and-applying-logistic-regression-models.html#cb262-1"></a>HeartBP &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;http://users.stat.ufl.edu/~aa/cat/data/HeartBP.dat&quot;</span>,</span>
<span id="cb262-2"><a href="building-and-applying-logistic-regression-models.html#cb262-2"></a>                      <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">stringsAsFactors =</span> <span class="ot">TRUE</span>)</span>
<span id="cb262-3"><a href="building-and-applying-logistic-regression-models.html#cb262-3"></a></span>
<span id="cb262-4"><a href="building-and-applying-logistic-regression-models.html#cb262-4"></a>theModel &lt;-<span class="st"> </span><span class="kw">glm</span>(y<span class="op">/</span>n <span class="op">~</span><span class="st"> </span>bp, <span class="dt">family =</span> binomial, <span class="dt">data =</span> HeartBP, <span class="dt">weights =</span> n)</span>
<span id="cb262-5"><a href="building-and-applying-logistic-regression-models.html#cb262-5"></a><span class="kw">summary</span>(theModel)</span></code></pre></div>
<pre class="custom-output"><code>
Call:
glm(formula = y/n ~ bp, family = binomial, data = HeartBP, weights = n)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.0617  -0.5977  -0.2245   0.2140   1.8501  

Coefficients:
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -6.082033   0.724320  -8.397  &lt; 2e-16 ***
bp           0.024338   0.004843   5.025 5.03e-07 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 30.0226  on 7  degrees of freedom
Residual deviance:  5.9092  on 6  degrees of freedom
AIC: 42.61

Number of Fisher Scoring iterations: 4</code></pre>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="building-and-applying-logistic-regression-models.html#cb264-1"></a>predicted &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="kw">fitted</span>(theModel)<span class="op">*</span><span class="st"> </span>HeartBP<span class="op">$</span>n, <span class="dv">1</span>)</span>
<span id="cb264-2"><a href="building-and-applying-logistic-regression-models.html#cb264-2"></a>std_res &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="kw">rstandard</span>(theModel, <span class="dt">type =</span> <span class="st">&quot;pearson&quot;</span>),<span class="dv">2</span>)</span>
<span id="cb264-3"><a href="building-and-applying-logistic-regression-models.html#cb264-3"></a></span>
<span id="cb264-4"><a href="building-and-applying-logistic-regression-models.html#cb264-4"></a><span class="co">#influence.measures(theModel)</span></span>
<span id="cb264-5"><a href="building-and-applying-logistic-regression-models.html#cb264-5"></a>rDfbeta &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">dfbetas</span>(theModel)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb264-6"><a href="building-and-applying-logistic-regression-models.html#cb264-6"></a><span class="st">  </span><span class="kw">select</span>(bp) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb264-7"><a href="building-and-applying-logistic-regression-models.html#cb264-7"></a><span class="st">  </span><span class="kw">transmute</span>(<span class="dt">DFbeta =</span> <span class="kw">round</span>(bp, <span class="dv">2</span>))</span>
<span id="cb264-8"><a href="building-and-applying-logistic-regression-models.html#cb264-8"></a></span>
<span id="cb264-9"><a href="building-and-applying-logistic-regression-models.html#cb264-9"></a>HeartBP <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb264-10"><a href="building-and-applying-logistic-regression-models.html#cb264-10"></a><span class="st">  </span><span class="kw">rename</span>(<span class="st">&quot;Blood Presure&quot;</span> =<span class="st"> </span>bp,</span>
<span id="cb264-11"><a href="building-and-applying-logistic-regression-models.html#cb264-11"></a>         <span class="st">&quot;Sample size&quot;</span> =<span class="st"> </span>n,</span>
<span id="cb264-12"><a href="building-and-applying-logistic-regression-models.html#cb264-12"></a>         <span class="st">&quot;Observed Disease&quot;</span> =<span class="st"> </span>y) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb264-13"><a href="building-and-applying-logistic-regression-models.html#cb264-13"></a><span class="st">  </span><span class="kw">bind_cols</span>(<span class="st">&quot;Fitted Disease&quot;</span> =<span class="st"> </span>predicted,</span>
<span id="cb264-14"><a href="building-and-applying-logistic-regression-models.html#cb264-14"></a>            <span class="st">&quot;Standardized Residual&quot;</span> =<span class="st"> </span>std_res,</span>
<span id="cb264-15"><a href="building-and-applying-logistic-regression-models.html#cb264-15"></a>            <span class="st">&quot;Dfbeta (not SAS)&quot;</span> =<span class="st"> </span>rDfbeta)</span></code></pre></div>
<pre class="custom-output"><code>  Blood Presure Sample size Observed Disease Fitted Disease
1         111.5         156                3            5.2
2         121.5         252               17           10.6
3         131.5         284               12           15.1
4         141.5         271               16           18.1
5         151.5         139               12           11.6
6         161.5          85                8            8.9
7         176.5          99               16           14.2
8         191.5          43                8            8.4
  Standardized Residual DFbeta
1                 -1.11   0.56
2                  2.37  -2.24
3                 -0.95   0.34
4                 -0.57   0.08
5                  0.13   0.01
6                 -0.33  -0.06
7                  0.65   0.38
8                 -0.18  -0.11</code></pre>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="building-and-applying-logistic-regression-models.html#cb266-1"></a><span class="kw">library</span>(ggthemes)</span>
<span id="cb266-2"><a href="building-and-applying-logistic-regression-models.html#cb266-2"></a>predicted &lt;-<span class="st"> </span><span class="kw">predict</span>(theModel, <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb266-3"><a href="building-and-applying-logistic-regression-models.html#cb266-3"></a>HeartBP <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb266-4"><a href="building-and-applying-logistic-regression-models.html#cb266-4"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">proportion=</span>y<span class="op">/</span>n) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb266-5"><a href="building-and-applying-logistic-regression-models.html#cb266-5"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span> bp, <span class="dt">y =</span> proportion)) <span class="op">+</span></span>
<span id="cb266-6"><a href="building-and-applying-logistic-regression-models.html#cb266-6"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">shape =</span> <span class="dv">4</span>) <span class="op">+</span></span>
<span id="cb266-7"><a href="building-and-applying-logistic-regression-models.html#cb266-7"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="kw">aes</span>(<span class="dt">y =</span> predicted)) <span class="op">+</span></span>
<span id="cb266-8"><a href="building-and-applying-logistic-regression-models.html#cb266-8"></a><span class="st">  </span><span class="kw">theme_few</span>() <span class="op">+</span></span>
<span id="cb266-9"><a href="building-and-applying-logistic-regression-models.html#cb266-9"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">110</span>, <span class="dv">200</span>, <span class="dt">by =</span> <span class="dv">10</span>), <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">110</span>, <span class="dv">200</span>)) <span class="op">+</span></span>
<span id="cb266-10"><a href="building-and-applying-logistic-regression-models.html#cb266-10"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Figure 5.1&quot;</span>)</span></code></pre></div>
<pre><code>`geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-56-1.png" width="672" /></p>
</div>
</div>
<div id="infinite-estimates-in-logistic-regression" class="section level2">
<h2>5.3 Infinite Estimates in Logistic Regression</h2>
<div id="complete-and-quasi-complete-separation-perfeect-discrination" class="section level3">
<h3>5.3.1 Complete and Quasi-Complete Separation: Perfeect Discrination</h3>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="building-and-applying-logistic-regression-models.html#cb268-1"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb268-2"><a href="building-and-applying-logistic-regression-models.html#cb268-2"></a><span class="kw">library</span>(ggthemes)</span>
<span id="cb268-3"><a href="building-and-applying-logistic-regression-models.html#cb268-3"></a><span class="kw">data.frame</span> (<span class="dt">x =</span> <span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">40</span>, <span class="dv">60</span>, <span class="dv">70</span>, <span class="dv">80</span>, <span class="dv">90</span>),</span>
<span id="cb268-4"><a href="building-and-applying-logistic-regression-models.html#cb268-4"></a>                         <span class="dt">y =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb268-5"><a href="building-and-applying-logistic-regression-models.html#cb268-5"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y)) <span class="op">+</span></span>
<span id="cb268-6"><a href="building-and-applying-logistic-regression-models.html#cb268-6"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb268-7"><a href="building-and-applying-logistic-regression-models.html#cb268-7"></a><span class="st">  </span><span class="kw">theme_few</span>() <span class="op">+</span></span>
<span id="cb268-8"><a href="building-and-applying-logistic-regression-models.html#cb268-8"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Figure 5.2&quot;</span>) <span class="op">+</span></span>
<span id="cb268-9"><a href="building-and-applying-logistic-regression-models.html#cb268-9"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="op">+</span></span>
<span id="cb268-10"><a href="building-and-applying-logistic-regression-models.html#cb268-10"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb268-11"><a href="building-and-applying-logistic-regression-models.html#cb268-11"></a>        <span class="dt">axis.ticks.x =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb268-12"><a href="building-and-applying-logistic-regression-models.html#cb268-12"></a>        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">0</span>, <span class="dt">vjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb268-13"><a href="building-and-applying-logistic-regression-models.html#cb268-13"></a>        <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>)) </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-57-1.png" width="672" /></p>
</div>
<div id="example-infinite-estimate-for-toy-example" class="section level3">
<h3>5.3.2 Example: Infinite Estimate for Toy Example</h3>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb269-1"><a href="building-and-applying-logistic-regression-models.html#cb269-1"></a>x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">40</span>, <span class="dv">60</span>, <span class="dv">70</span>, <span class="dv">80</span>, <span class="dv">90</span>)</span>
<span id="cb269-2"><a href="building-and-applying-logistic-regression-models.html#cb269-2"></a>y &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb269-3"><a href="building-and-applying-logistic-regression-models.html#cb269-3"></a></span>
<span id="cb269-4"><a href="building-and-applying-logistic-regression-models.html#cb269-4"></a>fit &lt;-<span class="st"> </span><span class="kw">glm</span>(y <span class="op">~</span><span class="st"> </span>x, <span class="dt">family =</span> binomial)</span></code></pre></div>
<pre><code>Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</code></pre>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb271-1"><a href="building-and-applying-logistic-regression-models.html#cb271-1"></a><span class="co"># P-value for Wald test of H0: beta = 0</span></span>
<span id="cb271-2"><a href="building-and-applying-logistic-regression-models.html#cb271-2"></a><span class="co"># res deviance = 0 means perfect fit</span></span>
<span id="cb271-3"><a href="building-and-applying-logistic-regression-models.html#cb271-3"></a><span class="co"># Fisher iterations: 25 shows very slow convergence</span></span>
<span id="cb271-4"><a href="building-and-applying-logistic-regression-models.html#cb271-4"></a><span class="kw">summary</span>(fit)</span></code></pre></div>
<pre class="custom-output"><code>
Call:
glm(formula = y ~ x, family = binomial)

Deviance Residuals: 
       Min          1Q      Median          3Q         Max  
-1.045e-05  -2.110e-08   0.000e+00   2.110e-08   1.045e-05  

Coefficients:
              Estimate Std. Error z value Pr(&gt;|z|)
(Intercept)   -118.158 296046.187       0        1
x                2.363   5805.939       0        1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1.1090e+01  on 7  degrees of freedom
Residual deviance: 2.1827e-10  on 6  degrees of freedom
AIC: 4

Number of Fisher Scoring iterations: 25</code></pre>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb273-1"><a href="building-and-applying-logistic-regression-models.html#cb273-1"></a><span class="co"># maximized log-likelihood = 0, so maximized likelihood = 1</span></span>
<span id="cb273-2"><a href="building-and-applying-logistic-regression-models.html#cb273-2"></a><span class="kw">logLik</span>(fit)</span></code></pre></div>
<pre class="custom-output"><code>&#39;log Lik.&#39; -1.09134e-10 (df=2)</code></pre>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="building-and-applying-logistic-regression-models.html#cb275-1"></a><span class="co">#library(car)</span></span>
<span id="cb275-2"><a href="building-and-applying-logistic-regression-models.html#cb275-2"></a><span class="co"># P-value for likelihood-ratio test of beta = 0 is more sensitive than p-value of 1 for Wald test</span></span>
<span id="cb275-3"><a href="building-and-applying-logistic-regression-models.html#cb275-3"></a>car<span class="op">::</span><span class="kw">Anova</span>(fit)</span></code></pre></div>
<pre class="custom-output"><code>Analysis of Deviance Table (Type II tests)

Response: y
  LR Chisq Df Pr(&gt;Chisq)    
x    11.09  1  0.0008678 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="building-and-applying-logistic-regression-models.html#cb277-1"></a><span class="kw">library</span>(profileModel) <span class="co"># ordinary confint function fails for infinite estimates</span></span>
<span id="cb277-2"><a href="building-and-applying-logistic-regression-models.html#cb277-2"></a><span class="kw">confintModel</span>(fit, <span class="dt">objective =</span> <span class="st">&quot;ordinaryDeviance&quot;</span>, <span class="dt">method =</span> <span class="st">&quot;zoom&quot;</span>)</span></code></pre></div>
<pre class="custom-output"><code>Preliminary iteration .. Done

Profiling for parameter (Intercept) ... Done
Profiling for parameter x ... Done
Zooming for parameter (Intercept) ...
Zooming for parameter x ...</code></pre>
<pre class="custom-output"><code>                 Lower    Upper
(Intercept)       -Inf -2.66963
x           0.05876605      Inf
attr(,&quot;fitted object&quot;)
fit</code></pre>
</div>
<div id="sparse-data-and-infinite-effects-with-categorical-predictors" class="section level3">
<h3>5.3.3 Sparse Data and Infinite Effects with Categorical Predictors</h3>
</div>
<div id="x5.3.5" class="section level3">
<h3>5.3.4 Example: Risk Factors for Endometrial Cancer Grade</h3>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="building-and-applying-logistic-regression-models.html#cb280-1"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb280-2"><a href="building-and-applying-logistic-regression-models.html#cb280-2"></a>Endo &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;http://users.stat.ufl.edu/~aa/cat/data/Endometrial.dat&quot;</span>,</span>
<span id="cb280-3"><a href="building-and-applying-logistic-regression-models.html#cb280-3"></a>                   <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">stringsAsFactors =</span> <span class="ot">TRUE</span>)</span>
<span id="cb280-4"><a href="building-and-applying-logistic-regression-models.html#cb280-4"></a></span>
<span id="cb280-5"><a href="building-and-applying-logistic-regression-models.html#cb280-5"></a>Endo <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb280-6"><a href="building-and-applying-logistic-regression-models.html#cb280-6"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">row_number</span>() <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="kw">n</span>())) </span></code></pre></div>
<pre class="custom-output"><code>  NV PI   EH HG
1  0 13 1.64  0
2  0 16 2.26  0
3  0 33 0.85  1</code></pre>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="building-and-applying-logistic-regression-models.html#cb282-1"></a><span class="kw">xtabs</span>(<span class="op">~</span>NV <span class="op">+</span><span class="st"> </span>HG, <span class="dt">data =</span> Endo) <span class="co"># quasi-complete separation when NV = 1, no HG=0 cases occur</span></span></code></pre></div>
<pre class="custom-output"><code>   HG
NV   0  1
  0 49 17
  1  0 13</code></pre>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb284-1"><a href="building-and-applying-logistic-regression-models.html#cb284-1"></a>fit &lt;-<span class="st"> </span><span class="kw">glm</span>(HG <span class="op">~</span><span class="st"> </span>NV <span class="op">+</span><span class="st"> </span>PI <span class="op">+</span><span class="st"> </span>EH, <span class="dt">family =</span> binomial, <span class="dt">data =</span> Endo)</span>
<span id="cb284-2"><a href="building-and-applying-logistic-regression-models.html#cb284-2"></a></span>
<span id="cb284-3"><a href="building-and-applying-logistic-regression-models.html#cb284-3"></a><span class="co"># NV&#39;s true estimate is infinity</span></span>
<span id="cb284-4"><a href="building-and-applying-logistic-regression-models.html#cb284-4"></a><span class="kw">summary</span>(fit)</span></code></pre></div>
<pre class="custom-output"><code>
Call:
glm(formula = HG ~ NV + PI + EH, family = binomial, data = Endo)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-1.50137  -0.64108  -0.29432   0.00016   2.72777  

Coefficients:
              Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)    4.30452    1.63730   2.629 0.008563 ** 
NV            18.18556 1715.75089   0.011 0.991543    
PI            -0.04218    0.04433  -0.952 0.341333    
EH            -2.90261    0.84555  -3.433 0.000597 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 104.903  on 78  degrees of freedom
Residual deviance:  55.393  on 75  degrees of freedom
AIC: 63.393

Number of Fisher Scoring iterations: 17</code></pre>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb286-1"><a href="building-and-applying-logistic-regression-models.html#cb286-1"></a><span class="kw">logLik</span>(fit)</span></code></pre></div>
<pre class="custom-output"><code>&#39;log Lik.&#39; -27.69663 (df=4)</code></pre>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb288-1"><a href="building-and-applying-logistic-regression-models.html#cb288-1"></a><span class="kw">library</span>(car)</span>
<span id="cb288-2"><a href="building-and-applying-logistic-regression-models.html#cb288-2"></a><span class="kw">Anova</span>(fit) <span class="co"># NV P= .0022 vs Wald 0.99</span></span></code></pre></div>
<pre class="custom-output"><code>Analysis of Deviance Table (Type II tests)

Response: HG
   LR Chisq Df Pr(&gt;Chisq)    
NV   9.3576  1   0.002221 ** 
PI   0.9851  1   0.320934    
EH  19.7606  1  8.777e-06 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb290-1"><a href="building-and-applying-logistic-regression-models.html#cb290-1"></a><span class="kw">library</span>(profileModel)  <span class="co"># ordinary confint function fails for infinite est</span></span>
<span id="cb290-2"><a href="building-and-applying-logistic-regression-models.html#cb290-2"></a><span class="kw">confintModel</span>(fit, <span class="dt">objective =</span> <span class="st">&quot;ordinaryDeviance&quot;</span>, <span class="dt">method =</span> <span class="st">&quot;zoom&quot;</span>) <span class="co"># 95% profile likelihood CI for beta 1 </span></span></code></pre></div>
<pre class="custom-output"><code>Preliminary iteration .... Done

Profiling for parameter (Intercept) ... Done
Profiling for parameter NV ... Done
Profiling for parameter PI ... Done
Profiling for parameter EH ... Done
Zooming for parameter (Intercept) ...
Zooming for parameter NV ...
Zooming for parameter PI ...
Zooming for parameter EH ...</code></pre>
<pre class="custom-output"><code>                 Lower       Upper
(Intercept)  1.4290183  7.94717425
NV           1.2856920         Inf
PI          -0.1370717  0.03810556
EH          -4.7866976 -1.43682244
attr(,&quot;fitted object&quot;)
fit</code></pre>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb293-1"><a href="building-and-applying-logistic-regression-models.html#cb293-1"></a><span class="kw">library</span>(detectseparation) <span class="co"># new package</span></span>
<span id="cb293-2"><a href="building-and-applying-logistic-regression-models.html#cb293-2"></a><span class="co"># 0 denotes finite est, Inf denotes infinite est.</span></span>
<span id="cb293-3"><a href="building-and-applying-logistic-regression-models.html#cb293-3"></a><span class="kw">glm</span>(HG <span class="op">~</span><span class="st"> </span>NV <span class="op">+</span><span class="st"> </span>PI <span class="op">+</span><span class="st"> </span>EH, <span class="dt">family =</span> binomial, <span class="dt">data =</span> Endo, <span class="dt">method =</span> <span class="st">&quot;detectSeparation&quot;</span>)</span></code></pre></div>
<pre class="custom-output"><code>Implementation: ROI | Solver: lpsolve 
Separation: TRUE 
Existence of maximum likelihood estimates
(Intercept)          NV          PI          EH 
          0         Inf           0           0 
0: finite value, Inf: infinity, -Inf: -infinity</code></pre>
</div>
</div>
<div id="x5.4" class="section level2">
<h2>5.4 Bayesian Inference, Penalized Likelihood, and Conditional Likelihood for Logistic Regression *</h2>
<div id="bayesian-modeling-specification-of-prior-distributions" class="section level3">
<h3>5.4.1 Bayesian Modeling: Specification of Prior Distributions</h3>
</div>
<div id="example-risk-factors-for-endometrial-caner-revisited" class="section level3">
<h3>5.4.2 Example: Risk Factors for Endometrial Caner Revisited</h3>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb295-1"><a href="building-and-applying-logistic-regression-models.html#cb295-1"></a>Endo2 &lt;-<span class="st"> </span></span>
<span id="cb295-2"><a href="building-and-applying-logistic-regression-models.html#cb295-2"></a><span class="st">  </span>Endo <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb295-3"><a href="building-and-applying-logistic-regression-models.html#cb295-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">PI2 =</span> <span class="kw">scale</span>(PI),</span>
<span id="cb295-4"><a href="building-and-applying-logistic-regression-models.html#cb295-4"></a>         <span class="dt">EH2 =</span> <span class="kw">scale</span>(EH),</span>
<span id="cb295-5"><a href="building-and-applying-logistic-regression-models.html#cb295-5"></a>         <span class="dt">NV2 =</span> NV <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span>) </span>
<span id="cb295-6"><a href="building-and-applying-logistic-regression-models.html#cb295-6"></a>  </span>
<span id="cb295-7"><a href="building-and-applying-logistic-regression-models.html#cb295-7"></a>fit.ML &lt;-<span class="st"> </span><span class="kw">glm</span>(HG <span class="op">~</span><span class="st"> </span>NV2 <span class="op">+</span><span class="st"> </span>PI2 <span class="op">+</span><span class="st"> </span>EH2, <span class="dt">family =</span> binomial, <span class="dt">data =</span> Endo2)</span>
<span id="cb295-8"><a href="building-and-applying-logistic-regression-models.html#cb295-8"></a><span class="kw">summary</span>(fit.ML)</span></code></pre></div>
<pre class="custom-output"><code>
Call:
glm(formula = HG ~ NV2 + PI2 + EH2, family = binomial, data = Endo2)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-1.50137  -0.64108  -0.29432   0.00016   2.72777  

Coefficients:
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)    7.8411   857.8755   0.009 0.992707    
NV2           18.1856  1715.7509   0.011 0.991543    
PI2           -0.4217     0.4432  -0.952 0.341333    
EH2           -1.9219     0.5599  -3.433 0.000597 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 104.903  on 78  degrees of freedom
Residual deviance:  55.393  on 75  degrees of freedom
AIC: 63.393

Number of Fisher Scoring iterations: 17</code></pre>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb297-1"><a href="building-and-applying-logistic-regression-models.html#cb297-1"></a><span class="kw">library</span>(MCMCpack)  <span class="co"># b0 = prior mean, B0 = prior precision = 1/variance</span></span></code></pre></div>
<pre><code>Loading required package: coda</code></pre>
<pre><code>##
## Markov Chain Monte Carlo Package (MCMCpack)</code></pre>
<pre><code>## Copyright (C) 2003-2021 Andrew D. Martin, Kevin M. Quinn, and Jong Hee Park</code></pre>
<pre><code>##
## Support provided by the U.S. National Science Foundation</code></pre>
<pre><code>## (Grants SES-0350646 and SES-0350613)
##</code></pre>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb303-1"><a href="building-and-applying-logistic-regression-models.html#cb303-1"></a>fitBayes &lt;-<span class="st"> </span><span class="kw">MCMClogit</span>(HG <span class="op">~</span><span class="st"> </span>NV2 <span class="op">+</span><span class="st"> </span>PI2 <span class="op">+</span><span class="st"> </span>EH2, <span class="dt">mcmc =</span> <span class="dv">100000</span>, <span class="dt">b0 =</span> <span class="dv">0</span>, <span class="dt">B0 =</span> <span class="fl">0.01</span>, </span>
<span id="cb303-2"><a href="building-and-applying-logistic-regression-models.html#cb303-2"></a>                      <span class="dt">data =</span> Endo2) <span class="co"># prior var = 1/0.01 = 100, sd = 10</span></span>
<span id="cb303-3"><a href="building-and-applying-logistic-regression-models.html#cb303-3"></a></span>
<span id="cb303-4"><a href="building-and-applying-logistic-regression-models.html#cb303-4"></a><span class="kw">summary</span>(fitBayes) <span class="co"># posterior deviation</span></span></code></pre></div>
<pre class="custom-output"><code>
Iterations = 1001:101000
Thinning interval = 1 
Number of chains = 1 
Sample size per chain = 1e+05 

1. Empirical mean and standard deviation for each variable,
   plus standard error of the mean:

               Mean     SD Naive SE Time-series SE
(Intercept)  3.2356 2.5948 0.008206       0.026682
NV2          9.1626 5.1639 0.016330       0.053109
PI2         -0.4711 0.4546 0.001437       0.006376
EH2         -2.1332 0.5879 0.001859       0.008450

2. Quantiles for each variable:

               2.5%     25%     50%     75%   97.5%
(Intercept) -0.3391  1.2619  2.7161  4.6972  9.4865
NV2          2.1105  5.2437  8.1064 12.1133 21.6077
PI2         -1.4163 -0.7676 -0.4445 -0.1538  0.3538
EH2         -3.3781 -2.5087 -2.0977 -1.7227 -1.0786</code></pre>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb305-1"><a href="building-and-applying-logistic-regression-models.html#cb305-1"></a><span class="kw">mean</span>(fitBayes[,<span class="dv">2</span>] <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>)  <span class="co"># probability below 0 for 2n model parameter (NV2)</span></span></code></pre></div>
<pre class="custom-output"><code>[1] 0.00016</code></pre>
</div>
<div id="penalized-likelihood-reduces-bias-in-logistic-regression" class="section level3">
<h3>5.4.3 Penalized Likelihood Reduces Bias in Logistic Regression</h3>
<p><span class="math display">\[L^*(\beta) = L(\beta) - s(\beta),\]</span></p>
</div>
<div id="example-risk-factors-for-endometrial-cancer-revisited" class="section level3">
<h3>5.4.4 Example: Risk Factors for Endometrial Cancer Revisited</h3>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb307-1"><a href="building-and-applying-logistic-regression-models.html#cb307-1"></a><span class="kw">library</span>(logistf)</span>
<span id="cb307-2"><a href="building-and-applying-logistic-regression-models.html#cb307-2"></a>fit.penalized &lt;-<span class="st"> </span><span class="kw">logistf</span>(HG <span class="op">~</span><span class="st"> </span>NV2 <span class="op">+</span><span class="st"> </span>PI2 <span class="op">+</span><span class="st"> </span>EH2, <span class="dt">family=</span>binomial, <span class="dt">data=</span>Endo2)</span>
<span id="cb307-3"><a href="building-and-applying-logistic-regression-models.html#cb307-3"></a><span class="kw">options</span>(<span class="dt">digits =</span> <span class="dv">4</span>)</span>
<span id="cb307-4"><a href="building-and-applying-logistic-regression-models.html#cb307-4"></a><span class="kw">summary</span>(fit.penalized)</span></code></pre></div>
<pre class="custom-output"><code>logistf(formula = HG ~ NV2 + PI2 + EH2, data = Endo2, family = binomial)

Model fitted by Penalized ML
Coefficients:
               coef se(coef) lower 0.95 upper 0.95   Chisq         p method
(Intercept)  0.3080   0.8006    -0.9755     2.7888  0.1690 6.810e-01      2
NV2          2.9293   1.5508     0.6097     7.8546  6.7985 9.124e-03      2
PI2         -0.3474   0.3957    -1.2443     0.4045  0.7468 3.875e-01      2
EH2         -1.7243   0.5138    -2.8903    -0.8162 17.7593 2.507e-05      2

Method: 1-Wald, 2-Profile penalized log-likelihood, 3-None

Likelihood ratio test=43.66 on 3 df, p=1.786e-09, n=79
Wald test = 17.48 on 3 df, p = 0.000563</code></pre>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb309-1"><a href="building-and-applying-logistic-regression-models.html#cb309-1"></a><span class="kw">options</span>(<span class="dt">digits =</span> <span class="dv">7</span>)</span></code></pre></div>
</div>
<div id="x5.4.5" class="section level3">
<h3>5.4.5 Conditional Likelihood and Conditional Logistic Regression</h3>
<p><span class="math display">\[\mathrm{logit}[P(Y_{it} = 1)] = \alpha_i + \beta x_{it},\]</span></p>
</div>
<div id="conditional-logistic-regression-and-exact-tests-for-contingency-tables" class="section level3">
<h3>5.4.6 Conditional Logistic Regression and Exact Tests for Contingency Tables</h3>
</div>
</div>
<div id="alternative-link-functions-linear-probability-and-probit-models" class="section level2">
<h2>5.5 Alternative Link Functions: Linear Probability and Probit Models *</h2>
<div id="linar-probability-model" class="section level3">
<h3>5.5.1 Linar Probability Model</h3>
<p><span class="math display">\[F(Y = 1) = \alpha + \beta_1 x_1 + \cdots + \beta_px_p,\]</span></p>
</div>
<div id="example-political-ideology-and-belief-in-evolution-1" class="section level3">
<h3>5.5.2 Example: Political Ideology and Belief in Evolution</h3>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb310-1"><a href="building-and-applying-logistic-regression-models.html#cb310-1"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb310-2"><a href="building-and-applying-logistic-regression-models.html#cb310-2"></a>Evo &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;http://users.stat.ufl.edu/~aa/cat/data/Evolution2.dat&quot;</span>,</span>
<span id="cb310-3"><a href="building-and-applying-logistic-regression-models.html#cb310-3"></a>                        <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">stringsAsFactors =</span> <span class="ot">TRUE</span>)</span>
<span id="cb310-4"><a href="building-and-applying-logistic-regression-models.html#cb310-4"></a></span>
<span id="cb310-5"><a href="building-and-applying-logistic-regression-models.html#cb310-5"></a>Evo <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb310-6"><a href="building-and-applying-logistic-regression-models.html#cb310-6"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">row_number</span>() <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="kw">n</span>())) </span></code></pre></div>
<pre class="custom-output"><code>  ideology evolved
1        1       1
2        1       1
3        7       0</code></pre>
<div class="sourceCode" id="cb312"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb312-1"><a href="building-and-applying-logistic-regression-models.html#cb312-1"></a>fit &lt;-<span class="st"> </span><span class="kw">glm</span>(evolved <span class="op">~</span><span class="st"> </span>ideology, </span>
<span id="cb312-2"><a href="building-and-applying-logistic-regression-models.html#cb312-2"></a>           <span class="dt">family=</span><span class="kw">quasi</span>(<span class="dt">link=</span>identity, <span class="dt">variance =</span> <span class="st">&quot;mu(1-mu)&quot;</span>), </span>
<span id="cb312-3"><a href="building-and-applying-logistic-regression-models.html#cb312-3"></a>           <span class="dt">data =</span> Evo)</span>
<span id="cb312-4"><a href="building-and-applying-logistic-regression-models.html#cb312-4"></a></span>
<span id="cb312-5"><a href="building-and-applying-logistic-regression-models.html#cb312-5"></a><span class="kw">summary</span>(fit, <span class="dt">dispersion =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre class="custom-output"><code>
Call:
glm(formula = evolved ~ ideology, family = quasi(link = identity, 
    variance = &quot;mu(1-mu)&quot;), data = Evo)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.0558  -1.2617   0.7247   1.0954   1.7440  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) 0.108437   0.038932   2.785  0.00535 ** 
ideology    0.110102   0.008971  12.273  &lt; 2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for quasi family taken to be 1)

    Null deviance: 1469.3  on 1063  degrees of freedom
Residual deviance: 1359.5  on 1062  degrees of freedom
AIC: NA

Number of Fisher Scoring iterations: 3</code></pre>
<div class="sourceCode" id="cb314"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb314-1"><a href="building-and-applying-logistic-regression-models.html#cb314-1"></a>fit2 &lt;-<span class="st"> </span><span class="kw">glm</span>(evolved <span class="op">~</span><span class="st"> </span>ideology, <span class="dt">family=</span><span class="kw">gaussian</span>(<span class="dt">link=</span>identity), <span class="dt">data =</span> Evo)</span>
<span id="cb314-2"><a href="building-and-applying-logistic-regression-models.html#cb314-2"></a></span>
<span id="cb314-3"><a href="building-and-applying-logistic-regression-models.html#cb314-3"></a><span class="kw">summary</span>(fit2)</span></code></pre></div>
<pre class="custom-output"><code>
Call:
glm(formula = evolved ~ ideology, family = gaussian(link = identity), 
    data = Evo)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-0.8819  -0.5492   0.2290   0.4508   0.7836  

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.10554    0.04272    2.47   0.0137 *  
ideology     0.11091    0.01033   10.73   &lt;2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for gaussian family taken to be 0.2247506)

    Null deviance: 264.57  on 1063  degrees of freedom
Residual deviance: 238.69  on 1062  degrees of freedom
AIC: 1435.2

Number of Fisher Scoring iterations: 2</code></pre>
</div>
<div id="x5.5.3" class="section level3">
<h3>5.5.3 Probit Model and Normal Latent Variable Model</h3>
<p><span class="math display">\[\mathrm{probit}[F(Y = 1)] = \alpha + \beta_1 x_1 + \cdots + \beta_px_p\]</span></p>
<p><span class="math display">\[y^* = \alpha + \beta_1 x_1+ \cdots + \beta_px_p + \epsilon.\]</span></p>
</div>
<div id="example-snoring-and-heart-disease-revisited" class="section level3">
<h3>5.5.4 Example: Snoring and Heart Disease Revisited</h3>
<p><span class="math display">\[\mathrm{probit}[\hat P(Y = 1)] = -2.061 + 0.188x.\]</span></p>
<div class="sourceCode" id="cb316"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb316-1"><a href="building-and-applying-logistic-regression-models.html#cb316-1"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb316-2"><a href="building-and-applying-logistic-regression-models.html#cb316-2"></a>Heart &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;http://users.stat.ufl.edu/~aa/cat/data/Heart.dat&quot;</span>,</span>
<span id="cb316-3"><a href="building-and-applying-logistic-regression-models.html#cb316-3"></a>                        <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">stringsAsFactors =</span> <span class="ot">TRUE</span>)</span>
<span id="cb316-4"><a href="building-and-applying-logistic-regression-models.html#cb316-4"></a>Heart</span></code></pre></div>
<pre class="custom-output"><code>             snoring yes   no
1              never  24 1355
2         occasional  35  603
3 nearly_every_night  21  192
4        every_night  30  224</code></pre>
<div class="sourceCode" id="cb318"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb318-1"><a href="building-and-applying-logistic-regression-models.html#cb318-1"></a><span class="co"># recode() is in dplyr and car...</span></span>
<span id="cb318-2"><a href="building-and-applying-logistic-regression-models.html#cb318-2"></a>Heart &lt;-<span class="st"> </span>Heart <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb318-3"><a href="building-and-applying-logistic-regression-models.html#cb318-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">snoringNights =</span> dplyr<span class="op">::</span><span class="kw">recode</span>(snoring, <span class="dt">never =</span> <span class="dv">0</span>, <span class="dt">occasional =</span> <span class="dv">2</span>, </span>
<span id="cb318-4"><a href="building-and-applying-logistic-regression-models.html#cb318-4"></a>                                       <span class="dt">nearly_every_night =</span> <span class="dv">4</span>, <span class="dt">every_night =</span> <span class="dv">5</span>)) </span>
<span id="cb318-5"><a href="building-and-applying-logistic-regression-models.html#cb318-5"></a></span>
<span id="cb318-6"><a href="building-and-applying-logistic-regression-models.html#cb318-6"></a>fit &lt;-<span class="st"> </span><span class="kw">glm</span>(yes<span class="op">/</span>(yes<span class="op">+</span>no) <span class="op">~</span><span class="st"> </span>snoringNights, <span class="dt">family =</span> <span class="kw">binomial</span>(<span class="dt">link =</span> probit), </span>
<span id="cb318-7"><a href="building-and-applying-logistic-regression-models.html#cb318-7"></a>           <span class="dt">weights =</span> yes<span class="op">+</span>no, <span class="dt">data =</span> Heart)</span>
<span id="cb318-8"><a href="building-and-applying-logistic-regression-models.html#cb318-8"></a></span>
<span id="cb318-9"><a href="building-and-applying-logistic-regression-models.html#cb318-9"></a><span class="kw">summary</span>(fit)</span></code></pre></div>
<pre class="custom-output"><code>
Call:
glm(formula = yes/(yes + no) ~ snoringNights, family = binomial(link = probit), 
    data = Heart, weights = yes + no)

Deviance Residuals: 
      1        2        3        4  
-0.6188   1.0388   0.1684  -0.6175  

Coefficients:
              Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)   -2.06055    0.07017 -29.367  &lt; 2e-16 ***
snoringNights  0.18777    0.02348   7.997 1.28e-15 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 65.9045  on 3  degrees of freedom
Residual deviance:  1.8716  on 2  degrees of freedom
AIC: 26.124

Number of Fisher Scoring iterations: 4</code></pre>
<div class="sourceCode" id="cb320"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb320-1"><a href="building-and-applying-logistic-regression-models.html#cb320-1"></a><span class="kw">options</span>(<span class="dt">digits =</span> <span class="dv">4</span>)</span>
<span id="cb320-2"><a href="building-and-applying-logistic-regression-models.html#cb320-2"></a><span class="kw">fitted</span>(fit)</span></code></pre></div>
<pre class="custom-output"><code>      1       2       3       4 
0.01967 0.04599 0.09519 0.13100 </code></pre>
<div class="sourceCode" id="cb322"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb322-1"><a href="building-and-applying-logistic-regression-models.html#cb322-1"></a><span class="kw">options</span>(<span class="dt">digits =</span> <span class="dv">7</span>)</span></code></pre></div>
</div>
<div id="latent-variable-models-imply-binary-regression-models" class="section level3">
<h3>5.5.5 Latent Variable Models Imply Binary Regression Models</h3>
</div>
<div id="cdfs-and-shapes-of-curves-for-binary-reegressoin-models" class="section level3">
<h3>5.5.6 CDFs and Shapes of Curves for Binary Reegressoin Models</h3>
</div>
</div>
<div id="sample-size-and-power-for-logistic-regression" class="section level2">
<h2>5.6 Sample Size and Power for Logistic Regression *</h2>
<div id="sample-size-for-comparing-two-proportions" class="section level3">
<h3>5.6.1 Sample Size for Comparing Two Proportions</h3>
</div>
<div id="sample-size-in-logistic-regression-modeling" class="section level3">
<h3>5.6.2 Sample Size in Logistic Regression Modeling</h3>
</div>
<div id="example-modeling-the-probability-of-heart-disease" class="section level3">
<h3>5.6.3 Example: Modeling the Probability of Heart Disease</h3>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="Logistic.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="Multicategory.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": false
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
